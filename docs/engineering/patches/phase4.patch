diff -ruN '--exclude=.devlogs' '--exclude=venv' '--exclude=node_modules' '--exclude=__pycache__' /tmp/AntiHub.phase3.base/config.py /home/user2643/code/AntiHub/config.py
--- /tmp/AntiHub.phase3.base/config.py	2026-01-22 21:52:23.262380687 +0800
+++ /home/user2643/code/AntiHub/config.py	2026-01-22 22:43:15.719418211 +0800
@@ -1,28 +1,83 @@
-import os
-
-REDIS_URL = os.getenv("REDIS_URL", "redis://localhost:6379/0")
-PUBLIC_HOST = os.getenv("PUBLIC_HOST", "localhost")
-DEFAULT_BRANCH = os.getenv("DEFAULT_BRANCH", "main")
-BUILD_ROOT = os.getenv("BUILD_ROOT", "/tmp/builds")
-
-PORT_POOL_START = int(os.getenv("PORT_POOL_START", "30000"))
-PORT_POOL_END = int(os.getenv("PORT_POOL_END", "30100"))
-PORT_MODE = os.getenv("PORT_MODE", "pool")  # pool | dynamic
-
-LOG_RETENTION_LINES = int(os.getenv("LOG_RETENTION_LINES", "2000"))
-LOG_LIST_PREFIX = os.getenv("LOG_LIST_PREFIX", "logs:")
-WS_LOG_CHANNEL_PREFIX = os.getenv("WS_LOG_CHANNEL_PREFIX", "build_logs:")
-CASE_PREFIX = os.getenv("CASE_PREFIX", "case:")
+import os
+from typing import Any, Dict
+
+import yaml
+
+ROOT_DIR = os.path.dirname(__file__)
+APP_ENV = os.getenv("APP_ENV", "dev")
+CONFIG_PATH = os.getenv("CONFIG_PATH", os.path.join(ROOT_DIR, "config.yaml"))
+
+
+def _load_config(path: str, env: str) -> Dict[str, Any]:
+    if not os.path.exists(path):
+        return {}
+    try:
+        with open(path, "r", encoding="utf-8") as handle:
+            data = yaml.safe_load(handle) or {}
+    except Exception:
+        return {}
+    if isinstance(data, dict) and env in data and isinstance(data[env], dict):
+        return data[env]
+    if isinstance(data, dict):
+        return data
+    return {}
+
+
+_CONFIG = _load_config(CONFIG_PATH, APP_ENV)
+
+
+def _get(name: str, default: Any) -> Any:
+    if name in os.environ:
+        return os.environ[name]
+    if isinstance(_CONFIG, dict):
+        if name in _CONFIG:
+            return _CONFIG[name]
+        lower = name.lower()
+        if lower in _CONFIG:
+            return _CONFIG[lower]
+    return default
+
+
+REDIS_URL = _get("REDIS_URL", "redis://localhost:6379/0")
+PUBLIC_HOST = _get("PUBLIC_HOST", "localhost")
+DEFAULT_BRANCH = _get("DEFAULT_BRANCH", "main")
+BUILD_ROOT = _get("BUILD_ROOT", "/tmp/builds")
+MANUAL_ROOT = _get("MANUAL_ROOT", "/tmp/manuals")
+AUTO_MANUAL = str(_get("AUTO_MANUAL", "false")).lower() in {"1", "true", "yes"}
+MANUAL_TREE_DEPTH = int(_get("MANUAL_TREE_DEPTH", "2"))
+MANUAL_MAX_README_CHARS = int(_get("MANUAL_MAX_README_CHARS", "1200"))
+MANUAL_GENERATOR_VERSION = str(_get("MANUAL_GENERATOR_VERSION", "v0.4"))
+
+PORT_POOL_START = int(_get("PORT_POOL_START", "30000"))
+PORT_POOL_END = int(_get("PORT_POOL_END", "30100"))
+PORT_MODE = str(_get("PORT_MODE", "pool"))  # pool | dynamic
+
+LOG_RETENTION_LINES = int(_get("LOG_RETENTION_LINES", "2000"))
+LOG_LIST_PREFIX = _get("LOG_LIST_PREFIX", "logs:")
+WS_LOG_CHANNEL_PREFIX = _get("WS_LOG_CHANNEL_PREFIX", "build_logs:")
+CASE_PREFIX = _get("CASE_PREFIX", "case:")
+MANUAL_PREFIX = _get("MANUAL_PREFIX", "manual:")
+MANUAL_META_PREFIX = _get("MANUAL_META_PREFIX", "manual_meta:")
+MANUAL_STATUS_PREFIX = _get("MANUAL_STATUS_PREFIX", "manual_status:")
+MANUAL_STATS_KEY = _get("MANUAL_STATS_KEY", "manual_stats")
 
 CORS_ORIGINS = [
     origin.strip()
-    for origin in os.getenv(
-        "CORS_ORIGINS",
-        "http://127.0.0.1:5173,http://localhost:5173",
+    for origin in str(
+        _get(
+            "CORS_ORIGINS",
+            "http://127.0.0.1:5173,http://localhost:5173",
+        )
     ).split(",")
     if origin.strip()
 ]
-
-GIT_CLONE_TIMEOUT_SECONDS = int(os.getenv("GIT_CLONE_TIMEOUT_SECONDS", "120"))
-DOCKER_BUILD_TIMEOUT_SECONDS = int(os.getenv("DOCKER_BUILD_TIMEOUT_SECONDS", "1800"))
-STARTUP_TIMEOUT_SECONDS = int(os.getenv("STARTUP_TIMEOUT_SECONDS", "120"))
+
+CASE_LABEL_KEY = _get("CASE_LABEL_KEY", "antihub.case_id")
+CASE_LABEL_MANAGED = _get("CASE_LABEL_MANAGED", "antihub.managed")
+
+GIT_CLONE_TIMEOUT_SECONDS = int(_get("GIT_CLONE_TIMEOUT_SECONDS", "120"))
+DOCKER_BUILD_TIMEOUT_SECONDS = int(_get("DOCKER_BUILD_TIMEOUT_SECONDS", "1800"))
+STARTUP_TIMEOUT_SECONDS = int(_get("STARTUP_TIMEOUT_SECONDS", "120"))
+ANALYZE_TIMEOUT_SECONDS = int(_get("ANALYZE_TIMEOUT_SECONDS", "300"))
+
+CASE_TEMPLATES = _get("CASE_TEMPLATES", [])
diff -ruN '--exclude=.devlogs' '--exclude=venv' '--exclude=node_modules' '--exclude=__pycache__' /tmp/AntiHub.phase3.base/config.yaml /home/user2643/code/AntiHub/config.yaml
--- /tmp/AntiHub.phase3.base/config.yaml	1970-01-01 08:00:00.000000000 +0800
+++ /home/user2643/code/AntiHub/config.yaml	2026-01-22 22:46:56.591476419 +0800
@@ -0,0 +1,43 @@
+dev:
+  public_host: "localhost"
+  auto_manual: false
+  manual_root: "/tmp/manuals"
+  manual_tree_depth: 2
+  manual_max_readme_chars: 1200
+  manual_generator_version: "v0.4"
+  git_clone_timeout_seconds: 120
+  docker_build_timeout_seconds: 1800
+  startup_timeout_seconds: 120
+  analyze_timeout_seconds: 300
+  case_templates:
+    - name: "Hello World"
+      repo_url: "/home/user2643/code/AntiHub/test-repos/hello-world"
+      ref: "master"
+      default_env_keys: []
+      build_mode: "light"
+      port_mode: "pool"
+      timeouts:
+        clone: 120
+        build: 1800
+        run: 120
+        analyze: 300
+    - name: "MetaGPT Demo"
+      repo_url: "/home/user2643/code/AntiHub/test-repos/metagpt-min"
+      ref: "master"
+      default_env_keys:
+        - "OPENAI_API_KEY"
+      build_mode: "standard"
+      port_mode: "pool"
+      timeouts:
+        clone: 120
+        build: 1800
+        run: 120
+        analyze: 300
+prod:
+  public_host: "127.0.0.1"
+  auto_manual: true
+  manual_root: "/data/manuals"
+  manual_tree_depth: 2
+  manual_max_readme_chars: 1200
+  manual_generator_version: "v0.4"
+  case_templates: []
diff -ruN '--exclude=.devlogs' '--exclude=venv' '--exclude=node_modules' '--exclude=__pycache__' /tmp/AntiHub.phase3.base/docker_ops.py /home/user2643/code/AntiHub/docker_ops.py
--- /tmp/AntiHub.phase3.base/docker_ops.py	2026-01-20 20:43:28.985769484 +0800
+++ /home/user2643/code/AntiHub/docker_ops.py	2026-01-22 21:21:11.782959255 +0800
@@ -66,12 +66,14 @@
     image: str,
     container_port: int,
     environment: Optional[Dict[str, str]] = None,
+    labels: Optional[Dict[str, str]] = None,
 ) -> Tuple[str, int]:
     container = client.containers.run(
         image,
         detach=True,
         ports={f"{container_port}/tcp": None},
         environment=environment or {},
+        labels=labels or {},
     )
     container.reload()
     ports = container.attrs.get("NetworkSettings", {}).get("Ports", {})
@@ -88,12 +90,14 @@
     container_port: int,
     host_port: int,
     environment: Optional[Dict[str, str]] = None,
+    labels: Optional[Dict[str, str]] = None,
 ) -> str:
     container = client.containers.run(
         image,
         detach=True,
         ports={f"{container_port}/tcp": host_port},
         environment=environment or {},
+        labels=labels or {},
     )
     return container.id
 
diff -ruN '--exclude=.devlogs' '--exclude=venv' '--exclude=node_modules' '--exclude=__pycache__' /tmp/AntiHub.phase3.base/errors.py /home/user2643/code/AntiHub/errors.py
--- /tmp/AntiHub.phase3.base/errors.py	1970-01-01 08:00:00.000000000 +0800
+++ /home/user2643/code/AntiHub/errors.py	2026-01-22 22:53:19.796045952 +0800
@@ -0,0 +1,90 @@
+from typing import Dict
+
+ERROR_CODE_MAP: Dict[str, Dict[str, str]] = {
+    "PORT_POOL_EXHAUSTED": {
+        "message": "端口池已满",
+        "hint": "停止旧容器或扩大端口范围。",
+    },
+    "PORT_IN_USE": {
+        "message": "端口已被占用",
+        "hint": "请等待端口释放或改用其他端口。",
+    },
+    "GIT_CLONE_FAILED": {
+        "message": "Git 克隆失败",
+        "hint": "检查仓库地址、网络与权限配置。",
+    },
+    "GIT_CLONE_TIMEOUT": {
+        "message": "Git 克隆超时",
+        "hint": "缩小仓库或提升克隆超时。",
+    },
+    "DOCKER_BUILD_FAILED": {
+        "message": "Docker 构建失败",
+        "hint": "检查 Dockerfile 与构建日志。",
+    },
+    "DOCKER_API_ERROR": {
+        "message": "Docker 守护进程异常",
+        "hint": "确认 Docker 服务可用、磁盘空间充足。",
+    },
+    "DOCKERFILE_MISSING": {
+        "message": "Dockerfile 缺失",
+        "hint": "请在仓库根目录补齐 Dockerfile。",
+    },
+    "CONTAINER_EXITED": {
+        "message": "容器启动阶段退出",
+        "hint": "确认进程持续运行且监听端口正确。",
+    },
+    "CONTAINER_EXIT_NONZERO": {
+        "message": "容器非零退出",
+        "hint": "检查应用启动日志与依赖配置。",
+    },
+    "STARTUP_TIMEOUT": {
+        "message": "容器启动超时",
+        "hint": "确认应用监听 0.0.0.0 且端口匹配 EXPOSE。",
+    },
+    "TIMEOUT_CLONE": {
+        "message": "克隆超时",
+        "hint": "优化仓库体积或提升超时配置。",
+    },
+    "TIMEOUT_BUILD": {
+        "message": "构建超时",
+        "hint": "减少构建步骤或提升超时配置。",
+    },
+    "TIMEOUT_RUN": {
+        "message": "启动超时",
+        "hint": "检查应用启动耗时与健康检查。",
+    },
+    "TIMEOUT_ANALYZE": {
+        "message": "分析超时",
+        "hint": "简化分析步骤或提升超时配置。",
+    },
+    "STOPPED_BY_USER": {
+        "message": "已手动停止",
+        "hint": "可使用 Restart 重新启动。",
+    },
+    "ARCHIVED": {
+        "message": "已归档",
+        "hint": "可在列表中启用 include_archived 查看。",
+    },
+    "MANUAL_GENERATION_FAILED": {
+        "message": "说明书生成失败",
+        "hint": "检查仓库结构与 README，稍后重试。",
+    },
+    "MANUAL_CLONE_FAILED": {
+        "message": "说明书克隆失败",
+        "hint": "确认仓库地址可访问。",
+    },
+    "MANUAL_PARSE_FAILED": {
+        "message": "说明书解析失败",
+        "hint": "检查仓库文件编码与权限。",
+    },
+    "UNEXPECTED_ERROR": {
+        "message": "未知错误",
+        "hint": "查看日志详情或联系管理员。",
+    },
+}
+
+
+def explain_error(code: str | None) -> Dict[str, str] | None:
+    if not code:
+        return None
+    return ERROR_CODE_MAP.get(code)
diff -ruN '--exclude=.devlogs' '--exclude=venv' '--exclude=node_modules' '--exclude=__pycache__' /tmp/AntiHub.phase3.base/fourth.md /home/user2643/code/AntiHub/fourth.md
--- /tmp/AntiHub.phase3.base/fourth.md	1970-01-01 08:00:00.000000000 +0800
+++ /home/user2643/code/AntiHub/fourth.md	2026-01-23 00:22:56.582925795 +0800
@@ -0,0 +1,157 @@
+# Phase 4 智能展厅 + 体验打磨·配置升级验收报告
+
+## 1. 概述 / 范围 / 结论
+- 范围：在 Phase 3 Dashboard + 运维动作 + 日志导出基础上，新增“说明书自动生成 + Mermaid + 前端展示”，补齐错误码字典、healthz、配置体系与模板、端口池锁、超时控制与日志脱敏。
+- 结论：**PASS**（后端与核心能力完成；前端依赖已在 WSL 内安装成功，启动步骤见第 11 节）。
+
+## 2. 新增能力清单（Phase 4）
+- 智能展厅：支持每个 case 生成说明书 Markdown（含 Mermaid 图），支持状态查询与手动重新生成。
+- Dashboard：新增说明书状态列、模板创建入口、管理动作与分页筛选。
+- 详情页：Tab 化（Overview / Logs / Manual），Manual 支持 Markdown + Mermaid 渲染。
+- 体验打磨：错误统一 toast（带详情展开）、日志搜索/过滤/跳到最新/自动重连。
+- 后端稳定性：healthz、错误码字典、日志敏感信息脱敏、端口池锁优化。
+- 配置体系：`config.yaml` + 环境变量覆盖，新增 Case Template 方案。
+
+## 3. Manual 模板与信号来源说明
+- README：优先 `README.md/README.MD/README`，截取前 1200 字摘要。
+- Tree：默认深度 2，过滤 `.git/node_modules/venv/dist/build` 等目录。
+- 配置文件：识别 `.env(.example)`、`*.yaml/yml/toml/json`、`docker-compose.yml`、`pyproject.toml`、`package.json`、`requirements.txt`。
+- Dockerfile：解析 base image、EXPOSE、CMD/ENTRYPOINT；无 Dockerfile 则在说明书提示。
+- 降级策略：README 缺失时仍输出最小可用说明书（signals.has_readme = false）。
+
+## 4. Manual API 契约（OpenAPI 可见）
+- `POST /cases/{id}/manual`：触发生成，返回状态。
+- `GET /cases/{id}/manual/status`：查询状态（PENDING/RUNNING/SUCCESS/FAILED）。
+- `GET /cases/{id}/manual`：获取说明书 Markdown + meta。
+- 管理接口：`GET /cases`、`POST /cases/{id}/stop|restart|retry|archive`、`GET /cases/{id}/logs`。
+- 相关管理 API：`GET /case-templates`、`GET /error-codes`、`GET /stats`、`GET /healthz`。
+
+示例：
+```json
+// POST /cases/{id}/manual
+{"case_id":"c_ddec58","status":"PENDING"}
+```
+```json
+// GET /cases/{id}/manual
+{
+  "case_id":"c_ddec58",
+  "manual_markdown":"# ...",
+  "meta":{
+    "generated_at":1769096734.13,
+    "generator_version":"v0.4",
+    "signals":{"has_readme":true,"has_dockerfile":true,"tree_depth":2,"file_count":3},
+    "time_cost_ms":12
+  }
+}
+```
+
+## 5. Mermaid 示例（来自说明书）
+```mermaid
+flowchart TD
+  A[Repo Source] --> B[Build Image]
+  B --> C[Container Runtime]
+  C --> D[Access URL]
+  C --> E[Logs Stream]
+```
+
+## 6. UX 打磨项
+- 全局错误提示：统一 toast + 详情展开。
+- 日志体验：关键词搜索 + stream 过滤 + 自动滚动/暂停 + “跳到最新” + 断线自动重连（指数退避）。
+- 危险操作：Stop/Retry/Archive/Regenerate 二次确认 + 操作反馈。
+- 空态/加载态：Manual 未生成、日志为空、请求失败均有提示。
+
+## 7. 配置体系说明（config.yaml + env 覆盖）
+- 新增 `config.yaml`：支持 dev/prod 配置，支持 `APP_ENV` / `CONFIG_PATH` 覆盖。
+- Case Template：`name/repo_url/ref/default_env_keys/build_mode/port_mode/timeouts`。
+- 说明书生成配置：`manual_root/manual_tree_depth/manual_max_readme_chars`。
+
+## 8. 端口池 / 状态机 / 错误码字典
+- 状态机：PENDING/CLONING/BUILDING/STARTING/RUNNING/FAILED/STOPPED/FINISHED/ARCHIVED（归档为软删除，不影响运行状态）。
+- 端口池：Redis 端口锁，容器退出或 stop 时释放，防止并发冲突。
+- 错误码字典：`/error-codes` 提供 message + hint（如 TIMEOUT_*、PORT_*、DOCKER_*）。
+
+## 9. 测试证据（6 项 + 2 仓库 E2E）
+1) 说明书生成（README 正常）：
+- case：`c_ddec58`
+- 证据：`.devlogs/phase4_case3_manual.json`
+
+2) 说明书降级（README 缺失）：
+- case：`c_d8cd8e`
+- 证据：`.devlogs/phase4_fail_manual.json`（signals.has_readme=false）
+
+3) Regenerate 更新：
+- case：`c_ddec58`
+- 证据：`.devlogs/phase4_case3_manual_regen.json`
+
+4) 安全脱敏（日志中 *_KEY/*TOKEN/*SECRET）：
+- case：`c_ddec58`
+- 证据：`.devlogs/phase4_case3_logs_scrub.jsonl`（value 已替换为 ***）
+
+5) /healthz 正常与 Redis Down：
+- 证据：`.devlogs/phase4_healthz_ok.json`、`.devlogs/phase4_healthz_redis_down.json`
+
+6) 端口池并发（3 个 case 同时启动）：
+- 证据：`.devlogs/phase4_port_pool_status2.json`（30000/30001/30002）
+
+E2E 用例 1（hello-world RUNNING）：
+- case：`c_ddec58`
+- 状态：`.devlogs/phase4_case3_status.json`
+- 日志：`.devlogs/phase4_case3_logs.jsonl`
+- 访问：`http://localhost:30000` -> 200
+
+E2E 用例 2（metagpt-min RUNNING）：
+- case：`c_2c1376`
+- 状态：`.devlogs/phase4_case_metagpt_status.json`
+- 日志：`.devlogs/phase4_case_metagpt_logs.jsonl`
+- 访问：`http://localhost:30003` -> 200
+
+失败/重试/归档链路：
+- case：`c_d8cd8e`
+- 失败：`.devlogs/phase4_fail_status.json`
+- Retry：`.devlogs/phase4_fail_retry.json`、`.devlogs/phase4_fail_status_after_retry.json`
+- Archive：`.devlogs/phase4_fail_archive.json` + 列表对比（`.devlogs/phase4_list_no_archived2.json` / `.devlogs/phase4_list_include_archived2.json`）
+
+## 10. 演示脚本（5 分钟）
+1) 进入 Dashboard，刷新列表与筛选状态。
+2) 进入 Create 页面，选择模板 / 填写 repo，创建 case。
+3) 列表中出现新 case，进入详情页查看状态与 access_url。
+4) 打开 Logs 页，演示搜索/过滤/自动重连。
+5) 切换 Manual 页，展示说明书与 Mermaid。
+6) 点击 Stop -> Restart，查看状态变化。
+7) 触发 Retry（失败 case）并查看错误码。
+8) 导出日志 JSONL。
+9) Archive 隐藏 case，include_archived 再查看。
+
+## 11. 启动说明
+- 后端：`./dev.sh up`
+- 前端：`cd frontend && npm install && npm run dev`
+- 配置：`config.yaml`（可用 `APP_ENV` / `CONFIG_PATH` 覆盖）
+
+## 12. 问题清单与修复记录（含 patch）
+- 已修复：说明书生成、配置体系、错误码字典、healthz、端口锁与日志脱敏。
+- 已修复：前端依赖安装 UNC 路径问题（WSL 内使用 Node 18 后安装成功）。
+- 当前阻塞：无。
+
+Patch：`phase4.patch`
+- 应用：`patch -p0 < phase4.patch`
+- 回滚：`patch -R -p0 < phase4.patch`
+
+## 13. 对接/沟通清单 + SLA
+对接清单（需甲方确认）：
+- 镜像源/镜像仓库（私有仓库账号与白名单）
+- 资源配额（CPU/Mem/GPU、磁盘、并发限制）
+- 网络策略（出站限制、域名白名单、端口范围）
+- 运行域名与 HTTPS 证书
+- 日志与监控平台接入方式
+
+响应机制（建议 SLA）：
+- P0（全站不可用）：1 小时内响应、4 小时内恢复
+- P1（核心功能不可用）：4 小时内响应、24 小时内恢复
+- P2（局部/边缘问题）：1 个工作日内响应
+
+## 14. Phase 5 建议
+1) 生产化部署（镜像化、多环境配置、CI/CD）
+2) 说明书模板可编辑与版本对比
+3) 更完善的权限与审计
+4) 扩展观测指标（Prometheus/Grafana）
+5) 产出完整交付包与运维手册
diff -ruN '--exclude=.devlogs' '--exclude=venv' '--exclude=node_modules' '--exclude=__pycache__' /tmp/AntiHub.phase3.base/frontend/package-lock.json /home/user2643/code/AntiHub/frontend/package-lock.json
--- /tmp/AntiHub.phase3.base/frontend/package-lock.json	2026-01-22 21:52:23.262380687 +0800
+++ /home/user2643/code/AntiHub/frontend/package-lock.json	2026-01-23 00:21:40.859431137 +0800
@@ -8,6 +8,8 @@
       "name": "antihub-console",
       "version": "0.0.0",
       "dependencies": {
+        "marked": "^12.0.2",
+        "mermaid": "^10.9.1",
         "react": "^18.3.1",
         "react-dom": "^18.3.1"
       },
@@ -301,6 +303,12 @@
         "node": ">=6.9.0"
       }
     },
+    "node_modules/@braintree/sanitize-url": {
+      "version": "6.0.4",
+      "resolved": "https://registry.npmjs.org/@braintree/sanitize-url/-/sanitize-url-6.0.4.tgz",
+      "integrity": "sha512-s3jaWicZd0pkP0jf5ysyHUI/RE7MHos6qlToFcGWXVp+ykHOy77OUMrfbgJ9it2C5bow7OIQwYYaHjk9XlBQ2A==",
+      "license": "MIT"
+    },
     "node_modules/@esbuild/aix-ppc64": {
       "version": "0.21.5",
       "resolved": "https://registry.npmjs.org/@esbuild/aix-ppc64/-/aix-ppc64-0.21.5.tgz",
@@ -1144,6 +1152,36 @@
         "@babel/types": "^7.28.2"
       }
     },
+    "node_modules/@types/d3-scale": {
+      "version": "4.0.9",
+      "resolved": "https://registry.npmjs.org/@types/d3-scale/-/d3-scale-4.0.9.tgz",
+      "integrity": "sha512-dLmtwB8zkAeO/juAMfnV+sItKjlsw2lKdZVVy6LRr0cBmegxSABiLEpGVmSJJ8O08i4+sGR6qQtb6WtuwJdvVw==",
+      "license": "MIT",
+      "dependencies": {
+        "@types/d3-time": "*"
+      }
+    },
+    "node_modules/@types/d3-scale-chromatic": {
+      "version": "3.1.0",
+      "resolved": "https://registry.npmjs.org/@types/d3-scale-chromatic/-/d3-scale-chromatic-3.1.0.tgz",
+      "integrity": "sha512-iWMJgwkK7yTRmWqRB5plb1kadXyQ5Sj8V/zYlFGMUBbIPKQScw+Dku9cAAMgJG+z5GYDoMjWGLVOvjghDEFnKQ==",
+      "license": "MIT"
+    },
+    "node_modules/@types/d3-time": {
+      "version": "3.0.4",
+      "resolved": "https://registry.npmjs.org/@types/d3-time/-/d3-time-3.0.4.tgz",
+      "integrity": "sha512-yuzZug1nkAAaBlBBikKZTgzCeA+k1uy4ZFwWANOfKw5z5LRhV0gNA7gNkKm7HoK+HRN0wX3EkxGk0fpbWhmB7g==",
+      "license": "MIT"
+    },
+    "node_modules/@types/debug": {
+      "version": "4.1.12",
+      "resolved": "https://registry.npmjs.org/@types/debug/-/debug-4.1.12.tgz",
+      "integrity": "sha512-vIChWdVG3LG1SMxEvI/AK+FWJthlrqlTu7fbrlywTkkaONwk/UAGaULXRlf8vkzFBLVm0zkMdCquhL5aOjhXPQ==",
+      "license": "MIT",
+      "dependencies": {
+        "@types/ms": "*"
+      }
+    },
     "node_modules/@types/estree": {
       "version": "1.0.8",
       "resolved": "https://registry.npmjs.org/@types/estree/-/estree-1.0.8.tgz",
@@ -1151,6 +1189,21 @@
       "dev": true,
       "license": "MIT"
     },
+    "node_modules/@types/mdast": {
+      "version": "3.0.15",
+      "resolved": "https://registry.npmjs.org/@types/mdast/-/mdast-3.0.15.tgz",
+      "integrity": "sha512-LnwD+mUEfxWMa1QpDraczIn6k0Ee3SMicuYSSzS6ZYl2gKS09EClnJYGd8Du6rfc5r/GZEk5o1mRb8TaTj03sQ==",
+      "license": "MIT",
+      "dependencies": {
+        "@types/unist": "^2"
+      }
+    },
+    "node_modules/@types/ms": {
+      "version": "2.1.0",
+      "resolved": "https://registry.npmjs.org/@types/ms/-/ms-2.1.0.tgz",
+      "integrity": "sha512-GsCCIZDE/p3i96vtEqx+7dBUGXrc7zeSK3wwPHIaRThS+9OhWIXRqzs4d6k1SVU8g91DrNRWxWUGhp5KXQb2VA==",
+      "license": "MIT"
+    },
     "node_modules/@types/prop-types": {
       "version": "15.7.15",
       "resolved": "https://registry.npmjs.org/@types/prop-types/-/prop-types-15.7.15.tgz",
@@ -1179,6 +1232,19 @@
         "@types/react": "^18.0.0"
       }
     },
+    "node_modules/@types/trusted-types": {
+      "version": "2.0.7",
+      "resolved": "https://registry.npmjs.org/@types/trusted-types/-/trusted-types-2.0.7.tgz",
+      "integrity": "sha512-ScaPdn1dQczgbl0QFTeTOmVHFULt394XJgOQNoyVhZ6r2vLnMLJfBPd53SB52T/3G36VI1/g2MZaX0cwDuXsfw==",
+      "license": "MIT",
+      "optional": true
+    },
+    "node_modules/@types/unist": {
+      "version": "2.0.11",
+      "resolved": "https://registry.npmjs.org/@types/unist/-/unist-2.0.11.tgz",
+      "integrity": "sha512-CmBKiL6NNo/OqgmMn95Fk9Whlp2mtvIv+KNpQKN2F4SjvrEesubTRWGYSg+BnWZOnlCaSTU1sMpsBOzgbYhnsA==",
+      "license": "MIT"
+    },
     "node_modules/@vitejs/plugin-react": {
       "version": "4.7.0",
       "resolved": "https://registry.npmjs.org/@vitejs/plugin-react/-/plugin-react-4.7.0.tgz",
@@ -1265,6 +1331,25 @@
       ],
       "license": "CC-BY-4.0"
     },
+    "node_modules/character-entities": {
+      "version": "2.0.2",
+      "resolved": "https://registry.npmjs.org/character-entities/-/character-entities-2.0.2.tgz",
+      "integrity": "sha512-shx7oQ0Awen/BRIdkjkvz54PnEEI/EjwXDSIZp86/KKdbafHh1Df/RYGBhn4hbe2+uKC9FnT5UCEdyPz3ai9hQ==",
+      "license": "MIT",
+      "funding": {
+        "type": "github",
+        "url": "https://github.com/sponsors/wooorm"
+      }
+    },
+    "node_modules/commander": {
+      "version": "7.2.0",
+      "resolved": "https://registry.npmjs.org/commander/-/commander-7.2.0.tgz",
+      "integrity": "sha512-QrWXB+ZQSVPmIWIhtEO9H+gwHaMGYiF5ChvoJ+K9ZGHG/sVsa6yiesAD1GC/x46sET00Xlwo1u49RVVVzvcSkw==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 10"
+      }
+    },
     "node_modules/convert-source-map": {
       "version": "2.0.0",
       "resolved": "https://registry.npmjs.org/convert-source-map/-/convert-source-map-2.0.0.tgz",
@@ -1272,6 +1357,15 @@
       "dev": true,
       "license": "MIT"
     },
+    "node_modules/cose-base": {
+      "version": "1.0.3",
+      "resolved": "https://registry.npmjs.org/cose-base/-/cose-base-1.0.3.tgz",
+      "integrity": "sha512-s9whTXInMSgAp/NVXVNuVxVKzGH2qck3aQlVHxDCdAEPgtMKwc4Wq6/QKhgdEdgbLSi9rBTAcPoRa6JpiG4ksg==",
+      "license": "MIT",
+      "dependencies": {
+        "layout-base": "^1.0.0"
+      }
+    },
     "node_modules/csstype": {
       "version": "3.2.3",
       "resolved": "https://registry.npmjs.org/csstype/-/csstype-3.2.3.tgz",
@@ -1279,11 +1373,488 @@
       "dev": true,
       "license": "MIT"
     },
+    "node_modules/cytoscape": {
+      "version": "3.33.1",
+      "resolved": "https://registry.npmjs.org/cytoscape/-/cytoscape-3.33.1.tgz",
+      "integrity": "sha512-iJc4TwyANnOGR1OmWhsS9ayRS3s+XQ185FmuHObThD+5AeJCakAAbWv8KimMTt08xCCLNgneQwFp+JRJOr9qGQ==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=0.10"
+      }
+    },
+    "node_modules/cytoscape-cose-bilkent": {
+      "version": "4.1.0",
+      "resolved": "https://registry.npmjs.org/cytoscape-cose-bilkent/-/cytoscape-cose-bilkent-4.1.0.tgz",
+      "integrity": "sha512-wgQlVIUJF13Quxiv5e1gstZ08rnZj2XaLHGoFMYXz7SkNfCDOOteKBE6SYRfA9WxxI/iBc3ajfDoc6hb/MRAHQ==",
+      "license": "MIT",
+      "dependencies": {
+        "cose-base": "^1.0.0"
+      },
+      "peerDependencies": {
+        "cytoscape": "^3.2.0"
+      }
+    },
+    "node_modules/d3": {
+      "version": "7.9.0",
+      "resolved": "https://registry.npmjs.org/d3/-/d3-7.9.0.tgz",
+      "integrity": "sha512-e1U46jVP+w7Iut8Jt8ri1YsPOvFpg46k+K8TpCb0P+zjCkjkPnV7WzfDJzMHy1LnA+wj5pLT1wjO901gLXeEhA==",
+      "license": "ISC",
+      "dependencies": {
+        "d3-array": "3",
+        "d3-axis": "3",
+        "d3-brush": "3",
+        "d3-chord": "3",
+        "d3-color": "3",
+        "d3-contour": "4",
+        "d3-delaunay": "6",
+        "d3-dispatch": "3",
+        "d3-drag": "3",
+        "d3-dsv": "3",
+        "d3-ease": "3",
+        "d3-fetch": "3",
+        "d3-force": "3",
+        "d3-format": "3",
+        "d3-geo": "3",
+        "d3-hierarchy": "3",
+        "d3-interpolate": "3",
+        "d3-path": "3",
+        "d3-polygon": "3",
+        "d3-quadtree": "3",
+        "d3-random": "3",
+        "d3-scale": "4",
+        "d3-scale-chromatic": "3",
+        "d3-selection": "3",
+        "d3-shape": "3",
+        "d3-time": "3",
+        "d3-time-format": "4",
+        "d3-timer": "3",
+        "d3-transition": "3",
+        "d3-zoom": "3"
+      },
+      "engines": {
+        "node": ">=12"
+      }
+    },
+    "node_modules/d3-array": {
+      "version": "3.2.4",
+      "resolved": "https://registry.npmjs.org/d3-array/-/d3-array-3.2.4.tgz",
+      "integrity": "sha512-tdQAmyA18i4J7wprpYq8ClcxZy3SC31QMeByyCFyRt7BVHdREQZ5lpzoe5mFEYZUWe+oq8HBvk9JjpibyEV4Jg==",
+      "license": "ISC",
+      "dependencies": {
+        "internmap": "1 - 2"
+      },
+      "engines": {
+        "node": ">=12"
+      }
+    },
+    "node_modules/d3-axis": {
+      "version": "3.0.0",
+      "resolved": "https://registry.npmjs.org/d3-axis/-/d3-axis-3.0.0.tgz",
+      "integrity": "sha512-IH5tgjV4jE/GhHkRV0HiVYPDtvfjHQlQfJHs0usq7M30XcSBvOotpmH1IgkcXsO/5gEQZD43B//fc7SRT5S+xw==",
+      "license": "ISC",
+      "engines": {
+        "node": ">=12"
+      }
+    },
+    "node_modules/d3-brush": {
+      "version": "3.0.0",
+      "resolved": "https://registry.npmjs.org/d3-brush/-/d3-brush-3.0.0.tgz",
+      "integrity": "sha512-ALnjWlVYkXsVIGlOsuWH1+3udkYFI48Ljihfnh8FZPF2QS9o+PzGLBslO0PjzVoHLZ2KCVgAM8NVkXPJB2aNnQ==",
+      "license": "ISC",
+      "dependencies": {
+        "d3-dispatch": "1 - 3",
+        "d3-drag": "2 - 3",
+        "d3-interpolate": "1 - 3",
+        "d3-selection": "3",
+        "d3-transition": "3"
+      },
+      "engines": {
+        "node": ">=12"
+      }
+    },
+    "node_modules/d3-chord": {
+      "version": "3.0.1",
+      "resolved": "https://registry.npmjs.org/d3-chord/-/d3-chord-3.0.1.tgz",
+      "integrity": "sha512-VE5S6TNa+j8msksl7HwjxMHDM2yNK3XCkusIlpX5kwauBfXuyLAtNg9jCp/iHH61tgI4sb6R/EIMWCqEIdjT/g==",
+      "license": "ISC",
+      "dependencies": {
+        "d3-path": "1 - 3"
+      },
+      "engines": {
+        "node": ">=12"
+      }
+    },
+    "node_modules/d3-color": {
+      "version": "3.1.0",
+      "resolved": "https://registry.npmjs.org/d3-color/-/d3-color-3.1.0.tgz",
+      "integrity": "sha512-zg/chbXyeBtMQ1LbD/WSoW2DpC3I0mpmPdW+ynRTj/x2DAWYrIY7qeZIHidozwV24m4iavr15lNwIwLxRmOxhA==",
+      "license": "ISC",
+      "engines": {
+        "node": ">=12"
+      }
+    },
+    "node_modules/d3-contour": {
+      "version": "4.0.2",
+      "resolved": "https://registry.npmjs.org/d3-contour/-/d3-contour-4.0.2.tgz",
+      "integrity": "sha512-4EzFTRIikzs47RGmdxbeUvLWtGedDUNkTcmzoeyg4sP/dvCexO47AaQL7VKy/gul85TOxw+IBgA8US2xwbToNA==",
+      "license": "ISC",
+      "dependencies": {
+        "d3-array": "^3.2.0"
+      },
+      "engines": {
+        "node": ">=12"
+      }
+    },
+    "node_modules/d3-delaunay": {
+      "version": "6.0.4",
+      "resolved": "https://registry.npmjs.org/d3-delaunay/-/d3-delaunay-6.0.4.tgz",
+      "integrity": "sha512-mdjtIZ1XLAM8bm/hx3WwjfHt6Sggek7qH043O8KEjDXN40xi3vx/6pYSVTwLjEgiXQTbvaouWKynLBiUZ6SK6A==",
+      "license": "ISC",
+      "dependencies": {
+        "delaunator": "5"
+      },
+      "engines": {
+        "node": ">=12"
+      }
+    },
+    "node_modules/d3-dispatch": {
+      "version": "3.0.1",
+      "resolved": "https://registry.npmjs.org/d3-dispatch/-/d3-dispatch-3.0.1.tgz",
+      "integrity": "sha512-rzUyPU/S7rwUflMyLc1ETDeBj0NRuHKKAcvukozwhshr6g6c5d8zh4c2gQjY2bZ0dXeGLWc1PF174P2tVvKhfg==",
+      "license": "ISC",
+      "engines": {
+        "node": ">=12"
+      }
+    },
+    "node_modules/d3-drag": {
+      "version": "3.0.0",
+      "resolved": "https://registry.npmjs.org/d3-drag/-/d3-drag-3.0.0.tgz",
+      "integrity": "sha512-pWbUJLdETVA8lQNJecMxoXfH6x+mO2UQo8rSmZ+QqxcbyA3hfeprFgIT//HW2nlHChWeIIMwS2Fq+gEARkhTkg==",
+      "license": "ISC",
+      "dependencies": {
+        "d3-dispatch": "1 - 3",
+        "d3-selection": "3"
+      },
+      "engines": {
+        "node": ">=12"
+      }
+    },
+    "node_modules/d3-dsv": {
+      "version": "3.0.1",
+      "resolved": "https://registry.npmjs.org/d3-dsv/-/d3-dsv-3.0.1.tgz",
+      "integrity": "sha512-UG6OvdI5afDIFP9w4G0mNq50dSOsXHJaRE8arAS5o9ApWnIElp8GZw1Dun8vP8OyHOZ/QJUKUJwxiiCCnUwm+Q==",
+      "license": "ISC",
+      "dependencies": {
+        "commander": "7",
+        "iconv-lite": "0.6",
+        "rw": "1"
+      },
+      "bin": {
+        "csv2json": "bin/dsv2json.js",
+        "csv2tsv": "bin/dsv2dsv.js",
+        "dsv2dsv": "bin/dsv2dsv.js",
+        "dsv2json": "bin/dsv2json.js",
+        "json2csv": "bin/json2dsv.js",
+        "json2dsv": "bin/json2dsv.js",
+        "json2tsv": "bin/json2dsv.js",
+        "tsv2csv": "bin/dsv2dsv.js",
+        "tsv2json": "bin/dsv2json.js"
+      },
+      "engines": {
+        "node": ">=12"
+      }
+    },
+    "node_modules/d3-ease": {
+      "version": "3.0.1",
+      "resolved": "https://registry.npmjs.org/d3-ease/-/d3-ease-3.0.1.tgz",
+      "integrity": "sha512-wR/XK3D3XcLIZwpbvQwQ5fK+8Ykds1ip7A2Txe0yxncXSdq1L9skcG7blcedkOX+ZcgxGAmLX1FrRGbADwzi0w==",
+      "license": "BSD-3-Clause",
+      "engines": {
+        "node": ">=12"
+      }
+    },
+    "node_modules/d3-fetch": {
+      "version": "3.0.1",
+      "resolved": "https://registry.npmjs.org/d3-fetch/-/d3-fetch-3.0.1.tgz",
+      "integrity": "sha512-kpkQIM20n3oLVBKGg6oHrUchHM3xODkTzjMoj7aWQFq5QEM+R6E4WkzT5+tojDY7yjez8KgCBRoj4aEr99Fdqw==",
+      "license": "ISC",
+      "dependencies": {
+        "d3-dsv": "1 - 3"
+      },
+      "engines": {
+        "node": ">=12"
+      }
+    },
+    "node_modules/d3-force": {
+      "version": "3.0.0",
+      "resolved": "https://registry.npmjs.org/d3-force/-/d3-force-3.0.0.tgz",
+      "integrity": "sha512-zxV/SsA+U4yte8051P4ECydjD/S+qeYtnaIyAs9tgHCqfguma/aAQDjo85A9Z6EKhBirHRJHXIgJUlffT4wdLg==",
+      "license": "ISC",
+      "dependencies": {
+        "d3-dispatch": "1 - 3",
+        "d3-quadtree": "1 - 3",
+        "d3-timer": "1 - 3"
+      },
+      "engines": {
+        "node": ">=12"
+      }
+    },
+    "node_modules/d3-format": {
+      "version": "3.1.2",
+      "resolved": "https://registry.npmjs.org/d3-format/-/d3-format-3.1.2.tgz",
+      "integrity": "sha512-AJDdYOdnyRDV5b6ArilzCPPwc1ejkHcoyFarqlPqT7zRYjhavcT3uSrqcMvsgh2CgoPbK3RCwyHaVyxYcP2Arg==",
+      "license": "ISC",
+      "engines": {
+        "node": ">=12"
+      }
+    },
+    "node_modules/d3-geo": {
+      "version": "3.1.1",
+      "resolved": "https://registry.npmjs.org/d3-geo/-/d3-geo-3.1.1.tgz",
+      "integrity": "sha512-637ln3gXKXOwhalDzinUgY83KzNWZRKbYubaG+fGVuc/dxO64RRljtCTnf5ecMyE1RIdtqpkVcq0IbtU2S8j2Q==",
+      "license": "ISC",
+      "dependencies": {
+        "d3-array": "2.5.0 - 3"
+      },
+      "engines": {
+        "node": ">=12"
+      }
+    },
+    "node_modules/d3-hierarchy": {
+      "version": "3.1.2",
+      "resolved": "https://registry.npmjs.org/d3-hierarchy/-/d3-hierarchy-3.1.2.tgz",
+      "integrity": "sha512-FX/9frcub54beBdugHjDCdikxThEqjnR93Qt7PvQTOHxyiNCAlvMrHhclk3cD5VeAaq9fxmfRp+CnWw9rEMBuA==",
+      "license": "ISC",
+      "engines": {
+        "node": ">=12"
+      }
+    },
+    "node_modules/d3-interpolate": {
+      "version": "3.0.1",
+      "resolved": "https://registry.npmjs.org/d3-interpolate/-/d3-interpolate-3.0.1.tgz",
+      "integrity": "sha512-3bYs1rOD33uo8aqJfKP3JWPAibgw8Zm2+L9vBKEHJ2Rg+viTR7o5Mmv5mZcieN+FRYaAOWX5SJATX6k1PWz72g==",
+      "license": "ISC",
+      "dependencies": {
+        "d3-color": "1 - 3"
+      },
+      "engines": {
+        "node": ">=12"
+      }
+    },
+    "node_modules/d3-path": {
+      "version": "3.1.0",
+      "resolved": "https://registry.npmjs.org/d3-path/-/d3-path-3.1.0.tgz",
+      "integrity": "sha512-p3KP5HCf/bvjBSSKuXid6Zqijx7wIfNW+J/maPs+iwR35at5JCbLUT0LzF1cnjbCHWhqzQTIN2Jpe8pRebIEFQ==",
+      "license": "ISC",
+      "engines": {
+        "node": ">=12"
+      }
+    },
+    "node_modules/d3-polygon": {
+      "version": "3.0.1",
+      "resolved": "https://registry.npmjs.org/d3-polygon/-/d3-polygon-3.0.1.tgz",
+      "integrity": "sha512-3vbA7vXYwfe1SYhED++fPUQlWSYTTGmFmQiany/gdbiWgU/iEyQzyymwL9SkJjFFuCS4902BSzewVGsHHmHtXg==",
+      "license": "ISC",
+      "engines": {
+        "node": ">=12"
+      }
+    },
+    "node_modules/d3-quadtree": {
+      "version": "3.0.1",
+      "resolved": "https://registry.npmjs.org/d3-quadtree/-/d3-quadtree-3.0.1.tgz",
+      "integrity": "sha512-04xDrxQTDTCFwP5H6hRhsRcb9xxv2RzkcsygFzmkSIOJy3PeRJP7sNk3VRIbKXcog561P9oU0/rVH6vDROAgUw==",
+      "license": "ISC",
+      "engines": {
+        "node": ">=12"
+      }
+    },
+    "node_modules/d3-random": {
+      "version": "3.0.1",
+      "resolved": "https://registry.npmjs.org/d3-random/-/d3-random-3.0.1.tgz",
+      "integrity": "sha512-FXMe9GfxTxqd5D6jFsQ+DJ8BJS4E/fT5mqqdjovykEB2oFbTMDVdg1MGFxfQW+FBOGoB++k8swBrgwSHT1cUXQ==",
+      "license": "ISC",
+      "engines": {
+        "node": ">=12"
+      }
+    },
+    "node_modules/d3-sankey": {
+      "version": "0.12.3",
+      "resolved": "https://registry.npmjs.org/d3-sankey/-/d3-sankey-0.12.3.tgz",
+      "integrity": "sha512-nQhsBRmM19Ax5xEIPLMY9ZmJ/cDvd1BG3UVvt5h3WRxKg5zGRbvnteTyWAbzeSvlh3tW7ZEmq4VwR5mB3tutmQ==",
+      "license": "BSD-3-Clause",
+      "dependencies": {
+        "d3-array": "1 - 2",
+        "d3-shape": "^1.2.0"
+      }
+    },
+    "node_modules/d3-sankey/node_modules/d3-array": {
+      "version": "2.12.1",
+      "resolved": "https://registry.npmjs.org/d3-array/-/d3-array-2.12.1.tgz",
+      "integrity": "sha512-B0ErZK/66mHtEsR1TkPEEkwdy+WDesimkM5gpZr5Dsg54BiTA5RXtYW5qTLIAcekaS9xfZrzBLF/OAkB3Qn1YQ==",
+      "license": "BSD-3-Clause",
+      "dependencies": {
+        "internmap": "^1.0.0"
+      }
+    },
+    "node_modules/d3-sankey/node_modules/d3-path": {
+      "version": "1.0.9",
+      "resolved": "https://registry.npmjs.org/d3-path/-/d3-path-1.0.9.tgz",
+      "integrity": "sha512-VLaYcn81dtHVTjEHd8B+pbe9yHWpXKZUC87PzoFmsFrJqgFwDe/qxfp5MlfsfM1V5E/iVt0MmEbWQ7FVIXh/bg==",
+      "license": "BSD-3-Clause"
+    },
+    "node_modules/d3-sankey/node_modules/d3-shape": {
+      "version": "1.3.7",
+      "resolved": "https://registry.npmjs.org/d3-shape/-/d3-shape-1.3.7.tgz",
+      "integrity": "sha512-EUkvKjqPFUAZyOlhY5gzCxCeI0Aep04LwIRpsZ/mLFelJiUfnK56jo5JMDSE7yyP2kLSb6LtF+S5chMk7uqPqw==",
+      "license": "BSD-3-Clause",
+      "dependencies": {
+        "d3-path": "1"
+      }
+    },
+    "node_modules/d3-sankey/node_modules/internmap": {
+      "version": "1.0.1",
+      "resolved": "https://registry.npmjs.org/internmap/-/internmap-1.0.1.tgz",
+      "integrity": "sha512-lDB5YccMydFBtasVtxnZ3MRBHuaoE8GKsppq+EchKL2U4nK/DmEpPHNH8MZe5HkMtpSiTSOZwfN0tzYjO/lJEw==",
+      "license": "ISC"
+    },
+    "node_modules/d3-scale": {
+      "version": "4.0.2",
+      "resolved": "https://registry.npmjs.org/d3-scale/-/d3-scale-4.0.2.tgz",
+      "integrity": "sha512-GZW464g1SH7ag3Y7hXjf8RoUuAFIqklOAq3MRl4OaWabTFJY9PN/E1YklhXLh+OQ3fM9yS2nOkCoS+WLZ6kvxQ==",
+      "license": "ISC",
+      "dependencies": {
+        "d3-array": "2.10.0 - 3",
+        "d3-format": "1 - 3",
+        "d3-interpolate": "1.2.0 - 3",
+        "d3-time": "2.1.1 - 3",
+        "d3-time-format": "2 - 4"
+      },
+      "engines": {
+        "node": ">=12"
+      }
+    },
+    "node_modules/d3-scale-chromatic": {
+      "version": "3.1.0",
+      "resolved": "https://registry.npmjs.org/d3-scale-chromatic/-/d3-scale-chromatic-3.1.0.tgz",
+      "integrity": "sha512-A3s5PWiZ9YCXFye1o246KoscMWqf8BsD9eRiJ3He7C9OBaxKhAd5TFCdEx/7VbKtxxTsu//1mMJFrEt572cEyQ==",
+      "license": "ISC",
+      "dependencies": {
+        "d3-color": "1 - 3",
+        "d3-interpolate": "1 - 3"
+      },
+      "engines": {
+        "node": ">=12"
+      }
+    },
+    "node_modules/d3-selection": {
+      "version": "3.0.0",
+      "resolved": "https://registry.npmjs.org/d3-selection/-/d3-selection-3.0.0.tgz",
+      "integrity": "sha512-fmTRWbNMmsmWq6xJV8D19U/gw/bwrHfNXxrIN+HfZgnzqTHp9jOmKMhsTUjXOJnZOdZY9Q28y4yebKzqDKlxlQ==",
+      "license": "ISC",
+      "engines": {
+        "node": ">=12"
+      }
+    },
+    "node_modules/d3-shape": {
+      "version": "3.2.0",
+      "resolved": "https://registry.npmjs.org/d3-shape/-/d3-shape-3.2.0.tgz",
+      "integrity": "sha512-SaLBuwGm3MOViRq2ABk3eLoxwZELpH6zhl3FbAoJ7Vm1gofKx6El1Ib5z23NUEhF9AsGl7y+dzLe5Cw2AArGTA==",
+      "license": "ISC",
+      "dependencies": {
+        "d3-path": "^3.1.0"
+      },
+      "engines": {
+        "node": ">=12"
+      }
+    },
+    "node_modules/d3-time": {
+      "version": "3.1.0",
+      "resolved": "https://registry.npmjs.org/d3-time/-/d3-time-3.1.0.tgz",
+      "integrity": "sha512-VqKjzBLejbSMT4IgbmVgDjpkYrNWUYJnbCGo874u7MMKIWsILRX+OpX/gTk8MqjpT1A/c6HY2dCA77ZN0lkQ2Q==",
+      "license": "ISC",
+      "dependencies": {
+        "d3-array": "2 - 3"
+      },
+      "engines": {
+        "node": ">=12"
+      }
+    },
+    "node_modules/d3-time-format": {
+      "version": "4.1.0",
+      "resolved": "https://registry.npmjs.org/d3-time-format/-/d3-time-format-4.1.0.tgz",
+      "integrity": "sha512-dJxPBlzC7NugB2PDLwo9Q8JiTR3M3e4/XANkreKSUxF8vvXKqm1Yfq4Q5dl8budlunRVlUUaDUgFt7eA8D6NLg==",
+      "license": "ISC",
+      "dependencies": {
+        "d3-time": "1 - 3"
+      },
+      "engines": {
+        "node": ">=12"
+      }
+    },
+    "node_modules/d3-timer": {
+      "version": "3.0.1",
+      "resolved": "https://registry.npmjs.org/d3-timer/-/d3-timer-3.0.1.tgz",
+      "integrity": "sha512-ndfJ/JxxMd3nw31uyKoY2naivF+r29V+Lc0svZxe1JvvIRmi8hUsrMvdOwgS1o6uBHmiz91geQ0ylPP0aj1VUA==",
+      "license": "ISC",
+      "engines": {
+        "node": ">=12"
+      }
+    },
+    "node_modules/d3-transition": {
+      "version": "3.0.1",
+      "resolved": "https://registry.npmjs.org/d3-transition/-/d3-transition-3.0.1.tgz",
+      "integrity": "sha512-ApKvfjsSR6tg06xrL434C0WydLr7JewBB3V+/39RMHsaXTOG0zmt/OAXeng5M5LBm0ojmxJrpomQVZ1aPvBL4w==",
+      "license": "ISC",
+      "dependencies": {
+        "d3-color": "1 - 3",
+        "d3-dispatch": "1 - 3",
+        "d3-ease": "1 - 3",
+        "d3-interpolate": "1 - 3",
+        "d3-timer": "1 - 3"
+      },
+      "engines": {
+        "node": ">=12"
+      },
+      "peerDependencies": {
+        "d3-selection": "2 - 3"
+      }
+    },
+    "node_modules/d3-zoom": {
+      "version": "3.0.0",
+      "resolved": "https://registry.npmjs.org/d3-zoom/-/d3-zoom-3.0.0.tgz",
+      "integrity": "sha512-b8AmV3kfQaqWAuacbPuNbL6vahnOJflOhexLzMMNLga62+/nh0JzvJ0aO/5a5MVgUFGS7Hu1P9P03o3fJkDCyw==",
+      "license": "ISC",
+      "dependencies": {
+        "d3-dispatch": "1 - 3",
+        "d3-drag": "2 - 3",
+        "d3-interpolate": "1 - 3",
+        "d3-selection": "2 - 3",
+        "d3-transition": "2 - 3"
+      },
+      "engines": {
+        "node": ">=12"
+      }
+    },
+    "node_modules/dagre-d3-es": {
+      "version": "7.0.13",
+      "resolved": "https://registry.npmjs.org/dagre-d3-es/-/dagre-d3-es-7.0.13.tgz",
+      "integrity": "sha512-efEhnxpSuwpYOKRm/L5KbqoZmNNukHa/Flty4Wp62JRvgH2ojwVgPgdYyr4twpieZnyRDdIH7PY2mopX26+j2Q==",
+      "license": "MIT",
+      "dependencies": {
+        "d3": "^7.9.0",
+        "lodash-es": "^4.17.21"
+      }
+    },
+    "node_modules/dayjs": {
+      "version": "1.11.19",
+      "resolved": "https://registry.npmjs.org/dayjs/-/dayjs-1.11.19.tgz",
+      "integrity": "sha512-t5EcLVS6QPBNqM2z8fakk/NKel+Xzshgt8FFKAn+qwlD1pzZWxh0nVCrvFK7ZDb6XucZeF9z8C7CBWTRIVApAw==",
+      "license": "MIT"
+    },
     "node_modules/debug": {
       "version": "4.4.3",
       "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
       "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
-      "dev": true,
       "license": "MIT",
       "dependencies": {
         "ms": "^2.1.3"
@@ -1297,13 +1868,68 @@
         }
       }
     },
+    "node_modules/decode-named-character-reference": {
+      "version": "1.3.0",
+      "resolved": "https://registry.npmjs.org/decode-named-character-reference/-/decode-named-character-reference-1.3.0.tgz",
+      "integrity": "sha512-GtpQYB283KrPp6nRw50q3U9/VfOutZOe103qlN7BPP6Ad27xYnOIWv4lPzo8HCAL+mMZofJ9KEy30fq6MfaK6Q==",
+      "license": "MIT",
+      "dependencies": {
+        "character-entities": "^2.0.0"
+      },
+      "funding": {
+        "type": "github",
+        "url": "https://github.com/sponsors/wooorm"
+      }
+    },
+    "node_modules/delaunator": {
+      "version": "5.0.1",
+      "resolved": "https://registry.npmjs.org/delaunator/-/delaunator-5.0.1.tgz",
+      "integrity": "sha512-8nvh+XBe96aCESrGOqMp/84b13H9cdKbG5P2ejQCh4d4sK9RL4371qou9drQjMhvnPmhWl5hnmqbEE0fXr9Xnw==",
+      "license": "ISC",
+      "dependencies": {
+        "robust-predicates": "^3.0.2"
+      }
+    },
+    "node_modules/dequal": {
+      "version": "2.0.3",
+      "resolved": "https://registry.npmjs.org/dequal/-/dequal-2.0.3.tgz",
+      "integrity": "sha512-0je+qPKHEMohvfRTCEo3CrPG6cAzAYgmzKyxRiYSSDkS6eGJdyVJm7WaYA5ECaAD9wLB2T4EEeymA5aFVcYXCA==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=6"
+      }
+    },
+    "node_modules/diff": {
+      "version": "5.2.2",
+      "resolved": "https://registry.npmjs.org/diff/-/diff-5.2.2.tgz",
+      "integrity": "sha512-vtcDfH3TOjP8UekytvnHH1o1P4FcUdt4eQ1Y+Abap1tk/OB2MWQvcwS2ClCd1zuIhc3JKOx6p3kod8Vfys3E+A==",
+      "license": "BSD-3-Clause",
+      "engines": {
+        "node": ">=0.3.1"
+      }
+    },
+    "node_modules/dompurify": {
+      "version": "3.3.1",
+      "resolved": "https://registry.npmjs.org/dompurify/-/dompurify-3.3.1.tgz",
+      "integrity": "sha512-qkdCKzLNtrgPFP1Vo+98FRzJnBRGe4ffyCea9IwHB1fyxPOeNTHpLKYGd4Uk9xvNoH0ZoOjwZxNptyMwqrId1Q==",
+      "license": "(MPL-2.0 OR Apache-2.0)",
+      "optionalDependencies": {
+        "@types/trusted-types": "^2.0.7"
+      }
+    },
     "node_modules/electron-to-chromium": {
-      "version": "1.5.267",
-      "resolved": "https://registry.npmjs.org/electron-to-chromium/-/electron-to-chromium-1.5.267.tgz",
-      "integrity": "sha512-0Drusm6MVRXSOJpGbaSVgcQsuB4hEkMpHXaVstcPmhu5LIedxs1xNK/nIxmQIU/RPC0+1/o0AVZfBTkTNJOdUw==",
+      "version": "1.5.277",
+      "resolved": "https://registry.npmjs.org/electron-to-chromium/-/electron-to-chromium-1.5.277.tgz",
+      "integrity": "sha512-wKXFZw4erWmmOz5N/grBoJ2XrNJGDFMu2+W5ACHza5rHtvsqrK4gb6rnLC7XxKB9WlJ+RmyQatuEXmtm86xbnw==",
       "dev": true,
       "license": "ISC"
     },
+    "node_modules/elkjs": {
+      "version": "0.9.3",
+      "resolved": "https://registry.npmjs.org/elkjs/-/elkjs-0.9.3.tgz",
+      "integrity": "sha512-f/ZeWvW/BCXbhGEf1Ujp29EASo/lk1FDnETgNKwJrsVvGZhUWCZyg3xLJjAsxfOmt8KjswHmI5EwCQcPMpOYhQ==",
+      "license": "EPL-2.0"
+    },
     "node_modules/esbuild": {
       "version": "0.21.5",
       "resolved": "https://registry.npmjs.org/esbuild/-/esbuild-0.21.5.tgz",
@@ -1378,6 +2004,27 @@
         "node": ">=6.9.0"
       }
     },
+    "node_modules/iconv-lite": {
+      "version": "0.6.3",
+      "resolved": "https://registry.npmjs.org/iconv-lite/-/iconv-lite-0.6.3.tgz",
+      "integrity": "sha512-4fCk79wshMdzMp2rH06qWrJE4iolqLhCUH+OiuIgU++RB0+94NlDL81atO7GX55uUKueo0txHNtvEyI6D7WdMw==",
+      "license": "MIT",
+      "dependencies": {
+        "safer-buffer": ">= 2.1.2 < 3.0.0"
+      },
+      "engines": {
+        "node": ">=0.10.0"
+      }
+    },
+    "node_modules/internmap": {
+      "version": "2.0.3",
+      "resolved": "https://registry.npmjs.org/internmap/-/internmap-2.0.3.tgz",
+      "integrity": "sha512-5Hh7Y1wQbvY5ooGgPbDaL5iYLAPzMTUrjMulskHLH6wnv/A+1q5rgEaiuqEjB+oxGXIVZs1FF+R/KPN3ZSQYYg==",
+      "license": "ISC",
+      "engines": {
+        "node": ">=12"
+      }
+    },
     "node_modules/js-tokens": {
       "version": "4.0.0",
       "resolved": "https://registry.npmjs.org/js-tokens/-/js-tokens-4.0.0.tgz",
@@ -1410,6 +2057,57 @@
         "node": ">=6"
       }
     },
+    "node_modules/katex": {
+      "version": "0.16.27",
+      "resolved": "https://registry.npmjs.org/katex/-/katex-0.16.27.tgz",
+      "integrity": "sha512-aeQoDkuRWSqQN6nSvVCEFvfXdqo1OQiCmmW1kc9xSdjutPv7BGO7pqY9sQRJpMOGrEdfDgF2TfRXe5eUAD2Waw==",
+      "funding": [
+        "https://opencollective.com/katex",
+        "https://github.com/sponsors/katex"
+      ],
+      "license": "MIT",
+      "dependencies": {
+        "commander": "^8.3.0"
+      },
+      "bin": {
+        "katex": "cli.js"
+      }
+    },
+    "node_modules/katex/node_modules/commander": {
+      "version": "8.3.0",
+      "resolved": "https://registry.npmjs.org/commander/-/commander-8.3.0.tgz",
+      "integrity": "sha512-OkTL9umf+He2DZkUq8f8J9of7yL6RJKI24dVITBmNfZBmri9zYZQrKkuXiKhyfPSu8tUhnVBB1iKXevvnlR4Ww==",
+      "license": "MIT",
+      "engines": {
+        "node": ">= 12"
+      }
+    },
+    "node_modules/khroma": {
+      "version": "2.1.0",
+      "resolved": "https://registry.npmjs.org/khroma/-/khroma-2.1.0.tgz",
+      "integrity": "sha512-Ls993zuzfayK269Svk9hzpeGUKob/sIgZzyHYdjQoAdQetRKpOLj+k/QQQ/6Qi0Yz65mlROrfd+Ev+1+7dz9Kw=="
+    },
+    "node_modules/kleur": {
+      "version": "4.1.5",
+      "resolved": "https://registry.npmjs.org/kleur/-/kleur-4.1.5.tgz",
+      "integrity": "sha512-o+NO+8WrRiQEE4/7nwRJhN1HWpVmJm511pBHUxPLtp0BUISzlBplORYSmTclCnJvQq2tKu/sgl3xVpkc7ZWuQQ==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=6"
+      }
+    },
+    "node_modules/layout-base": {
+      "version": "1.0.2",
+      "resolved": "https://registry.npmjs.org/layout-base/-/layout-base-1.0.2.tgz",
+      "integrity": "sha512-8h2oVEZNktL4BH2JCOI90iD1yXwL6iNW7KcCKT2QZgQJR2vbqDsldCTPRU9NifTCqHZci57XvQQ15YTu+sTYPg==",
+      "license": "MIT"
+    },
+    "node_modules/lodash-es": {
+      "version": "4.17.23",
+      "resolved": "https://registry.npmjs.org/lodash-es/-/lodash-es-4.17.23.tgz",
+      "integrity": "sha512-kVI48u3PZr38HdYz98UmfPnXl2DXrpdctLrFLCd3kOx1xUkOmpFPx7gCWWM5MPkL/fD8zb+Ph0QzjGFs4+hHWg==",
+      "license": "MIT"
+    },
     "node_modules/loose-envify": {
       "version": "1.4.0",
       "resolved": "https://registry.npmjs.org/loose-envify/-/loose-envify-1.4.0.tgz",
@@ -1432,11 +2130,538 @@
         "yallist": "^3.0.2"
       }
     },
+    "node_modules/marked": {
+      "version": "12.0.2",
+      "resolved": "https://registry.npmjs.org/marked/-/marked-12.0.2.tgz",
+      "integrity": "sha512-qXUm7e/YKFoqFPYPa3Ukg9xlI5cyAtGmyEIzMfW//m6kXwCy2Ps9DYf5ioijFKQ8qyuscrHoY04iJGctu2Kg0Q==",
+      "license": "MIT",
+      "bin": {
+        "marked": "bin/marked.js"
+      },
+      "engines": {
+        "node": ">= 18"
+      }
+    },
+    "node_modules/mdast-util-from-markdown": {
+      "version": "1.3.1",
+      "resolved": "https://registry.npmjs.org/mdast-util-from-markdown/-/mdast-util-from-markdown-1.3.1.tgz",
+      "integrity": "sha512-4xTO/M8c82qBcnQc1tgpNtubGUW/Y1tBQ1B0i5CtSoelOLKFYlElIr3bvgREYYO5iRqbMY1YuqZng0GVOI8Qww==",
+      "license": "MIT",
+      "dependencies": {
+        "@types/mdast": "^3.0.0",
+        "@types/unist": "^2.0.0",
+        "decode-named-character-reference": "^1.0.0",
+        "mdast-util-to-string": "^3.1.0",
+        "micromark": "^3.0.0",
+        "micromark-util-decode-numeric-character-reference": "^1.0.0",
+        "micromark-util-decode-string": "^1.0.0",
+        "micromark-util-normalize-identifier": "^1.0.0",
+        "micromark-util-symbol": "^1.0.0",
+        "micromark-util-types": "^1.0.0",
+        "unist-util-stringify-position": "^3.0.0",
+        "uvu": "^0.5.0"
+      },
+      "funding": {
+        "type": "opencollective",
+        "url": "https://opencollective.com/unified"
+      }
+    },
+    "node_modules/mdast-util-to-string": {
+      "version": "3.2.0",
+      "resolved": "https://registry.npmjs.org/mdast-util-to-string/-/mdast-util-to-string-3.2.0.tgz",
+      "integrity": "sha512-V4Zn/ncyN1QNSqSBxTrMOLpjr+IKdHl2v3KVLoWmDPscP4r9GcCi71gjgvUV1SFSKh92AjAG4peFuBl2/YgCJg==",
+      "license": "MIT",
+      "dependencies": {
+        "@types/mdast": "^3.0.0"
+      },
+      "funding": {
+        "type": "opencollective",
+        "url": "https://opencollective.com/unified"
+      }
+    },
+    "node_modules/mermaid": {
+      "version": "10.9.5",
+      "resolved": "https://registry.npmjs.org/mermaid/-/mermaid-10.9.5.tgz",
+      "integrity": "sha512-eRlKEjzak4z1rcXeCd1OAlyawhrptClQDo8OuI8n6bSVqJ9oMfd5Lrf3Q+TdJHewi/9AIOc3UmEo8Fz+kNzzuQ==",
+      "license": "MIT",
+      "dependencies": {
+        "@braintree/sanitize-url": "^6.0.1",
+        "@types/d3-scale": "^4.0.3",
+        "@types/d3-scale-chromatic": "^3.0.0",
+        "cytoscape": "^3.28.1",
+        "cytoscape-cose-bilkent": "^4.1.0",
+        "d3": "^7.4.0",
+        "d3-sankey": "^0.12.3",
+        "dagre-d3-es": "7.0.13",
+        "dayjs": "^1.11.7",
+        "dompurify": "^3.2.4",
+        "elkjs": "^0.9.0",
+        "katex": "^0.16.9",
+        "khroma": "^2.0.0",
+        "lodash-es": "^4.17.21",
+        "mdast-util-from-markdown": "^1.3.0",
+        "non-layered-tidy-tree-layout": "^2.0.2",
+        "stylis": "^4.1.3",
+        "ts-dedent": "^2.2.0",
+        "uuid": "^9.0.0",
+        "web-worker": "^1.2.0"
+      }
+    },
+    "node_modules/micromark": {
+      "version": "3.2.0",
+      "resolved": "https://registry.npmjs.org/micromark/-/micromark-3.2.0.tgz",
+      "integrity": "sha512-uD66tJj54JLYq0De10AhWycZWGQNUvDI55xPgk2sQM5kn1JYlhbCMTtEeT27+vAhW2FBQxLlOmS3pmA7/2z4aA==",
+      "funding": [
+        {
+          "type": "GitHub Sponsors",
+          "url": "https://github.com/sponsors/unifiedjs"
+        },
+        {
+          "type": "OpenCollective",
+          "url": "https://opencollective.com/unified"
+        }
+      ],
+      "license": "MIT",
+      "dependencies": {
+        "@types/debug": "^4.0.0",
+        "debug": "^4.0.0",
+        "decode-named-character-reference": "^1.0.0",
+        "micromark-core-commonmark": "^1.0.1",
+        "micromark-factory-space": "^1.0.0",
+        "micromark-util-character": "^1.0.0",
+        "micromark-util-chunked": "^1.0.0",
+        "micromark-util-combine-extensions": "^1.0.0",
+        "micromark-util-decode-numeric-character-reference": "^1.0.0",
+        "micromark-util-encode": "^1.0.0",
+        "micromark-util-normalize-identifier": "^1.0.0",
+        "micromark-util-resolve-all": "^1.0.0",
+        "micromark-util-sanitize-uri": "^1.0.0",
+        "micromark-util-subtokenize": "^1.0.0",
+        "micromark-util-symbol": "^1.0.0",
+        "micromark-util-types": "^1.0.1",
+        "uvu": "^0.5.0"
+      }
+    },
+    "node_modules/micromark-core-commonmark": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/micromark-core-commonmark/-/micromark-core-commonmark-1.1.0.tgz",
+      "integrity": "sha512-BgHO1aRbolh2hcrzL2d1La37V0Aoz73ymF8rAcKnohLy93titmv62E0gP8Hrx9PKcKrqCZ1BbLGbP3bEhoXYlw==",
+      "funding": [
+        {
+          "type": "GitHub Sponsors",
+          "url": "https://github.com/sponsors/unifiedjs"
+        },
+        {
+          "type": "OpenCollective",
+          "url": "https://opencollective.com/unified"
+        }
+      ],
+      "license": "MIT",
+      "dependencies": {
+        "decode-named-character-reference": "^1.0.0",
+        "micromark-factory-destination": "^1.0.0",
+        "micromark-factory-label": "^1.0.0",
+        "micromark-factory-space": "^1.0.0",
+        "micromark-factory-title": "^1.0.0",
+        "micromark-factory-whitespace": "^1.0.0",
+        "micromark-util-character": "^1.0.0",
+        "micromark-util-chunked": "^1.0.0",
+        "micromark-util-classify-character": "^1.0.0",
+        "micromark-util-html-tag-name": "^1.0.0",
+        "micromark-util-normalize-identifier": "^1.0.0",
+        "micromark-util-resolve-all": "^1.0.0",
+        "micromark-util-subtokenize": "^1.0.0",
+        "micromark-util-symbol": "^1.0.0",
+        "micromark-util-types": "^1.0.1",
+        "uvu": "^0.5.0"
+      }
+    },
+    "node_modules/micromark-factory-destination": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/micromark-factory-destination/-/micromark-factory-destination-1.1.0.tgz",
+      "integrity": "sha512-XaNDROBgx9SgSChd69pjiGKbV+nfHGDPVYFs5dOoDd7ZnMAE+Cuu91BCpsY8RT2NP9vo/B8pds2VQNCLiu0zhg==",
+      "funding": [
+        {
+          "type": "GitHub Sponsors",
+          "url": "https://github.com/sponsors/unifiedjs"
+        },
+        {
+          "type": "OpenCollective",
+          "url": "https://opencollective.com/unified"
+        }
+      ],
+      "license": "MIT",
+      "dependencies": {
+        "micromark-util-character": "^1.0.0",
+        "micromark-util-symbol": "^1.0.0",
+        "micromark-util-types": "^1.0.0"
+      }
+    },
+    "node_modules/micromark-factory-label": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/micromark-factory-label/-/micromark-factory-label-1.1.0.tgz",
+      "integrity": "sha512-OLtyez4vZo/1NjxGhcpDSbHQ+m0IIGnT8BoPamh+7jVlzLJBH98zzuCoUeMxvM6WsNeh8wx8cKvqLiPHEACn0w==",
+      "funding": [
+        {
+          "type": "GitHub Sponsors",
+          "url": "https://github.com/sponsors/unifiedjs"
+        },
+        {
+          "type": "OpenCollective",
+          "url": "https://opencollective.com/unified"
+        }
+      ],
+      "license": "MIT",
+      "dependencies": {
+        "micromark-util-character": "^1.0.0",
+        "micromark-util-symbol": "^1.0.0",
+        "micromark-util-types": "^1.0.0",
+        "uvu": "^0.5.0"
+      }
+    },
+    "node_modules/micromark-factory-space": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/micromark-factory-space/-/micromark-factory-space-1.1.0.tgz",
+      "integrity": "sha512-cRzEj7c0OL4Mw2v6nwzttyOZe8XY/Z8G0rzmWQZTBi/jjwyw/U4uqKtUORXQrR5bAZZnbTI/feRV/R7hc4jQYQ==",
+      "funding": [
+        {
+          "type": "GitHub Sponsors",
+          "url": "https://github.com/sponsors/unifiedjs"
+        },
+        {
+          "type": "OpenCollective",
+          "url": "https://opencollective.com/unified"
+        }
+      ],
+      "license": "MIT",
+      "dependencies": {
+        "micromark-util-character": "^1.0.0",
+        "micromark-util-types": "^1.0.0"
+      }
+    },
+    "node_modules/micromark-factory-title": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/micromark-factory-title/-/micromark-factory-title-1.1.0.tgz",
+      "integrity": "sha512-J7n9R3vMmgjDOCY8NPw55jiyaQnH5kBdV2/UXCtZIpnHH3P6nHUKaH7XXEYuWwx/xUJcawa8plLBEjMPU24HzQ==",
+      "funding": [
+        {
+          "type": "GitHub Sponsors",
+          "url": "https://github.com/sponsors/unifiedjs"
+        },
+        {
+          "type": "OpenCollective",
+          "url": "https://opencollective.com/unified"
+        }
+      ],
+      "license": "MIT",
+      "dependencies": {
+        "micromark-factory-space": "^1.0.0",
+        "micromark-util-character": "^1.0.0",
+        "micromark-util-symbol": "^1.0.0",
+        "micromark-util-types": "^1.0.0"
+      }
+    },
+    "node_modules/micromark-factory-whitespace": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/micromark-factory-whitespace/-/micromark-factory-whitespace-1.1.0.tgz",
+      "integrity": "sha512-v2WlmiymVSp5oMg+1Q0N1Lxmt6pMhIHD457whWM7/GUlEks1hI9xj5w3zbc4uuMKXGisksZk8DzP2UyGbGqNsQ==",
+      "funding": [
+        {
+          "type": "GitHub Sponsors",
+          "url": "https://github.com/sponsors/unifiedjs"
+        },
+        {
+          "type": "OpenCollective",
+          "url": "https://opencollective.com/unified"
+        }
+      ],
+      "license": "MIT",
+      "dependencies": {
+        "micromark-factory-space": "^1.0.0",
+        "micromark-util-character": "^1.0.0",
+        "micromark-util-symbol": "^1.0.0",
+        "micromark-util-types": "^1.0.0"
+      }
+    },
+    "node_modules/micromark-util-character": {
+      "version": "1.2.0",
+      "resolved": "https://registry.npmjs.org/micromark-util-character/-/micromark-util-character-1.2.0.tgz",
+      "integrity": "sha512-lXraTwcX3yH/vMDaFWCQJP1uIszLVebzUa3ZHdrgxr7KEU/9mL4mVgCpGbyhvNLNlauROiNUq7WN5u7ndbY6xg==",
+      "funding": [
+        {
+          "type": "GitHub Sponsors",
+          "url": "https://github.com/sponsors/unifiedjs"
+        },
+        {
+          "type": "OpenCollective",
+          "url": "https://opencollective.com/unified"
+        }
+      ],
+      "license": "MIT",
+      "dependencies": {
+        "micromark-util-symbol": "^1.0.0",
+        "micromark-util-types": "^1.0.0"
+      }
+    },
+    "node_modules/micromark-util-chunked": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/micromark-util-chunked/-/micromark-util-chunked-1.1.0.tgz",
+      "integrity": "sha512-Ye01HXpkZPNcV6FiyoW2fGZDUw4Yc7vT0E9Sad83+bEDiCJ1uXu0S3mr8WLpsz3HaG3x2q0HM6CTuPdcZcluFQ==",
+      "funding": [
+        {
+          "type": "GitHub Sponsors",
+          "url": "https://github.com/sponsors/unifiedjs"
+        },
+        {
+          "type": "OpenCollective",
+          "url": "https://opencollective.com/unified"
+        }
+      ],
+      "license": "MIT",
+      "dependencies": {
+        "micromark-util-symbol": "^1.0.0"
+      }
+    },
+    "node_modules/micromark-util-classify-character": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/micromark-util-classify-character/-/micromark-util-classify-character-1.1.0.tgz",
+      "integrity": "sha512-SL0wLxtKSnklKSUplok1WQFoGhUdWYKggKUiqhX+Swala+BtptGCu5iPRc+xvzJ4PXE/hwM3FNXsfEVgoZsWbw==",
+      "funding": [
+        {
+          "type": "GitHub Sponsors",
+          "url": "https://github.com/sponsors/unifiedjs"
+        },
+        {
+          "type": "OpenCollective",
+          "url": "https://opencollective.com/unified"
+        }
+      ],
+      "license": "MIT",
+      "dependencies": {
+        "micromark-util-character": "^1.0.0",
+        "micromark-util-symbol": "^1.0.0",
+        "micromark-util-types": "^1.0.0"
+      }
+    },
+    "node_modules/micromark-util-combine-extensions": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/micromark-util-combine-extensions/-/micromark-util-combine-extensions-1.1.0.tgz",
+      "integrity": "sha512-Q20sp4mfNf9yEqDL50WwuWZHUrCO4fEyeDCnMGmG5Pr0Cz15Uo7KBs6jq+dq0EgX4DPwwrh9m0X+zPV1ypFvUA==",
+      "funding": [
+        {
+          "type": "GitHub Sponsors",
+          "url": "https://github.com/sponsors/unifiedjs"
+        },
+        {
+          "type": "OpenCollective",
+          "url": "https://opencollective.com/unified"
+        }
+      ],
+      "license": "MIT",
+      "dependencies": {
+        "micromark-util-chunked": "^1.0.0",
+        "micromark-util-types": "^1.0.0"
+      }
+    },
+    "node_modules/micromark-util-decode-numeric-character-reference": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/micromark-util-decode-numeric-character-reference/-/micromark-util-decode-numeric-character-reference-1.1.0.tgz",
+      "integrity": "sha512-m9V0ExGv0jB1OT21mrWcuf4QhP46pH1KkfWy9ZEezqHKAxkj4mPCy3nIH1rkbdMlChLHX531eOrymlwyZIf2iw==",
+      "funding": [
+        {
+          "type": "GitHub Sponsors",
+          "url": "https://github.com/sponsors/unifiedjs"
+        },
+        {
+          "type": "OpenCollective",
+          "url": "https://opencollective.com/unified"
+        }
+      ],
+      "license": "MIT",
+      "dependencies": {
+        "micromark-util-symbol": "^1.0.0"
+      }
+    },
+    "node_modules/micromark-util-decode-string": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/micromark-util-decode-string/-/micromark-util-decode-string-1.1.0.tgz",
+      "integrity": "sha512-YphLGCK8gM1tG1bd54azwyrQRjCFcmgj2S2GoJDNnh4vYtnL38JS8M4gpxzOPNyHdNEpheyWXCTnnTDY3N+NVQ==",
+      "funding": [
+        {
+          "type": "GitHub Sponsors",
+          "url": "https://github.com/sponsors/unifiedjs"
+        },
+        {
+          "type": "OpenCollective",
+          "url": "https://opencollective.com/unified"
+        }
+      ],
+      "license": "MIT",
+      "dependencies": {
+        "decode-named-character-reference": "^1.0.0",
+        "micromark-util-character": "^1.0.0",
+        "micromark-util-decode-numeric-character-reference": "^1.0.0",
+        "micromark-util-symbol": "^1.0.0"
+      }
+    },
+    "node_modules/micromark-util-encode": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/micromark-util-encode/-/micromark-util-encode-1.1.0.tgz",
+      "integrity": "sha512-EuEzTWSTAj9PA5GOAs992GzNh2dGQO52UvAbtSOMvXTxv3Criqb6IOzJUBCmEqrrXSblJIJBbFFv6zPxpreiJw==",
+      "funding": [
+        {
+          "type": "GitHub Sponsors",
+          "url": "https://github.com/sponsors/unifiedjs"
+        },
+        {
+          "type": "OpenCollective",
+          "url": "https://opencollective.com/unified"
+        }
+      ],
+      "license": "MIT"
+    },
+    "node_modules/micromark-util-html-tag-name": {
+      "version": "1.2.0",
+      "resolved": "https://registry.npmjs.org/micromark-util-html-tag-name/-/micromark-util-html-tag-name-1.2.0.tgz",
+      "integrity": "sha512-VTQzcuQgFUD7yYztuQFKXT49KghjtETQ+Wv/zUjGSGBioZnkA4P1XXZPT1FHeJA6RwRXSF47yvJ1tsJdoxwO+Q==",
+      "funding": [
+        {
+          "type": "GitHub Sponsors",
+          "url": "https://github.com/sponsors/unifiedjs"
+        },
+        {
+          "type": "OpenCollective",
+          "url": "https://opencollective.com/unified"
+        }
+      ],
+      "license": "MIT"
+    },
+    "node_modules/micromark-util-normalize-identifier": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/micromark-util-normalize-identifier/-/micromark-util-normalize-identifier-1.1.0.tgz",
+      "integrity": "sha512-N+w5vhqrBihhjdpM8+5Xsxy71QWqGn7HYNUvch71iV2PM7+E3uWGox1Qp90loa1ephtCxG2ftRV/Conitc6P2Q==",
+      "funding": [
+        {
+          "type": "GitHub Sponsors",
+          "url": "https://github.com/sponsors/unifiedjs"
+        },
+        {
+          "type": "OpenCollective",
+          "url": "https://opencollective.com/unified"
+        }
+      ],
+      "license": "MIT",
+      "dependencies": {
+        "micromark-util-symbol": "^1.0.0"
+      }
+    },
+    "node_modules/micromark-util-resolve-all": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/micromark-util-resolve-all/-/micromark-util-resolve-all-1.1.0.tgz",
+      "integrity": "sha512-b/G6BTMSg+bX+xVCshPTPyAu2tmA0E4X98NSR7eIbeC6ycCqCeE7wjfDIgzEbkzdEVJXRtOG4FbEm/uGbCRouA==",
+      "funding": [
+        {
+          "type": "GitHub Sponsors",
+          "url": "https://github.com/sponsors/unifiedjs"
+        },
+        {
+          "type": "OpenCollective",
+          "url": "https://opencollective.com/unified"
+        }
+      ],
+      "license": "MIT",
+      "dependencies": {
+        "micromark-util-types": "^1.0.0"
+      }
+    },
+    "node_modules/micromark-util-sanitize-uri": {
+      "version": "1.2.0",
+      "resolved": "https://registry.npmjs.org/micromark-util-sanitize-uri/-/micromark-util-sanitize-uri-1.2.0.tgz",
+      "integrity": "sha512-QO4GXv0XZfWey4pYFndLUKEAktKkG5kZTdUNaTAkzbuJxn2tNBOr+QtxR2XpWaMhbImT2dPzyLrPXLlPhph34A==",
+      "funding": [
+        {
+          "type": "GitHub Sponsors",
+          "url": "https://github.com/sponsors/unifiedjs"
+        },
+        {
+          "type": "OpenCollective",
+          "url": "https://opencollective.com/unified"
+        }
+      ],
+      "license": "MIT",
+      "dependencies": {
+        "micromark-util-character": "^1.0.0",
+        "micromark-util-encode": "^1.0.0",
+        "micromark-util-symbol": "^1.0.0"
+      }
+    },
+    "node_modules/micromark-util-subtokenize": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/micromark-util-subtokenize/-/micromark-util-subtokenize-1.1.0.tgz",
+      "integrity": "sha512-kUQHyzRoxvZO2PuLzMt2P/dwVsTiivCK8icYTeR+3WgbuPqfHgPPy7nFKbeqRivBvn/3N3GBiNC+JRTMSxEC7A==",
+      "funding": [
+        {
+          "type": "GitHub Sponsors",
+          "url": "https://github.com/sponsors/unifiedjs"
+        },
+        {
+          "type": "OpenCollective",
+          "url": "https://opencollective.com/unified"
+        }
+      ],
+      "license": "MIT",
+      "dependencies": {
+        "micromark-util-chunked": "^1.0.0",
+        "micromark-util-symbol": "^1.0.0",
+        "micromark-util-types": "^1.0.0",
+        "uvu": "^0.5.0"
+      }
+    },
+    "node_modules/micromark-util-symbol": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/micromark-util-symbol/-/micromark-util-symbol-1.1.0.tgz",
+      "integrity": "sha512-uEjpEYY6KMs1g7QfJ2eX1SQEV+ZT4rUD3UcF6l57acZvLNK7PBZL+ty82Z1qhK1/yXIY4bdx04FKMgR0g4IAag==",
+      "funding": [
+        {
+          "type": "GitHub Sponsors",
+          "url": "https://github.com/sponsors/unifiedjs"
+        },
+        {
+          "type": "OpenCollective",
+          "url": "https://opencollective.com/unified"
+        }
+      ],
+      "license": "MIT"
+    },
+    "node_modules/micromark-util-types": {
+      "version": "1.1.0",
+      "resolved": "https://registry.npmjs.org/micromark-util-types/-/micromark-util-types-1.1.0.tgz",
+      "integrity": "sha512-ukRBgie8TIAcacscVHSiddHjO4k/q3pnedmzMQ4iwDcK0FtFCohKOlFbaOL/mPgfnPsL3C1ZyxJa4sbWrBl3jg==",
+      "funding": [
+        {
+          "type": "GitHub Sponsors",
+          "url": "https://github.com/sponsors/unifiedjs"
+        },
+        {
+          "type": "OpenCollective",
+          "url": "https://opencollective.com/unified"
+        }
+      ],
+      "license": "MIT"
+    },
+    "node_modules/mri": {
+      "version": "1.2.0",
+      "resolved": "https://registry.npmjs.org/mri/-/mri-1.2.0.tgz",
+      "integrity": "sha512-tzzskb3bG8LvYGFF/mDTpq3jpI6Q9wc3LEmBaghu+DdCssd1FakN7Bc0hVNmEyGq1bq3RgfkCb3cmQLpNPOroA==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=4"
+      }
+    },
     "node_modules/ms": {
       "version": "2.1.3",
       "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
       "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
-      "dev": true,
       "license": "MIT"
     },
     "node_modules/nanoid": {
@@ -1465,6 +2690,12 @@
       "dev": true,
       "license": "MIT"
     },
+    "node_modules/non-layered-tidy-tree-layout": {
+      "version": "2.0.2",
+      "resolved": "https://registry.npmjs.org/non-layered-tidy-tree-layout/-/non-layered-tidy-tree-layout-2.0.2.tgz",
+      "integrity": "sha512-gkXMxRzUH+PB0ax9dUN0yYF0S25BqeAYqhgMaLUFmpXLEk7Fcu8f4emJuOAY0V8kjDICxROIKsTAKsV/v355xw==",
+      "license": "MIT"
+    },
     "node_modules/picocolors": {
       "version": "1.1.1",
       "resolved": "https://registry.npmjs.org/picocolors/-/picocolors-1.1.1.tgz",
@@ -1536,6 +2767,12 @@
         "node": ">=0.10.0"
       }
     },
+    "node_modules/robust-predicates": {
+      "version": "3.0.2",
+      "resolved": "https://registry.npmjs.org/robust-predicates/-/robust-predicates-3.0.2.tgz",
+      "integrity": "sha512-IXgzBWvWQwE6PrDI05OvmXUIruQTcoMDzRsOd5CDvHCVLcLHMTSYvOK5Cm46kWqlV3yAbuSpBZdJ5oP5OUoStg==",
+      "license": "Unlicense"
+    },
     "node_modules/rollup": {
       "version": "4.56.0",
       "resolved": "https://registry.npmjs.org/rollup/-/rollup-4.56.0.tgz",
@@ -1581,6 +2818,30 @@
         "fsevents": "~2.3.2"
       }
     },
+    "node_modules/rw": {
+      "version": "1.3.3",
+      "resolved": "https://registry.npmjs.org/rw/-/rw-1.3.3.tgz",
+      "integrity": "sha512-PdhdWy89SiZogBLaw42zdeqtRJ//zFd2PgQavcICDUgJT5oW10QCRKbJ6bg4r0/UY2M6BWd5tkxuGFRvCkgfHQ==",
+      "license": "BSD-3-Clause"
+    },
+    "node_modules/sade": {
+      "version": "1.8.1",
+      "resolved": "https://registry.npmjs.org/sade/-/sade-1.8.1.tgz",
+      "integrity": "sha512-xal3CZX1Xlo/k4ApwCFrHVACi9fBqJ7V+mwhBsuf/1IOKbBy098Fex+Wa/5QMubw09pSZ/u8EY8PWgevJsXp1A==",
+      "license": "MIT",
+      "dependencies": {
+        "mri": "^1.1.0"
+      },
+      "engines": {
+        "node": ">=6"
+      }
+    },
+    "node_modules/safer-buffer": {
+      "version": "2.1.2",
+      "resolved": "https://registry.npmjs.org/safer-buffer/-/safer-buffer-2.1.2.tgz",
+      "integrity": "sha512-YZo3K82SD7Riyi0E1EQPojLz7kpepnSQI9IyPbHHg1XXXevb5dJI7tpyN2ADxGcQbHG7vcyRHk0cbwqcQriUtg==",
+      "license": "MIT"
+    },
     "node_modules/scheduler": {
       "version": "0.23.2",
       "resolved": "https://registry.npmjs.org/scheduler/-/scheduler-0.23.2.tgz",
@@ -1610,6 +2871,21 @@
         "node": ">=0.10.0"
       }
     },
+    "node_modules/stylis": {
+      "version": "4.3.6",
+      "resolved": "https://registry.npmjs.org/stylis/-/stylis-4.3.6.tgz",
+      "integrity": "sha512-yQ3rwFWRfwNUY7H5vpU0wfdkNSnvnJinhF9830Swlaxl03zsOjCfmX0ugac+3LtK0lYSgwL/KXc8oYL3mG4YFQ==",
+      "license": "MIT"
+    },
+    "node_modules/ts-dedent": {
+      "version": "2.2.0",
+      "resolved": "https://registry.npmjs.org/ts-dedent/-/ts-dedent-2.2.0.tgz",
+      "integrity": "sha512-q5W7tVM71e2xjHZTlgfTDoPF/SmqKG5hddq9SzR49CH2hayqRKJtQ4mtRlSxKaJlR/+9rEM+mnBHf7I2/BQcpQ==",
+      "license": "MIT",
+      "engines": {
+        "node": ">=6.10"
+      }
+    },
     "node_modules/typescript": {
       "version": "5.9.3",
       "resolved": "https://registry.npmjs.org/typescript/-/typescript-5.9.3.tgz",
@@ -1624,6 +2900,19 @@
         "node": ">=14.17"
       }
     },
+    "node_modules/unist-util-stringify-position": {
+      "version": "3.0.3",
+      "resolved": "https://registry.npmjs.org/unist-util-stringify-position/-/unist-util-stringify-position-3.0.3.tgz",
+      "integrity": "sha512-k5GzIBZ/QatR8N5X2y+drfpWG8IDBzdnVj6OInRNWm1oXrzydiaAT2OQiA8DPRRZyAKb9b6I2a6PxYklZD0gKg==",
+      "license": "MIT",
+      "dependencies": {
+        "@types/unist": "^2.0.0"
+      },
+      "funding": {
+        "type": "opencollective",
+        "url": "https://opencollective.com/unified"
+      }
+    },
     "node_modules/update-browserslist-db": {
       "version": "1.2.3",
       "resolved": "https://registry.npmjs.org/update-browserslist-db/-/update-browserslist-db-1.2.3.tgz",
@@ -1655,6 +2944,37 @@
         "browserslist": ">= 4.21.0"
       }
     },
+    "node_modules/uuid": {
+      "version": "9.0.1",
+      "resolved": "https://registry.npmjs.org/uuid/-/uuid-9.0.1.tgz",
+      "integrity": "sha512-b+1eJOlsR9K8HJpow9Ok3fiWOWSIcIzXodvv0rQjVoOVNpWMpxf1wZNpt4y9h10odCNrqnYp1OBzRktckBe3sA==",
+      "funding": [
+        "https://github.com/sponsors/broofa",
+        "https://github.com/sponsors/ctavan"
+      ],
+      "license": "MIT",
+      "bin": {
+        "uuid": "dist/bin/uuid"
+      }
+    },
+    "node_modules/uvu": {
+      "version": "0.5.6",
+      "resolved": "https://registry.npmjs.org/uvu/-/uvu-0.5.6.tgz",
+      "integrity": "sha512-+g8ENReyr8YsOc6fv/NVJs2vFdHBnBNdfE49rshrTzDWOlUx4Gq7KOS2GD8eqhy2j+Ejq29+SbKH8yjkAqXqoA==",
+      "license": "MIT",
+      "dependencies": {
+        "dequal": "^2.0.0",
+        "diff": "^5.0.0",
+        "kleur": "^4.0.3",
+        "sade": "^1.7.3"
+      },
+      "bin": {
+        "uvu": "bin.js"
+      },
+      "engines": {
+        "node": ">=8"
+      }
+    },
     "node_modules/vite": {
       "version": "5.4.21",
       "resolved": "https://registry.npmjs.org/vite/-/vite-5.4.21.tgz",
@@ -1715,6 +3035,12 @@
         }
       }
     },
+    "node_modules/web-worker": {
+      "version": "1.5.0",
+      "resolved": "https://registry.npmjs.org/web-worker/-/web-worker-1.5.0.tgz",
+      "integrity": "sha512-RiMReJrTAiA+mBjGONMnjVDP2u3p9R1vkcGz6gDIrOMT3oGuYwX2WRMYI9ipkphSuE5XKEhydbhNEJh4NY9mlw==",
+      "license": "Apache-2.0"
+    },
     "node_modules/yallist": {
       "version": "3.1.1",
       "resolved": "https://registry.npmjs.org/yallist/-/yallist-3.1.1.tgz",
diff -ruN '--exclude=.devlogs' '--exclude=venv' '--exclude=node_modules' '--exclude=__pycache__' /tmp/AntiHub.phase3.base/frontend/package.json /home/user2643/code/AntiHub/frontend/package.json
--- /tmp/AntiHub.phase3.base/frontend/package.json	2026-01-22 21:52:23.262380687 +0800
+++ /home/user2643/code/AntiHub/frontend/package.json	2026-01-22 23:26:38.562408408 +0800
@@ -9,6 +9,8 @@
     "preview": "vite preview"
   },
   "dependencies": {
+    "marked": "^12.0.2",
+    "mermaid": "^10.9.1",
     "react": "^18.3.1",
     "react-dom": "^18.3.1"
   },
diff -ruN '--exclude=.devlogs' '--exclude=venv' '--exclude=node_modules' '--exclude=__pycache__' /tmp/AntiHub.phase3.base/frontend/src/App.tsx /home/user2643/code/AntiHub/frontend/src/App.tsx
--- /tmp/AntiHub.phase3.base/frontend/src/App.tsx	2026-01-22 21:52:23.262380687 +0800
+++ /home/user2643/code/AntiHub/frontend/src/App.tsx	2026-01-22 23:27:37.640750450 +0800
@@ -1,4 +1,6 @@
 import React, { useCallback, useEffect, useMemo, useRef, useState } from "react";
+import { marked } from "marked";
+import mermaid from "mermaid";
 
 const API_BASE = import.meta.env.VITE_API_BASE || "http://127.0.0.1:8010";
 
@@ -22,6 +24,31 @@
   error_message?: string | null;
   created_at?: number | null;
   updated_at?: number | null;
+  repo_url?: string | null;
+  ref?: string | null;
+  branch?: string | null;
+  archived?: boolean;
+  archived_at?: number | null;
+  attempt?: number | null;
+  retry_of?: string | null;
+  manual_status?: string | null;
+  manual_generated_at?: number | null;
+  manual_error_code?: string | null;
+  manual_error_message?: string | null;
+};
+
+type CaseListResponse = {
+  items: CaseResponse[];
+  total: number;
+  page: number;
+  size: number;
+};
+
+type CaseActionResponse = {
+  case_id: string;
+  action: string;
+  status: string;
+  message: string;
 };
 
 type LogEntry = {
@@ -31,7 +58,49 @@
   line: string;
 };
 
+type Toast = {
+  type: "success" | "error";
+  message: string;
+  detail?: string;
+  code?: string;
+};
+
+type ErrorCodeMap = Record<string, { message: string; hint: string }>;
+
+type ManualMeta = {
+  generated_at: number;
+  generator_version: string;
+  signals: Record<string, unknown>;
+  time_cost_ms: number;
+};
+
+type ManualStatusResponse = {
+  case_id: string;
+  status: string;
+  generated_at?: number | null;
+  error_code?: string | null;
+  error_message?: string | null;
+};
+
+type ManualResponse = {
+  case_id: string;
+  manual_markdown: string;
+  meta: ManualMeta;
+};
+
+type CaseTemplate = {
+  name: string;
+  repo_url?: string | null;
+  git_url?: string | null;
+  ref?: string | null;
+  default_env_keys?: string[];
+  build_mode?: string | null;
+  port_mode?: string | null;
+  timeouts?: Record<string, number>;
+};
+
 type Route =
+  | { type: "dashboard" }
   | { type: "create" }
   | {
       type: "case";
@@ -40,14 +109,21 @@
 
 const ERROR_EXPLAIN: Record<string, string> = {
   PORT_POOL_EXHAUSTED: "端口池已满，请停止旧容器或扩大端口范围。",
+  PORT_IN_USE: "端口已被占用，请稍后重试。",
   DOCKER_BUILD_FAILED: "Docker 镜像构建失败，请检查 Dockerfile 与构建日志。",
   DOCKER_API_ERROR: "Docker 守护进程错误，请确认 Docker 正常运行且端口未被占用。",
   DOCKERFILE_MISSING: "仓库根目录缺少 Dockerfile。",
   GIT_CLONE_FAILED: "Git 克隆失败，请检查仓库地址与权限。",
   GIT_CLONE_TIMEOUT: "Git 克隆超时，请重试或使用更小的仓库。",
-  STARTUP_TIMEOUT: "容器启动超时，请确认监听 0.0.0.0 且 EXPOSE 端口正确。",
+  TIMEOUT_CLONE: "克隆超时，请检查仓库体积或超时配置。",
+  TIMEOUT_BUILD: "构建超时，请检查构建步骤与超时配置。",
+  TIMEOUT_RUN: "启动超时，请确认监听 0.0.0.0 且端口匹配 EXPOSE。",
+  TIMEOUT_ANALYZE: "分析超时，请稍后重试。",
+  STARTUP_TIMEOUT: "容器启动超时，请确认监听 0.0.0.0 且端口匹配 EXPOSE。",
   CONTAINER_EXIT_NONZERO: "容器非零退出，请查看容器日志。",
+  STOPPED_BY_USER: "已由用户手动停止。",
   UNEXPECTED_ERROR: "未知错误，请查看日志详情。",
+  MANUAL_GENERATION_FAILED: "说明书生成失败，请检查仓库文件。",
 };
 
 const STREAM_LABELS: Record<string, string> = {
@@ -71,29 +147,12 @@
   BUILDING: "构建中",
   STARTING: "启动中",
   RUNNING: "运行中",
+  STOPPED: "已停止",
   FAILED: "失败",
   FINISHED: "已结束",
   ANALYZING: "分析中",
 };
 
-function streamLabel(stream: string) {
-  return STREAM_LABELS[stream] || stream;
-}
-
-function statusLabel(status?: string) {
-  if (!status) return "-";
-  const normalized = status.toUpperCase();
-  const label = STATUS_LABELS[normalized];
-  return label ? `${label} (${normalized})` : normalized;
-}
-
-function stageLabel(stage?: string) {
-  if (!stage) return "-";
-  const normalized = stage.toLowerCase();
-  const label = STAGE_LABELS[normalized];
-  return label ? `${label} (${normalized})` : stage;
-}
-
 function joinUrl(base: string, path: string) {
   const trimmed = base.replace(/\/+$/, "");
   return `${trimmed}${path}`;
@@ -110,11 +169,14 @@
 }
 
 function parseRoute(pathname: string): Route {
+  if (pathname.startsWith("/create")) {
+    return { type: "create" };
+  }
   const match = pathname.match(/^\/cases\/([^/]+)$/);
   if (match && match[1]) {
     return { type: "case", caseId: match[1] };
   }
-  return { type: "create" };
+  return { type: "dashboard" };
 }
 
 function useRoute() {
@@ -134,9 +196,11 @@
   return { route, navigate };
 }
 
-function formatTime(ts?: number | null) {
+function formatTime(ts?: number | string | null) {
   if (!ts) return "-";
-  const date = new Date(ts * 1000);
+  const value = typeof ts === "string" ? Number(ts) : ts;
+  if (!value || Number.isNaN(value)) return "-";
+  const date = new Date(value * 1000);
   return date.toLocaleString();
 }
 
@@ -144,6 +208,7 @@
   const normalized = (status || "").toUpperCase();
   if (normalized === "RUNNING") return "running";
   if (normalized === "FAILED") return "failed";
+  if (normalized === "STOPPED") return "neutral";
   if (normalized === "BUILDING" || normalized === "CLONING" || normalized === "STARTING") {
     return "working";
   }
@@ -151,34 +216,113 @@
   return "neutral";
 }
 
+function streamLabel(stream: string) {
+  return STREAM_LABELS[stream] || stream;
+}
+
+function statusLabel(status?: string) {
+  if (!status) return "-";
+  const normalized = status.toUpperCase();
+  const label = STATUS_LABELS[normalized];
+  return label ? `${label} (${normalized})` : normalized;
+}
+
+function stageLabel(stage?: string) {
+  if (!stage) return "-";
+  const normalized = stage.toLowerCase();
+  const label = STAGE_LABELS[normalized];
+  return label ? `${label} (${normalized})` : stage;
+}
+
+function manualStatusLabel(status?: string | null) {
+  const normalized = (status || "").toUpperCase();
+  if (!normalized || normalized === "NOT_STARTED") return "未生成";
+  if (normalized === "PENDING" || normalized === "RUNNING") return "生成中";
+  if (normalized === "SUCCESS") return "已生成";
+  if (normalized === "FAILED") return "生成失败";
+  return normalized;
+}
+
+function resolveErrorHint(code: string | null | undefined, errorCodes: ErrorCodeMap) {
+  if (!code) return null;
+  if (errorCodes[code]) {
+    return `${errorCodes[code].message} ${errorCodes[code].hint}`.trim();
+  }
+  return ERROR_EXPLAIN[code] || null;
+}
+
 function App() {
   const { route, navigate } = useRoute();
   const [flashCaseId, setFlashCaseId] = useState<string | null>(null);
+  const [toast, setToast] = useState<Toast | null>(null);
+  const [errorCodes, setErrorCodes] = useState<ErrorCodeMap>({});
+
+  useEffect(() => {
+    mermaid.initialize({ startOnLoad: false, theme: "neutral" });
+  }, []);
+
+  useEffect(() => {
+    let alive = true;
+    const fetchErrorCodes = async () => {
+      try {
+        const response = await fetch(joinUrl(API_BASE, "/error-codes"));
+        if (!response.ok) return;
+        const data = (await response.json()) as ErrorCodeMap;
+        if (alive) setErrorCodes(data || {});
+      } catch (err) {
+        if (alive) setErrorCodes({});
+      }
+    };
+    fetchErrorCodes();
+    return () => {
+      alive = false;
+    };
+  }, []);
+
+  useEffect(() => {
+    if (!toast) return undefined;
+    const timer = window.setTimeout(() => setToast(null), 3200);
+    return () => window.clearTimeout(timer);
+  }, [toast]);
+
+  const pushToast = useCallback((next: Toast) => {
+    setToast(next);
+  }, []);
 
   return (
     <div className="app">
       <header className="topbar">
         <div className="brand">
-            <div className="brand-mark">AH</div>
+          <div className="brand-mark">AH</div>
           <div>
-            <div className="brand-title">AntiHub 控制台</div>
-            <div className="brand-sub">阶段 2 - 创建、观测、对齐</div>
+            <div className="brand-title">AntiHub 智能展厅</div>
+            <div className="brand-sub">阶段 4 - 说明书与体验打磨</div>
           </div>
         </div>
         <div className="topbar-actions">
-          <button className="ghost" onClick={() => navigate("/")}>新建案例</button>
+          <button className="ghost" onClick={() => navigate("/")}>控制台</button>
+          <button className="ghost" onClick={() => navigate("/create")}>新建案例</button>
           <a className="ghost" href="http://127.0.0.1:8010/docs" target="_blank" rel="noreferrer">
             API 文档
           </a>
         </div>
       </header>
       <main className="main">
-        {route.type === "create" ? (
+        {toast ? <ToastBanner toast={toast} onClose={() => setToast(null)} /> : null}
+        {route.type === "dashboard" ? (
+          <Dashboard
+            onOpen={(caseId) => navigate(`/cases/${caseId}`)}
+            onCreate={() => navigate("/create")}
+            errorCodes={errorCodes}
+            pushToast={pushToast}
+          />
+        ) : route.type === "create" ? (
           <CreateCase
             onCreated={(caseId) => {
               setFlashCaseId(caseId);
               navigate(`/cases/${caseId}`);
             }}
+            pushToast={pushToast}
           />
         ) : (
           <CaseDetail
@@ -186,6 +330,8 @@
             onBack={() => navigate("/")}
             flashCaseId={flashCaseId}
             clearFlash={() => setFlashCaseId(null)}
+            pushToast={pushToast}
+            errorCodes={errorCodes}
           />
         )}
       </main>
@@ -195,16 +341,78 @@
 
 type EnvRow = { id: string; key: string; value: string };
 
-function CreateCase({ onCreated }: { onCreated: (caseId: string) => void }) {
+function ToastBanner({ toast, onClose }: { toast: Toast; onClose: () => void }) {
+  const [expanded, setExpanded] = useState(false);
+  return (
+    <div className={`toast-banner ${toast.type === "success" ? "toast-success" : "toast-error"}`}>
+      <div>
+        <div className="toast-title">{toast.message}</div>
+        {toast.code ? <div className="toast-code">{toast.code}</div> : null}
+        {toast.detail ? (
+          <button className="toast-detail" type="button" onClick={() => setExpanded((v) => !v)}>
+            {expanded ? "收起详情" : "查看详情"}
+          </button>
+        ) : null}
+        {expanded && toast.detail ? <div className="toast-body">{toast.detail}</div> : null}
+      </div>
+      <button className="ghost" type="button" onClick={onClose}>
+        关闭
+      </button>
+    </div>
+  );
+}
+
+function CreateCase({ onCreated, pushToast }: { onCreated: (caseId: string) => void; pushToast: (t: Toast) => void }) {
   const [repoUrl, setRepoUrl] = useState("");
   const [ref, setRef] = useState("");
   const [autoAnalyze, setAutoAnalyze] = useState(false);
   const [envRows, setEnvRows] = useState<EnvRow[]>([
     { id: `env-${Date.now()}`, key: "", value: "" },
   ]);
+  const [templates, setTemplates] = useState<CaseTemplate[]>([]);
+  const [selectedTemplate, setSelectedTemplate] = useState("");
   const [submitting, setSubmitting] = useState(false);
   const [error, setError] = useState<string | null>(null);
 
+  useEffect(() => {
+    let alive = true;
+    const fetchTemplates = async () => {
+      try {
+        const response = await fetch(joinUrl(API_BASE, "/case-templates"));
+        if (!response.ok) return;
+        const data = (await response.json()) as CaseTemplate[];
+        if (alive) setTemplates(data || []);
+      } catch (err) {
+        if (alive) setTemplates([]);
+      }
+    };
+    fetchTemplates();
+    return () => {
+      alive = false;
+    };
+  }, []);
+
+  const applyTemplate = (name: string) => {
+    setSelectedTemplate(name);
+    const tpl = templates.find((item) => item.name === name);
+    if (!tpl) return;
+    const nextRepo = tpl.repo_url || tpl.git_url || "";
+    setRepoUrl(nextRepo);
+    setRef(tpl.ref || "");
+    const nextEnvKeys = (tpl.default_env_keys || []).filter(Boolean);
+    if (nextEnvKeys.length) {
+      setEnvRows(
+        nextEnvKeys.map((key, index) => ({
+          id: `tpl-${Date.now()}-${index}`,
+          key,
+          value: "",
+        }))
+      );
+    } else {
+      setEnvRows([{ id: `env-${Date.now()}`, key: "", value: "" }]);
+    }
+  };
+
   const addRow = () => {
     setEnvRows((rows) => [...rows, { id: `env-${Date.now()}-${rows.length}`, key: "", value: "" }]);
   };
@@ -264,15 +472,19 @@
           if (text) message = text;
         }
         setError(message);
+        pushToast({ type: "error", message: "创建失败", detail: message });
         return;
       }
       const data = (await response.json()) as CaseResponse;
       setEnvRows([{ id: `env-${Date.now()}`, key: "", value: "" }]);
       setRepoUrl("");
       setRef("");
+      setSelectedTemplate("");
       onCreated(data.case_id);
+      pushToast({ type: "success", message: "创建成功", detail: `case_id: ${data.case_id}` });
     } catch (err) {
       setError("网络错误，请检查 API 连接。");
+      pushToast({ type: "error", message: "创建失败", detail: "网络错误" });
     } finally {
       setSubmitting(false);
     }
@@ -282,8 +494,21 @@
     <div className="create-grid">
       <section className="card card-hero" style={{ animationDelay: "0.05s" }}>
         <div className="section-title">创建案例</div>
-        <p className="section-sub">几秒内启动仓库并可视化全流程日志。</p>
+        <p className="section-sub">选择模板或填入仓库地址，即可生成可展示的案例说明书。</p>
         <form className="form" onSubmit={handleSubmit}>
+          {templates.length ? (
+            <label className="field">
+              <span>案例模板</span>
+              <select value={selectedTemplate} onChange={(event) => applyTemplate(event.target.value)}>
+                <option value="">请选择模板</option>
+                {templates.map((tpl) => (
+                  <option key={tpl.name} value={tpl.name}>
+                    {tpl.name}
+                  </option>
+                ))}
+              </select>
+            </label>
+          ) : null}
           <label className="field">
             <span>仓库地址</span>
             <input
@@ -359,7 +584,7 @@
         <ul className="list">
           <li>2 秒内返回 case_id</li>
           <li>WS 日志回放 + 实时追踪</li>
-          <li>访问地址可点击/复制</li>
+          <li>自动生成仓库说明书 + Mermaid 图</li>
           <li>仅展示 env 键名</li>
         </ul>
         <div className="note">
@@ -373,20 +598,316 @@
   );
 }
 
+function Dashboard({
+  onOpen,
+  onCreate,
+  errorCodes,
+  pushToast,
+}: {
+  onOpen: (caseId: string) => void;
+  onCreate: () => void;
+  errorCodes: ErrorCodeMap;
+  pushToast: (t: Toast) => void;
+}) {
+  const [cases, setCases] = useState<CaseResponse[]>([]);
+  const [total, setTotal] = useState(0);
+  const [page, setPage] = useState(1);
+  const [size, setSize] = useState(10);
+  const [query, setQuery] = useState("");
+  const [status, setStatus] = useState("");
+  const [stage, setStage] = useState("");
+  const [includeArchived, setIncludeArchived] = useState(false);
+  const [loading, setLoading] = useState(false);
+  const [error, setError] = useState<string | null>(null);
+
+  const fetchCases = useCallback(async () => {
+    setLoading(true);
+    setError(null);
+    try {
+      const params = new URLSearchParams();
+      params.set("page", String(page));
+      params.set("size", String(size));
+      if (query.trim()) params.set("q", query.trim());
+      if (status) params.set("status", status);
+      if (stage) params.set("stage", stage);
+      if (includeArchived) params.set("include_archived", "true");
+      const response = await fetch(joinUrl(API_BASE, `/cases?${params.toString()}`));
+      if (!response.ok) {
+        throw new Error(`请求失败 (${response.status})`);
+      }
+      const data = (await response.json()) as CaseListResponse;
+      setCases(data.items || []);
+      setTotal(data.total || 0);
+    } catch (err) {
+      setError(err instanceof Error ? err.message : "加载失败");
+      pushToast({ type: "error", message: "加载失败", detail: String(err) });
+    } finally {
+      setLoading(false);
+    }
+  }, [page, size, query, status, stage, includeArchived, pushToast]);
+
+  useEffect(() => {
+    fetchCases();
+  }, [fetchCases]);
+
+  const totalPages = Math.max(1, Math.ceil(total / size));
+  const runningCount = cases.filter((item) => item.status?.toUpperCase() === "RUNNING").length;
+  const failedCount = cases.filter((item) => item.status?.toUpperCase() === "FAILED").length;
+
+  const handleAction = async (caseId: string, action: "stop" | "retry" | "archive") => {
+    const confirmText =
+      action === "stop"
+        ? "确认停止该运行中的案例？"
+        : action === "retry"
+        ? "确认重试该失败案例？"
+        : "确认归档该案例？";
+    if (!window.confirm(confirmText)) return;
+    try {
+      const response = await fetch(joinUrl(API_BASE, `/cases/${caseId}/${action}`), {
+        method: "POST",
+        headers: { "Content-Type": "application/json" },
+        body: action === "retry" ? JSON.stringify({}) : undefined,
+      });
+      if (!response.ok) {
+        const text = await response.text();
+        throw new Error(text || `操作失败 (${response.status})`);
+      }
+      const data = (await response.json()) as CaseActionResponse;
+      pushToast({ type: "success", message: "操作成功", detail: data.message });
+      fetchCases();
+    } catch (err) {
+      pushToast({ type: "error", message: "操作失败", detail: String(err) });
+    }
+  };
+
+  return (
+    <div className="dashboard">
+      <div className="dashboard-head">
+        <div>
+          <div className="section-title">案例列表</div>
+          <div className="section-sub">支持搜索、筛选、分页与管理动作。</div>
+        </div>
+        <div className="dashboard-actions">
+          <button className="ghost" type="button" onClick={fetchCases}>
+            刷新列表
+          </button>
+          <button className="primary" type="button" onClick={onCreate}>
+            新建案例
+          </button>
+        </div>
+      </div>
+
+      <div className="stats">
+        <div className="card stat-card">
+          <div className="stat-title">总数</div>
+          <div className="stat-value">{total}</div>
+        </div>
+        <div className="card stat-card">
+          <div className="stat-title">运行中</div>
+          <div className="stat-value">{runningCount}</div>
+        </div>
+        <div className="card stat-card">
+          <div className="stat-title">失败</div>
+          <div className="stat-value">{failedCount}</div>
+        </div>
+      </div>
+
+      <div className="filters-panel card">
+        <label className="field">
+          <span>搜索</span>
+          <input
+            type="text"
+            placeholder="case_id / repo / ref"
+            value={query}
+            onChange={(event) => {
+              setQuery(event.target.value);
+              setPage(1);
+            }}
+          />
+        </label>
+        <label className="field">
+          <span>状态</span>
+          <select
+            value={status}
+            onChange={(event) => {
+              setStatus(event.target.value);
+              setPage(1);
+            }}
+          >
+            <option value="">全部</option>
+            <option value="RUNNING">RUNNING</option>
+            <option value="FAILED">FAILED</option>
+            <option value="STOPPED">STOPPED</option>
+            <option value="PENDING">PENDING</option>
+            <option value="BUILDING">BUILDING</option>
+          </select>
+        </label>
+        <label className="field">
+          <span>阶段</span>
+          <select
+            value={stage}
+            onChange={(event) => {
+              setStage(event.target.value);
+              setPage(1);
+            }}
+          >
+            <option value="">全部</option>
+            <option value="clone">clone</option>
+            <option value="build">build</option>
+            <option value="run">run</option>
+            <option value="analyze">analyze</option>
+            <option value="system">system</option>
+          </select>
+        </label>
+        <label className="field checkbox">
+          <span>显示归档</span>
+          <input
+            type="checkbox"
+            checked={includeArchived}
+            onChange={(event) => {
+              setIncludeArchived(event.target.checked);
+              setPage(1);
+            }}
+          />
+        </label>
+        <label className="field">
+          <span>每页</span>
+          <select
+            value={String(size)}
+            onChange={(event) => {
+              setSize(Number(event.target.value));
+              setPage(1);
+            }}
+          >
+            <option value="10">10</option>
+            <option value="20">20</option>
+            <option value="50">50</option>
+          </select>
+        </label>
+      </div>
+
+      {error ? <div className="error-banner">{error}</div> : null}
+
+      <div className="card table-card">
+        <div className="table">
+          <div className="table-header">
+            <span>case_id</span>
+            <span>repo/ref</span>
+            <span>状态/阶段</span>
+            <span>更新时间</span>
+            <span>访问</span>
+            <span>错误码</span>
+            <span>说明书</span>
+            <span>操作</span>
+          </div>
+          {loading ? (
+            <div className="table-empty">加载中...</div>
+          ) : cases.length ? (
+            cases.map((item) => {
+              const runtime = item.runtime || {};
+              const statusUpper = (item.status || "").toUpperCase();
+              const errorHint = resolveErrorHint(item.error_code, errorCodes);
+              return (
+                <div className="table-row" key={item.case_id}>
+                  <span className="mono">{item.case_id}</span>
+                  <span className="table-repo">
+                    <div className="mono">{item.repo_url || "-"}</div>
+                    <div className="muted">{item.ref || item.branch || "-"}</div>
+                  </span>
+                  <span>
+                    <span className={`badge badge--${statusTone(item.status)}`}>{statusLabel(item.status)}</span>
+                    <span className="stage">{stageLabel(item.stage)}</span>
+                  </span>
+                  <span>{formatTime(item.updated_at)}</span>
+                  <span>
+                    {runtime.access_url ? (
+                      <a href={runtime.access_url} target="_blank" rel="noreferrer">
+                        {runtime.access_url}
+                      </a>
+                    ) : runtime.host_port ? (
+                      <span>{runtime.host_port}</span>
+                    ) : (
+                      "-"
+                    )}
+                  </span>
+                  <span className="mono">
+                    {statusUpper === "FAILED" ? item.error_code || "-" : "-"}
+                    {statusUpper === "FAILED" && errorHint ? (
+                      <div className="muted">{errorHint}</div>
+                    ) : null}
+                  </span>
+                  <span className="manual-status">
+                    <span>{manualStatusLabel(item.manual_status)}</span>
+                    {item.manual_generated_at ? (
+                      <div className="muted">{formatTime(item.manual_generated_at)}</div>
+                    ) : null}
+                  </span>
+                  <span className="table-actions">
+                    <button className="ghost" onClick={() => onOpen(item.case_id)}>详情</button>
+                    <button
+                      className="ghost"
+                      disabled={statusUpper !== "RUNNING"}
+                      onClick={() => handleAction(item.case_id, "stop")}
+                    >
+                      停止
+                    </button>
+                    <button
+                      className="ghost"
+                      disabled={statusUpper !== "FAILED"}
+                      onClick={() => handleAction(item.case_id, "retry")}
+                    >
+                      重试
+                    </button>
+                    <button className="ghost" onClick={() => handleAction(item.case_id, "archive")}>
+                      归档
+                    </button>
+                  </span>
+                </div>
+              );
+            })
+          ) : (
+            <div className="table-empty">暂无案例</div>
+          )}
+        </div>
+        <div className="pagination">
+          <button className="ghost" disabled={page <= 1} onClick={() => setPage((p) => Math.max(1, p - 1))}>
+            上一页
+          </button>
+          <span>
+            第 {page} / {totalPages} 页
+          </span>
+          <button
+            className="ghost"
+            disabled={page >= totalPages}
+            onClick={() => setPage((p) => Math.min(totalPages, p + 1))}
+          >
+            下一页
+          </button>
+        </div>
+      </div>
+    </div>
+  );
+}
+
 function CaseDetail({
   caseId,
   onBack,
   flashCaseId,
   clearFlash,
+  pushToast,
+  errorCodes,
 }: {
   caseId: string;
   onBack: () => void;
   flashCaseId: string | null;
   clearFlash: () => void;
+  pushToast: (t: Toast) => void;
+  errorCodes: ErrorCodeMap;
 }) {
   const [caseData, setCaseData] = useState<CaseResponse | null>(null);
   const [loadError, setLoadError] = useState<string | null>(null);
   const [loading, setLoading] = useState(false);
+  const [activeTab, setActiveTab] = useState<"overview" | "logs" | "manual">("overview");
   const statusRef = useRef<string>("");
   const fetchLock = useRef(false);
 
@@ -412,12 +933,14 @@
             if (text) message = text;
           }
           setLoadError(message);
+          pushToast({ type: "error", message: "加载失败", detail: message });
           return;
         }
         const data = (await response.json()) as CaseResponse;
         setCaseData(data);
       } catch (err) {
         setLoadError("网络错误，请检查 API 连接。");
+        pushToast({ type: "error", message: "加载失败", detail: "网络错误" });
       } finally {
         fetchLock.current = false;
         if (!silent) {
@@ -425,7 +948,7 @@
         }
       }
     },
-    [caseId]
+    [caseId, pushToast]
   );
 
   useEffect(() => {
@@ -443,7 +966,7 @@
       if (cancelled) return;
       await fetchCase(true);
       const status = statusRef.current.toUpperCase();
-      const slow = status === "RUNNING" || status === "FAILED" || status === "FINISHED";
+      const slow = status === "RUNNING" || status === "FAILED" || status === "STOPPED" || status === "FINISHED";
       const delay = slow ? 5000 : 2000;
       timer = window.setTimeout(poll, delay);
     };
@@ -466,6 +989,54 @@
   const envKeys = caseData?.env_keys || [];
   const errorCode = caseData?.error_code || undefined;
   const errorMessage = caseData?.error_message || undefined;
+  const statusUpper = (caseData?.status || "").toUpperCase();
+  const errorHint = resolveErrorHint(errorCode, errorCodes);
+
+  const runAction = async (action: "stop" | "restart" | "retry" | "archive") => {
+    const confirmText =
+      action === "stop"
+        ? "确认停止该运行中的案例？"
+        : action === "restart"
+        ? "确认重新启动该案例？"
+        : action === "retry"
+        ? "确认重新构建并运行该案例？"
+        : "确认归档该案例？";
+    if (!window.confirm(confirmText)) return;
+    try {
+      const response = await fetch(joinUrl(API_BASE, `/cases/${caseId}/${action}`), {
+        method: "POST",
+        headers: { "Content-Type": "application/json" },
+        body: action === "retry" ? JSON.stringify({}) : undefined,
+      });
+      if (!response.ok) {
+        const text = await response.text();
+        throw new Error(text || `操作失败 (${response.status})`);
+      }
+      const data = (await response.json()) as CaseActionResponse;
+      pushToast({ type: "success", message: "操作成功", detail: data.message });
+      fetchCase();
+    } catch (err) {
+      pushToast({ type: "error", message: "操作失败", detail: String(err) });
+    }
+  };
+
+  const copyLogs = async () => {
+    try {
+      const response = await fetch(joinUrl(API_BASE, `/cases/${caseId}/logs?limit=1000&format=jsonl`));
+      if (!response.ok) {
+        throw new Error(`导出失败 (${response.status})`);
+      }
+      const text = await response.text();
+      await navigator.clipboard.writeText(text);
+      pushToast({ type: "success", message: "已复制日志", detail: "最近 1000 行 JSONL 已复制" });
+    } catch (err) {
+      pushToast({ type: "error", message: "导出失败", detail: String(err) });
+    }
+  };
+
+  const downloadLogs = () => {
+    window.open(joinUrl(API_BASE, `/cases/${caseId}/logs/download?limit=1000`), "_blank");
+  };
 
   return (
     <div className="detail">
@@ -480,79 +1051,339 @@
       </div>
       {flashCaseId ? <div className="success-banner">创建成功：{flashCaseId}</div> : null}
       {loadError ? <div className="error-banner">{loadError}</div> : null}
-      <div className="detail-grid">
-        <section className="card" style={{ animationDelay: "0.05s" }}>
-          <div className="section-title">状态</div>
-          <div className="status-row">
-            <span className={`badge badge--${statusTone(caseData?.status)}`}>
-              {statusLabel(caseData?.status)}
-            </span>
-            <span className="stage">阶段：{stageLabel(caseData?.stage)}</span>
-          </div>
-          <div className="meta">
-            <div>更新时间：{formatTime(caseData?.updated_at)}</div>
-            <div>创建时间：{formatTime(caseData?.created_at)}</div>
-            <div>提交：{caseData?.commit_sha || "-"}</div>
-          </div>
-        </section>
-        <section className="card" style={{ animationDelay: "0.12s" }}>
-          <div className="section-title">运行信息</div>
-          <div className="runtime">
-            <div className="runtime-row">
-              <span>访问地址</span>
-              {runtime.access_url ? (
-                <div className="runtime-actions">
-                  <a href={runtime.access_url} target="_blank" rel="noreferrer">
-                    {runtime.access_url}
-                  </a>
-                  <CopyButton value={runtime.access_url} />
-                </div>
-              ) : (
-                <span>-</span>
-              )}
+
+      <div className="tabs">
+        <button
+          className={activeTab === "overview" ? "tab active" : "tab"}
+          onClick={() => setActiveTab("overview")}
+        >
+          概览
+        </button>
+        <button
+          className={activeTab === "logs" ? "tab active" : "tab"}
+          onClick={() => setActiveTab("logs")}
+        >
+          日志
+        </button>
+        <button
+          className={activeTab === "manual" ? "tab active" : "tab"}
+          onClick={() => setActiveTab("manual")}
+        >
+          说明书
+        </button>
+      </div>
+
+      {activeTab === "overview" ? (
+        <div className="detail-grid">
+          <section className="card" style={{ animationDelay: "0.05s" }}>
+            <div className="section-title">状态</div>
+            <div className="status-row">
+              <span className={`badge badge--${statusTone(caseData?.status)}`}>
+                {statusLabel(caseData?.status)}
+              </span>
+              <span className="stage">阶段：{stageLabel(caseData?.stage)}</span>
             </div>
-            <div className="runtime-row">
-              <span>主机端口</span>
-              <span>{runtime.host_port ?? "-"}</span>
+            <div className="meta">
+              <div>更新时间：{formatTime(caseData?.updated_at)}</div>
+              <div>创建时间：{formatTime(caseData?.created_at)}</div>
+              <div>提交：{caseData?.commit_sha || "-"}</div>
             </div>
-            <div className="runtime-row">
-              <span>容器 ID</span>
-              <span className="mono">{runtime.container_id ?? "-"}</span>
+          </section>
+          <section className="card" style={{ animationDelay: "0.12s" }}>
+            <div className="section-title">运行信息</div>
+            <div className="runtime">
+              <div className="runtime-row">
+                <span>访问地址</span>
+                {runtime.access_url ? (
+                  <div className="runtime-actions">
+                    <a href={runtime.access_url} target="_blank" rel="noreferrer">
+                      {runtime.access_url}
+                    </a>
+                    <CopyButton value={runtime.access_url} />
+                  </div>
+                ) : (
+                  <span>-</span>
+                )}
+              </div>
+              <div className="runtime-row">
+                <span>主机端口</span>
+                <span>{runtime.host_port ?? "-"}</span>
+              </div>
+              <div className="runtime-row">
+                <span>容器 ID</span>
+                <span className="mono">{runtime.container_id ?? "-"}</span>
+              </div>
             </div>
-          </div>
-        </section>
-        <section className="card" style={{ animationDelay: "0.18s" }}>
-          <div className="section-title">环境变量键</div>
-          {envKeys.length ? (
-            <div className="chips">
-              {envKeys.map((key) => (
-                <span key={key} className="chip">
-                  {key}
-                </span>
-              ))}
+          </section>
+          <section className="card" style={{ animationDelay: "0.18s" }}>
+            <div className="section-title">管理动作</div>
+            <div className="action-grid">
+              <button className="ghost" disabled={statusUpper !== "RUNNING"} onClick={() => runAction("stop")}>
+                停止
+              </button>
+              <button
+                className="ghost"
+                disabled={!(statusUpper === "STOPPED" || statusUpper === "FAILED")}
+                onClick={() => runAction("restart")}
+              >
+                重启
+              </button>
+              <button className="ghost" disabled={statusUpper !== "FAILED"} onClick={() => runAction("retry")}>
+                重试
+              </button>
+              <button className="ghost" onClick={() => runAction("archive")}>
+                归档
+              </button>
             </div>
-          ) : (
-            <div className="muted">暂无 env 键名。</div>
-          )}
-        </section>
-        {caseData?.status?.toUpperCase() === "FAILED" ? (
-          <section className="card error-card" style={{ animationDelay: "0.24s" }}>
-            <div className="section-title">错误</div>
-            <div className="error-code">{errorCode || "UNKNOWN"}</div>
-            <div className="error-message">{errorMessage || "未知错误。"}</div>
-            <div className="error-hint">
-              {ERROR_EXPLAIN[errorCode || ""] || "请查看日志详情。"}
+          </section>
+          <section className="card" style={{ animationDelay: "0.2s" }}>
+            <div className="section-title">环境变量键</div>
+            {envKeys.length ? (
+              <div className="chips">
+                {envKeys.map((key) => (
+                  <span key={key} className="chip">
+                    {key}
+                  </span>
+                ))}
+              </div>
+            ) : (
+              <div className="muted">暂无 env 键名。</div>
+            )}
+          </section>
+          {caseData?.status?.toUpperCase() === "FAILED" ? (
+            <section className="card error-card" style={{ animationDelay: "0.24s" }}>
+              <div className="section-title">错误</div>
+              <div className="error-code">{errorCode || "UNKNOWN"}</div>
+              <div className="error-message">{errorMessage || "未知错误。"}</div>
+              <div className="error-hint">{errorHint || "请查看日志详情。"}</div>
+            </section>
+          ) : null}
+          <section className="card" style={{ animationDelay: "0.28s" }}>
+            <div className="section-title">说明书状态</div>
+            <div className="meta">
+              <div>状态：{manualStatusLabel(caseData?.manual_status)}</div>
+              <div>生成时间：{formatTime(caseData?.manual_generated_at)}</div>
             </div>
           </section>
-        ) : null}
+        </div>
+      ) : null}
+
+      {activeTab === "logs" ? (
         <section className="card logs" style={{ animationDelay: "0.3s" }}>
-          <LogPanel caseId={caseId} />
+          <LogPanel caseId={caseId} onCopyLogs={copyLogs} onDownloadLogs={downloadLogs} />
         </section>
+      ) : null}
+
+      {activeTab === "manual" ? (
+        <ManualPanel
+          caseId={caseId}
+          manualStatus={caseData?.manual_status}
+          manualGeneratedAt={caseData?.manual_generated_at}
+          manualErrorCode={caseData?.manual_error_code}
+          manualErrorMessage={caseData?.manual_error_message}
+          errorCodes={errorCodes}
+          pushToast={pushToast}
+        />
+      ) : null}
+    </div>
+  );
+}
+
+function ManualPanel({
+  caseId,
+  manualStatus,
+  manualGeneratedAt,
+  manualErrorCode,
+  manualErrorMessage,
+  errorCodes,
+  pushToast,
+}: {
+  caseId: string;
+  manualStatus?: string | null;
+  manualGeneratedAt?: number | null;
+  manualErrorCode?: string | null;
+  manualErrorMessage?: string | null;
+  errorCodes: ErrorCodeMap;
+  pushToast: (t: Toast) => void;
+}) {
+  const [status, setStatus] = useState<ManualStatusResponse | null>(null);
+  const [manual, setManual] = useState<ManualResponse | null>(null);
+  const [loading, setLoading] = useState(false);
+  const [polling, setPolling] = useState(false);
+
+  const fetchStatus = useCallback(async () => {
+    try {
+      const response = await fetch(joinUrl(API_BASE, `/cases/${caseId}/manual/status`));
+      if (!response.ok) {
+        throw new Error(`获取状态失败 (${response.status})`);
+      }
+      const data = (await response.json()) as ManualStatusResponse;
+      setStatus(data);
+      return data;
+    } catch (err) {
+      pushToast({ type: "error", message: "获取说明书状态失败", detail: String(err) });
+      return null;
+    }
+  }, [caseId, pushToast]);
+
+  const fetchManual = useCallback(async () => {
+    setLoading(true);
+    try {
+      const response = await fetch(joinUrl(API_BASE, `/cases/${caseId}/manual`));
+      if (!response.ok) {
+        throw new Error(`获取说明书失败 (${response.status})`);
+      }
+      const data = (await response.json()) as ManualResponse;
+      setManual(data);
+      return data;
+    } catch (err) {
+      pushToast({ type: "error", message: "获取说明书失败", detail: String(err) });
+      return null;
+    } finally {
+      setLoading(false);
+    }
+  }, [caseId, pushToast]);
+
+  const triggerManual = async () => {
+    if (!window.confirm("确认重新生成说明书？")) return;
+    try {
+      const response = await fetch(joinUrl(API_BASE, `/cases/${caseId}/manual`), {
+        method: "POST",
+      });
+      if (!response.ok) {
+        const text = await response.text();
+        throw new Error(text || `触发失败 (${response.status})`);
+      }
+      const data = (await response.json()) as ManualStatusResponse;
+      setStatus(data);
+      setManual(null);
+      pushToast({ type: "success", message: "已触发说明书生成" });
+      setPolling(true);
+    } catch (err) {
+      pushToast({ type: "error", message: "触发失败", detail: String(err) });
+    }
+  };
+
+  useEffect(() => {
+    fetchStatus().then((data) => {
+      if (data?.status === "SUCCESS") {
+        fetchManual();
+      } else if (data?.status === "PENDING" || data?.status === "RUNNING") {
+        setPolling(true);
+      }
+    });
+  }, [fetchStatus, fetchManual]);
+
+  useEffect(() => {
+    if (!polling) return undefined;
+    let timer: number | undefined;
+    let cancelled = false;
+    const poll = async () => {
+      if (cancelled) return;
+      const data = await fetchStatus();
+      if (data?.status === "SUCCESS") {
+        await fetchManual();
+        setPolling(false);
+        return;
+      }
+      if (data?.status === "FAILED") {
+        setPolling(false);
+        return;
+      }
+      timer = window.setTimeout(poll, 2000);
+    };
+    poll();
+    return () => {
+      cancelled = true;
+      if (timer) window.clearTimeout(timer);
+    };
+  }, [polling, fetchManual, fetchStatus]);
+
+  const displayStatus = (status?.status || manualStatus || "NOT_STARTED").toUpperCase();
+  const displayGeneratedAt = status?.generated_at || manualGeneratedAt || undefined;
+  const displayErrorCode = status?.error_code || manualErrorCode || undefined;
+  const displayErrorMessage = status?.error_message || manualErrorMessage || undefined;
+  const displayErrorHint = resolveErrorHint(displayErrorCode, errorCodes);
+
+  return (
+    <div className="manual">
+      <div className="manual-head card">
+        <div>
+          <div className="section-title">说明书</div>
+          <div className="manual-meta">
+            <span>状态：{manualStatusLabel(displayStatus)}</span>
+            <span>生成时间：{formatTime(displayGeneratedAt)}</span>
+          </div>
+        </div>
+        <div className="manual-actions">
+          <button
+            className="ghost"
+            onClick={triggerManual}
+            disabled={displayStatus === "RUNNING" || displayStatus === "PENDING"}
+          >
+            重新生成
+          </button>
+        </div>
       </div>
+
+      {displayStatus === "FAILED" ? (
+        <div className="card error-card">
+          <div className="section-title">生成失败</div>
+          <div className="error-code">{displayErrorCode || "MANUAL_FAILED"}</div>
+          <div className="error-message">{displayErrorMessage || "请稍后重试。"}</div>
+          <div className="error-hint">{displayErrorHint || "请检查仓库文件与权限。"}</div>
+        </div>
+      ) : null}
+
+      {loading ? <div className="card">说明书加载中...</div> : null}
+
+      {manual ? (
+        <div className="card manual-body">
+          <ManualSummary meta={manual.meta} />
+          <MarkdownRenderer markdown={manual.manual_markdown} />
+        </div>
+      ) : displayStatus === "PENDING" || displayStatus === "RUNNING" ? (
+        <div className="card empty-state">说明书生成中，请稍候刷新。</div>
+      ) : displayStatus === "NOT_STARTED" ? (
+        <div className="card empty-state">暂无说明书，请点击“重新生成”。</div>
+      ) : null}
+    </div>
+  );
+}
+
+function ManualSummary({ meta }: { meta: ManualMeta }) {
+  return (
+    <div className="manual-summary">
+      <div>generator_version: {meta.generator_version}</div>
+      <div>generated_at: {formatTime(meta.generated_at)}</div>
+      <div>time_cost_ms: {meta.time_cost_ms}</div>
+      <div>signals: {JSON.stringify(meta.signals)}</div>
     </div>
   );
 }
 
+function MarkdownRenderer({ markdown }: { markdown: string }) {
+  const containerRef = useRef<HTMLDivElement | null>(null);
+  const html = useMemo(() => marked.parse(markdown, { breaks: true }), [markdown]);
+
+  useEffect(() => {
+    if (!containerRef.current) return;
+    const container = containerRef.current;
+    const blocks = container.querySelectorAll("pre code.language-mermaid, pre code.lang-mermaid, pre code.mermaid");
+    blocks.forEach((block) => {
+      const parent = block.parentElement;
+      if (!parent) return;
+      const wrapper = document.createElement("div");
+      wrapper.className = "mermaid";
+      wrapper.textContent = block.textContent || "";
+      parent.replaceWith(wrapper);
+    });
+    mermaid.run({ nodes: container.querySelectorAll(".mermaid") });
+  }, [html]);
+
+  return <div className="markdown" ref={containerRef} dangerouslySetInnerHTML={{ __html: html }} />;
+}
+
 function CopyButton({ value }: { value: string }) {
   const [copied, setCopied] = useState(false);
 
@@ -573,7 +1404,15 @@
   );
 }
 
-function LogPanel({ caseId }: { caseId: string }) {
+function LogPanel({
+  caseId,
+  onCopyLogs,
+  onDownloadLogs,
+}: {
+  caseId: string;
+  onCopyLogs: () => void;
+  onDownloadLogs: () => void;
+}) {
   const [logs, setLogs] = useState<LogEntry[]>([]);
   const [autoScroll, setAutoScroll] = useState(true);
   const [status, setStatus] = useState<"connecting" | "open" | "closed" | "error">(
@@ -585,21 +1424,56 @@
     analyze: true,
     system: true,
   });
+  const [keyword, setKeyword] = useState("");
+  const [reconnectIn, setReconnectIn] = useState<number | null>(null);
   const wsRef = useRef<WebSocket | null>(null);
   const bottomRef = useRef<HTMLDivElement | null>(null);
+  const reconnectAttempt = useRef(0);
+  const reconnectTimer = useRef<number | null>(null);
+  const connectRef = useRef<() => void>(() => {});
 
   const wsUrl = joinUrl(toWsUrl(API_BASE), `/ws/logs/${caseId}`);
 
+  const clearReconnect = () => {
+    if (reconnectTimer.current) {
+      window.clearTimeout(reconnectTimer.current);
+      reconnectTimer.current = null;
+    }
+    setReconnectIn(null);
+  };
+
+  const scheduleReconnect = useCallback(() => {
+    if (reconnectTimer.current) return;
+    reconnectAttempt.current += 1;
+    const delay = Math.min(30000, 1000 * 2 ** (reconnectAttempt.current - 1));
+    setReconnectIn(delay);
+    reconnectTimer.current = window.setTimeout(() => {
+      reconnectTimer.current = null;
+      connectRef.current();
+    }, delay);
+  }, []);
+
   const connect = useCallback(() => {
     if (wsRef.current) {
       wsRef.current.close();
     }
+    clearReconnect();
     setStatus("connecting");
     const ws = new WebSocket(wsUrl);
     wsRef.current = ws;
-    ws.onopen = () => setStatus("open");
-    ws.onclose = () => setStatus("closed");
-    ws.onerror = () => setStatus("error");
+    ws.onopen = () => {
+      reconnectAttempt.current = 0;
+      setStatus("open");
+      setReconnectIn(null);
+    };
+    ws.onclose = () => {
+      setStatus("closed");
+      scheduleReconnect();
+    };
+    ws.onerror = () => {
+      setStatus("error");
+      scheduleReconnect();
+    };
     ws.onmessage = (event) => {
       let parsed: LogEntry = {
         ts: Date.now() / 1000,
@@ -631,12 +1505,17 @@
         return next;
       });
     };
-  }, [wsUrl]);
+  }, [wsUrl, scheduleReconnect]);
+
+  useEffect(() => {
+    connectRef.current = connect;
+  }, [connect]);
 
   useEffect(() => {
     setLogs([]);
     connect();
     return () => {
+      clearReconnect();
       if (wsRef.current) {
         wsRef.current.close();
       }
@@ -651,12 +1530,20 @@
   }, [logs, autoScroll]);
 
   const visibleLogs = useMemo(() => {
+    const needle = keyword.trim().toLowerCase();
     return logs.filter((entry) => {
       const key = entry.stream as keyof typeof filters;
-      if (filters[key] === undefined) return true;
-      return filters[key];
+      if (filters[key] === false) return false;
+      if (needle && !entry.line.toLowerCase().includes(needle)) return false;
+      return true;
     });
-  }, [logs, filters]);
+  }, [logs, filters, keyword]);
+
+  const jumpToLatest = () => {
+    if (bottomRef.current) {
+      bottomRef.current.scrollIntoView({ behavior: "smooth" });
+    }
+  };
 
   return (
     <div className="logs-panel">
@@ -665,18 +1552,36 @@
           <div className="section-title">日志</div>
           <div className={`ws-status ws-${status}`}>
             {status === "open" ? "已连接" : status === "connecting" ? "连接中" : "已断开"}
+            {reconnectIn ? ` · ${Math.ceil(reconnectIn / 1000)}s 后重连` : ""}
           </div>
         </div>
         <div className="logs-actions">
+          <button className="ghost" type="button" onClick={onCopyLogs}>
+            复制 JSONL
+          </button>
+          <button className="ghost" type="button" onClick={onDownloadLogs}>
+            下载 1000 行
+          </button>
           <button className="ghost" type="button" onClick={() => setAutoScroll((value) => !value)}>
             {autoScroll ? "暂停滚动" : "自动滚动"}
           </button>
+          <button className="ghost" type="button" onClick={jumpToLatest}>
+            跳到最新
+          </button>
           <button className="ghost" type="button" onClick={connect}>
             重连
           </button>
         </div>
       </div>
       <div className="filters">
+        <div className="filter search">
+          <input
+            type="text"
+            placeholder="搜索关键词"
+            value={keyword}
+            onChange={(event) => setKeyword(event.target.value)}
+          />
+        </div>
         {(
           [
             { id: "build", label: "构建" },
diff -ruN '--exclude=.devlogs' '--exclude=venv' '--exclude=node_modules' '--exclude=__pycache__' /tmp/AntiHub.phase3.base/frontend/src/styles.css /home/user2643/code/AntiHub/frontend/src/styles.css
--- /tmp/AntiHub.phase3.base/frontend/src/styles.css	2026-01-22 21:52:23.262380687 +0800
+++ /home/user2643/code/AntiHub/frontend/src/styles.css	2026-01-22 23:29:23.402663450 +0800
@@ -179,6 +179,14 @@
   font-size: 15px;
 }
 
+.field select {
+  padding: 12px 14px;
+  border-radius: 12px;
+  border: 1px solid var(--border);
+  font-size: 15px;
+  background: white;
+}
+
 .field-row {
   display: grid;
   grid-template-columns: 1fr auto;
@@ -300,6 +308,128 @@
   font-size: 14px;
 }
 
+.dashboard {
+  display: flex;
+  flex-direction: column;
+  gap: 20px;
+}
+
+.dashboard-head {
+  display: flex;
+  justify-content: space-between;
+  align-items: center;
+  gap: 16px;
+}
+
+.dashboard-actions {
+  display: flex;
+  gap: 12px;
+}
+
+.stats {
+  display: grid;
+  grid-template-columns: repeat(3, 1fr);
+  gap: 16px;
+}
+
+.stat-card {
+  display: flex;
+  flex-direction: column;
+  gap: 6px;
+}
+
+.stat-title {
+  color: var(--muted);
+  font-size: 13px;
+}
+
+.stat-value {
+  font-size: 24px;
+  font-weight: 700;
+}
+
+.filters-panel {
+  display: grid;
+  grid-template-columns: repeat(5, minmax(0, 1fr));
+  gap: 12px;
+  align-items: end;
+}
+
+.filters-panel select,
+.filters-panel input {
+  padding: 10px 12px;
+  border-radius: 12px;
+  border: 1px solid var(--border);
+}
+
+.table-card {
+  padding: 0;
+  overflow: hidden;
+}
+
+.table {
+  display: grid;
+}
+
+.table-header,
+.table-row {
+  display: grid;
+  grid-template-columns: 1.1fr 2fr 1.6fr 1.2fr 1.6fr 1.2fr 1.1fr 1.6fr;
+  gap: 12px;
+  padding: 16px 20px;
+  align-items: center;
+}
+
+.table-header {
+  font-size: 13px;
+  font-weight: 600;
+  color: var(--muted);
+  text-transform: uppercase;
+  letter-spacing: 0.5px;
+  background: rgba(30, 111, 122, 0.06);
+}
+
+.table-row {
+  border-top: 1px solid var(--border);
+  font-size: 14px;
+}
+
+.table-row a {
+  color: var(--accent-strong);
+  text-decoration: none;
+}
+
+.table-repo {
+  display: flex;
+  flex-direction: column;
+  gap: 4px;
+}
+
+.table-actions {
+  display: flex;
+  gap: 8px;
+  flex-wrap: wrap;
+}
+
+.table-empty {
+  padding: 24px;
+  color: var(--muted);
+}
+
+.pagination {
+  display: flex;
+  justify-content: space-between;
+  align-items: center;
+  padding: 16px 20px;
+  border-top: 1px solid var(--border);
+}
+
+.action-grid {
+  display: grid;
+  grid-template-columns: repeat(2, minmax(0, 1fr));
+  gap: 10px;
+}
+
 .detail {
   display: flex;
   flex-direction: column;
@@ -569,11 +699,182 @@
   color: var(--accent-strong);
 }
 
+.toast-banner {
+  display: flex;
+  justify-content: space-between;
+  align-items: flex-start;
+  gap: 16px;
+  padding: 16px;
+  border-radius: 16px;
+  margin-bottom: 16px;
+}
+
+.toast-success {
+  background: rgba(30, 111, 122, 0.12);
+  border: 1px solid rgba(30, 111, 122, 0.3);
+  color: var(--accent-strong);
+}
+
+.toast-error {
+  background: rgba(186, 53, 36, 0.12);
+  border: 1px solid rgba(186, 53, 36, 0.3);
+  color: #8d1f12;
+}
+
+.toast-title {
+  font-weight: 600;
+}
+
+.toast-code {
+  font-size: 12px;
+  color: var(--muted);
+  margin-top: 4px;
+}
+
+.toast-detail {
+  margin-top: 8px;
+  background: transparent;
+  border: none;
+  color: inherit;
+  text-decoration: underline;
+  cursor: pointer;
+}
+
+.toast-body {
+  margin-top: 8px;
+  font-size: 13px;
+  color: inherit;
+  white-space: pre-wrap;
+}
+
+.tabs {
+  display: flex;
+  gap: 12px;
+  margin: 12px 0 20px;
+}
+
+.tab {
+  border: 1px solid var(--border);
+  background: transparent;
+  padding: 8px 16px;
+  border-radius: 999px;
+  color: var(--muted);
+}
+
+.tab.active {
+  background: var(--accent);
+  color: white;
+  border-color: transparent;
+}
+
+.manual {
+  display: flex;
+  flex-direction: column;
+  gap: 16px;
+}
+
+.manual-head {
+  display: flex;
+  justify-content: space-between;
+  align-items: center;
+}
+
+.manual-meta {
+  display: flex;
+  gap: 16px;
+  color: var(--muted);
+  font-size: 13px;
+}
+
+.manual-body {
+  display: flex;
+  flex-direction: column;
+  gap: 16px;
+}
+
+.manual-summary {
+  font-size: 12px;
+  color: var(--muted);
+  display: grid;
+  gap: 4px;
+}
+
+.empty-state {
+  text-align: center;
+  color: var(--muted);
+}
+
+.markdown {
+  line-height: 1.6;
+}
+
+.markdown h1,
+.markdown h2,
+.markdown h3 {
+  margin-top: 16px;
+}
+
+.markdown pre {
+  background: #1d1914;
+  color: #f5efe6;
+  padding: 12px;
+  border-radius: 12px;
+  overflow-x: auto;
+}
+
+.markdown code {
+  font-family: "IBM Plex Mono", "Courier New", monospace;
+}
+
+.markdown table {
+  width: 100%;
+  border-collapse: collapse;
+  margin: 12px 0;
+}
+
+.markdown th,
+.markdown td {
+  border: 1px solid var(--border);
+  padding: 6px 8px;
+  text-align: left;
+  font-size: 13px;
+}
+
+.manual-status {
+  display: flex;
+  flex-direction: column;
+  gap: 4px;
+}
+
+.mermaid {
+  background: white;
+  border: 1px solid var(--border);
+  border-radius: 12px;
+  padding: 12px;
+  overflow-x: auto;
+}
+
+.filters .search input {
+  padding: 8px 12px;
+  border-radius: 12px;
+  border: 1px solid var(--border);
+  background: rgba(255, 255, 255, 0.7);
+  color: var(--ink);
+}
+
 @media (max-width: 980px) {
   .create-grid {
     grid-template-columns: 1fr;
   }
 
+  .stats {
+    grid-template-columns: 1fr;
+  }
+
+  .filters-panel {
+    grid-template-columns: 1fr;
+  }
+
   .detail-grid {
     grid-template-columns: 1fr;
   }
@@ -597,4 +898,19 @@
   .log-line {
     grid-template-columns: 1fr;
   }
+
+  .table-header,
+  .table-row {
+    grid-template-columns: 1fr;
+    gap: 6px;
+  }
+
+  .pagination {
+    flex-direction: column;
+    gap: 12px;
+  }
+
+  .tabs {
+    flex-wrap: wrap;
+  }
 }
diff -ruN '--exclude=.devlogs' '--exclude=venv' '--exclude=node_modules' '--exclude=__pycache__' /tmp/AntiHub.phase3.base/main.py /home/user2643/code/AntiHub/main.py
--- /tmp/AntiHub.phase3.base/main.py	2026-01-22 21:52:23.262380687 +0800
+++ /home/user2643/code/AntiHub/main.py	2026-01-22 23:49:01.285958861 +0800
@@ -1,18 +1,49 @@
 from __future__ import annotations
 
+import json
 import time
 import uuid
 from typing import Any, Dict, List, Optional
 
-from fastapi import FastAPI, HTTPException, WebSocket, WebSocketDisconnect
+import docker
+from fastapi import Body, FastAPI, HTTPException, Query, WebSocket, WebSocketDisconnect
 from fastapi.middleware.cors import CORSMiddleware
+from fastapi.responses import PlainTextResponse, StreamingResponse
 from pydantic import BaseModel, ConfigDict, Field
 
-from config import CORS_ORIGINS, DEFAULT_BRANCH
-from storage import decode_log_entry, get_async_redis_client, get_case, get_logs, log_channel, set_case
-from worker import analyze_case, build_and_run
+from config import (
+    AUTO_MANUAL,
+    CASE_LABEL_KEY,
+    CASE_LABEL_MANAGED,
+    CASE_TEMPLATES,
+    CORS_ORIGINS,
+    DEFAULT_BRANCH,
+    PORT_MODE,
+    PUBLIC_HOST,
+    STARTUP_TIMEOUT_SECONDS,
+)
+from docker_ops import wait_for_container_running
+from errors import ERROR_CODE_MAP
+from storage import (
+    append_log,
+    decode_log_entry,
+    get_async_redis_client,
+    get_manual,
+    get_manual_stats,
+    get_manual_status,
+    get_redis_client,
+    get_case,
+    get_logs,
+    get_logs_slice,
+    list_case_ids,
+    log_channel,
+    set_manual_status,
+    set_case,
+    update_case,
+)
+from worker import BuildError, analyze_case, build_and_run, generate_manual_task, release_port, reserve_specific_port
 
-app = FastAPI(title="Agent Platform", version="0.2.0")
+app = FastAPI(title="Agent Platform", version="0.4.0")
 app.add_middleware(
     CORSMiddleware,
     allow_origins=CORS_ORIGINS,
@@ -28,9 +59,11 @@
     "BUILDING": "build",
     "STARTING": "run",
     "RUNNING": "run",
+    "STOPPED": "run",
     "FINISHED": "run",
     "FAILED": "system",
     "ANALYZING": "analyze",
+    "ARCHIVED": "system",
 }
 
 
@@ -61,6 +94,21 @@
     model_config = ConfigDict(extra="ignore")
 
 
+class CaseActionRequest(BaseModel):
+    action: str = Field(..., description="stop | restart | retry | archive")
+    env: Dict[str, str] = Field(
+        default_factory=dict,
+        description="Optional env override for retry (values are not stored).",
+    )
+
+
+class CaseRetryRequest(BaseModel):
+    env: Dict[str, str] = Field(
+        default_factory=dict,
+        description="Optional env override for retry (values are not stored).",
+    )
+
+
 class RuntimeInfo(BaseModel):
     container_id: Optional[str] = None
     host_port: Optional[int] = None
@@ -81,6 +129,10 @@
     error_message: Optional[str] = None
     created_at: Optional[float] = None
     updated_at: Optional[float] = None
+    archived: bool = False
+    archived_at: Optional[float] = None
+    attempt: Optional[int] = None
+    retry_of: Optional[str] = None
     repo_url: Optional[str] = None
     ref: Optional[str] = None
     branch: Optional[str] = None
@@ -91,6 +143,56 @@
     image_tag: Optional[str] = None
     last_log_at: Optional[float] = None
     report_ready: bool = False
+    manual_status: Optional[str] = None
+    manual_generated_at: Optional[float] = None
+    manual_error_code: Optional[str] = None
+    manual_error_message: Optional[str] = None
+
+
+class CaseListResponse(BaseModel):
+    items: List[CaseResponse]
+    total: int
+    page: int
+    size: int
+
+
+class CaseActionResponse(BaseModel):
+    case_id: str
+    action: str
+    status: str
+    message: str
+
+
+class ManualMeta(BaseModel):
+    generated_at: float
+    generator_version: str
+    signals: Dict[str, Any]
+    time_cost_ms: int
+
+
+class ManualResponse(BaseModel):
+    case_id: str
+    manual_markdown: str
+    meta: ManualMeta
+
+
+class ManualStatusResponse(BaseModel):
+    case_id: str
+    status: str
+    generated_at: Optional[float] = None
+    error_code: Optional[str] = None
+    error_message: Optional[str] = None
+
+
+class CaseTemplate(BaseModel):
+    name: str
+    repo_url: Optional[str] = None
+    git_url: Optional[str] = None
+    ref: Optional[str] = None
+    default_env_keys: List[str] = Field(default_factory=list)
+    build_mode: Optional[str] = None
+    port_mode: Optional[str] = None
+    timeouts: Dict[str, int] = Field(default_factory=dict)
 
 
 def normalize_stage(raw_stage: Optional[str], status: Optional[str]) -> str:
@@ -142,6 +244,10 @@
         error_message=error_message,
         created_at=data.get("created_at"),
         updated_at=data.get("updated_at"),
+        archived=bool(data.get("archived", False)),
+        archived_at=data.get("archived_at"),
+        attempt=data.get("attempt"),
+        retry_of=data.get("retry_of"),
         repo_url=data.get("repo_url"),
         ref=ref_value,
         branch=branch_value,
@@ -152,12 +258,136 @@
         image_tag=data.get("image_tag"),
         last_log_at=data.get("last_log_at"),
         report_ready=bool(data.get("report_ready", False)),
+        manual_status=data.get("manual_status"),
+        manual_generated_at=data.get("manual_generated_at"),
+        manual_error_code=data.get("manual_error_code"),
+        manual_error_message=data.get("manual_error_message"),
     )
 
 
+def matches_query(case_id: str, data: Dict[str, Any], query: str) -> bool:
+    q = query.lower().strip()
+    if not q:
+        return True
+    haystacks = [
+        case_id,
+        str(data.get("repo_url") or ""),
+        str(data.get("ref") or data.get("branch") or ""),
+    ]
+    return any(q in (value or "").lower() for value in haystacks)
+
+
+def get_case_or_404(case_id: str) -> Dict[str, Any]:
+    data = get_case(case_id) or {}
+    if not data:
+        raise HTTPException(status_code=404, detail="Case not found")
+    return data
+
+
+def get_managed_container(case_id: str, container_id: str) -> docker.models.containers.Container:
+    client = docker.from_env()
+    container = client.containers.get(container_id)
+    labels = container.labels or {}
+    if labels.get(CASE_LABEL_KEY) != case_id or labels.get(CASE_LABEL_MANAGED) != "true":
+        raise HTTPException(status_code=400, detail="Container is not managed by AntiHub")
+    return container
+
+
+def append_system_log(case_id: str, line: str, level: str = "INFO") -> None:
+    append_log(case_id, {"ts": time.time(), "stream": "system", "level": level, "line": line})
+
+
+def build_jsonl(entries: List[Dict[str, Any]]) -> str:
+    return "\n".join(json.dumps(entry, ensure_ascii=False) for entry in entries) + ("\n" if entries else "")
+
+
+def resolve_host_port(container: docker.models.containers.Container, container_port: Optional[int]) -> Optional[int]:
+    ports = container.attrs.get("NetworkSettings", {}).get("Ports", {}) or {}
+    if container_port:
+        binding = ports.get(f"{container_port}/tcp")
+        if binding:
+            return int(binding[0]["HostPort"])
+    for binding in ports.values():
+        if binding:
+            return int(binding[0]["HostPort"])
+    return None
+
+
 @app.get("/healthz")
 async def healthz() -> dict:
-    return {"status": "ok"}
+    health = {"status": "ok", "api": "ok", "redis": "ok", "docker": "ok", "details": {}}
+    try:
+        client = get_redis_client()
+        client.ping()
+    except Exception as exc:  # noqa: BLE001
+        health["redis"] = "error"
+        health["details"]["redis"] = str(exc)
+        health["status"] = "degraded"
+    try:
+        docker.from_env().ping()
+    except Exception as exc:  # noqa: BLE001
+        health["docker"] = "error"
+        health["details"]["docker"] = str(exc)
+        health["status"] = "degraded"
+    return health
+
+
+@app.get("/error-codes")
+async def error_codes() -> Dict[str, Dict[str, str]]:
+    return ERROR_CODE_MAP
+
+
+@app.get("/stats")
+async def stats() -> Dict[str, Any]:
+    return {"manual": get_manual_stats()}
+
+
+@app.get("/case-templates", response_model=List[CaseTemplate])
+async def case_templates() -> List[CaseTemplate]:
+    templates: List[CaseTemplate] = []
+    raw_templates = CASE_TEMPLATES if isinstance(CASE_TEMPLATES, list) else []
+    for item in raw_templates:
+        if not isinstance(item, dict):
+            continue
+        payload = dict(item)
+        env_keys = payload.get("default_env_keys") or []
+        if not isinstance(env_keys, list):
+            env_keys = []
+        payload["default_env_keys"] = [str(key) for key in env_keys]
+        templates.append(CaseTemplate(**payload))
+    return templates
+
+
+@app.get("/cases", response_model=CaseListResponse)
+async def list_cases(
+    q: Optional[str] = Query(None, description="Search by case_id/repo/ref"),
+    status: Optional[str] = Query(None, description="Filter by status"),
+    stage: Optional[str] = Query(None, description="Filter by stage"),
+    page: int = Query(1, ge=1, description="Page number"),
+    size: int = Query(20, ge=1, le=200, description="Page size"),
+    include_archived: bool = Query(False, description="Include archived cases"),
+) -> CaseListResponse:
+    ids = list_case_ids()
+    items: List[CaseResponse] = []
+    for case_id in ids:
+        data = get_case(case_id) or {}
+        if not data:
+            continue
+        if not include_archived and bool(data.get("archived", False)):
+            continue
+        if status and (data.get("status") or "").upper() != status.upper():
+            continue
+        normalized_stage = normalize_stage(data.get("stage"), data.get("status"))
+        if stage and normalized_stage != stage.lower():
+            continue
+        if q and not matches_query(case_id, data, q):
+            continue
+        items.append(build_case_response(case_id, data))
+    items.sort(key=lambda item: item.updated_at or item.created_at or 0, reverse=True)
+    total = len(items)
+    start = (page - 1) * size
+    end = start + size
+    return CaseListResponse(items=items[start:end], total=total, page=page, size=size)
 
 
 @app.post("/cases", response_model=CaseResponse)
@@ -181,6 +411,14 @@
         "report_ready": False,
         "created_at": now,
         "updated_at": now,
+        "archived": False,
+        "archived_at": None,
+        "attempt": 1,
+        "retry_of": None,
+        "manual_status": "NOT_STARTED",
+        "manual_generated_at": None,
+        "manual_error_code": None,
+        "manual_error_message": None,
         "runtime": {
             "container_id": None,
             "host_port": None,
@@ -199,18 +437,160 @@
         payload.env,
         payload.auto_analyze,
     )
+    if AUTO_MANUAL:
+        update_case(case_id, {"manual_status": "PENDING"})
+        data["manual_status"] = "PENDING"
+        generate_manual_task.delay(case_id)
     return build_case_response(case_id, data)
 
 
 @app.get("/cases/{case_id}", response_model=CaseResponse)
 async def get_case_status(case_id: str) -> CaseResponse:
-    data = get_case(case_id) or {}
-    if not data:
-        raise HTTPException(status_code=404, detail="Case not found")
+    data = get_case_or_404(case_id)
     data.pop("case_id", None)
     return build_case_response(case_id, data)
 
 
+def handle_case_action(case_id: str, action: str, env: Optional[Dict[str, str]] = None) -> CaseActionResponse:
+    data = get_case_or_404(case_id)
+    action_key = action.lower()
+    runtime = data.get("runtime") or {}
+    container_id = data.get("container_id") or runtime.get("container_id")
+    host_port = data.get("host_port") or runtime.get("host_port")
+
+    if action_key == "stop":
+        if not container_id:
+            raise HTTPException(status_code=400, detail="No running container for case")
+        container = get_managed_container(case_id, container_id)
+        try:
+            container.stop(timeout=10)
+        except Exception:
+            container.kill()
+        container.reload()
+        exit_code = container.attrs.get("State", {}).get("ExitCode")
+        update_case(
+            case_id,
+            {
+                "status": "STOPPED",
+                "stage": "run",
+                "error_code": "STOPPED_BY_USER",
+                "error_message": "Stopped by user",
+                "runtime": {
+                    **runtime,
+                    "exited_at": time.time(),
+                    "exit_code": exit_code,
+                },
+            },
+        )
+        append_system_log(case_id, "Container stopped by user")
+        if PORT_MODE != "dynamic":
+            release_port(host_port)
+        return CaseActionResponse(case_id=case_id, action=action_key, status="STOPPED", message="Stopped")
+
+    if action_key == "restart":
+        if not container_id:
+            raise HTTPException(status_code=400, detail="No existing container to restart")
+        container = get_managed_container(case_id, container_id)
+        if PORT_MODE != "dynamic" and host_port:
+            try:
+                reserve_specific_port(case_id, int(host_port))
+            except BuildError as exc:
+                raise HTTPException(status_code=409, detail=f"{exc.code}: {exc}") from exc
+        container.start()
+        wait_for_container_running(docker.from_env(), container_id, STARTUP_TIMEOUT_SECONDS)
+        container.reload()
+        container_port = data.get("container_port")
+        host_port = host_port or resolve_host_port(container, container_port)
+        access_url = data.get("access_url") or runtime.get("access_url")
+        if host_port and not access_url:
+            access_url = f"http://{PUBLIC_HOST}:{host_port}"
+        update_case(
+            case_id,
+            {
+                "status": "RUNNING",
+                "stage": "run",
+                "error_code": None,
+                "error_message": None,
+                "container_id": container_id,
+                "host_port": host_port,
+                "access_url": access_url,
+                "runtime": {
+                    **runtime,
+                    "container_id": container_id,
+                    "host_port": host_port,
+                    "access_url": access_url,
+                    "started_at": time.time(),
+                    "exited_at": None,
+                    "exit_code": None,
+                },
+            },
+        )
+        append_system_log(case_id, "Container restarted")
+        return CaseActionResponse(case_id=case_id, action=action_key, status="RUNNING", message="Restarted")
+
+    if action_key == "retry":
+        repo_url = data.get("repo_url")
+        if not repo_url:
+            raise HTTPException(status_code=400, detail="Missing repo_url for retry")
+        ref = data.get("ref") or data.get("branch") or DEFAULT_BRANCH
+        container_port = data.get("container_port")
+        retry_env = env or {}
+        env_keys = sorted(retry_env.keys()) if retry_env else sorted(data.get("env_keys") or [])
+        attempt = int(data.get("attempt") or 1) + 1
+        retry_of = data.get("retry_of") or case_id
+        update_case(
+            case_id,
+            {
+                "status": "PENDING",
+                "stage": "system",
+                "error_code": None,
+                "error_message": None,
+                "env_keys": env_keys,
+                "attempt": attempt,
+                "retry_of": retry_of,
+            },
+        )
+        append_system_log(case_id, "Retry requested")
+        build_and_run.delay(case_id, repo_url, ref, container_port, retry_env, False)
+        return CaseActionResponse(case_id=case_id, action=action_key, status="PENDING", message="Retry started")
+
+    if action_key == "archive":
+        update_case(case_id, {"archived": True, "archived_at": time.time()})
+        append_system_log(case_id, "Case archived")
+        return CaseActionResponse(case_id=case_id, action=action_key, status="ARCHIVED", message="Archived")
+
+    raise HTTPException(status_code=400, detail="Unsupported action")
+
+
+@app.post("/cases/{case_id}/actions", response_model=CaseActionResponse)
+async def case_actions(case_id: str, payload: CaseActionRequest) -> CaseActionResponse:
+    return handle_case_action(case_id, payload.action, payload.env)
+
+
+@app.post("/cases/{case_id}/stop", response_model=CaseActionResponse)
+async def case_stop(case_id: str) -> CaseActionResponse:
+    return handle_case_action(case_id, "stop")
+
+
+@app.post("/cases/{case_id}/restart", response_model=CaseActionResponse)
+async def case_restart(case_id: str) -> CaseActionResponse:
+    return handle_case_action(case_id, "restart")
+
+
+@app.post("/cases/{case_id}/retry", response_model=CaseActionResponse)
+async def case_retry(
+    case_id: str,
+    payload: CaseRetryRequest = Body(default_factory=CaseRetryRequest),
+) -> CaseActionResponse:
+    env = payload.env
+    return handle_case_action(case_id, "retry", env)
+
+
+@app.post("/cases/{case_id}/archive", response_model=CaseActionResponse)
+async def case_archive(case_id: str) -> CaseActionResponse:
+    return handle_case_action(case_id, "archive")
+
+
 @app.post("/cases/{case_id}/analyze")
 async def trigger_analyze(case_id: str) -> Dict[str, str]:
     data = get_case(case_id)
@@ -228,6 +608,45 @@
     raise HTTPException(status_code=404, detail="Report not ready (stub)")
 
 
+@app.post("/cases/{case_id}/manual", response_model=ManualStatusResponse)
+async def trigger_manual(case_id: str) -> ManualStatusResponse:
+    get_case_or_404(case_id)
+    update_case(
+        case_id,
+        {
+            "manual_status": "PENDING",
+            "manual_error_code": None,
+            "manual_error_message": None,
+        },
+    )
+    set_manual_status(case_id, "PENDING")
+    generate_manual_task.delay(case_id)
+    return ManualStatusResponse(case_id=case_id, status="PENDING")
+
+
+@app.get("/cases/{case_id}/manual/status", response_model=ManualStatusResponse)
+async def manual_status(case_id: str) -> ManualStatusResponse:
+    data = get_case_or_404(case_id)
+    status_data = get_manual_status(case_id) or {}
+    status = status_data.get("status") or data.get("manual_status") or "NOT_STARTED"
+    return ManualStatusResponse(
+        case_id=case_id,
+        status=status,
+        generated_at=status_data.get("generated_at") or data.get("manual_generated_at"),
+        error_code=status_data.get("error_code") or data.get("manual_error_code"),
+        error_message=status_data.get("error_message") or data.get("manual_error_message"),
+    )
+
+
+@app.get("/cases/{case_id}/manual", response_model=ManualResponse)
+async def get_manual_content(case_id: str) -> ManualResponse:
+    get_case_or_404(case_id)
+    markdown, meta = get_manual(case_id)
+    if not markdown or not meta:
+        raise HTTPException(status_code=404, detail="Manual not found")
+    return ManualResponse(case_id=case_id, manual_markdown=markdown, meta=ManualMeta(**meta))
+
+
 @app.websocket("/cases/{case_id}/logs")
 @app.websocket("/ws/logs/{case_id}")
 async def case_logs(websocket: WebSocket, case_id: str) -> None:
@@ -254,5 +673,27 @@
 
 
 @app.get("/cases/{case_id}/logs")
-async def http_logs(case_id: str) -> List[Dict[str, Any]]:
-    return get_logs(case_id)
+async def http_logs(
+    case_id: str,
+    limit: int = Query(200, ge=1, le=2000, description="Number of lines from tail"),
+    offset: int = Query(0, ge=0, description="Offset from tail"),
+    format: Optional[str] = Query(None, description="json | jsonl"),
+) -> Any:
+    get_case_or_404(case_id)
+    entries = get_logs_slice(case_id, offset=offset, limit=limit)
+    if format == "jsonl":
+        return PlainTextResponse(build_jsonl(entries), media_type="application/jsonl")
+    return entries
+
+
+@app.get("/cases/{case_id}/logs/download")
+async def download_logs(
+    case_id: str,
+    limit: int = Query(1000, ge=1, le=2000, description="Number of lines from tail"),
+    offset: int = Query(0, ge=0, description="Offset from tail"),
+) -> StreamingResponse:
+    get_case_or_404(case_id)
+    entries = get_logs_slice(case_id, offset=offset, limit=limit)
+    payload = build_jsonl(entries).encode("utf-8")
+    headers = {"Content-Disposition": f"attachment; filename={case_id}.jsonl"}
+    return StreamingResponse(iter([payload]), media_type="application/jsonl", headers=headers)
diff -ruN '--exclude=.devlogs' '--exclude=venv' '--exclude=node_modules' '--exclude=__pycache__' /tmp/AntiHub.phase3.base/manual_generator.py /home/user2643/code/AntiHub/manual_generator.py
--- /tmp/AntiHub.phase3.base/manual_generator.py	1970-01-01 08:00:00.000000000 +0800
+++ /home/user2643/code/AntiHub/manual_generator.py	2026-01-22 22:46:46.722142245 +0800
@@ -0,0 +1,351 @@
+import json
+import os
+import re
+import time
+from pathlib import Path
+from typing import Any, Dict, List, Optional, Tuple
+
+from config import MANUAL_GENERATOR_VERSION, MANUAL_MAX_README_CHARS, MANUAL_TREE_DEPTH
+
+README_CANDIDATES = ["README.md", "README.MD", "README"]
+IGNORED_DIRS = {
+    ".git",
+    ".hg",
+    ".svn",
+    ".idea",
+    ".vscode",
+    "__pycache__",
+    "node_modules",
+    "venv",
+    ".venv",
+    "dist",
+    "build",
+    ".tox",
+}
+
+CONFIG_FILE_PATTERNS = {
+    ".env",
+    ".env.example",
+    "docker-compose.yml",
+    "docker-compose.yaml",
+    "pyproject.toml",
+    "package.json",
+    "requirements.txt",
+}
+CONFIG_SUFFIXES = (".yaml", ".yml", ".toml", ".json")
+
+
+def generate_manual(
+    repo_path: Path,
+    env_keys: List[str],
+    repo_name: Optional[str] = None,
+    tree_depth: Optional[int] = None,
+    readme_max_chars: Optional[int] = None,
+) -> Tuple[str, Dict[str, Any]]:
+    start = time.time()
+    repo_name = repo_name or repo_path.name
+    tree_depth = tree_depth if tree_depth is not None else MANUAL_TREE_DEPTH
+    readme_max_chars = readme_max_chars if readme_max_chars is not None else MANUAL_MAX_README_CHARS
+
+    readme_path, readme_text = _read_readme(repo_path, readme_max_chars)
+    dockerfile_path = repo_path / "Dockerfile"
+    has_dockerfile = dockerfile_path.exists()
+    docker_info = _parse_dockerfile(dockerfile_path) if has_dockerfile else {}
+    tree_output, file_count = _build_tree(repo_path, tree_depth)
+    config_files = _find_config_files(repo_path, tree_depth)
+
+    one_liner, features = _summarize_readme(readme_text, repo_name)
+    local_run = _infer_local_run(repo_path)
+    docker_run = _infer_docker_run(repo_name, docker_info)
+    port_hint = docker_info.get("expose") or "-"
+    env_keys = sorted({key for key in env_keys if key})
+
+    manual_markdown = _render_manual(
+        repo_name=repo_name,
+        one_liner=one_liner,
+        features=features,
+        local_run=local_run,
+        docker_run=docker_run,
+        env_keys=env_keys,
+        port_hint=port_hint,
+        config_files=config_files,
+        tree_output=tree_output,
+        docker_info=docker_info,
+        readme_path=readme_path,
+    )
+
+    time_cost_ms = int((time.time() - start) * 1000)
+    meta = {
+        "generated_at": time.time(),
+        "generator_version": MANUAL_GENERATOR_VERSION,
+        "signals": {
+            "has_readme": bool(readme_text),
+            "has_dockerfile": has_dockerfile,
+            "config_files": config_files,
+            "tree_depth": tree_depth,
+            "file_count": file_count,
+        },
+        "time_cost_ms": time_cost_ms,
+    }
+    manual_markdown = (
+        manual_markdown.replace("{generated_at}", str(meta["generated_at"]))
+        .replace("{generator_version}", str(meta["generator_version"]))
+        .replace("{signals}", json.dumps(meta["signals"], ensure_ascii=False))
+        .replace("{time_cost_ms}", str(meta["time_cost_ms"]))
+    )
+    return manual_markdown, meta
+
+
+def _read_readme(repo_path: Path, max_chars: int) -> Tuple[Optional[str], str]:
+    for name in README_CANDIDATES:
+        path = repo_path / name
+        if path.exists():
+            try:
+                text = path.read_text(encoding="utf-8", errors="replace")
+            except Exception:
+                text = ""
+            return str(path.name), text[:max_chars]
+    return None, ""
+
+
+def _summarize_readme(readme_text: str, repo_name: str) -> Tuple[str, List[str]]:
+    lines = [line.strip() for line in readme_text.splitlines() if line.strip()]
+    one_liner = ""
+    features: List[str] = []
+    if lines:
+        title = ""
+        for line in lines:
+            if line.startswith("#"):
+                title = line.lstrip("#").strip()
+                continue
+            one_liner = line
+            break
+        if not one_liner:
+            one_liner = title or f"{repo_name} 的服务示例。"
+        for line in lines:
+            if line.startswith(("- ", "* ")):
+                feature = line.lstrip("-* ").strip()
+                if feature and feature not in features:
+                    features.append(feature)
+            if line.startswith("## "):
+                heading = line[3:].strip()
+                if heading and heading not in features:
+                    features.append(heading)
+            if len(features) >= 5:
+                break
+    if not one_liner:
+        one_liner = f"{repo_name} 的部署与运行说明。"
+    if not features:
+        features = [
+            "一键部署与运行",
+            "结构化日志与状态可视化",
+            "可扩展的配置与环境变量",
+        ]
+    return one_liner, features
+
+
+def _infer_local_run(repo_path: Path) -> List[str]:
+    commands: List[str] = []
+    pkg_path = repo_path / "package.json"
+    if pkg_path.exists():
+        commands.append("依赖：Node.js 18+ / npm")
+        commands.append("npm install")
+        script = _resolve_node_script(pkg_path)
+        commands.append(script or "npm run dev")
+        return commands
+
+    if (repo_path / "requirements.txt").exists() or (repo_path / "pyproject.toml").exists():
+        commands.append("依赖：Python 3.9+")
+        if (repo_path / "requirements.txt").exists():
+            commands.append("pip install -r requirements.txt")
+        else:
+            commands.append("pip install -U pip && pip install -e .")
+        if (repo_path / "main.py").exists():
+            commands.append("python main.py")
+        else:
+            commands.append("python -m uvicorn main:app --host 0.0.0.0 --port 8000")
+        return commands
+
+    commands.append("依赖：按 README 指引准备")
+    commands.append("启动命令：请参考 README 或 Dockerfile")
+    return commands
+
+
+def _resolve_node_script(pkg_path: Path) -> Optional[str]:
+    try:
+        data = json.loads(pkg_path.read_text(encoding="utf-8", errors="replace"))
+    except Exception:
+        return None
+    scripts = data.get("scripts") if isinstance(data, dict) else {}
+    if isinstance(scripts, dict):
+        if "dev" in scripts:
+            return "npm run dev"
+        if "start" in scripts:
+            return "npm start"
+    return None
+
+
+def _infer_docker_run(repo_name: str, docker_info: Dict[str, Any]) -> List[str]:
+    expose = docker_info.get("expose") or "8080"
+    commands = [
+        f"docker build -t {repo_name.lower()}:local .",
+        f"docker run --rm -p 8080:{expose} {repo_name.lower()}:local",
+    ]
+    return commands
+
+
+def _parse_dockerfile(path: Path) -> Dict[str, Any]:
+    info: Dict[str, Any] = {"base": None, "expose": None, "cmd": None, "entrypoint": None}
+    if not path.exists():
+        return info
+    try:
+        contents = path.read_text(encoding="utf-8", errors="replace")
+    except Exception:
+        return info
+    for line in contents.splitlines():
+        line = line.strip()
+        if not line or line.startswith("#"):
+            continue
+        if line.upper().startswith("FROM "):
+            info["base"] = line.split(" ", 1)[1].strip()
+        if line.upper().startswith("EXPOSE "):
+            match = re.search(r"EXPOSE\s+(\d+)", line, re.IGNORECASE)
+            if match:
+                info["expose"] = match.group(1)
+        if line.upper().startswith("CMD "):
+            info["cmd"] = line
+        if line.upper().startswith("ENTRYPOINT "):
+            info["entrypoint"] = line
+    return info
+
+
+def _build_tree(repo_path: Path, depth: int) -> Tuple[str, int]:
+    lines: List[str] = []
+    file_count = 0
+
+    def walk(current: Path, prefix: str, current_depth: int) -> None:
+        nonlocal file_count
+        if current_depth > depth:
+            return
+        entries = [p for p in sorted(current.iterdir(), key=lambda p: (not p.is_dir(), p.name.lower()))]
+        entries = [p for p in entries if p.name not in IGNORED_DIRS]
+        for idx, entry in enumerate(entries):
+            connector = "└──" if idx == len(entries) - 1 else "├──"
+            name = f"{entry.name}/" if entry.is_dir() else entry.name
+            lines.append(f"{prefix}{connector} {name}")
+            if entry.is_dir():
+                next_prefix = prefix + ("    " if idx == len(entries) - 1 else "│   ")
+                walk(entry, next_prefix, current_depth + 1)
+            else:
+                file_count += 1
+
+    lines.append(f"{repo_path.name}/")
+    try:
+        walk(repo_path, "", 1)
+    except Exception:
+        lines.append("(目录解析失败)")
+
+    return "\n".join(lines), file_count
+
+
+def _find_config_files(repo_path: Path, depth: int) -> List[str]:
+    config_files: List[str] = []
+    for root, dirs, files in os.walk(repo_path):
+        rel = Path(root).relative_to(repo_path)
+        if any(part in IGNORED_DIRS for part in rel.parts):
+            dirs[:] = []
+            continue
+        if len(rel.parts) > depth:
+            dirs[:] = []
+            continue
+        for file in files:
+            name = file
+            lower = name.lower()
+            if lower in CONFIG_FILE_PATTERNS or lower.endswith(CONFIG_SUFFIXES):
+                path = str((Path(root) / file).relative_to(repo_path))
+                if path not in config_files:
+                    config_files.append(path)
+    return sorted(config_files)
+
+
+def _render_manual(
+    repo_name: str,
+    one_liner: str,
+    features: List[str],
+    local_run: List[str],
+    docker_run: List[str],
+    env_keys: List[str],
+    port_hint: str,
+    config_files: List[str],
+    tree_output: str,
+    docker_info: Dict[str, Any],
+    readme_path: Optional[str],
+) -> str:
+    feature_lines = "\n".join([f"- [ ] {item}" for item in features])
+    local_lines = "\n".join([f"- {item}" for item in local_run])
+    docker_lines = "\n".join([f"- {item}" for item in docker_run])
+    env_lines = "\n".join([f"  - {item}" for item in env_keys]) or "  - (无)"
+    config_lines = "\n".join([f"  - {item}" for item in config_files]) or "  - (无)"
+    docker_notes = []
+    if docker_info.get("base"):
+        docker_notes.append(f"Dockerfile 基础镜像：{docker_info['base']}")
+    if docker_info.get("cmd"):
+        docker_notes.append(f"Dockerfile CMD：{docker_info['cmd']}")
+    if docker_info.get("entrypoint"):
+        docker_notes.append(f"Dockerfile ENTRYPOINT：{docker_info['entrypoint']}")
+    docker_note_block = "\n".join(f"- {item}" for item in docker_notes) or "- (未解析到 Dockerfile 关键指令)"
+    readme_note = readme_path or "README 缺失"
+
+    return f"""# {repo_name} 说明书
+## 1. 一句话简介
+- {one_liner}
+
+## 2. 功能概览
+{feature_lines}
+
+## 3. 快速开始
+### 3.1 一键部署（本平台）
+- 创建 Case：在控制台填写 repo/ref/env_keys，提交后获取 case_id
+- 访问地址：RUNNING 后使用 access_url 打开
+
+### 3.2 本地运行（如可推断）
+{local_lines}
+
+### 3.3 Docker 运行（如可推断）
+{docker_lines}
+
+## 4. 配置与环境变量（只展示 keys）
+- 端口：{port_hint}
+- 环境变量：
+{env_lines}
+- 关键配置文件：
+{config_lines}
+
+## 5. 目录结构解读
+```text
+{tree_output}
+```
+关键目录/文件说明：
+- Dockerfile: {docker_info.get('expose') or '-'} 端口与镜像构建入口
+- README: {readme_note}
+
+## 6. 架构/流程图（Mermaid）
+```mermaid
+flowchart TD
+  A[Repo Source] --> B[Build Image]
+  B --> C[Container Runtime]
+  C --> D[Access URL]
+  C --> E[Logs Stream]
+```
+
+## 7. 常见问题与注意事项
+- Dockerfile 缺失：请在仓库根目录补齐 Dockerfile
+- 端口不可访问：确认 EXPOSE 与应用监听端口一致
+- 环境变量未生效：仅支持 key 注入，请检查键名是否正确
+
+## 8. 版本与生成信息
+- generated_at: {{generated_at}}
+- generator_version: {{generator_version}}
+- signals: {{signals}}
+- time_cost_ms: {{time_cost_ms}}
+"""
diff -ruN '--exclude=.devlogs' '--exclude=venv' '--exclude=node_modules' '--exclude=__pycache__' /tmp/AntiHub.phase3.base/phase2.patch /home/user2643/code/AntiHub/phase2.patch
--- /tmp/AntiHub.phase3.base/phase2.patch	1970-01-01 08:00:00.000000000 +0800
+++ /home/user2643/code/AntiHub/phase2.patch	2026-01-22 17:27:17.190205944 +0800
@@ -0,0 +1,3705 @@
+--- README.md
++++ README.md
+@@ -1,13 +1,13 @@
+-# AntiHub Phase 1 快速上手（中文傻瓜版）
++# AntiHub
+ 
+ 目标：用本地 MetaGPT 仓库一键跑通 “创建 case -> 构建/运行 -> 实时日志 -> 查询状态”。
+ 
+-## 0. 项目概览 & 作用
++## 0. 项目概览
+ - 作用：给任意代码仓库做一键容器化部署，实时回放 build/run 日志，并暴露 API/WS 便于集成上层智能体。
+ - 特点：env 安全（只存 key）、状态机可达 RUNNING/FAILED（含错误码）、WS 支持历史回放+实时推送、默认一键脚本 `dev.sh up`（端口 8010）。
+ - 适用场景：本地/WSL 上快速验证 Agent 生成代码，或将已有仓库打成可访问的容器实例。
+ 
+-### 核心流程（文字版）
++### 核心流程
+ 1) `POST /cases`：记录 env_keys、排队构建。
+ 2) clone + Docker build（log: stream=build）。
+ 3) run 容器，探活成功后状态转 RUNNING（log: system/run）。
+@@ -40,7 +40,7 @@
+ 
+ ## 3. 一键启动（推荐）
+ ```bash
+-./dev.sh up
++bash ./dev.sh up
+ # 停止：./dev.sh down
+ # 日志：.devlogs/api.log 与 .devlogs/worker.log
+ ```
+@@ -106,7 +106,7 @@
+ - 端口映射：查看 `GET /cases/{id}` 返回的 `host_port`，浏览器访问 `http://localhost:{host_port}`
+ - 容器日志：`docker logs <container_id>`（从接口返回的 runtime.container_id 获取）
+ 
+-## 10. 冒烟测试（curl 串行）
++## 10. 测试（curl 串行）
+ ```bash
+ ./dev.sh up
+ export OPENAI_API_KEY=sk-xxx
+--- config.py
++++ config.py
+@@ -13,6 +13,15 @@
+ LOG_LIST_PREFIX = os.getenv("LOG_LIST_PREFIX", "logs:")
+ WS_LOG_CHANNEL_PREFIX = os.getenv("WS_LOG_CHANNEL_PREFIX", "build_logs:")
+ CASE_PREFIX = os.getenv("CASE_PREFIX", "case:")
++
++CORS_ORIGINS = [
++    origin.strip()
++    for origin in os.getenv(
++        "CORS_ORIGINS",
++        "http://127.0.0.1:5173,http://localhost:5173",
++    ).split(",")
++    if origin.strip()
++]
+ 
+ GIT_CLONE_TIMEOUT_SECONDS = int(os.getenv("GIT_CLONE_TIMEOUT_SECONDS", "120"))
+ DOCKER_BUILD_TIMEOUT_SECONDS = int(os.getenv("DOCKER_BUILD_TIMEOUT_SECONDS", "1800"))
+--- main.py
++++ main.py
+@@ -1,26 +1,64 @@
+ from __future__ import annotations
+ 
++import time
+ import uuid
+ from typing import Any, Dict, List, Optional
+ 
+ from fastapi import FastAPI, HTTPException, WebSocket, WebSocketDisconnect
++from fastapi.middleware.cors import CORSMiddleware
+ from pydantic import BaseModel, ConfigDict, Field
+ 
+-from config import DEFAULT_BRANCH
++from config import CORS_ORIGINS, DEFAULT_BRANCH
+ from storage import decode_log_entry, get_async_redis_client, get_case, get_logs, log_channel, set_case
+ from worker import analyze_case, build_and_run
+ 
+ app = FastAPI(title="Agent Platform", version="0.2.0")
+-
+-
+-class CreateCaseRequest(BaseModel):
+-    repo_url: str = Field(..., alias="git_url", description="Git repository URL")
+-    branch: str = Field(DEFAULT_BRANCH, alias="ref", description="Git branch")
++app.add_middleware(
++    CORSMiddleware,
++    allow_origins=CORS_ORIGINS,
++    allow_credentials=True,
++    allow_methods=["*"],
++    allow_headers=["*"],
++)
++
++STAGE_VALUES = {"clone", "build", "run", "analyze", "system"}
++STATUS_STAGE_MAP = {
++    "PENDING": "system",
++    "CLONING": "clone",
++    "BUILDING": "build",
++    "STARTING": "run",
++    "RUNNING": "run",
++    "FINISHED": "run",
++    "FAILED": "system",
++    "ANALYZING": "analyze",
++}
++
++
++class CaseCreateRequest(BaseModel):
++    git_url: Optional[str] = Field(
++        None,
++        description="Git repository URL (alias for repo_url).",
++    )
++    repo_url: Optional[str] = Field(
++        None,
++        description="Git repository URL.",
++    )
++    ref: Optional[str] = Field(
++        None,
++        description="Git ref (alias for branch).",
++    )
++    branch: Optional[str] = Field(
++        None,
++        description="Git branch (alias for ref).",
++    )
+     container_port: Optional[int] = Field(None, description="Container port override")
+-    env: Dict[str, str] = Field(default_factory=dict, description="Environment variables")
+-    auto_analyze: bool = Field(True, description="Trigger analysis after deploy")
++    env: Dict[str, str] = Field(
++        default_factory=dict,
++        description="Environment variables (values are not stored).",
++    )
++    auto_analyze: bool = Field(False, description="Trigger analysis after deploy")
+ 
+-    model_config = ConfigDict(populate_by_name=True)
++    model_config = ConfigDict(extra="ignore")
+ 
+ 
+ class RuntimeInfo(BaseModel):
+@@ -35,21 +73,86 @@
+ class CaseResponse(BaseModel):
+     case_id: str
+     status: str
+-    repo_url: str
+-    branch: str
++    stage: str
++    commit_sha: Optional[str] = None
++    runtime: RuntimeInfo = Field(default_factory=RuntimeInfo)
++    env_keys: List[str] = Field(default_factory=list)
++    error_code: Optional[str] = None
++    error_message: Optional[str] = None
++    created_at: Optional[float] = None
++    updated_at: Optional[float] = None
++    repo_url: Optional[str] = None
++    ref: Optional[str] = None
++    branch: Optional[str] = None
+     container_port: Optional[int] = None
+     container_id: Optional[str] = None
+     host_port: Optional[int] = None
+     access_url: Optional[str] = None
+     image_tag: Optional[str] = None
+-    error_code: Optional[str] = None
+-    error_message: Optional[str] = None
+     last_log_at: Optional[float] = None
+-    env_keys: List[str] = Field(default_factory=list)
+-    commit_sha: Optional[str] = None
+-    stage: Optional[str] = None
+     report_ready: bool = False
+-    runtime: Optional[RuntimeInfo] = None
++
++
++def normalize_stage(raw_stage: Optional[str], status: Optional[str]) -> str:
++    if raw_stage:
++        normalized = raw_stage.lower()
++        if normalized in STAGE_VALUES:
++            return normalized
++    if status:
++        return STATUS_STAGE_MAP.get(status.upper(), "system")
++    return "system"
++
++
++def build_case_response(case_id: str, data: Dict[str, Any]) -> CaseResponse:
++    status = (data.get("status") or "PENDING").upper()
++    stage = normalize_stage(data.get("stage"), status)
++    runtime_data = data.get("runtime") or {}
++    if not isinstance(runtime_data, dict):
++        runtime_data = {}
++    runtime = RuntimeInfo(**runtime_data)
++    container_id = data.get("container_id") or runtime.container_id
++    host_port = data.get("host_port") or runtime.host_port
++    access_url = data.get("access_url") or runtime.access_url
++    runtime = RuntimeInfo(
++        container_id=container_id,
++        host_port=host_port,
++        access_url=access_url,
++        started_at=runtime.started_at,
++        exited_at=runtime.exited_at,
++        exit_code=runtime.exit_code,
++    )
++    env_keys = sorted(data.get("env_keys") or [])
++    error_code = data.get("error_code")
++    error_message = data.get("error_message")
++    if status == "FAILED":
++        if not error_code:
++            error_code = "UNEXPECTED_ERROR"
++        if not error_message:
++            error_message = "Unknown failure"
++    ref_value = data.get("ref") or data.get("branch")
++    branch_value = data.get("branch") or ref_value
++    return CaseResponse(
++        case_id=case_id,
++        status=status,
++        stage=stage,
++        commit_sha=data.get("commit_sha"),
++        runtime=runtime,
++        env_keys=env_keys,
++        error_code=error_code,
++        error_message=error_message,
++        created_at=data.get("created_at"),
++        updated_at=data.get("updated_at"),
++        repo_url=data.get("repo_url"),
++        ref=ref_value,
++        branch=branch_value,
++        container_port=data.get("container_port"),
++        container_id=container_id,
++        host_port=host_port,
++        access_url=access_url,
++        image_tag=data.get("image_tag"),
++        last_log_at=data.get("last_log_at"),
++        report_ready=bool(data.get("report_ready", False)),
++    )
+ 
+ 
+ @app.get("/healthz")
+@@ -58,22 +161,45 @@
+ 
+ 
+ @app.post("/cases", response_model=CaseResponse)
+-async def create_case(payload: CreateCaseRequest) -> CaseResponse:
++async def create_case(payload: CaseCreateRequest) -> CaseResponse:
++    repo_url = payload.repo_url or payload.git_url
++    if not repo_url:
++        raise HTTPException(status_code=422, detail="git_url or repo_url is required")
++    ref = payload.ref or payload.branch or DEFAULT_BRANCH
+     case_id = f"c_{uuid.uuid4().hex[:6]}"
++    now = time.time()
+     env_keys = sorted(list((payload.env or {}).keys()))
+     data: Dict[str, Any] = {
+         "case_id": case_id,
+         "status": "PENDING",
+-        "stage": "PENDING",
+-        "repo_url": payload.repo_url,
+-        "branch": payload.branch,
++        "stage": "system",
++        "repo_url": repo_url,
++        "ref": ref,
++        "branch": ref,
+         "container_port": payload.container_port,
+         "env_keys": env_keys,
+         "report_ready": False,
++        "created_at": now,
++        "updated_at": now,
++        "runtime": {
++            "container_id": None,
++            "host_port": None,
++            "access_url": None,
++            "started_at": None,
++            "exited_at": None,
++            "exit_code": None,
++        },
+     }
+     set_case(case_id, data)
+-    build_and_run.delay(case_id, payload.repo_url, payload.branch, payload.container_port, payload.env, payload.auto_analyze)
+-    return CaseResponse(**data)
++    build_and_run.delay(
++        case_id,
++        repo_url,
++        ref,
++        payload.container_port,
++        payload.env,
++        payload.auto_analyze,
++    )
++    return build_case_response(case_id, data)
+ 
+ 
+ @app.get("/cases/{case_id}", response_model=CaseResponse)
+@@ -82,7 +208,7 @@
+     if not data:
+         raise HTTPException(status_code=404, detail="Case not found")
+     data.pop("case_id", None)
+-    return CaseResponse(case_id=case_id, **data)
++    return build_case_response(case_id, data)
+ 
+ 
+ @app.post("/cases/{case_id}/analyze")
+--- requirements.txt
++++ requirements.txt
+@@ -1,6 +1,7 @@
+-fastapi==0.112.0
+-uvicorn==0.30.5
+-celery==5.4.0
+-redis==5.0.8
+-docker==7.1.0
+-pydantic==2.8.2
+\ No newline at end of file
++fastapi==0.112.0
++uvicorn==0.30.5
++celery==5.4.0
++redis==5.0.8
++docker==7.1.0
++pydantic==2.8.2
++websockets==12.0
+--- storage.py
++++ storage.py
+@@ -25,6 +25,8 @@
+ def update_case(case_id: str, data: Dict[str, Any]) -> None:
+     if not data:
+         return
++    data = dict(data)
++    data["updated_at"] = time.time()
+     client = get_redis_client()
+     client.hset(f"{CASE_PREFIX}{case_id}", mapping=_encode_data(data))
+ 
+--- worker.py
++++ worker.py
+@@ -123,7 +123,7 @@
+                 case_id,
+                 {
+                     "status": "FINISHED",
+-                    "stage": "FINISHED",
++                    "stage": "run",
+                     "runtime": {
+                         **runtime,
+                         "exited_at": finished_at,
+@@ -137,7 +137,7 @@
+                 case_id,
+                 {
+                     "status": "FAILED",
+-                    "stage": "FAILED",
++                    "stage": "run",
+                     "error_code": "CONTAINER_EXIT_NONZERO",
+                     "error_message": f"Container exited with code {exit_code}",
+                     "runtime": {
+@@ -159,19 +159,19 @@
+ def build_and_run(
+     case_id: str,
+     repo_url: str,
+-    branch: Optional[str] = None,
++    ref: Optional[str] = None,
+     container_port: Optional[int] = None,
+     env: Optional[Dict[str, str]] = None,
+-    auto_analyze: bool = True,
++    auto_analyze: bool = False,
+ ) -> dict:
+-    branch = branch or DEFAULT_BRANCH
++    ref = ref or DEFAULT_BRANCH
+     env = env or {}
+-    update_case(case_id, {"status": "CLONING", "stage": "CLONING"})
++    update_case(case_id, {"status": "CLONING", "stage": "clone"})
+     target_dir = Path(BUILD_ROOT) / case_id
+     host_port: Optional[int] = None
+     try:
+-        publish_log(case_id, "system", f"Cloning repo {repo_url} (branch {branch})...")
+-        clone_repo(repo_url, branch, target_dir)
++        publish_log(case_id, "system", f"Cloning repo {repo_url} (ref {ref})...")
++        clone_repo(repo_url, ref, target_dir)
+         publish_log(case_id, "system", "Clone completed")
+         try:
+             commit_sha = (
+@@ -192,7 +192,7 @@
+             case_id,
+             {
+                 "status": "BUILDING",
+-                "stage": "BUILDING",
++                "stage": "build",
+                 "container_port": resolved_port,
+                 "env_keys": sorted(env.keys()),
+             },
+@@ -205,7 +205,7 @@
+         for event in build_image(client, target_dir, tag):
+             log_event(case_id, event)
+ 
+-        update_case(case_id, {"status": "STARTING", "stage": "STARTING"})
++        update_case(case_id, {"status": "STARTING", "stage": "run"})
+ 
+         if PORT_MODE == "dynamic":
+             container_id, host_port = run_container_dynamic(client, tag, resolved_port, env)
+@@ -219,7 +219,7 @@
+             case_id,
+             {
+                 "status": "RUNNING",
+-                "stage": "RUNNING",
++                "stage": "run",
+                 "container_id": container_id,
+                 "host_port": host_port,
+                 "access_url": access_url,
+@@ -239,11 +239,13 @@
+         return {"container_id": container_id, "host_port": host_port}
+     except Exception as exc:  # noqa: BLE001
+         error_code, error_message = classify_error(exc)
++        existing = get_case(case_id) or {}
++        stage = existing.get("stage") or "system"
+         update_case(
+             case_id,
+             {
+                 "status": "FAILED",
+-                "stage": "FAILED",
++                "stage": stage,
+                 "error_code": error_code,
+                 "error_message": error_message,
+             },
+@@ -263,4 +265,8 @@
+ 
+ @celery_app.task(name="analyze_case")
+ def analyze_case(case_id: str) -> None:
++    existing = get_case(case_id) or {}
++    status = existing.get("status") or "RUNNING"
++    if status not in {"FAILED", "FINISHED"}:
++        update_case(case_id, {"status": status, "stage": "analyze"})
+     publish_log(case_id, "analyze", "ANALYZE_QUEUED (stub)")
+--- second.md
++++ second.md
+@@ -0,0 +1,149 @@
++# Phase 2 前端交互与后端对齐验收报告
++
++## 1. 概述 / 范围 / 结论
++- 验收范围：创建 case -> build/run -> WS 实时日志 -> 状态与运行信息 -> ENV 注入安全，新增前端控制台与后端接口契约对齐。
++- 结论：PASS（前后端对齐完成，WS 回放+订阅稳定，接口契约与 OpenAPI 同步；端口池冲突属于已知问题，详见第 6 节）。
++
++## 2. 启动与基线确认
++- 启动：`./dev.sh up`
++- /docs：`http://127.0.0.1:8010/docs` -> 200
++- /openapi.json：字段已更新（见第 3 节摘要）
++- Phase1 基线：完成创建 case、WS 日志回放、状态查询（示例：`c_536b9e`）
++
++## 3. 接口契约（以 OpenAPI 为准）
++
++### 3.1 CaseCreateRequest
++- 字段：`git_url | repo_url`（二选一）、`ref | branch`（二选一）、`env`、`auto_analyze`、`container_port`
++- 说明：
++  - `git_url` / `repo_url` 兼容输入；内部统一为 `repo_url`
++  - `ref` / `branch` 兼容输入；内部统一为 `ref`
++  - `auto_analyze` 默认 `false`
++  - `env` 仅用于容器注入，不持久化 value（只保留 `env_keys`）
++
++### 3.2 CaseResponse / CaseStatusResponse
++- 必备字段：`case_id`, `status`, `stage`, `commit_sha`, `runtime`, `env_keys`, `error_code`, `error_message`, `created_at`, `updated_at`
++- 运行信息：`runtime = { container_id?, host_port?, access_url? }`（含 started/exited/exit_code）
++- 兼容字段：`repo_url`, `ref`, `branch`, `container_port`, `container_id`, `host_port`, `access_url`, `image_tag`, `last_log_at`
++
++### 3.3 状态/阶段定义
++- `status`：`PENDING/CLONING/BUILDING/STARTING/RUNNING/FAILED/FINISHED`（保持现有实现）
++- `stage`：`clone/build/run/analyze/system`（已统一为小写）
++
++### 3.4 WS 日志格式
++- JSON 行：`{"ts":<epoch_seconds>,"stream":"build|run|analyze|system","level":"INFO|ERROR","line":"..."}`
++- 机制：WS 连接后先回放 Redis List，再订阅 Redis Pub/Sub
++
++### 3.5 跨域与依赖
++- CORS：允许 `http://127.0.0.1:5173` / `http://localhost:5173`
++- 依赖：`websockets` 已加入 `requirements.txt`
++
++## 4. 前端功能清单（frontend/）
++- Create Case 页面
++  - 表单：`repo_url`、`ref`、`env`（可增删行）、`auto_analyze`
++  - 提交后展示 `case_id` 并跳转到 `/cases/:id`
++- Case Detail 页面
++  - 状态 Badge + stage + 更新时间
++  - Runtime 卡片：`access_url`（点击/复制）、`host_port`、`container_id`
++  - Env Keys 卡片：仅显示 key
++  - 错误卡片：`FAILED` 时显示 `error_code`、`error_message` + 可解释文案
++  - 日志面板：WS 回放+实时、自动滚动/暂停、按 stream 过滤、断线提示与一键重连
++  - 底部状态刷新按钮 + 轮询（2s，RUNNING/FAILED 后降频 5s）
++- 安全：不写入 localStorage，不打印 env value，不在页面显示明文值
++- 构建验证：`npm run build` 通过
++
++## 5. 联调用例证据（2 个）
++
++### 用例 1：轻量仓 hello-world（RUNNING）
++- 创建请求（env value 已打码）：
++```json
++{
++  "repo_url": "/home/user2643/code/AntiHub/test-repos/hello-world",
++  "ref": "master",
++  "env": {"FOO": "***"},
++  "auto_analyze": false
++}
++```
++- 创建响应：`case_id = c_db5ef1`（秒回）
++- WS 日志（摘录）：`.devlogs/phase2_case1_ws.jsonl`
++```json
++{"ts":1768981005.8472288,"stream":"system","level":"INFO","line":"Cloning repo /home/user2643/code/AntiHub/test-repos/hello-world (ref master)..."}
++{"ts":1768981006.0443277,"stream":"build","level":"INFO","line":"Step 1/5 : FROM nikolaik/python-nodejs:python3.9-nodejs20-slim"}
++```
++- 状态响应（摘录）：`.devlogs/phase2_case1_status.json`
++```json
++{"case_id":"c_db5ef1","status":"RUNNING","stage":"run","runtime":{"host_port":30000,"access_url":"http://localhost:30000"},"env_keys":["FOO"],"error_code":null}
++```
++- 访问验证：`curl http://localhost:30000/` -> `HTTP/1.0 200 OK`
++- 前端页面行为：
++  - 状态卡：RUNNING / stage=run / 更新时间显示
++  - Runtime 卡：access_url 可点击与复制
++  - Env Keys：展示 `FOO`
++  - 日志面板：build/system 实时日志可见、支持过滤与暂停
++- 结论：PASS
++
++### 用例 2：MetaGPT 场景仓（RUNNING）
++- 创建请求（env value 已打码）：
++```json
++{
++  "repo_url": "/home/user2643/code/AntiHub/test-repos/metagpt-min",
++  "ref": "master",
++  "env": {"OPENAI_API_KEY": "sk-****"},
++  "auto_analyze": false
++}
++```
++- 创建响应：`case_id = c_c6547a`（秒回）
++- WS 日志（摘录）：`.devlogs/phase2_case2_ws.jsonl`
++```json
++{"ts":1768981050.0024369,"stream":"system","level":"INFO","line":"Cloning repo /home/user2643/code/AntiHub/test-repos/metagpt-min (ref master)..."}
++{"ts":1768981050.195938,"stream":"build","level":"INFO","line":"Step 1/5 : FROM nikolaik/python-nodejs:python3.9-nodejs20-slim"}
++```
++- 状态响应（摘录）：`.devlogs/phase2_case2_status.json`
++```json
++{"case_id":"c_c6547a","status":"RUNNING","stage":"run","runtime":{"host_port":30000,"access_url":"http://localhost:30000"},"env_keys":["OPENAI_API_KEY"],"error_code":null}
++```
++- 访问验证：`curl http://localhost:30000/` -> `HTTP/1.0 200 OK`
++- 前端页面行为：
++  - 状态卡：RUNNING / stage=run
++  - Env Keys：展示 `OPENAI_API_KEY`
++  - 日志面板：build/system 可见，支持过滤与暂停
++- 结论：PASS
++
++## 6. 发现问题与修复记录（含 patch）
++1) WebSocket 依赖缺失
++- 修复：`requirements.txt` 加入 `websockets==12.0`
++
++2) 接口契约对齐
++- 修复：新增 `CaseCreateRequest`/`CaseResponse` 字段与默认值，补齐 `runtime`、`env_keys`、`error_code`、`created_at/updated_at`，统一 `stage` 枚举；OpenAPI 同步更新
++
++3) CORS/前端联调
++- 修复：后端允许 `http://127.0.0.1:5173` / `http://localhost:5173`
++
++4) 前端控制台
++- 修复：新增 `frontend/`（Vite + React + TS），支持创建、详情、WS 日志与可视化状态
++
++5) 端口池冲突（已知问题）
++- 现象：若已有容器占用 30000，新的 case 会在启动阶段报错 `port is already allocated`
++- 本次处理：停用旧容器释放端口后重试（对业务逻辑无侵入）
++
++Patch：`phase2.patch`
++- 应用方式（项目根目录）：`patch -p0 < phase2.patch`
++
++## 7. 启动说明
++- 后端：`./dev.sh up`
++- 前端：`cd frontend && npm i && npm run dev`
++- 并发启动（可选）：开两终端分别执行上述两条命令
++## 7.1 前端操作教程（快速上手）
++1) 启动前端：`cd frontend && npm i && npm run dev`，浏览器打开 `http://127.0.0.1:5173`  
++2) 创建案例：在“创建案例”页填写 `repo_url`、可选 `ref`，按需添加 env（只填 key 或打码 value），点击“创建案例”  
++3) 查看详情：提交后自动跳转到 `/cases/:id`，顶部显示状态与阶段  
++4) 运行信息：可点击访问 `access_url`，点击“复制”复制地址  
++5) 日志面板：支持按 `构建/运行/分析/系统` 过滤，支持“暂停滚动 / 自动滚动”切换  
++6) 断线处理：若 WS 断开，面板提示“已断开”，点击“重连”恢复  
++7) 状态刷新：点击“刷新状态”立即拉取；系统也会自动轮询
++
++## 8. 下一步（Phase 3）建议
++1) Case 列表/检索与生命周期管理（停止/重启/清理）
++2) 项目维度视图（按 repo/branch 统计与对比）
++3) 环境变量与凭据管理（仅 key 可见，支持模板与复用）
++4) 运行观测（资源用量、容器健康、失败聚类）
++5) 多租户/权限控制与审计日志
+\ No newline at end of file
+--- frontend/index.html
++++ frontend/index.html
+@@ -0,0 +1,12 @@
++<!doctype html>
++<html lang="zh-CN">
++  <head>
++    <meta charset="UTF-8" />
++    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
++    <title>AntiHub 控制台</title>
++  </head>
++  <body>
++    <div id="root"></div>
++    <script type="module" src="/src/main.tsx"></script>
++  </body>
++</html>
+--- frontend/package.json
++++ frontend/package.json
+@@ -0,0 +1,22 @@
++{
++  "name": "antihub-console",
++  "private": true,
++  "version": "0.0.0",
++  "type": "module",
++  "scripts": {
++    "dev": "vite",
++    "build": "vite build",
++    "preview": "vite preview"
++  },
++  "dependencies": {
++    "react": "^18.3.1",
++    "react-dom": "^18.3.1"
++  },
++  "devDependencies": {
++    "@types/react": "^18.3.3",
++    "@types/react-dom": "^18.3.0",
++    "@vitejs/plugin-react": "^4.3.1",
++    "typescript": "^5.5.4",
++    "vite": "^5.4.2"
++  }
++}
+--- frontend/package-lock.json
++++ frontend/package-lock.json
+@@ -0,0 +1,1726 @@
++{
++  "name": "antihub-console",
++  "version": "0.0.0",
++  "lockfileVersion": 3,
++  "requires": true,
++  "packages": {
++    "": {
++      "name": "antihub-console",
++      "version": "0.0.0",
++      "dependencies": {
++        "react": "^18.3.1",
++        "react-dom": "^18.3.1"
++      },
++      "devDependencies": {
++        "@types/react": "^18.3.3",
++        "@types/react-dom": "^18.3.0",
++        "@vitejs/plugin-react": "^4.3.1",
++        "typescript": "^5.5.4",
++        "vite": "^5.4.2"
++      }
++    },
++    "node_modules/@babel/code-frame": {
++      "version": "7.28.6",
++      "resolved": "https://registry.npmjs.org/@babel/code-frame/-/code-frame-7.28.6.tgz",
++      "integrity": "sha512-JYgintcMjRiCvS8mMECzaEn+m3PfoQiyqukOMCCVQtoJGYJw8j/8LBJEiqkHLkfwCcs74E3pbAUFNg7d9VNJ+Q==",
++      "dev": true,
++      "license": "MIT",
++      "dependencies": {
++        "@babel/helper-validator-identifier": "^7.28.5",
++        "js-tokens": "^4.0.0",
++        "picocolors": "^1.1.1"
++      },
++      "engines": {
++        "node": ">=6.9.0"
++      }
++    },
++    "node_modules/@babel/compat-data": {
++      "version": "7.28.6",
++      "resolved": "https://registry.npmjs.org/@babel/compat-data/-/compat-data-7.28.6.tgz",
++      "integrity": "sha512-2lfu57JtzctfIrcGMz992hyLlByuzgIk58+hhGCxjKZ3rWI82NnVLjXcaTqkI2NvlcvOskZaiZ5kjUALo3Lpxg==",
++      "dev": true,
++      "license": "MIT",
++      "engines": {
++        "node": ">=6.9.0"
++      }
++    },
++    "node_modules/@babel/core": {
++      "version": "7.28.6",
++      "resolved": "https://registry.npmjs.org/@babel/core/-/core-7.28.6.tgz",
++      "integrity": "sha512-H3mcG6ZDLTlYfaSNi0iOKkigqMFvkTKlGUYlD8GW7nNOYRrevuA46iTypPyv+06V3fEmvvazfntkBU34L0azAw==",
++      "dev": true,
++      "license": "MIT",
++      "dependencies": {
++        "@babel/code-frame": "^7.28.6",
++        "@babel/generator": "^7.28.6",
++        "@babel/helper-compilation-targets": "^7.28.6",
++        "@babel/helper-module-transforms": "^7.28.6",
++        "@babel/helpers": "^7.28.6",
++        "@babel/parser": "^7.28.6",
++        "@babel/template": "^7.28.6",
++        "@babel/traverse": "^7.28.6",
++        "@babel/types": "^7.28.6",
++        "@jridgewell/remapping": "^2.3.5",
++        "convert-source-map": "^2.0.0",
++        "debug": "^4.1.0",
++        "gensync": "^1.0.0-beta.2",
++        "json5": "^2.2.3",
++        "semver": "^6.3.1"
++      },
++      "engines": {
++        "node": ">=6.9.0"
++      },
++      "funding": {
++        "type": "opencollective",
++        "url": "https://opencollective.com/babel"
++      }
++    },
++    "node_modules/@babel/generator": {
++      "version": "7.28.6",
++      "resolved": "https://registry.npmjs.org/@babel/generator/-/generator-7.28.6.tgz",
++      "integrity": "sha512-lOoVRwADj8hjf7al89tvQ2a1lf53Z+7tiXMgpZJL3maQPDxh0DgLMN62B2MKUOFcoodBHLMbDM6WAbKgNy5Suw==",
++      "dev": true,
++      "license": "MIT",
++      "dependencies": {
++        "@babel/parser": "^7.28.6",
++        "@babel/types": "^7.28.6",
++        "@jridgewell/gen-mapping": "^0.3.12",
++        "@jridgewell/trace-mapping": "^0.3.28",
++        "jsesc": "^3.0.2"
++      },
++      "engines": {
++        "node": ">=6.9.0"
++      }
++    },
++    "node_modules/@babel/helper-compilation-targets": {
++      "version": "7.28.6",
++      "resolved": "https://registry.npmjs.org/@babel/helper-compilation-targets/-/helper-compilation-targets-7.28.6.tgz",
++      "integrity": "sha512-JYtls3hqi15fcx5GaSNL7SCTJ2MNmjrkHXg4FSpOA/grxK8KwyZ5bubHsCq8FXCkua6xhuaaBit+3b7+VZRfcA==",
++      "dev": true,
++      "license": "MIT",
++      "dependencies": {
++        "@babel/compat-data": "^7.28.6",
++        "@babel/helper-validator-option": "^7.27.1",
++        "browserslist": "^4.24.0",
++        "lru-cache": "^5.1.1",
++        "semver": "^6.3.1"
++      },
++      "engines": {
++        "node": ">=6.9.0"
++      }
++    },
++    "node_modules/@babel/helper-globals": {
++      "version": "7.28.0",
++      "resolved": "https://registry.npmjs.org/@babel/helper-globals/-/helper-globals-7.28.0.tgz",
++      "integrity": "sha512-+W6cISkXFa1jXsDEdYA8HeevQT/FULhxzR99pxphltZcVaugps53THCeiWA8SguxxpSp3gKPiuYfSWopkLQ4hw==",
++      "dev": true,
++      "license": "MIT",
++      "engines": {
++        "node": ">=6.9.0"
++      }
++    },
++    "node_modules/@babel/helper-module-imports": {
++      "version": "7.28.6",
++      "resolved": "https://registry.npmjs.org/@babel/helper-module-imports/-/helper-module-imports-7.28.6.tgz",
++      "integrity": "sha512-l5XkZK7r7wa9LucGw9LwZyyCUscb4x37JWTPz7swwFE/0FMQAGpiWUZn8u9DzkSBWEcK25jmvubfpw2dnAMdbw==",
++      "dev": true,
++      "license": "MIT",
++      "dependencies": {
++        "@babel/traverse": "^7.28.6",
++        "@babel/types": "^7.28.6"
++      },
++      "engines": {
++        "node": ">=6.9.0"
++      }
++    },
++    "node_modules/@babel/helper-module-transforms": {
++      "version": "7.28.6",
++      "resolved": "https://registry.npmjs.org/@babel/helper-module-transforms/-/helper-module-transforms-7.28.6.tgz",
++      "integrity": "sha512-67oXFAYr2cDLDVGLXTEABjdBJZ6drElUSI7WKp70NrpyISso3plG9SAGEF6y7zbha/wOzUByWWTJvEDVNIUGcA==",
++      "dev": true,
++      "license": "MIT",
++      "dependencies": {
++        "@babel/helper-module-imports": "^7.28.6",
++        "@babel/helper-validator-identifier": "^7.28.5",
++        "@babel/traverse": "^7.28.6"
++      },
++      "engines": {
++        "node": ">=6.9.0"
++      },
++      "peerDependencies": {
++        "@babel/core": "^7.0.0"
++      }
++    },
++    "node_modules/@babel/helper-plugin-utils": {
++      "version": "7.28.6",
++      "resolved": "https://registry.npmjs.org/@babel/helper-plugin-utils/-/helper-plugin-utils-7.28.6.tgz",
++      "integrity": "sha512-S9gzZ/bz83GRysI7gAD4wPT/AI3uCnY+9xn+Mx/KPs2JwHJIz1W8PZkg2cqyt3RNOBM8ejcXhV6y8Og7ly/Dug==",
++      "dev": true,
++      "license": "MIT",
++      "engines": {
++        "node": ">=6.9.0"
++      }
++    },
++    "node_modules/@babel/helper-string-parser": {
++      "version": "7.27.1",
++      "resolved": "https://registry.npmjs.org/@babel/helper-string-parser/-/helper-string-parser-7.27.1.tgz",
++      "integrity": "sha512-qMlSxKbpRlAridDExk92nSobyDdpPijUq2DW6oDnUqd0iOGxmQjyqhMIihI9+zv4LPyZdRje2cavWPbCbWm3eA==",
++      "dev": true,
++      "license": "MIT",
++      "engines": {
++        "node": ">=6.9.0"
++      }
++    },
++    "node_modules/@babel/helper-validator-identifier": {
++      "version": "7.28.5",
++      "resolved": "https://registry.npmjs.org/@babel/helper-validator-identifier/-/helper-validator-identifier-7.28.5.tgz",
++      "integrity": "sha512-qSs4ifwzKJSV39ucNjsvc6WVHs6b7S03sOh2OcHF9UHfVPqWWALUsNUVzhSBiItjRZoLHx7nIarVjqKVusUZ1Q==",
++      "dev": true,
++      "license": "MIT",
++      "engines": {
++        "node": ">=6.9.0"
++      }
++    },
++    "node_modules/@babel/helper-validator-option": {
++      "version": "7.27.1",
++      "resolved": "https://registry.npmjs.org/@babel/helper-validator-option/-/helper-validator-option-7.27.1.tgz",
++      "integrity": "sha512-YvjJow9FxbhFFKDSuFnVCe2WxXk1zWc22fFePVNEaWJEu8IrZVlda6N0uHwzZrUM1il7NC9Mlp4MaJYbYd9JSg==",
++      "dev": true,
++      "license": "MIT",
++      "engines": {
++        "node": ">=6.9.0"
++      }
++    },
++    "node_modules/@babel/helpers": {
++      "version": "7.28.6",
++      "resolved": "https://registry.npmjs.org/@babel/helpers/-/helpers-7.28.6.tgz",
++      "integrity": "sha512-xOBvwq86HHdB7WUDTfKfT/Vuxh7gElQ+Sfti2Cy6yIWNW05P8iUslOVcZ4/sKbE+/jQaukQAdz/gf3724kYdqw==",
++      "dev": true,
++      "license": "MIT",
++      "dependencies": {
++        "@babel/template": "^7.28.6",
++        "@babel/types": "^7.28.6"
++      },
++      "engines": {
++        "node": ">=6.9.0"
++      }
++    },
++    "node_modules/@babel/parser": {
++      "version": "7.28.6",
++      "resolved": "https://registry.npmjs.org/@babel/parser/-/parser-7.28.6.tgz",
++      "integrity": "sha512-TeR9zWR18BvbfPmGbLampPMW+uW1NZnJlRuuHso8i87QZNq2JRF9i6RgxRqtEq+wQGsS19NNTWr2duhnE49mfQ==",
++      "dev": true,
++      "license": "MIT",
++      "dependencies": {
++        "@babel/types": "^7.28.6"
++      },
++      "bin": {
++        "parser": "bin/babel-parser.js"
++      },
++      "engines": {
++        "node": ">=6.0.0"
++      }
++    },
++    "node_modules/@babel/plugin-transform-react-jsx-self": {
++      "version": "7.27.1",
++      "resolved": "https://registry.npmjs.org/@babel/plugin-transform-react-jsx-self/-/plugin-transform-react-jsx-self-7.27.1.tgz",
++      "integrity": "sha512-6UzkCs+ejGdZ5mFFC/OCUrv028ab2fp1znZmCZjAOBKiBK2jXD1O+BPSfX8X2qjJ75fZBMSnQn3Rq2mrBJK2mw==",
++      "dev": true,
++      "license": "MIT",
++      "dependencies": {
++        "@babel/helper-plugin-utils": "^7.27.1"
++      },
++      "engines": {
++        "node": ">=6.9.0"
++      },
++      "peerDependencies": {
++        "@babel/core": "^7.0.0-0"
++      }
++    },
++    "node_modules/@babel/plugin-transform-react-jsx-source": {
++      "version": "7.27.1",
++      "resolved": "https://registry.npmjs.org/@babel/plugin-transform-react-jsx-source/-/plugin-transform-react-jsx-source-7.27.1.tgz",
++      "integrity": "sha512-zbwoTsBruTeKB9hSq73ha66iFeJHuaFkUbwvqElnygoNbj/jHRsSeokowZFN3CZ64IvEqcmmkVe89OPXc7ldAw==",
++      "dev": true,
++      "license": "MIT",
++      "dependencies": {
++        "@babel/helper-plugin-utils": "^7.27.1"
++      },
++      "engines": {
++        "node": ">=6.9.0"
++      },
++      "peerDependencies": {
++        "@babel/core": "^7.0.0-0"
++      }
++    },
++    "node_modules/@babel/template": {
++      "version": "7.28.6",
++      "resolved": "https://registry.npmjs.org/@babel/template/-/template-7.28.6.tgz",
++      "integrity": "sha512-YA6Ma2KsCdGb+WC6UpBVFJGXL58MDA6oyONbjyF/+5sBgxY/dwkhLogbMT2GXXyU84/IhRw/2D1Os1B/giz+BQ==",
++      "dev": true,
++      "license": "MIT",
++      "dependencies": {
++        "@babel/code-frame": "^7.28.6",
++        "@babel/parser": "^7.28.6",
++        "@babel/types": "^7.28.6"
++      },
++      "engines": {
++        "node": ">=6.9.0"
++      }
++    },
++    "node_modules/@babel/traverse": {
++      "version": "7.28.6",
++      "resolved": "https://registry.npmjs.org/@babel/traverse/-/traverse-7.28.6.tgz",
++      "integrity": "sha512-fgWX62k02qtjqdSNTAGxmKYY/7FSL9WAS1o2Hu5+I5m9T0yxZzr4cnrfXQ/MX0rIifthCSs6FKTlzYbJcPtMNg==",
++      "dev": true,
++      "license": "MIT",
++      "dependencies": {
++        "@babel/code-frame": "^7.28.6",
++        "@babel/generator": "^7.28.6",
++        "@babel/helper-globals": "^7.28.0",
++        "@babel/parser": "^7.28.6",
++        "@babel/template": "^7.28.6",
++        "@babel/types": "^7.28.6",
++        "debug": "^4.3.1"
++      },
++      "engines": {
++        "node": ">=6.9.0"
++      }
++    },
++    "node_modules/@babel/types": {
++      "version": "7.28.6",
++      "resolved": "https://registry.npmjs.org/@babel/types/-/types-7.28.6.tgz",
++      "integrity": "sha512-0ZrskXVEHSWIqZM/sQZ4EV3jZJXRkio/WCxaqKZP1g//CEWEPSfeZFcms4XeKBCHU0ZKnIkdJeU/kF+eRp5lBg==",
++      "dev": true,
++      "license": "MIT",
++      "dependencies": {
++        "@babel/helper-string-parser": "^7.27.1",
++        "@babel/helper-validator-identifier": "^7.28.5"
++      },
++      "engines": {
++        "node": ">=6.9.0"
++      }
++    },
++    "node_modules/@esbuild/aix-ppc64": {
++      "version": "0.21.5",
++      "resolved": "https://registry.npmjs.org/@esbuild/aix-ppc64/-/aix-ppc64-0.21.5.tgz",
++      "integrity": "sha512-1SDgH6ZSPTlggy1yI6+Dbkiz8xzpHJEVAlF/AM1tHPLsf5STom9rwtjE4hKAF20FfXXNTFqEYXyJNWh1GiZedQ==",
++      "cpu": [
++        "ppc64"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "aix"
++      ],
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/@esbuild/android-arm": {
++      "version": "0.21.5",
++      "resolved": "https://registry.npmjs.org/@esbuild/android-arm/-/android-arm-0.21.5.tgz",
++      "integrity": "sha512-vCPvzSjpPHEi1siZdlvAlsPxXl7WbOVUBBAowWug4rJHb68Ox8KualB+1ocNvT5fjv6wpkX6o/iEpbDrf68zcg==",
++      "cpu": [
++        "arm"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "android"
++      ],
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/@esbuild/android-arm64": {
++      "version": "0.21.5",
++      "resolved": "https://registry.npmjs.org/@esbuild/android-arm64/-/android-arm64-0.21.5.tgz",
++      "integrity": "sha512-c0uX9VAUBQ7dTDCjq+wdyGLowMdtR/GoC2U5IYk/7D1H1JYC0qseD7+11iMP2mRLN9RcCMRcjC4YMclCzGwS/A==",
++      "cpu": [
++        "arm64"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "android"
++      ],
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/@esbuild/android-x64": {
++      "version": "0.21.5",
++      "resolved": "https://registry.npmjs.org/@esbuild/android-x64/-/android-x64-0.21.5.tgz",
++      "integrity": "sha512-D7aPRUUNHRBwHxzxRvp856rjUHRFW1SdQATKXH2hqA0kAZb1hKmi02OpYRacl0TxIGz/ZmXWlbZgjwWYaCakTA==",
++      "cpu": [
++        "x64"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "android"
++      ],
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/@esbuild/darwin-arm64": {
++      "version": "0.21.5",
++      "resolved": "https://registry.npmjs.org/@esbuild/darwin-arm64/-/darwin-arm64-0.21.5.tgz",
++      "integrity": "sha512-DwqXqZyuk5AiWWf3UfLiRDJ5EDd49zg6O9wclZ7kUMv2WRFr4HKjXp/5t8JZ11QbQfUS6/cRCKGwYhtNAY88kQ==",
++      "cpu": [
++        "arm64"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "darwin"
++      ],
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/@esbuild/darwin-x64": {
++      "version": "0.21.5",
++      "resolved": "https://registry.npmjs.org/@esbuild/darwin-x64/-/darwin-x64-0.21.5.tgz",
++      "integrity": "sha512-se/JjF8NlmKVG4kNIuyWMV/22ZaerB+qaSi5MdrXtd6R08kvs2qCN4C09miupktDitvh8jRFflwGFBQcxZRjbw==",
++      "cpu": [
++        "x64"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "darwin"
++      ],
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/@esbuild/freebsd-arm64": {
++      "version": "0.21.5",
++      "resolved": "https://registry.npmjs.org/@esbuild/freebsd-arm64/-/freebsd-arm64-0.21.5.tgz",
++      "integrity": "sha512-5JcRxxRDUJLX8JXp/wcBCy3pENnCgBR9bN6JsY4OmhfUtIHe3ZW0mawA7+RDAcMLrMIZaf03NlQiX9DGyB8h4g==",
++      "cpu": [
++        "arm64"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "freebsd"
++      ],
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/@esbuild/freebsd-x64": {
++      "version": "0.21.5",
++      "resolved": "https://registry.npmjs.org/@esbuild/freebsd-x64/-/freebsd-x64-0.21.5.tgz",
++      "integrity": "sha512-J95kNBj1zkbMXtHVH29bBriQygMXqoVQOQYA+ISs0/2l3T9/kj42ow2mpqerRBxDJnmkUDCaQT/dfNXWX/ZZCQ==",
++      "cpu": [
++        "x64"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "freebsd"
++      ],
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/@esbuild/linux-arm": {
++      "version": "0.21.5",
++      "resolved": "https://registry.npmjs.org/@esbuild/linux-arm/-/linux-arm-0.21.5.tgz",
++      "integrity": "sha512-bPb5AHZtbeNGjCKVZ9UGqGwo8EUu4cLq68E95A53KlxAPRmUyYv2D6F0uUI65XisGOL1hBP5mTronbgo+0bFcA==",
++      "cpu": [
++        "arm"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "linux"
++      ],
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/@esbuild/linux-arm64": {
++      "version": "0.21.5",
++      "resolved": "https://registry.npmjs.org/@esbuild/linux-arm64/-/linux-arm64-0.21.5.tgz",
++      "integrity": "sha512-ibKvmyYzKsBeX8d8I7MH/TMfWDXBF3db4qM6sy+7re0YXya+K1cem3on9XgdT2EQGMu4hQyZhan7TeQ8XkGp4Q==",
++      "cpu": [
++        "arm64"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "linux"
++      ],
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/@esbuild/linux-ia32": {
++      "version": "0.21.5",
++      "resolved": "https://registry.npmjs.org/@esbuild/linux-ia32/-/linux-ia32-0.21.5.tgz",
++      "integrity": "sha512-YvjXDqLRqPDl2dvRODYmmhz4rPeVKYvppfGYKSNGdyZkA01046pLWyRKKI3ax8fbJoK5QbxblURkwK/MWY18Tg==",
++      "cpu": [
++        "ia32"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "linux"
++      ],
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/@esbuild/linux-loong64": {
++      "version": "0.21.5",
++      "resolved": "https://registry.npmjs.org/@esbuild/linux-loong64/-/linux-loong64-0.21.5.tgz",
++      "integrity": "sha512-uHf1BmMG8qEvzdrzAqg2SIG/02+4/DHB6a9Kbya0XDvwDEKCoC8ZRWI5JJvNdUjtciBGFQ5PuBlpEOXQj+JQSg==",
++      "cpu": [
++        "loong64"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "linux"
++      ],
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/@esbuild/linux-mips64el": {
++      "version": "0.21.5",
++      "resolved": "https://registry.npmjs.org/@esbuild/linux-mips64el/-/linux-mips64el-0.21.5.tgz",
++      "integrity": "sha512-IajOmO+KJK23bj52dFSNCMsz1QP1DqM6cwLUv3W1QwyxkyIWecfafnI555fvSGqEKwjMXVLokcV5ygHW5b3Jbg==",
++      "cpu": [
++        "mips64el"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "linux"
++      ],
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/@esbuild/linux-ppc64": {
++      "version": "0.21.5",
++      "resolved": "https://registry.npmjs.org/@esbuild/linux-ppc64/-/linux-ppc64-0.21.5.tgz",
++      "integrity": "sha512-1hHV/Z4OEfMwpLO8rp7CvlhBDnjsC3CttJXIhBi+5Aj5r+MBvy4egg7wCbe//hSsT+RvDAG7s81tAvpL2XAE4w==",
++      "cpu": [
++        "ppc64"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "linux"
++      ],
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/@esbuild/linux-riscv64": {
++      "version": "0.21.5",
++      "resolved": "https://registry.npmjs.org/@esbuild/linux-riscv64/-/linux-riscv64-0.21.5.tgz",
++      "integrity": "sha512-2HdXDMd9GMgTGrPWnJzP2ALSokE/0O5HhTUvWIbD3YdjME8JwvSCnNGBnTThKGEB91OZhzrJ4qIIxk/SBmyDDA==",
++      "cpu": [
++        "riscv64"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "linux"
++      ],
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/@esbuild/linux-s390x": {
++      "version": "0.21.5",
++      "resolved": "https://registry.npmjs.org/@esbuild/linux-s390x/-/linux-s390x-0.21.5.tgz",
++      "integrity": "sha512-zus5sxzqBJD3eXxwvjN1yQkRepANgxE9lgOW2qLnmr8ikMTphkjgXu1HR01K4FJg8h1kEEDAqDcZQtbrRnB41A==",
++      "cpu": [
++        "s390x"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "linux"
++      ],
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/@esbuild/linux-x64": {
++      "version": "0.21.5",
++      "resolved": "https://registry.npmjs.org/@esbuild/linux-x64/-/linux-x64-0.21.5.tgz",
++      "integrity": "sha512-1rYdTpyv03iycF1+BhzrzQJCdOuAOtaqHTWJZCWvijKD2N5Xu0TtVC8/+1faWqcP9iBCWOmjmhoH94dH82BxPQ==",
++      "cpu": [
++        "x64"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "linux"
++      ],
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/@esbuild/netbsd-x64": {
++      "version": "0.21.5",
++      "resolved": "https://registry.npmjs.org/@esbuild/netbsd-x64/-/netbsd-x64-0.21.5.tgz",
++      "integrity": "sha512-Woi2MXzXjMULccIwMnLciyZH4nCIMpWQAs049KEeMvOcNADVxo0UBIQPfSmxB3CWKedngg7sWZdLvLczpe0tLg==",
++      "cpu": [
++        "x64"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "netbsd"
++      ],
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/@esbuild/openbsd-x64": {
++      "version": "0.21.5",
++      "resolved": "https://registry.npmjs.org/@esbuild/openbsd-x64/-/openbsd-x64-0.21.5.tgz",
++      "integrity": "sha512-HLNNw99xsvx12lFBUwoT8EVCsSvRNDVxNpjZ7bPn947b8gJPzeHWyNVhFsaerc0n3TsbOINvRP2byTZ5LKezow==",
++      "cpu": [
++        "x64"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "openbsd"
++      ],
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/@esbuild/sunos-x64": {
++      "version": "0.21.5",
++      "resolved": "https://registry.npmjs.org/@esbuild/sunos-x64/-/sunos-x64-0.21.5.tgz",
++      "integrity": "sha512-6+gjmFpfy0BHU5Tpptkuh8+uw3mnrvgs+dSPQXQOv3ekbordwnzTVEb4qnIvQcYXq6gzkyTnoZ9dZG+D4garKg==",
++      "cpu": [
++        "x64"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "sunos"
++      ],
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/@esbuild/win32-arm64": {
++      "version": "0.21.5",
++      "resolved": "https://registry.npmjs.org/@esbuild/win32-arm64/-/win32-arm64-0.21.5.tgz",
++      "integrity": "sha512-Z0gOTd75VvXqyq7nsl93zwahcTROgqvuAcYDUr+vOv8uHhNSKROyU961kgtCD1e95IqPKSQKH7tBTslnS3tA8A==",
++      "cpu": [
++        "arm64"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "win32"
++      ],
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/@esbuild/win32-ia32": {
++      "version": "0.21.5",
++      "resolved": "https://registry.npmjs.org/@esbuild/win32-ia32/-/win32-ia32-0.21.5.tgz",
++      "integrity": "sha512-SWXFF1CL2RVNMaVs+BBClwtfZSvDgtL//G/smwAc5oVK/UPu2Gu9tIaRgFmYFFKrmg3SyAjSrElf0TiJ1v8fYA==",
++      "cpu": [
++        "ia32"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "win32"
++      ],
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/@esbuild/win32-x64": {
++      "version": "0.21.5",
++      "resolved": "https://registry.npmjs.org/@esbuild/win32-x64/-/win32-x64-0.21.5.tgz",
++      "integrity": "sha512-tQd/1efJuzPC6rCFwEvLtci/xNFcTZknmXs98FYDfGE4wP9ClFV98nyKrzJKVPMhdDnjzLhdUyMX4PsQAPjwIw==",
++      "cpu": [
++        "x64"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "win32"
++      ],
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/@jridgewell/gen-mapping": {
++      "version": "0.3.13",
++      "resolved": "https://registry.npmjs.org/@jridgewell/gen-mapping/-/gen-mapping-0.3.13.tgz",
++      "integrity": "sha512-2kkt/7niJ6MgEPxF0bYdQ6etZaA+fQvDcLKckhy1yIQOzaoKjBBjSj63/aLVjYE3qhRt5dvM+uUyfCg6UKCBbA==",
++      "dev": true,
++      "license": "MIT",
++      "dependencies": {
++        "@jridgewell/sourcemap-codec": "^1.5.0",
++        "@jridgewell/trace-mapping": "^0.3.24"
++      }
++    },
++    "node_modules/@jridgewell/remapping": {
++      "version": "2.3.5",
++      "resolved": "https://registry.npmjs.org/@jridgewell/remapping/-/remapping-2.3.5.tgz",
++      "integrity": "sha512-LI9u/+laYG4Ds1TDKSJW2YPrIlcVYOwi2fUC6xB43lueCjgxV4lffOCZCtYFiH6TNOX+tQKXx97T4IKHbhyHEQ==",
++      "dev": true,
++      "license": "MIT",
++      "dependencies": {
++        "@jridgewell/gen-mapping": "^0.3.5",
++        "@jridgewell/trace-mapping": "^0.3.24"
++      }
++    },
++    "node_modules/@jridgewell/resolve-uri": {
++      "version": "3.1.2",
++      "resolved": "https://registry.npmjs.org/@jridgewell/resolve-uri/-/resolve-uri-3.1.2.tgz",
++      "integrity": "sha512-bRISgCIjP20/tbWSPWMEi54QVPRZExkuD9lJL+UIxUKtwVJA8wW1Trb1jMs1RFXo1CBTNZ/5hpC9QvmKWdopKw==",
++      "dev": true,
++      "license": "MIT",
++      "engines": {
++        "node": ">=6.0.0"
++      }
++    },
++    "node_modules/@jridgewell/sourcemap-codec": {
++      "version": "1.5.5",
++      "resolved": "https://registry.npmjs.org/@jridgewell/sourcemap-codec/-/sourcemap-codec-1.5.5.tgz",
++      "integrity": "sha512-cYQ9310grqxueWbl+WuIUIaiUaDcj7WOq5fVhEljNVgRfOUhY9fy2zTvfoqWsnebh8Sl70VScFbICvJnLKB0Og==",
++      "dev": true,
++      "license": "MIT"
++    },
++    "node_modules/@jridgewell/trace-mapping": {
++      "version": "0.3.31",
++      "resolved": "https://registry.npmjs.org/@jridgewell/trace-mapping/-/trace-mapping-0.3.31.tgz",
++      "integrity": "sha512-zzNR+SdQSDJzc8joaeP8QQoCQr8NuYx2dIIytl1QeBEZHJ9uW6hebsrYgbz8hJwUQao3TWCMtmfV8Nu1twOLAw==",
++      "dev": true,
++      "license": "MIT",
++      "dependencies": {
++        "@jridgewell/resolve-uri": "^3.1.0",
++        "@jridgewell/sourcemap-codec": "^1.4.14"
++      }
++    },
++    "node_modules/@rolldown/pluginutils": {
++      "version": "1.0.0-beta.27",
++      "resolved": "https://registry.npmjs.org/@rolldown/pluginutils/-/pluginutils-1.0.0-beta.27.tgz",
++      "integrity": "sha512-+d0F4MKMCbeVUJwG96uQ4SgAznZNSq93I3V+9NHA4OpvqG8mRCpGdKmK8l/dl02h2CCDHwW2FqilnTyDcAnqjA==",
++      "dev": true,
++      "license": "MIT"
++    },
++    "node_modules/@rollup/rollup-android-arm-eabi": {
++      "version": "4.56.0",
++      "resolved": "https://registry.npmjs.org/@rollup/rollup-android-arm-eabi/-/rollup-android-arm-eabi-4.56.0.tgz",
++      "integrity": "sha512-LNKIPA5k8PF1+jAFomGe3qN3bbIgJe/IlpDBwuVjrDKrJhVWywgnJvflMt/zkbVNLFtF1+94SljYQS6e99klnw==",
++      "cpu": [
++        "arm"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "android"
++      ]
++    },
++    "node_modules/@rollup/rollup-android-arm64": {
++      "version": "4.56.0",
++      "resolved": "https://registry.npmjs.org/@rollup/rollup-android-arm64/-/rollup-android-arm64-4.56.0.tgz",
++      "integrity": "sha512-lfbVUbelYqXlYiU/HApNMJzT1E87UPGvzveGg2h0ktUNlOCxKlWuJ9jtfvs1sKHdwU4fzY7Pl8sAl49/XaEk6Q==",
++      "cpu": [
++        "arm64"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "android"
++      ]
++    },
++    "node_modules/@rollup/rollup-darwin-arm64": {
++      "version": "4.56.0",
++      "resolved": "https://registry.npmjs.org/@rollup/rollup-darwin-arm64/-/rollup-darwin-arm64-4.56.0.tgz",
++      "integrity": "sha512-EgxD1ocWfhoD6xSOeEEwyE7tDvwTgZc8Bss7wCWe+uc7wO8G34HHCUH+Q6cHqJubxIAnQzAsyUsClt0yFLu06w==",
++      "cpu": [
++        "arm64"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "darwin"
++      ]
++    },
++    "node_modules/@rollup/rollup-darwin-x64": {
++      "version": "4.56.0",
++      "resolved": "https://registry.npmjs.org/@rollup/rollup-darwin-x64/-/rollup-darwin-x64-4.56.0.tgz",
++      "integrity": "sha512-1vXe1vcMOssb/hOF8iv52A7feWW2xnu+c8BV4t1F//m9QVLTfNVpEdja5ia762j/UEJe2Z1jAmEqZAK42tVW3g==",
++      "cpu": [
++        "x64"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "darwin"
++      ]
++    },
++    "node_modules/@rollup/rollup-freebsd-arm64": {
++      "version": "4.56.0",
++      "resolved": "https://registry.npmjs.org/@rollup/rollup-freebsd-arm64/-/rollup-freebsd-arm64-4.56.0.tgz",
++      "integrity": "sha512-bof7fbIlvqsyv/DtaXSck4VYQ9lPtoWNFCB/JY4snlFuJREXfZnm+Ej6yaCHfQvofJDXLDMTVxWscVSuQvVWUQ==",
++      "cpu": [
++        "arm64"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "freebsd"
++      ]
++    },
++    "node_modules/@rollup/rollup-freebsd-x64": {
++      "version": "4.56.0",
++      "resolved": "https://registry.npmjs.org/@rollup/rollup-freebsd-x64/-/rollup-freebsd-x64-4.56.0.tgz",
++      "integrity": "sha512-KNa6lYHloW+7lTEkYGa37fpvPq+NKG/EHKM8+G/g9WDU7ls4sMqbVRV78J6LdNuVaeeK5WB9/9VAFbKxcbXKYg==",
++      "cpu": [
++        "x64"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "freebsd"
++      ]
++    },
++    "node_modules/@rollup/rollup-linux-arm-gnueabihf": {
++      "version": "4.56.0",
++      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-arm-gnueabihf/-/rollup-linux-arm-gnueabihf-4.56.0.tgz",
++      "integrity": "sha512-E8jKK87uOvLrrLN28jnAAAChNq5LeCd2mGgZF+fGF5D507WlG/Noct3lP/QzQ6MrqJ5BCKNwI9ipADB6jyiq2A==",
++      "cpu": [
++        "arm"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "linux"
++      ]
++    },
++    "node_modules/@rollup/rollup-linux-arm-musleabihf": {
++      "version": "4.56.0",
++      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-arm-musleabihf/-/rollup-linux-arm-musleabihf-4.56.0.tgz",
++      "integrity": "sha512-jQosa5FMYF5Z6prEpTCCmzCXz6eKr/tCBssSmQGEeozA9tkRUty/5Vx06ibaOP9RCrW1Pvb8yp3gvZhHwTDsJw==",
++      "cpu": [
++        "arm"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "linux"
++      ]
++    },
++    "node_modules/@rollup/rollup-linux-arm64-gnu": {
++      "version": "4.56.0",
++      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-arm64-gnu/-/rollup-linux-arm64-gnu-4.56.0.tgz",
++      "integrity": "sha512-uQVoKkrC1KGEV6udrdVahASIsaF8h7iLG0U0W+Xn14ucFwi6uS539PsAr24IEF9/FoDtzMeeJXJIBo5RkbNWvQ==",
++      "cpu": [
++        "arm64"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "linux"
++      ]
++    },
++    "node_modules/@rollup/rollup-linux-arm64-musl": {
++      "version": "4.56.0",
++      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-arm64-musl/-/rollup-linux-arm64-musl-4.56.0.tgz",
++      "integrity": "sha512-vLZ1yJKLxhQLFKTs42RwTwa6zkGln+bnXc8ueFGMYmBTLfNu58sl5/eXyxRa2RarTkJbXl8TKPgfS6V5ijNqEA==",
++      "cpu": [
++        "arm64"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "linux"
++      ]
++    },
++    "node_modules/@rollup/rollup-linux-loong64-gnu": {
++      "version": "4.56.0",
++      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-loong64-gnu/-/rollup-linux-loong64-gnu-4.56.0.tgz",
++      "integrity": "sha512-FWfHOCub564kSE3xJQLLIC/hbKqHSVxy8vY75/YHHzWvbJL7aYJkdgwD/xGfUlL5UV2SB7otapLrcCj2xnF1dg==",
++      "cpu": [
++        "loong64"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "linux"
++      ]
++    },
++    "node_modules/@rollup/rollup-linux-loong64-musl": {
++      "version": "4.56.0",
++      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-loong64-musl/-/rollup-linux-loong64-musl-4.56.0.tgz",
++      "integrity": "sha512-z1EkujxIh7nbrKL1lmIpqFTc/sr0u8Uk0zK/qIEFldbt6EDKWFk/pxFq3gYj4Bjn3aa9eEhYRlL3H8ZbPT1xvA==",
++      "cpu": [
++        "loong64"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "linux"
++      ]
++    },
++    "node_modules/@rollup/rollup-linux-ppc64-gnu": {
++      "version": "4.56.0",
++      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-ppc64-gnu/-/rollup-linux-ppc64-gnu-4.56.0.tgz",
++      "integrity": "sha512-iNFTluqgdoQC7AIE8Q34R3AuPrJGJirj5wMUErxj22deOcY7XwZRaqYmB6ZKFHoVGqRcRd0mqO+845jAibKCkw==",
++      "cpu": [
++        "ppc64"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "linux"
++      ]
++    },
++    "node_modules/@rollup/rollup-linux-ppc64-musl": {
++      "version": "4.56.0",
++      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-ppc64-musl/-/rollup-linux-ppc64-musl-4.56.0.tgz",
++      "integrity": "sha512-MtMeFVlD2LIKjp2sE2xM2slq3Zxf9zwVuw0jemsxvh1QOpHSsSzfNOTH9uYW9i1MXFxUSMmLpeVeUzoNOKBaWg==",
++      "cpu": [
++        "ppc64"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "linux"
++      ]
++    },
++    "node_modules/@rollup/rollup-linux-riscv64-gnu": {
++      "version": "4.56.0",
++      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-riscv64-gnu/-/rollup-linux-riscv64-gnu-4.56.0.tgz",
++      "integrity": "sha512-in+v6wiHdzzVhYKXIk5U74dEZHdKN9KH0Q4ANHOTvyXPG41bajYRsy7a8TPKbYPl34hU7PP7hMVHRvv/5aCSew==",
++      "cpu": [
++        "riscv64"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "linux"
++      ]
++    },
++    "node_modules/@rollup/rollup-linux-riscv64-musl": {
++      "version": "4.56.0",
++      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-riscv64-musl/-/rollup-linux-riscv64-musl-4.56.0.tgz",
++      "integrity": "sha512-yni2raKHB8m9NQpI9fPVwN754mn6dHQSbDTwxdr9SE0ks38DTjLMMBjrwvB5+mXrX+C0npX0CVeCUcvvvD8CNQ==",
++      "cpu": [
++        "riscv64"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "linux"
++      ]
++    },
++    "node_modules/@rollup/rollup-linux-s390x-gnu": {
++      "version": "4.56.0",
++      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-s390x-gnu/-/rollup-linux-s390x-gnu-4.56.0.tgz",
++      "integrity": "sha512-zhLLJx9nQPu7wezbxt2ut+CI4YlXi68ndEve16tPc/iwoylWS9B3FxpLS2PkmfYgDQtosah07Mj9E0khc3Y+vQ==",
++      "cpu": [
++        "s390x"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "linux"
++      ]
++    },
++    "node_modules/@rollup/rollup-linux-x64-gnu": {
++      "version": "4.56.0",
++      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-x64-gnu/-/rollup-linux-x64-gnu-4.56.0.tgz",
++      "integrity": "sha512-MVC6UDp16ZSH7x4rtuJPAEoE1RwS8N4oK9DLHy3FTEdFoUTCFVzMfJl/BVJ330C+hx8FfprA5Wqx4FhZXkj2Kw==",
++      "cpu": [
++        "x64"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "linux"
++      ]
++    },
++    "node_modules/@rollup/rollup-linux-x64-musl": {
++      "version": "4.56.0",
++      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-x64-musl/-/rollup-linux-x64-musl-4.56.0.tgz",
++      "integrity": "sha512-ZhGH1eA4Qv0lxaV00azCIS1ChedK0V32952Md3FtnxSqZTBTd6tgil4nZT5cU8B+SIw3PFYkvyR4FKo2oyZIHA==",
++      "cpu": [
++        "x64"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "linux"
++      ]
++    },
++    "node_modules/@rollup/rollup-openbsd-x64": {
++      "version": "4.56.0",
++      "resolved": "https://registry.npmjs.org/@rollup/rollup-openbsd-x64/-/rollup-openbsd-x64-4.56.0.tgz",
++      "integrity": "sha512-O16XcmyDeFI9879pEcmtWvD/2nyxR9mF7Gs44lf1vGGx8Vg2DRNx11aVXBEqOQhWb92WN4z7fW/q4+2NYzCbBA==",
++      "cpu": [
++        "x64"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "openbsd"
++      ]
++    },
++    "node_modules/@rollup/rollup-openharmony-arm64": {
++      "version": "4.56.0",
++      "resolved": "https://registry.npmjs.org/@rollup/rollup-openharmony-arm64/-/rollup-openharmony-arm64-4.56.0.tgz",
++      "integrity": "sha512-LhN/Reh+7F3RCgQIRbgw8ZMwUwyqJM+8pXNT6IIJAqm2IdKkzpCh/V9EdgOMBKuebIrzswqy4ATlrDgiOwbRcQ==",
++      "cpu": [
++        "arm64"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "openharmony"
++      ]
++    },
++    "node_modules/@rollup/rollup-win32-arm64-msvc": {
++      "version": "4.56.0",
++      "resolved": "https://registry.npmjs.org/@rollup/rollup-win32-arm64-msvc/-/rollup-win32-arm64-msvc-4.56.0.tgz",
++      "integrity": "sha512-kbFsOObXp3LBULg1d3JIUQMa9Kv4UitDmpS+k0tinPBz3watcUiV2/LUDMMucA6pZO3WGE27P7DsfaN54l9ing==",
++      "cpu": [
++        "arm64"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "win32"
++      ]
++    },
++    "node_modules/@rollup/rollup-win32-ia32-msvc": {
++      "version": "4.56.0",
++      "resolved": "https://registry.npmjs.org/@rollup/rollup-win32-ia32-msvc/-/rollup-win32-ia32-msvc-4.56.0.tgz",
++      "integrity": "sha512-vSSgny54D6P4vf2izbtFm/TcWYedw7f8eBrOiGGecyHyQB9q4Kqentjaj8hToe+995nob/Wv48pDqL5a62EWtg==",
++      "cpu": [
++        "ia32"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "win32"
++      ]
++    },
++    "node_modules/@rollup/rollup-win32-x64-gnu": {
++      "version": "4.56.0",
++      "resolved": "https://registry.npmjs.org/@rollup/rollup-win32-x64-gnu/-/rollup-win32-x64-gnu-4.56.0.tgz",
++      "integrity": "sha512-FeCnkPCTHQJFbiGG49KjV5YGW/8b9rrXAM2Mz2kiIoktq2qsJxRD5giEMEOD2lPdgs72upzefaUvS+nc8E3UzQ==",
++      "cpu": [
++        "x64"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "win32"
++      ]
++    },
++    "node_modules/@rollup/rollup-win32-x64-msvc": {
++      "version": "4.56.0",
++      "resolved": "https://registry.npmjs.org/@rollup/rollup-win32-x64-msvc/-/rollup-win32-x64-msvc-4.56.0.tgz",
++      "integrity": "sha512-H8AE9Ur/t0+1VXujj90w0HrSOuv0Nq9r1vSZF2t5km20NTfosQsGGUXDaKdQZzwuLts7IyL1fYT4hM95TI9c4g==",
++      "cpu": [
++        "x64"
++      ],
++      "dev": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "win32"
++      ]
++    },
++    "node_modules/@types/babel__core": {
++      "version": "7.20.5",
++      "resolved": "https://registry.npmjs.org/@types/babel__core/-/babel__core-7.20.5.tgz",
++      "integrity": "sha512-qoQprZvz5wQFJwMDqeseRXWv3rqMvhgpbXFfVyWhbx9X47POIA6i/+dXefEmZKoAgOaTdaIgNSMqMIU61yRyzA==",
++      "dev": true,
++      "license": "MIT",
++      "dependencies": {
++        "@babel/parser": "^7.20.7",
++        "@babel/types": "^7.20.7",
++        "@types/babel__generator": "*",
++        "@types/babel__template": "*",
++        "@types/babel__traverse": "*"
++      }
++    },
++    "node_modules/@types/babel__generator": {
++      "version": "7.27.0",
++      "resolved": "https://registry.npmjs.org/@types/babel__generator/-/babel__generator-7.27.0.tgz",
++      "integrity": "sha512-ufFd2Xi92OAVPYsy+P4n7/U7e68fex0+Ee8gSG9KX7eo084CWiQ4sdxktvdl0bOPupXtVJPY19zk6EwWqUQ8lg==",
++      "dev": true,
++      "license": "MIT",
++      "dependencies": {
++        "@babel/types": "^7.0.0"
++      }
++    },
++    "node_modules/@types/babel__template": {
++      "version": "7.4.4",
++      "resolved": "https://registry.npmjs.org/@types/babel__template/-/babel__template-7.4.4.tgz",
++      "integrity": "sha512-h/NUaSyG5EyxBIp8YRxo4RMe2/qQgvyowRwVMzhYhBCONbW8PUsg4lkFMrhgZhUe5z3L3MiLDuvyJ/CaPa2A8A==",
++      "dev": true,
++      "license": "MIT",
++      "dependencies": {
++        "@babel/parser": "^7.1.0",
++        "@babel/types": "^7.0.0"
++      }
++    },
++    "node_modules/@types/babel__traverse": {
++      "version": "7.28.0",
++      "resolved": "https://registry.npmjs.org/@types/babel__traverse/-/babel__traverse-7.28.0.tgz",
++      "integrity": "sha512-8PvcXf70gTDZBgt9ptxJ8elBeBjcLOAcOtoO/mPJjtji1+CdGbHgm77om1GrsPxsiE+uXIpNSK64UYaIwQXd4Q==",
++      "dev": true,
++      "license": "MIT",
++      "dependencies": {
++        "@babel/types": "^7.28.2"
++      }
++    },
++    "node_modules/@types/estree": {
++      "version": "1.0.8",
++      "resolved": "https://registry.npmjs.org/@types/estree/-/estree-1.0.8.tgz",
++      "integrity": "sha512-dWHzHa2WqEXI/O1E9OjrocMTKJl2mSrEolh1Iomrv6U+JuNwaHXsXx9bLu5gG7BUWFIN0skIQJQ/L1rIex4X6w==",
++      "dev": true,
++      "license": "MIT"
++    },
++    "node_modules/@types/prop-types": {
++      "version": "15.7.15",
++      "resolved": "https://registry.npmjs.org/@types/prop-types/-/prop-types-15.7.15.tgz",
++      "integrity": "sha512-F6bEyamV9jKGAFBEmlQnesRPGOQqS2+Uwi0Em15xenOxHaf2hv6L8YCVn3rPdPJOiJfPiCnLIRyvwVaqMY3MIw==",
++      "dev": true,
++      "license": "MIT"
++    },
++    "node_modules/@types/react": {
++      "version": "18.3.27",
++      "resolved": "https://registry.npmjs.org/@types/react/-/react-18.3.27.tgz",
++      "integrity": "sha512-cisd7gxkzjBKU2GgdYrTdtQx1SORymWyaAFhaxQPK9bYO9ot3Y5OikQRvY0VYQtvwjeQnizCINJAenh/V7MK2w==",
++      "dev": true,
++      "license": "MIT",
++      "dependencies": {
++        "@types/prop-types": "*",
++        "csstype": "^3.2.2"
++      }
++    },
++    "node_modules/@types/react-dom": {
++      "version": "18.3.7",
++      "resolved": "https://registry.npmjs.org/@types/react-dom/-/react-dom-18.3.7.tgz",
++      "integrity": "sha512-MEe3UeoENYVFXzoXEWsvcpg6ZvlrFNlOQ7EOsvhI3CfAXwzPfO8Qwuxd40nepsYKqyyVQnTdEfv68q91yLcKrQ==",
++      "dev": true,
++      "license": "MIT",
++      "peerDependencies": {
++        "@types/react": "^18.0.0"
++      }
++    },
++    "node_modules/@vitejs/plugin-react": {
++      "version": "4.7.0",
++      "resolved": "https://registry.npmjs.org/@vitejs/plugin-react/-/plugin-react-4.7.0.tgz",
++      "integrity": "sha512-gUu9hwfWvvEDBBmgtAowQCojwZmJ5mcLn3aufeCsitijs3+f2NsrPtlAWIR6OPiqljl96GVCUbLe0HyqIpVaoA==",
++      "dev": true,
++      "license": "MIT",
++      "dependencies": {
++        "@babel/core": "^7.28.0",
++        "@babel/plugin-transform-react-jsx-self": "^7.27.1",
++        "@babel/plugin-transform-react-jsx-source": "^7.27.1",
++        "@rolldown/pluginutils": "1.0.0-beta.27",
++        "@types/babel__core": "^7.20.5",
++        "react-refresh": "^0.17.0"
++      },
++      "engines": {
++        "node": "^14.18.0 || >=16.0.0"
++      },
++      "peerDependencies": {
++        "vite": "^4.2.0 || ^5.0.0 || ^6.0.0 || ^7.0.0"
++      }
++    },
++    "node_modules/baseline-browser-mapping": {
++      "version": "2.9.17",
++      "resolved": "https://registry.npmjs.org/baseline-browser-mapping/-/baseline-browser-mapping-2.9.17.tgz",
++      "integrity": "sha512-agD0MgJFUP/4nvjqzIB29zRPUuCF7Ge6mEv9s8dHrtYD7QWXRcx75rOADE/d5ah1NI+0vkDl0yorDd5U852IQQ==",
++      "dev": true,
++      "license": "Apache-2.0",
++      "bin": {
++        "baseline-browser-mapping": "dist/cli.js"
++      }
++    },
++    "node_modules/browserslist": {
++      "version": "4.28.1",
++      "resolved": "https://registry.npmjs.org/browserslist/-/browserslist-4.28.1.tgz",
++      "integrity": "sha512-ZC5Bd0LgJXgwGqUknZY/vkUQ04r8NXnJZ3yYi4vDmSiZmC/pdSN0NbNRPxZpbtO4uAfDUAFffO8IZoM3Gj8IkA==",
++      "dev": true,
++      "funding": [
++        {
++          "type": "opencollective",
++          "url": "https://opencollective.com/browserslist"
++        },
++        {
++          "type": "tidelift",
++          "url": "https://tidelift.com/funding/github/npm/browserslist"
++        },
++        {
++          "type": "github",
++          "url": "https://github.com/sponsors/ai"
++        }
++      ],
++      "license": "MIT",
++      "dependencies": {
++        "baseline-browser-mapping": "^2.9.0",
++        "caniuse-lite": "^1.0.30001759",
++        "electron-to-chromium": "^1.5.263",
++        "node-releases": "^2.0.27",
++        "update-browserslist-db": "^1.2.0"
++      },
++      "bin": {
++        "browserslist": "cli.js"
++      },
++      "engines": {
++        "node": "^6 || ^7 || ^8 || ^9 || ^10 || ^11 || ^12 || >=13.7"
++      }
++    },
++    "node_modules/caniuse-lite": {
++      "version": "1.0.30001765",
++      "resolved": "https://registry.npmjs.org/caniuse-lite/-/caniuse-lite-1.0.30001765.tgz",
++      "integrity": "sha512-LWcNtSyZrakjECqmpP4qdg0MMGdN368D7X8XvvAqOcqMv0RxnlqVKZl2V6/mBR68oYMxOZPLw/gO7DuisMHUvQ==",
++      "dev": true,
++      "funding": [
++        {
++          "type": "opencollective",
++          "url": "https://opencollective.com/browserslist"
++        },
++        {
++          "type": "tidelift",
++          "url": "https://tidelift.com/funding/github/npm/caniuse-lite"
++        },
++        {
++          "type": "github",
++          "url": "https://github.com/sponsors/ai"
++        }
++      ],
++      "license": "CC-BY-4.0"
++    },
++    "node_modules/convert-source-map": {
++      "version": "2.0.0",
++      "resolved": "https://registry.npmjs.org/convert-source-map/-/convert-source-map-2.0.0.tgz",
++      "integrity": "sha512-Kvp459HrV2FEJ1CAsi1Ku+MY3kasH19TFykTz2xWmMeq6bk2NU3XXvfJ+Q61m0xktWwt+1HSYf3JZsTms3aRJg==",
++      "dev": true,
++      "license": "MIT"
++    },
++    "node_modules/csstype": {
++      "version": "3.2.3",
++      "resolved": "https://registry.npmjs.org/csstype/-/csstype-3.2.3.tgz",
++      "integrity": "sha512-z1HGKcYy2xA8AGQfwrn0PAy+PB7X/GSj3UVJW9qKyn43xWa+gl5nXmU4qqLMRzWVLFC8KusUX8T/0kCiOYpAIQ==",
++      "dev": true,
++      "license": "MIT"
++    },
++    "node_modules/debug": {
++      "version": "4.4.3",
++      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
++      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
++      "dev": true,
++      "license": "MIT",
++      "dependencies": {
++        "ms": "^2.1.3"
++      },
++      "engines": {
++        "node": ">=6.0"
++      },
++      "peerDependenciesMeta": {
++        "supports-color": {
++          "optional": true
++        }
++      }
++    },
++    "node_modules/electron-to-chromium": {
++      "version": "1.5.267",
++      "resolved": "https://registry.npmjs.org/electron-to-chromium/-/electron-to-chromium-1.5.267.tgz",
++      "integrity": "sha512-0Drusm6MVRXSOJpGbaSVgcQsuB4hEkMpHXaVstcPmhu5LIedxs1xNK/nIxmQIU/RPC0+1/o0AVZfBTkTNJOdUw==",
++      "dev": true,
++      "license": "ISC"
++    },
++    "node_modules/esbuild": {
++      "version": "0.21.5",
++      "resolved": "https://registry.npmjs.org/esbuild/-/esbuild-0.21.5.tgz",
++      "integrity": "sha512-mg3OPMV4hXywwpoDxu3Qda5xCKQi+vCTZq8S9J/EpkhB2HzKXq4SNFZE3+NK93JYxc8VMSep+lOUSC/RVKaBqw==",
++      "dev": true,
++      "hasInstallScript": true,
++      "license": "MIT",
++      "bin": {
++        "esbuild": "bin/esbuild"
++      },
++      "engines": {
++        "node": ">=12"
++      },
++      "optionalDependencies": {
++        "@esbuild/aix-ppc64": "0.21.5",
++        "@esbuild/android-arm": "0.21.5",
++        "@esbuild/android-arm64": "0.21.5",
++        "@esbuild/android-x64": "0.21.5",
++        "@esbuild/darwin-arm64": "0.21.5",
++        "@esbuild/darwin-x64": "0.21.5",
++        "@esbuild/freebsd-arm64": "0.21.5",
++        "@esbuild/freebsd-x64": "0.21.5",
++        "@esbuild/linux-arm": "0.21.5",
++        "@esbuild/linux-arm64": "0.21.5",
++        "@esbuild/linux-ia32": "0.21.5",
++        "@esbuild/linux-loong64": "0.21.5",
++        "@esbuild/linux-mips64el": "0.21.5",
++        "@esbuild/linux-ppc64": "0.21.5",
++        "@esbuild/linux-riscv64": "0.21.5",
++        "@esbuild/linux-s390x": "0.21.5",
++        "@esbuild/linux-x64": "0.21.5",
++        "@esbuild/netbsd-x64": "0.21.5",
++        "@esbuild/openbsd-x64": "0.21.5",
++        "@esbuild/sunos-x64": "0.21.5",
++        "@esbuild/win32-arm64": "0.21.5",
++        "@esbuild/win32-ia32": "0.21.5",
++        "@esbuild/win32-x64": "0.21.5"
++      }
++    },
++    "node_modules/escalade": {
++      "version": "3.2.0",
++      "resolved": "https://registry.npmjs.org/escalade/-/escalade-3.2.0.tgz",
++      "integrity": "sha512-WUj2qlxaQtO4g6Pq5c29GTcWGDyd8itL8zTlipgECz3JesAiiOKotd8JU6otB3PACgG6xkJUyVhboMS+bje/jA==",
++      "dev": true,
++      "license": "MIT",
++      "engines": {
++        "node": ">=6"
++      }
++    },
++    "node_modules/fsevents": {
++      "version": "2.3.3",
++      "resolved": "https://registry.npmjs.org/fsevents/-/fsevents-2.3.3.tgz",
++      "integrity": "sha512-5xoDfX+fL7faATnagmWPpbFtwh/R77WmMMqqHGS65C3vvB0YHrgF+B1YmZ3441tMj5n63k0212XNoJwzlhffQw==",
++      "dev": true,
++      "hasInstallScript": true,
++      "license": "MIT",
++      "optional": true,
++      "os": [
++        "darwin"
++      ],
++      "engines": {
++        "node": "^8.16.0 || ^10.6.0 || >=11.0.0"
++      }
++    },
++    "node_modules/gensync": {
++      "version": "1.0.0-beta.2",
++      "resolved": "https://registry.npmjs.org/gensync/-/gensync-1.0.0-beta.2.tgz",
++      "integrity": "sha512-3hN7NaskYvMDLQY55gnW3NQ+mesEAepTqlg+VEbj7zzqEMBVNhzcGYYeqFo/TlYz6eQiFcp1HcsCZO+nGgS8zg==",
++      "dev": true,
++      "license": "MIT",
++      "engines": {
++        "node": ">=6.9.0"
++      }
++    },
++    "node_modules/js-tokens": {
++      "version": "4.0.0",
++      "resolved": "https://registry.npmjs.org/js-tokens/-/js-tokens-4.0.0.tgz",
++      "integrity": "sha512-RdJUflcE3cUzKiMqQgsCu06FPu9UdIJO0beYbPhHN4k6apgJtifcoCtT9bcxOpYBtpD2kCM6Sbzg4CausW/PKQ==",
++      "license": "MIT"
++    },
++    "node_modules/jsesc": {
++      "version": "3.1.0",
++      "resolved": "https://registry.npmjs.org/jsesc/-/jsesc-3.1.0.tgz",
++      "integrity": "sha512-/sM3dO2FOzXjKQhJuo0Q173wf2KOo8t4I8vHy6lF9poUp7bKT0/NHE8fPX23PwfhnykfqnC2xRxOnVw5XuGIaA==",
++      "dev": true,
++      "license": "MIT",
++      "bin": {
++        "jsesc": "bin/jsesc"
++      },
++      "engines": {
++        "node": ">=6"
++      }
++    },
++    "node_modules/json5": {
++      "version": "2.2.3",
++      "resolved": "https://registry.npmjs.org/json5/-/json5-2.2.3.tgz",
++      "integrity": "sha512-XmOWe7eyHYH14cLdVPoyg+GOH3rYX++KpzrylJwSW98t3Nk+U8XOl8FWKOgwtzdb8lXGf6zYwDUzeHMWfxasyg==",
++      "dev": true,
++      "license": "MIT",
++      "bin": {
++        "json5": "lib/cli.js"
++      },
++      "engines": {
++        "node": ">=6"
++      }
++    },
++    "node_modules/loose-envify": {
++      "version": "1.4.0",
++      "resolved": "https://registry.npmjs.org/loose-envify/-/loose-envify-1.4.0.tgz",
++      "integrity": "sha512-lyuxPGr/Wfhrlem2CL/UcnUc1zcqKAImBDzukY7Y5F/yQiNdko6+fRLevlw1HgMySw7f611UIY408EtxRSoK3Q==",
++      "license": "MIT",
++      "dependencies": {
++        "js-tokens": "^3.0.0 || ^4.0.0"
++      },
++      "bin": {
++        "loose-envify": "cli.js"
++      }
++    },
++    "node_modules/lru-cache": {
++      "version": "5.1.1",
++      "resolved": "https://registry.npmjs.org/lru-cache/-/lru-cache-5.1.1.tgz",
++      "integrity": "sha512-KpNARQA3Iwv+jTA0utUVVbrh+Jlrr1Fv0e56GGzAFOXN7dk/FviaDW8LHmK52DlcH4WP2n6gI8vN1aesBFgo9w==",
++      "dev": true,
++      "license": "ISC",
++      "dependencies": {
++        "yallist": "^3.0.2"
++      }
++    },
++    "node_modules/ms": {
++      "version": "2.1.3",
++      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
++      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
++      "dev": true,
++      "license": "MIT"
++    },
++    "node_modules/nanoid": {
++      "version": "3.3.11",
++      "resolved": "https://registry.npmjs.org/nanoid/-/nanoid-3.3.11.tgz",
++      "integrity": "sha512-N8SpfPUnUp1bK+PMYW8qSWdl9U+wwNWI4QKxOYDy9JAro3WMX7p2OeVRF9v+347pnakNevPmiHhNmZ2HbFA76w==",
++      "dev": true,
++      "funding": [
++        {
++          "type": "github",
++          "url": "https://github.com/sponsors/ai"
++        }
++      ],
++      "license": "MIT",
++      "bin": {
++        "nanoid": "bin/nanoid.cjs"
++      },
++      "engines": {
++        "node": "^10 || ^12 || ^13.7 || ^14 || >=15.0.1"
++      }
++    },
++    "node_modules/node-releases": {
++      "version": "2.0.27",
++      "resolved": "https://registry.npmjs.org/node-releases/-/node-releases-2.0.27.tgz",
++      "integrity": "sha512-nmh3lCkYZ3grZvqcCH+fjmQ7X+H0OeZgP40OierEaAptX4XofMh5kwNbWh7lBduUzCcV/8kZ+NDLCwm2iorIlA==",
++      "dev": true,
++      "license": "MIT"
++    },
++    "node_modules/picocolors": {
++      "version": "1.1.1",
++      "resolved": "https://registry.npmjs.org/picocolors/-/picocolors-1.1.1.tgz",
++      "integrity": "sha512-xceH2snhtb5M9liqDsmEw56le376mTZkEX/jEb/RxNFyegNul7eNslCXP9FDj/Lcu0X8KEyMceP2ntpaHrDEVA==",
++      "dev": true,
++      "license": "ISC"
++    },
++    "node_modules/postcss": {
++      "version": "8.5.6",
++      "resolved": "https://registry.npmjs.org/postcss/-/postcss-8.5.6.tgz",
++      "integrity": "sha512-3Ybi1tAuwAP9s0r1UQ2J4n5Y0G05bJkpUIO0/bI9MhwmD70S5aTWbXGBwxHrelT+XM1k6dM0pk+SwNkpTRN7Pg==",
++      "dev": true,
++      "funding": [
++        {
++          "type": "opencollective",
++          "url": "https://opencollective.com/postcss/"
++        },
++        {
++          "type": "tidelift",
++          "url": "https://tidelift.com/funding/github/npm/postcss"
++        },
++        {
++          "type": "github",
++          "url": "https://github.com/sponsors/ai"
++        }
++      ],
++      "license": "MIT",
++      "dependencies": {
++        "nanoid": "^3.3.11",
++        "picocolors": "^1.1.1",
++        "source-map-js": "^1.2.1"
++      },
++      "engines": {
++        "node": "^10 || ^12 || >=14"
++      }
++    },
++    "node_modules/react": {
++      "version": "18.3.1",
++      "resolved": "https://registry.npmjs.org/react/-/react-18.3.1.tgz",
++      "integrity": "sha512-wS+hAgJShR0KhEvPJArfuPVN1+Hz1t0Y6n5jLrGQbkb4urgPE/0Rve+1kMB1v/oWgHgm4WIcV+i7F2pTVj+2iQ==",
++      "license": "MIT",
++      "dependencies": {
++        "loose-envify": "^1.1.0"
++      },
++      "engines": {
++        "node": ">=0.10.0"
++      }
++    },
++    "node_modules/react-dom": {
++      "version": "18.3.1",
++      "resolved": "https://registry.npmjs.org/react-dom/-/react-dom-18.3.1.tgz",
++      "integrity": "sha512-5m4nQKp+rZRb09LNH59GM4BxTh9251/ylbKIbpe7TpGxfJ+9kv6BLkLBXIjjspbgbnIBNqlI23tRnTWT0snUIw==",
++      "license": "MIT",
++      "dependencies": {
++        "loose-envify": "^1.1.0",
++        "scheduler": "^0.23.2"
++      },
++      "peerDependencies": {
++        "react": "^18.3.1"
++      }
++    },
++    "node_modules/react-refresh": {
++      "version": "0.17.0",
++      "resolved": "https://registry.npmjs.org/react-refresh/-/react-refresh-0.17.0.tgz",
++      "integrity": "sha512-z6F7K9bV85EfseRCp2bzrpyQ0Gkw1uLoCel9XBVWPg/TjRj94SkJzUTGfOa4bs7iJvBWtQG0Wq7wnI0syw3EBQ==",
++      "dev": true,
++      "license": "MIT",
++      "engines": {
++        "node": ">=0.10.0"
++      }
++    },
++    "node_modules/rollup": {
++      "version": "4.56.0",
++      "resolved": "https://registry.npmjs.org/rollup/-/rollup-4.56.0.tgz",
++      "integrity": "sha512-9FwVqlgUHzbXtDg9RCMgodF3Ua4Na6Gau+Sdt9vyCN4RhHfVKX2DCHy3BjMLTDd47ITDhYAnTwGulWTblJSDLg==",
++      "dev": true,
++      "license": "MIT",
++      "dependencies": {
++        "@types/estree": "1.0.8"
++      },
++      "bin": {
++        "rollup": "dist/bin/rollup"
++      },
++      "engines": {
++        "node": ">=18.0.0",
++        "npm": ">=8.0.0"
++      },
++      "optionalDependencies": {
++        "@rollup/rollup-android-arm-eabi": "4.56.0",
++        "@rollup/rollup-android-arm64": "4.56.0",
++        "@rollup/rollup-darwin-arm64": "4.56.0",
++        "@rollup/rollup-darwin-x64": "4.56.0",
++        "@rollup/rollup-freebsd-arm64": "4.56.0",
++        "@rollup/rollup-freebsd-x64": "4.56.0",
++        "@rollup/rollup-linux-arm-gnueabihf": "4.56.0",
++        "@rollup/rollup-linux-arm-musleabihf": "4.56.0",
++        "@rollup/rollup-linux-arm64-gnu": "4.56.0",
++        "@rollup/rollup-linux-arm64-musl": "4.56.0",
++        "@rollup/rollup-linux-loong64-gnu": "4.56.0",
++        "@rollup/rollup-linux-loong64-musl": "4.56.0",
++        "@rollup/rollup-linux-ppc64-gnu": "4.56.0",
++        "@rollup/rollup-linux-ppc64-musl": "4.56.0",
++        "@rollup/rollup-linux-riscv64-gnu": "4.56.0",
++        "@rollup/rollup-linux-riscv64-musl": "4.56.0",
++        "@rollup/rollup-linux-s390x-gnu": "4.56.0",
++        "@rollup/rollup-linux-x64-gnu": "4.56.0",
++        "@rollup/rollup-linux-x64-musl": "4.56.0",
++        "@rollup/rollup-openbsd-x64": "4.56.0",
++        "@rollup/rollup-openharmony-arm64": "4.56.0",
++        "@rollup/rollup-win32-arm64-msvc": "4.56.0",
++        "@rollup/rollup-win32-ia32-msvc": "4.56.0",
++        "@rollup/rollup-win32-x64-gnu": "4.56.0",
++        "@rollup/rollup-win32-x64-msvc": "4.56.0",
++        "fsevents": "~2.3.2"
++      }
++    },
++    "node_modules/scheduler": {
++      "version": "0.23.2",
++      "resolved": "https://registry.npmjs.org/scheduler/-/scheduler-0.23.2.tgz",
++      "integrity": "sha512-UOShsPwz7NrMUqhR6t0hWjFduvOzbtv7toDH1/hIrfRNIDBnnBWd0CwJTGvTpngVlmwGCdP9/Zl/tVrDqcuYzQ==",
++      "license": "MIT",
++      "dependencies": {
++        "loose-envify": "^1.1.0"
++      }
++    },
++    "node_modules/semver": {
++      "version": "6.3.1",
++      "resolved": "https://registry.npmjs.org/semver/-/semver-6.3.1.tgz",
++      "integrity": "sha512-BR7VvDCVHO+q2xBEWskxS6DJE1qRnb7DxzUrogb71CWoSficBxYsiAGd+Kl0mmq/MprG9yArRkyrQxTO6XjMzA==",
++      "dev": true,
++      "license": "ISC",
++      "bin": {
++        "semver": "bin/semver.js"
++      }
++    },
++    "node_modules/source-map-js": {
++      "version": "1.2.1",
++      "resolved": "https://registry.npmjs.org/source-map-js/-/source-map-js-1.2.1.tgz",
++      "integrity": "sha512-UXWMKhLOwVKb728IUtQPXxfYU+usdybtUrK/8uGE8CQMvrhOpwvzDBwj0QhSL7MQc7vIsISBG8VQ8+IDQxpfQA==",
++      "dev": true,
++      "license": "BSD-3-Clause",
++      "engines": {
++        "node": ">=0.10.0"
++      }
++    },
++    "node_modules/typescript": {
++      "version": "5.9.3",
++      "resolved": "https://registry.npmjs.org/typescript/-/typescript-5.9.3.tgz",
++      "integrity": "sha512-jl1vZzPDinLr9eUt3J/t7V6FgNEw9QjvBPdysz9KfQDD41fQrC2Y4vKQdiaUpFT4bXlb1RHhLpp8wtm6M5TgSw==",
++      "dev": true,
++      "license": "Apache-2.0",
++      "bin": {
++        "tsc": "bin/tsc",
++        "tsserver": "bin/tsserver"
++      },
++      "engines": {
++        "node": ">=14.17"
++      }
++    },
++    "node_modules/update-browserslist-db": {
++      "version": "1.2.3",
++      "resolved": "https://registry.npmjs.org/update-browserslist-db/-/update-browserslist-db-1.2.3.tgz",
++      "integrity": "sha512-Js0m9cx+qOgDxo0eMiFGEueWztz+d4+M3rGlmKPT+T4IS/jP4ylw3Nwpu6cpTTP8R1MAC1kF4VbdLt3ARf209w==",
++      "dev": true,
++      "funding": [
++        {
++          "type": "opencollective",
++          "url": "https://opencollective.com/browserslist"
++        },
++        {
++          "type": "tidelift",
++          "url": "https://tidelift.com/funding/github/npm/browserslist"
++        },
++        {
++          "type": "github",
++          "url": "https://github.com/sponsors/ai"
++        }
++      ],
++      "license": "MIT",
++      "dependencies": {
++        "escalade": "^3.2.0",
++        "picocolors": "^1.1.1"
++      },
++      "bin": {
++        "update-browserslist-db": "cli.js"
++      },
++      "peerDependencies": {
++        "browserslist": ">= 4.21.0"
++      }
++    },
++    "node_modules/vite": {
++      "version": "5.4.21",
++      "resolved": "https://registry.npmjs.org/vite/-/vite-5.4.21.tgz",
++      "integrity": "sha512-o5a9xKjbtuhY6Bi5S3+HvbRERmouabWbyUcpXXUA1u+GNUKoROi9byOJ8M0nHbHYHkYICiMlqxkg1KkYmm25Sw==",
++      "dev": true,
++      "license": "MIT",
++      "dependencies": {
++        "esbuild": "^0.21.3",
++        "postcss": "^8.4.43",
++        "rollup": "^4.20.0"
++      },
++      "bin": {
++        "vite": "bin/vite.js"
++      },
++      "engines": {
++        "node": "^18.0.0 || >=20.0.0"
++      },
++      "funding": {
++        "url": "https://github.com/vitejs/vite?sponsor=1"
++      },
++      "optionalDependencies": {
++        "fsevents": "~2.3.3"
++      },
++      "peerDependencies": {
++        "@types/node": "^18.0.0 || >=20.0.0",
++        "less": "*",
++        "lightningcss": "^1.21.0",
++        "sass": "*",
++        "sass-embedded": "*",
++        "stylus": "*",
++        "sugarss": "*",
++        "terser": "^5.4.0"
++      },
++      "peerDependenciesMeta": {
++        "@types/node": {
++          "optional": true
++        },
++        "less": {
++          "optional": true
++        },
++        "lightningcss": {
++          "optional": true
++        },
++        "sass": {
++          "optional": true
++        },
++        "sass-embedded": {
++          "optional": true
++        },
++        "stylus": {
++          "optional": true
++        },
++        "sugarss": {
++          "optional": true
++        },
++        "terser": {
++          "optional": true
++        }
++      }
++    },
++    "node_modules/yallist": {
++      "version": "3.1.1",
++      "resolved": "https://registry.npmjs.org/yallist/-/yallist-3.1.1.tgz",
++      "integrity": "sha512-a4UGQaWPH59mOXUYnAG2ewncQS4i4F43Tv3JoAM+s2VDAmS9NsK8GpDMLrCHPksFT7h3K6TOoUNn2pb7RoXx4g==",
++      "dev": true,
++      "license": "ISC"
++    }
++  }
++}
+--- frontend/tsconfig.json
++++ frontend/tsconfig.json
+@@ -0,0 +1,16 @@
++{
++  "compilerOptions": {
++    "target": "ES2020",
++    "useDefineForClassFields": true,
++    "lib": ["ES2020", "DOM", "DOM.Iterable"],
++    "module": "ESNext",
++    "skipLibCheck": true,
++    "moduleResolution": "Bundler",
++    "resolveJsonModule": true,
++    "isolatedModules": true,
++    "noEmit": true,
++    "jsx": "react-jsx",
++    "strict": true
++  },
++  "include": ["src"]
++}
+--- frontend/vite.config.ts
++++ frontend/vite.config.ts
+@@ -0,0 +1,9 @@
++import { defineConfig } from "vite";
++import react from "@vitejs/plugin-react";
++
++export default defineConfig({
++  plugins: [react()],
++  server: {
++    port: 5173,
++  },
++});
+--- frontend/src/main.tsx
++++ frontend/src/main.tsx
+@@ -0,0 +1,10 @@
++import React from "react";
++import ReactDOM from "react-dom/client";
++import App from "./App";
++import "./styles.css";
++
++ReactDOM.createRoot(document.getElementById("root")!).render(
++  <React.StrictMode>
++    <App />
++  </React.StrictMode>
++);
+--- frontend/src/App.tsx
++++ frontend/src/App.tsx
+@@ -0,0 +1,721 @@
++import React, { useCallback, useEffect, useMemo, useRef, useState } from "react";
++
++const API_BASE = import.meta.env.VITE_API_BASE || "http://127.0.0.1:8010";
++
++type RuntimeInfo = {
++  container_id?: string | null;
++  host_port?: number | null;
++  access_url?: string | null;
++  started_at?: number | null;
++  exited_at?: number | null;
++  exit_code?: number | null;
++};
++
++type CaseResponse = {
++  case_id: string;
++  status: string;
++  stage: string;
++  commit_sha?: string | null;
++  runtime?: RuntimeInfo | null;
++  env_keys?: string[];
++  error_code?: string | null;
++  error_message?: string | null;
++  created_at?: number | null;
++  updated_at?: number | null;
++};
++
++type LogEntry = {
++  ts: number | string;
++  stream: string;
++  level: string;
++  line: string;
++};
++
++type Route =
++  | { type: "create" }
++  | {
++      type: "case";
++      caseId: string;
++    };
++
++const ERROR_EXPLAIN: Record<string, string> = {
++  PORT_POOL_EXHAUSTED: "端口池已满，请停止旧容器或扩大端口范围。",
++  DOCKER_BUILD_FAILED: "Docker 镜像构建失败，请检查 Dockerfile 与构建日志。",
++  DOCKER_API_ERROR: "Docker 守护进程错误，请确认 Docker 正常运行且端口未被占用。",
++  DOCKERFILE_MISSING: "仓库根目录缺少 Dockerfile。",
++  GIT_CLONE_FAILED: "Git 克隆失败，请检查仓库地址与权限。",
++  GIT_CLONE_TIMEOUT: "Git 克隆超时，请重试或使用更小的仓库。",
++  STARTUP_TIMEOUT: "容器启动超时，请确认监听 0.0.0.0 且 EXPOSE 端口正确。",
++  CONTAINER_EXIT_NONZERO: "容器非零退出，请查看容器日志。",
++  UNEXPECTED_ERROR: "未知错误，请查看日志详情。",
++};
++
++const STREAM_LABELS: Record<string, string> = {
++  build: "构建",
++  run: "运行",
++  analyze: "分析",
++  system: "系统",
++};
++
++const STAGE_LABELS: Record<string, string> = {
++  clone: "克隆",
++  build: "构建",
++  run: "运行",
++  analyze: "分析",
++  system: "系统",
++};
++
++const STATUS_LABELS: Record<string, string> = {
++  PENDING: "待处理",
++  CLONING: "克隆中",
++  BUILDING: "构建中",
++  STARTING: "启动中",
++  RUNNING: "运行中",
++  FAILED: "失败",
++  FINISHED: "已结束",
++  ANALYZING: "分析中",
++};
++
++function streamLabel(stream: string) {
++  return STREAM_LABELS[stream] || stream;
++}
++
++function statusLabel(status?: string) {
++  if (!status) return "-";
++  const normalized = status.toUpperCase();
++  const label = STATUS_LABELS[normalized];
++  return label ? `${label} (${normalized})` : normalized;
++}
++
++function stageLabel(stage?: string) {
++  if (!stage) return "-";
++  const normalized = stage.toLowerCase();
++  const label = STAGE_LABELS[normalized];
++  return label ? `${label} (${normalized})` : stage;
++}
++
++function joinUrl(base: string, path: string) {
++  const trimmed = base.replace(/\/+$/, "");
++  return `${trimmed}${path}`;
++}
++
++function toWsUrl(base: string) {
++  if (base.startsWith("https://")) {
++    return base.replace("https://", "wss://");
++  }
++  if (base.startsWith("http://")) {
++    return base.replace("http://", "ws://");
++  }
++  return `ws://${base.replace(/^\/*/, "")}`;
++}
++
++function parseRoute(pathname: string): Route {
++  const match = pathname.match(/^\/cases\/([^/]+)$/);
++  if (match && match[1]) {
++    return { type: "case", caseId: match[1] };
++  }
++  return { type: "create" };
++}
++
++function useRoute() {
++  const [route, setRoute] = useState<Route>(() => parseRoute(window.location.pathname));
++
++  useEffect(() => {
++    const onPop = () => setRoute(parseRoute(window.location.pathname));
++    window.addEventListener("popstate", onPop);
++    return () => window.removeEventListener("popstate", onPop);
++  }, []);
++
++  const navigate = useCallback((path: string) => {
++    window.history.pushState({}, "", path);
++    setRoute(parseRoute(path));
++  }, []);
++
++  return { route, navigate };
++}
++
++function formatTime(ts?: number | null) {
++  if (!ts) return "-";
++  const date = new Date(ts * 1000);
++  return date.toLocaleString();
++}
++
++function statusTone(status?: string) {
++  const normalized = (status || "").toUpperCase();
++  if (normalized === "RUNNING") return "running";
++  if (normalized === "FAILED") return "failed";
++  if (normalized === "BUILDING" || normalized === "CLONING" || normalized === "STARTING") {
++    return "working";
++  }
++  if (normalized === "FINISHED") return "finished";
++  return "neutral";
++}
++
++function App() {
++  const { route, navigate } = useRoute();
++  const [flashCaseId, setFlashCaseId] = useState<string | null>(null);
++
++  return (
++    <div className="app">
++      <header className="topbar">
++        <div className="brand">
++            <div className="brand-mark">AH</div>
++          <div>
++            <div className="brand-title">AntiHub 控制台</div>
++            <div className="brand-sub">阶段 2 - 创建、观测、对齐</div>
++          </div>
++        </div>
++        <div className="topbar-actions">
++          <button className="ghost" onClick={() => navigate("/")}>新建案例</button>
++          <a className="ghost" href="http://127.0.0.1:8010/docs" target="_blank" rel="noreferrer">
++            API 文档
++          </a>
++        </div>
++      </header>
++      <main className="main">
++        {route.type === "create" ? (
++          <CreateCase
++            onCreated={(caseId) => {
++              setFlashCaseId(caseId);
++              navigate(`/cases/${caseId}`);
++            }}
++          />
++        ) : (
++          <CaseDetail
++            caseId={route.caseId}
++            onBack={() => navigate("/")}
++            flashCaseId={flashCaseId}
++            clearFlash={() => setFlashCaseId(null)}
++          />
++        )}
++      </main>
++    </div>
++  );
++}
++
++type EnvRow = { id: string; key: string; value: string };
++
++function CreateCase({ onCreated }: { onCreated: (caseId: string) => void }) {
++  const [repoUrl, setRepoUrl] = useState("");
++  const [ref, setRef] = useState("");
++  const [autoAnalyze, setAutoAnalyze] = useState(false);
++  const [envRows, setEnvRows] = useState<EnvRow[]>([
++    { id: `env-${Date.now()}`, key: "", value: "" },
++  ]);
++  const [submitting, setSubmitting] = useState(false);
++  const [error, setError] = useState<string | null>(null);
++
++  const addRow = () => {
++    setEnvRows((rows) => [...rows, { id: `env-${Date.now()}-${rows.length}`, key: "", value: "" }]);
++  };
++
++  const removeRow = (id: string) => {
++    setEnvRows((rows) => rows.filter((row) => row.id !== id));
++  };
++
++  const updateRow = (id: string, field: "key" | "value", value: string) => {
++    setEnvRows((rows) =>
++      rows.map((row) => (row.id === id ? { ...row, [field]: value } : row))
++    );
++  };
++
++  const handleSubmit = async (event: React.FormEvent) => {
++    event.preventDefault();
++    setError(null);
++
++    if (!repoUrl.trim()) {
++      setError("请填写仓库地址。");
++      return;
++    }
++
++    const env: Record<string, string> = {};
++    for (const row of envRows) {
++      const key = row.key.trim();
++      if (key) {
++        env[key] = row.value;
++      }
++    }
++
++    const payload: Record<string, unknown> = {
++      repo_url: repoUrl.trim(),
++      env,
++      auto_analyze: autoAnalyze,
++    };
++    if (ref.trim()) {
++      payload.ref = ref.trim();
++    }
++
++    setSubmitting(true);
++    try {
++      const response = await fetch(joinUrl(API_BASE, "/cases"), {
++        method: "POST",
++        headers: { "Content-Type": "application/json" },
++        body: JSON.stringify(payload),
++      });
++      if (!response.ok) {
++        let message = `请求失败 (${response.status})`;
++        try {
++          const body = await response.json();
++          if (body && body.detail) {
++            message = body.detail;
++          }
++        } catch (err) {
++          const text = await response.text();
++          if (text) message = text;
++        }
++        setError(message);
++        return;
++      }
++      const data = (await response.json()) as CaseResponse;
++      setEnvRows([{ id: `env-${Date.now()}`, key: "", value: "" }]);
++      setRepoUrl("");
++      setRef("");
++      onCreated(data.case_id);
++    } catch (err) {
++      setError("网络错误，请检查 API 连接。");
++    } finally {
++      setSubmitting(false);
++    }
++  };
++
++  return (
++    <div className="create-grid">
++      <section className="card card-hero" style={{ animationDelay: "0.05s" }}>
++        <div className="section-title">创建案例</div>
++        <p className="section-sub">几秒内启动仓库并可视化全流程日志。</p>
++        <form className="form" onSubmit={handleSubmit}>
++          <label className="field">
++            <span>仓库地址</span>
++            <input
++              type="text"
++              placeholder="git_url / repo_url"
++              value={repoUrl}
++              onChange={(event) => setRepoUrl(event.target.value)}
++            />
++          </label>
++          <div className="field-row">
++            <label className="field">
++              <span>Ref/分支</span>
++              <input
++                type="text"
++                placeholder="main / 分支 / 标签"
++                value={ref}
++                onChange={(event) => setRef(event.target.value)}
++              />
++            </label>
++            <label className="field checkbox">
++              <span>自动分析</span>
++              <input
++                type="checkbox"
++                checked={autoAnalyze}
++                onChange={(event) => setAutoAnalyze(event.target.checked)}
++              />
++            </label>
++          </div>
++          <div className="env-block">
++            <div className="env-header">
++              <div>
++                <div className="env-title">环境变量</div>
++                <div className="env-sub">仅提交一次，后端不持久化值。</div>
++              </div>
++              <button type="button" className="ghost" onClick={addRow}>
++                添加一行
++              </button>
++            </div>
++            {envRows.map((row, index) => (
++              <div className="env-row" key={row.id}>
++                <input
++                  type="text"
++                  placeholder="键名"
++                  value={row.key}
++                  onChange={(event) => updateRow(row.id, "key", event.target.value)}
++                />
++                <input
++                  type="password"
++                  placeholder="值"
++                  value={row.value}
++                  onChange={(event) => updateRow(row.id, "value", event.target.value)}
++                />
++                <button
++                  type="button"
++                  className="danger"
++                  onClick={() => removeRow(row.id)}
++                  disabled={envRows.length === 1}
++                  aria-label={`remove env row ${index + 1}`}
++                >
++                  移除
++                </button>
++              </div>
++            ))}
++          </div>
++          {error ? <div className="error-banner">{error}</div> : null}
++          <button className="primary" type="submit" disabled={submitting}>
++            {submitting ? "创建中..." : "创建案例"}
++          </button>
++        </form>
++      </section>
++      <section className="card card-glow" style={{ animationDelay: "0.12s" }}>
++        <div className="section-title">你将获得</div>
++        <ul className="list">
++          <li>2 秒内返回 case_id</li>
++          <li>WS 日志回放 + 实时追踪</li>
++          <li>访问地址可点击/复制</li>
++          <li>仅展示 env 键名</li>
++        </ul>
++        <div className="note">
++          <div className="note-title">安全提示</div>
++          <div className="note-body">
++            env value 仅用于一次性注入，不会落库或写日志。
++          </div>
++        </div>
++      </section>
++    </div>
++  );
++}
++
++function CaseDetail({
++  caseId,
++  onBack,
++  flashCaseId,
++  clearFlash,
++}: {
++  caseId: string;
++  onBack: () => void;
++  flashCaseId: string | null;
++  clearFlash: () => void;
++}) {
++  const [caseData, setCaseData] = useState<CaseResponse | null>(null);
++  const [loadError, setLoadError] = useState<string | null>(null);
++  const [loading, setLoading] = useState(false);
++  const statusRef = useRef<string>("");
++  const fetchLock = useRef(false);
++
++  const fetchCase = useCallback(
++    async (silent = false) => {
++      if (fetchLock.current) return;
++      fetchLock.current = true;
++      if (!silent) {
++        setLoading(true);
++      }
++      setLoadError(null);
++      try {
++        const response = await fetch(joinUrl(API_BASE, `/cases/${caseId}`));
++        if (!response.ok) {
++          let message = `请求失败 (${response.status})`;
++          try {
++            const body = await response.json();
++            if (body && body.detail) {
++              message = body.detail;
++            }
++          } catch (err) {
++            const text = await response.text();
++            if (text) message = text;
++          }
++          setLoadError(message);
++          return;
++        }
++        const data = (await response.json()) as CaseResponse;
++        setCaseData(data);
++      } catch (err) {
++        setLoadError("网络错误，请检查 API 连接。");
++      } finally {
++        fetchLock.current = false;
++        if (!silent) {
++          setLoading(false);
++        }
++      }
++    },
++    [caseId]
++  );
++
++  useEffect(() => {
++    fetchCase();
++  }, [fetchCase]);
++
++  useEffect(() => {
++    statusRef.current = caseData?.status || "";
++  }, [caseData?.status]);
++
++  useEffect(() => {
++    let timer: number | undefined;
++    let cancelled = false;
++    const poll = async () => {
++      if (cancelled) return;
++      await fetchCase(true);
++      const status = statusRef.current.toUpperCase();
++      const slow = status === "RUNNING" || status === "FAILED" || status === "FINISHED";
++      const delay = slow ? 5000 : 2000;
++      timer = window.setTimeout(poll, delay);
++    };
++    poll();
++    return () => {
++      cancelled = true;
++      if (timer) window.clearTimeout(timer);
++    };
++  }, [fetchCase]);
++
++  useEffect(() => {
++    if (flashCaseId) {
++      const timer = window.setTimeout(() => clearFlash(), 4000);
++      return () => window.clearTimeout(timer);
++    }
++    return undefined;
++  }, [flashCaseId, clearFlash]);
++
++  const runtime = caseData?.runtime || {};
++  const envKeys = caseData?.env_keys || [];
++  const errorCode = caseData?.error_code || undefined;
++  const errorMessage = caseData?.error_message || undefined;
++
++  return (
++    <div className="detail">
++      <div className="detail-head">
++        <button className="ghost" onClick={onBack}>
++          返回
++        </button>
++        <div className="case-id">案例：{caseId}</div>
++        <button className="ghost" onClick={() => fetchCase()} disabled={loading}>
++          {loading ? "刷新中..." : "刷新状态"}
++        </button>
++      </div>
++      {flashCaseId ? <div className="success-banner">创建成功：{flashCaseId}</div> : null}
++      {loadError ? <div className="error-banner">{loadError}</div> : null}
++      <div className="detail-grid">
++        <section className="card" style={{ animationDelay: "0.05s" }}>
++          <div className="section-title">状态</div>
++          <div className="status-row">
++            <span className={`badge badge--${statusTone(caseData?.status)}`}>
++              {statusLabel(caseData?.status)}
++            </span>
++            <span className="stage">阶段：{stageLabel(caseData?.stage)}</span>
++          </div>
++          <div className="meta">
++            <div>更新时间：{formatTime(caseData?.updated_at)}</div>
++            <div>创建时间：{formatTime(caseData?.created_at)}</div>
++            <div>提交：{caseData?.commit_sha || "-"}</div>
++          </div>
++        </section>
++        <section className="card" style={{ animationDelay: "0.12s" }}>
++          <div className="section-title">运行信息</div>
++          <div className="runtime">
++            <div className="runtime-row">
++              <span>访问地址</span>
++              {runtime.access_url ? (
++                <div className="runtime-actions">
++                  <a href={runtime.access_url} target="_blank" rel="noreferrer">
++                    {runtime.access_url}
++                  </a>
++                  <CopyButton value={runtime.access_url} />
++                </div>
++              ) : (
++                <span>-</span>
++              )}
++            </div>
++            <div className="runtime-row">
++              <span>主机端口</span>
++              <span>{runtime.host_port ?? "-"}</span>
++            </div>
++            <div className="runtime-row">
++              <span>容器 ID</span>
++              <span className="mono">{runtime.container_id ?? "-"}</span>
++            </div>
++          </div>
++        </section>
++        <section className="card" style={{ animationDelay: "0.18s" }}>
++          <div className="section-title">环境变量键</div>
++          {envKeys.length ? (
++            <div className="chips">
++              {envKeys.map((key) => (
++                <span key={key} className="chip">
++                  {key}
++                </span>
++              ))}
++            </div>
++          ) : (
++            <div className="muted">暂无 env 键名。</div>
++          )}
++        </section>
++        {caseData?.status?.toUpperCase() === "FAILED" ? (
++          <section className="card error-card" style={{ animationDelay: "0.24s" }}>
++            <div className="section-title">错误</div>
++            <div className="error-code">{errorCode || "UNKNOWN"}</div>
++            <div className="error-message">{errorMessage || "未知错误。"}</div>
++            <div className="error-hint">
++              {ERROR_EXPLAIN[errorCode || ""] || "请查看日志详情。"}
++            </div>
++          </section>
++        ) : null}
++        <section className="card logs" style={{ animationDelay: "0.3s" }}>
++          <LogPanel caseId={caseId} />
++        </section>
++      </div>
++    </div>
++  );
++}
++
++function CopyButton({ value }: { value: string }) {
++  const [copied, setCopied] = useState(false);
++
++  const handleCopy = async () => {
++    try {
++      await navigator.clipboard.writeText(value);
++      setCopied(true);
++      setTimeout(() => setCopied(false), 1500);
++    } catch (err) {
++      setCopied(false);
++    }
++  };
++
++  return (
++    <button className="ghost" type="button" onClick={handleCopy}>
++      {copied ? "已复制" : "复制"}
++    </button>
++  );
++}
++
++function LogPanel({ caseId }: { caseId: string }) {
++  const [logs, setLogs] = useState<LogEntry[]>([]);
++  const [autoScroll, setAutoScroll] = useState(true);
++  const [status, setStatus] = useState<"connecting" | "open" | "closed" | "error">(
++    "connecting"
++  );
++  const [filters, setFilters] = useState({
++    build: true,
++    run: true,
++    analyze: true,
++    system: true,
++  });
++  const wsRef = useRef<WebSocket | null>(null);
++  const bottomRef = useRef<HTMLDivElement | null>(null);
++
++  const wsUrl = joinUrl(toWsUrl(API_BASE), `/ws/logs/${caseId}`);
++
++  const connect = useCallback(() => {
++    if (wsRef.current) {
++      wsRef.current.close();
++    }
++    setStatus("connecting");
++    const ws = new WebSocket(wsUrl);
++    wsRef.current = ws;
++    ws.onopen = () => setStatus("open");
++    ws.onclose = () => setStatus("closed");
++    ws.onerror = () => setStatus("error");
++    ws.onmessage = (event) => {
++      let parsed: LogEntry = {
++        ts: Date.now() / 1000,
++        stream: "system",
++        level: "INFO",
++        line: String(event.data || ""),
++      };
++      try {
++        const data = JSON.parse(event.data as string);
++        if (data && typeof data === "object") {
++          parsed = {
++            ts: data.ts ?? parsed.ts,
++            stream: data.stream ?? parsed.stream,
++            level: data.level ?? parsed.level,
++            line: data.line ?? parsed.line,
++          };
++        }
++      } catch (err) {
++        parsed = {
++          ...parsed,
++          line: String(event.data || ""),
++        };
++      }
++      setLogs((prev) => {
++        const next = [...prev, parsed];
++        if (next.length > 2000) {
++          return next.slice(-2000);
++        }
++        return next;
++      });
++    };
++  }, [wsUrl]);
++
++  useEffect(() => {
++    setLogs([]);
++    connect();
++    return () => {
++      if (wsRef.current) {
++        wsRef.current.close();
++      }
++    };
++  }, [connect, caseId]);
++
++  useEffect(() => {
++    if (!autoScroll) return;
++    if (bottomRef.current) {
++      bottomRef.current.scrollIntoView({ behavior: "auto" });
++    }
++  }, [logs, autoScroll]);
++
++  const visibleLogs = useMemo(() => {
++    return logs.filter((entry) => {
++      const key = entry.stream as keyof typeof filters;
++      if (filters[key] === undefined) return true;
++      return filters[key];
++    });
++  }, [logs, filters]);
++
++  return (
++    <div className="logs-panel">
++      <div className="logs-header">
++        <div>
++          <div className="section-title">日志</div>
++          <div className={`ws-status ws-${status}`}>
++            {status === "open" ? "已连接" : status === "connecting" ? "连接中" : "已断开"}
++          </div>
++        </div>
++        <div className="logs-actions">
++          <button className="ghost" type="button" onClick={() => setAutoScroll((value) => !value)}>
++            {autoScroll ? "暂停滚动" : "自动滚动"}
++          </button>
++          <button className="ghost" type="button" onClick={connect}>
++            重连
++          </button>
++        </div>
++      </div>
++      <div className="filters">
++        {(
++          [
++            { id: "build", label: "构建" },
++            { id: "run", label: "运行" },
++            { id: "analyze", label: "分析" },
++            { id: "system", label: "系统" },
++          ] as const
++        ).map((item) => (
++          <label key={item.id} className="filter">
++            <input
++              type="checkbox"
++              checked={filters[item.id]}
++              onChange={() =>
++                setFilters((prev) => ({
++                  ...prev,
++                  [item.id]: !prev[item.id],
++                }))
++              }
++            />
++            <span>{item.label}</span>
++          </label>
++        ))}
++      </div>
++      <div className="log-list">
++        {visibleLogs.length ? (
++          visibleLogs.map((entry, index) => (
++            <div className={`log-line level-${entry.level?.toLowerCase()}`} key={`${index}-${entry.ts}`}>
++              <span className="log-ts">{typeof entry.ts === "number" ? formatTime(entry.ts) : entry.ts}</span>
++              <span className={`log-stream stream-${entry.stream}`}>{streamLabel(entry.stream)}</span>
++              <span className="log-msg">{entry.line}</span>
++            </div>
++          ))
++        ) : (
++          <div className="muted">暂无日志。</div>
++        )}
++        <div ref={bottomRef} />
++      </div>
++    </div>
++  );
++}
++
++export default App;
+--- frontend/src/styles.css
++++ frontend/src/styles.css
+@@ -0,0 +1,600 @@
++@import url("https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500&family=Space+Grotesk:wght@400;500;600;700&display=swap");
++
++:root {
++  --bg: #f7f0e6;
++  --bg-strong: #efe2d0;
++  --ink: #1f1b16;
++  --muted: #6b5f52;
++  --accent: #1e6f7a;
++  --accent-strong: #16555e;
++  --accent-warm: #e07a5f;
++  --card: #ffffffcc;
++  --border: #e2d1bf;
++  --shadow: 0 16px 40px rgba(34, 24, 16, 0.08);
++}
++
++* {
++  box-sizing: border-box;
++}
++
++body {
++  margin: 0;
++  font-family: "Space Grotesk", "Helvetica Neue", "Noto Sans", sans-serif;
++  color: var(--ink);
++  background-color: var(--bg);
++  min-height: 100vh;
++  background-image:
++    radial-gradient(circle at 20% 20%, rgba(224, 122, 95, 0.16), transparent 55%),
++    radial-gradient(circle at 80% 10%, rgba(30, 111, 122, 0.14), transparent 50%),
++    linear-gradient(160deg, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.1));
++}
++
++body::before,
++body::after {
++  content: "";
++  position: fixed;
++  inset: 0;
++  pointer-events: none;
++}
++
++body::before {
++  background-image: radial-gradient(rgba(31, 27, 22, 0.05) 1px, transparent 1px);
++  background-size: 22px 22px;
++  opacity: 0.45;
++}
++
++body::after {
++  background: linear-gradient(120deg, rgba(30, 111, 122, 0.12), transparent 60%);
++  opacity: 0.5;
++}
++
++.app {
++  min-height: 100vh;
++  position: relative;
++}
++
++.topbar {
++  display: flex;
++  justify-content: space-between;
++  align-items: center;
++  padding: 24px 32px;
++  border-bottom: 1px solid var(--border);
++  backdrop-filter: blur(6px);
++}
++
++.brand {
++  display: flex;
++  align-items: center;
++  gap: 16px;
++}
++
++.brand-mark {
++  width: 48px;
++  height: 48px;
++  border-radius: 16px;
++  background: linear-gradient(130deg, var(--accent), var(--accent-warm));
++  color: white;
++  display: grid;
++  place-items: center;
++  font-weight: 700;
++  letter-spacing: 1px;
++}
++
++.brand-title {
++  font-size: 20px;
++  font-weight: 700;
++}
++
++.brand-sub {
++  color: var(--muted);
++  font-size: 14px;
++}
++
++.topbar-actions {
++  display: flex;
++  gap: 12px;
++}
++
++.main {
++  max-width: 1200px;
++  margin: 0 auto;
++  padding: 32px;
++  animation: fadeIn 0.5s ease;
++}
++
++@keyframes fadeIn {
++  from {
++    opacity: 0;
++    transform: translateY(6px);
++  }
++  to {
++    opacity: 1;
++    transform: translateY(0);
++  }
++}
++
++.card {
++  background: var(--card);
++  border: 1px solid var(--border);
++  border-radius: 20px;
++  padding: 24px;
++  box-shadow: var(--shadow);
++  animation: floatIn 0.6s ease both;
++}
++
++.card-hero {
++  border: 1px solid rgba(30, 111, 122, 0.25);
++}
++
++.card-glow {
++  background: linear-gradient(150deg, rgba(255, 255, 255, 0.9), rgba(244, 234, 220, 0.9));
++}
++
++@keyframes floatIn {
++  from {
++    opacity: 0;
++    transform: translateY(12px);
++  }
++  to {
++    opacity: 1;
++    transform: translateY(0);
++  }
++}
++
++.section-title {
++  font-size: 18px;
++  font-weight: 600;
++  margin-bottom: 8px;
++}
++
++.section-sub {
++  color: var(--muted);
++  margin-bottom: 20px;
++}
++
++.create-grid {
++  display: grid;
++  grid-template-columns: 2fr 1fr;
++  gap: 24px;
++}
++
++.form {
++  display: flex;
++  flex-direction: column;
++  gap: 16px;
++}
++
++.field {
++  display: flex;
++  flex-direction: column;
++  gap: 6px;
++  font-size: 14px;
++  color: var(--muted);
++}
++
++.field input {
++  padding: 12px 14px;
++  border-radius: 12px;
++  border: 1px solid var(--border);
++  font-size: 15px;
++}
++
++.field-row {
++  display: grid;
++  grid-template-columns: 1fr auto;
++  gap: 12px;
++  align-items: end;
++}
++
++.checkbox {
++  align-items: center;
++  flex-direction: row;
++  gap: 12px;
++}
++
++.checkbox input {
++  width: 20px;
++  height: 20px;
++}
++
++.env-block {
++  background: rgba(244, 234, 220, 0.6);
++  border-radius: 16px;
++  padding: 16px;
++  border: 1px dashed rgba(30, 111, 122, 0.2);
++  display: flex;
++  flex-direction: column;
++  gap: 12px;
++}
++
++.env-header {
++  display: flex;
++  justify-content: space-between;
++  align-items: center;
++}
++
++.env-title {
++  font-weight: 600;
++}
++
++.env-sub {
++  color: var(--muted);
++  font-size: 13px;
++}
++
++.env-row {
++  display: grid;
++  grid-template-columns: 1fr 1fr auto;
++  gap: 8px;
++}
++
++.env-row input {
++  padding: 10px 12px;
++  border-radius: 10px;
++  border: 1px solid var(--border);
++}
++
++button {
++  font-family: "Space Grotesk", "Helvetica Neue", sans-serif;
++  border: none;
++  cursor: pointer;
++}
++
++button.primary {
++  background: var(--accent);
++  color: white;
++  padding: 12px 18px;
++  border-radius: 12px;
++  font-weight: 600;
++  transition: background 0.2s ease;
++}
++
++button.primary:hover {
++  background: var(--accent-strong);
++}
++
++button.ghost {
++  background: transparent;
++  color: var(--accent-strong);
++  border: 1px solid rgba(30, 111, 122, 0.3);
++  padding: 8px 14px;
++  border-radius: 999px;
++}
++
++button.danger {
++  background: rgba(224, 122, 95, 0.12);
++  color: #8d3b2a;
++  border: 1px solid rgba(224, 122, 95, 0.4);
++  padding: 8px 10px;
++  border-radius: 10px;
++}
++
++button:disabled {
++  opacity: 0.6;
++  cursor: not-allowed;
++}
++
++.list {
++  margin: 0;
++  padding-left: 18px;
++  color: var(--muted);
++  display: flex;
++  flex-direction: column;
++  gap: 8px;
++}
++
++.note {
++  margin-top: 24px;
++  background: rgba(30, 111, 122, 0.08);
++  padding: 16px;
++  border-radius: 14px;
++}
++
++.note-title {
++  font-weight: 600;
++  margin-bottom: 6px;
++}
++
++.note-body {
++  color: var(--muted);
++  font-size: 14px;
++}
++
++.detail {
++  display: flex;
++  flex-direction: column;
++  gap: 20px;
++}
++
++.detail-head {
++  display: flex;
++  justify-content: space-between;
++  align-items: center;
++}
++
++.case-id {
++  font-weight: 600;
++  font-size: 16px;
++}
++
++.detail-grid {
++  display: grid;
++  grid-template-columns: repeat(12, 1fr);
++  gap: 20px;
++}
++
++.detail-grid > .card {
++  grid-column: span 4;
++}
++
++.detail-grid > .card.logs,
++.detail-grid > .card.error-card {
++  grid-column: span 12;
++}
++
++.detail-grid > .card:nth-child(1) {
++  grid-column: span 4;
++}
++
++.detail-grid > .card:nth-child(2) {
++  grid-column: span 4;
++}
++
++.detail-grid > .card:nth-child(3) {
++  grid-column: span 4;
++}
++
++.status-row {
++  display: flex;
++  align-items: center;
++  gap: 12px;
++  margin-bottom: 12px;
++}
++
++.badge {
++  padding: 6px 12px;
++  border-radius: 999px;
++  font-size: 13px;
++  font-weight: 600;
++  text-transform: uppercase;
++}
++
++.badge--running {
++  background: rgba(30, 111, 122, 0.2);
++  color: var(--accent-strong);
++}
++
++.badge--working {
++  background: rgba(224, 122, 95, 0.18);
++  color: #8d3b2a;
++}
++
++.badge--failed {
++  background: rgba(186, 53, 36, 0.18);
++  color: #8d1f12;
++}
++
++.badge--finished {
++  background: rgba(120, 140, 90, 0.2);
++  color: #2f4b24;
++}
++
++.badge--neutral {
++  background: rgba(107, 95, 82, 0.2);
++  color: var(--muted);
++}
++
++.stage {
++  color: var(--muted);
++}
++
++.meta {
++  display: grid;
++  gap: 4px;
++  color: var(--muted);
++  font-size: 14px;
++}
++
++.runtime {
++  display: grid;
++  gap: 12px;
++}
++
++.runtime-row {
++  display: flex;
++  justify-content: space-between;
++  gap: 12px;
++  color: var(--muted);
++}
++
++.runtime-actions {
++  display: flex;
++  gap: 8px;
++  align-items: center;
++}
++
++.runtime-actions a {
++  color: var(--accent-strong);
++  text-decoration: none;
++}
++
++.chips {
++  display: flex;
++  flex-wrap: wrap;
++  gap: 8px;
++}
++
++.chip {
++  background: rgba(30, 111, 122, 0.16);
++  color: var(--accent-strong);
++  padding: 6px 10px;
++  border-radius: 999px;
++  font-size: 13px;
++}
++
++.error-card {
++  border: 1px solid rgba(186, 53, 36, 0.3);
++  background: rgba(255, 236, 234, 0.9);
++}
++
++.error-code {
++  font-size: 20px;
++  font-weight: 700;
++}
++
++.error-message {
++  margin-top: 8px;
++  color: #8d1f12;
++}
++
++.error-hint {
++  margin-top: 8px;
++  color: var(--muted);
++}
++
++.logs {
++  padding: 0;
++}
++
++.logs-panel {
++  display: flex;
++  flex-direction: column;
++  gap: 12px;
++}
++
++.logs-header {
++  display: flex;
++  justify-content: space-between;
++  align-items: center;
++  padding: 24px 24px 0;
++}
++
++.logs-actions {
++  display: flex;
++  gap: 10px;
++}
++
++.filters {
++  display: flex;
++  gap: 12px;
++  padding: 0 24px;
++  flex-wrap: wrap;
++}
++
++.filter {
++  display: flex;
++  gap: 6px;
++  align-items: center;
++  font-size: 13px;
++  color: var(--muted);
++}
++
++.log-list {
++  background: #1d1914;
++  color: #f5efe6;
++  border-radius: 0 0 20px 20px;
++  padding: 18px 24px 24px;
++  font-family: "IBM Plex Mono", "Courier New", monospace;
++  max-height: 360px;
++  overflow-y: auto;
++}
++
++.log-line {
++  display: grid;
++  grid-template-columns: 160px 80px 1fr;
++  gap: 12px;
++  font-size: 12px;
++  padding: 4px 0;
++}
++
++.log-ts {
++  color: #a9a096;
++}
++
++.log-stream {
++  text-transform: uppercase;
++  font-size: 11px;
++  padding: 2px 8px;
++  border-radius: 999px;
++  justify-self: start;
++  background: rgba(255, 255, 255, 0.1);
++}
++
++.log-msg {
++  white-space: pre-wrap;
++}
++
++.ws-status {
++  font-size: 12px;
++  color: var(--muted);
++}
++
++.ws-open {
++  color: #b6f2db;
++}
++
++.ws-connecting {
++  color: #ffd580;
++}
++
++.ws-closed,
++.ws-error {
++  color: #f2a7a0;
++}
++
++.muted {
++  color: var(--muted);
++}
++
++.mono {
++  font-family: "IBM Plex Mono", "Courier New", monospace;
++}
++
++.error-banner,
++.success-banner {
++  padding: 12px 16px;
++  border-radius: 12px;
++  font-size: 14px;
++}
++
++.error-banner {
++  background: rgba(186, 53, 36, 0.12);
++  border: 1px solid rgba(186, 53, 36, 0.3);
++  color: #8d1f12;
++}
++
++.success-banner {
++  background: rgba(30, 111, 122, 0.12);
++  border: 1px solid rgba(30, 111, 122, 0.3);
++  color: var(--accent-strong);
++}
++
++@media (max-width: 980px) {
++  .create-grid {
++    grid-template-columns: 1fr;
++  }
++
++  .detail-grid {
++    grid-template-columns: 1fr;
++  }
++
++  .detail-grid > .card {
++    grid-column: span 12;
++  }
++
++  .topbar {
++    flex-direction: column;
++    gap: 16px;
++    align-items: flex-start;
++  }
++
++  .detail-head {
++    flex-direction: column;
++    align-items: flex-start;
++    gap: 12px;
++  }
++
++  .log-line {
++    grid-template-columns: 1fr;
++  }
++}
diff -ruN '--exclude=.devlogs' '--exclude=venv' '--exclude=node_modules' '--exclude=__pycache__' /tmp/AntiHub.phase3.base/phase3.patch /home/user2643/code/AntiHub/phase3.patch
--- /tmp/AntiHub.phase3.base/phase3.patch	1970-01-01 08:00:00.000000000 +0800
+++ /home/user2643/code/AntiHub/phase3.patch	2026-01-22 21:52:39.967886519 +0800
@@ -0,0 +1,1437 @@
+--- config.py
++++ config.py
+@@ -22,6 +22,9 @@
+     ).split(",")
+     if origin.strip()
+ ]
++
++CASE_LABEL_KEY = os.getenv("CASE_LABEL_KEY", "antihub.case_id")
++CASE_LABEL_MANAGED = os.getenv("CASE_LABEL_MANAGED", "antihub.managed")
+ 
+ GIT_CLONE_TIMEOUT_SECONDS = int(os.getenv("GIT_CLONE_TIMEOUT_SECONDS", "120"))
+ DOCKER_BUILD_TIMEOUT_SECONDS = int(os.getenv("DOCKER_BUILD_TIMEOUT_SECONDS", "1800"))
+--- docker_ops.py
++++ docker_ops.py
+@@ -66,12 +66,14 @@
+     image: str,
+     container_port: int,
+     environment: Optional[Dict[str, str]] = None,
++    labels: Optional[Dict[str, str]] = None,
+ ) -> Tuple[str, int]:
+     container = client.containers.run(
+         image,
+         detach=True,
+         ports={f"{container_port}/tcp": None},
+         environment=environment or {},
++        labels=labels or {},
+     )
+     container.reload()
+     ports = container.attrs.get("NetworkSettings", {}).get("Ports", {})
+@@ -88,12 +90,14 @@
+     container_port: int,
+     host_port: int,
+     environment: Optional[Dict[str, str]] = None,
++    labels: Optional[Dict[str, str]] = None,
+ ) -> str:
+     container = client.containers.run(
+         image,
+         detach=True,
+         ports={f"{container_port}/tcp": host_port},
+         environment=environment or {},
++        labels=labels or {},
+     )
+     return container.id
+ 
+--- main.py
++++ main.py
+@@ -1,15 +1,37 @@
+ from __future__ import annotations
+ 
++import json
+ import time
+ import uuid
+ from typing import Any, Dict, List, Optional
+ 
+-from fastapi import FastAPI, HTTPException, WebSocket, WebSocketDisconnect
++import docker
++from fastapi import Body, FastAPI, HTTPException, Query, WebSocket, WebSocketDisconnect
+ from fastapi.middleware.cors import CORSMiddleware
++from fastapi.responses import PlainTextResponse, StreamingResponse
+ from pydantic import BaseModel, ConfigDict, Field
+ 
+-from config import CORS_ORIGINS, DEFAULT_BRANCH
+-from storage import decode_log_entry, get_async_redis_client, get_case, get_logs, log_channel, set_case
++from config import (
++    CASE_LABEL_KEY,
++    CASE_LABEL_MANAGED,
++    CORS_ORIGINS,
++    DEFAULT_BRANCH,
++    PUBLIC_HOST,
++    STARTUP_TIMEOUT_SECONDS,
++)
++from docker_ops import wait_for_container_running
++from storage import (
++    append_log,
++    decode_log_entry,
++    get_async_redis_client,
++    get_case,
++    get_logs,
++    get_logs_slice,
++    list_case_ids,
++    log_channel,
++    set_case,
++    update_case,
++)
+ from worker import analyze_case, build_and_run
+ 
+ app = FastAPI(title="Agent Platform", version="0.2.0")
+@@ -28,6 +50,7 @@
+     "BUILDING": "build",
+     "STARTING": "run",
+     "RUNNING": "run",
++    "STOPPED": "run",
+     "FINISHED": "run",
+     "FAILED": "system",
+     "ANALYZING": "analyze",
+@@ -61,6 +84,21 @@
+     model_config = ConfigDict(extra="ignore")
+ 
+ 
++class CaseActionRequest(BaseModel):
++    action: str = Field(..., description="stop | restart | retry | archive")
++    env: Dict[str, str] = Field(
++        default_factory=dict,
++        description="Optional env override for retry (values are not stored).",
++    )
++
++
++class CaseRetryRequest(BaseModel):
++    env: Dict[str, str] = Field(
++        default_factory=dict,
++        description="Optional env override for retry (values are not stored).",
++    )
++
++
+ class RuntimeInfo(BaseModel):
+     container_id: Optional[str] = None
+     host_port: Optional[int] = None
+@@ -81,6 +119,10 @@
+     error_message: Optional[str] = None
+     created_at: Optional[float] = None
+     updated_at: Optional[float] = None
++    archived: bool = False
++    archived_at: Optional[float] = None
++    attempt: Optional[int] = None
++    retry_of: Optional[str] = None
+     repo_url: Optional[str] = None
+     ref: Optional[str] = None
+     branch: Optional[str] = None
+@@ -93,6 +135,20 @@
+     report_ready: bool = False
+ 
+ 
++class CaseListResponse(BaseModel):
++    items: List[CaseResponse]
++    total: int
++    page: int
++    size: int
++
++
++class CaseActionResponse(BaseModel):
++    case_id: str
++    action: str
++    status: str
++    message: str
++
++
+ def normalize_stage(raw_stage: Optional[str], status: Optional[str]) -> str:
+     if raw_stage:
+         normalized = raw_stage.lower()
+@@ -142,6 +198,10 @@
+         error_message=error_message,
+         created_at=data.get("created_at"),
+         updated_at=data.get("updated_at"),
++        archived=bool(data.get("archived", False)),
++        archived_at=data.get("archived_at"),
++        attempt=data.get("attempt"),
++        retry_of=data.get("retry_of"),
+         repo_url=data.get("repo_url"),
+         ref=ref_value,
+         branch=branch_value,
+@@ -155,11 +215,91 @@
+     )
+ 
+ 
++def matches_query(case_id: str, data: Dict[str, Any], query: str) -> bool:
++    q = query.lower().strip()
++    if not q:
++        return True
++    haystacks = [
++        case_id,
++        str(data.get("repo_url") or ""),
++        str(data.get("ref") or data.get("branch") or ""),
++    ]
++    return any(q in (value or "").lower() for value in haystacks)
++
++
++def get_case_or_404(case_id: str) -> Dict[str, Any]:
++    data = get_case(case_id) or {}
++    if not data:
++        raise HTTPException(status_code=404, detail="Case not found")
++    return data
++
++
++def get_managed_container(case_id: str, container_id: str) -> docker.models.containers.Container:
++    client = docker.from_env()
++    container = client.containers.get(container_id)
++    labels = container.labels or {}
++    if labels.get(CASE_LABEL_KEY) != case_id or labels.get(CASE_LABEL_MANAGED) != "true":
++        raise HTTPException(status_code=400, detail="Container is not managed by AntiHub")
++    return container
++
++
++def append_system_log(case_id: str, line: str, level: str = "INFO") -> None:
++    append_log(case_id, {"ts": time.time(), "stream": "system", "level": level, "line": line})
++
++
++def build_jsonl(entries: List[Dict[str, Any]]) -> str:
++    return "\n".join(json.dumps(entry, ensure_ascii=False) for entry in entries) + ("\n" if entries else "")
++
++
++def resolve_host_port(container: docker.models.containers.Container, container_port: Optional[int]) -> Optional[int]:
++    ports = container.attrs.get("NetworkSettings", {}).get("Ports", {}) or {}
++    if container_port:
++        binding = ports.get(f"{container_port}/tcp")
++        if binding:
++            return int(binding[0]["HostPort"])
++    for binding in ports.values():
++        if binding:
++            return int(binding[0]["HostPort"])
++    return None
++
++
+ @app.get("/healthz")
+ async def healthz() -> dict:
+     return {"status": "ok"}
+ 
+ 
++@app.get("/cases", response_model=CaseListResponse)
++async def list_cases(
++    q: Optional[str] = Query(None, description="Search by case_id/repo/ref"),
++    status: Optional[str] = Query(None, description="Filter by status"),
++    stage: Optional[str] = Query(None, description="Filter by stage"),
++    page: int = Query(1, ge=1, description="Page number"),
++    size: int = Query(20, ge=1, le=200, description="Page size"),
++    include_archived: bool = Query(False, description="Include archived cases"),
++) -> CaseListResponse:
++    ids = list_case_ids()
++    items: List[CaseResponse] = []
++    for case_id in ids:
++        data = get_case(case_id) or {}
++        if not data:
++            continue
++        if not include_archived and bool(data.get("archived", False)):
++            continue
++        if status and (data.get("status") or "").upper() != status.upper():
++            continue
++        normalized_stage = normalize_stage(data.get("stage"), data.get("status"))
++        if stage and normalized_stage != stage.lower():
++            continue
++        if q and not matches_query(case_id, data, q):
++            continue
++        items.append(build_case_response(case_id, data))
++    items.sort(key=lambda item: item.updated_at or item.created_at or 0, reverse=True)
++    total = len(items)
++    start = (page - 1) * size
++    end = start + size
++    return CaseListResponse(items=items[start:end], total=total, page=page, size=size)
++
++
+ @app.post("/cases", response_model=CaseResponse)
+ async def create_case(payload: CaseCreateRequest) -> CaseResponse:
+     repo_url = payload.repo_url or payload.git_url
+@@ -181,6 +321,10 @@
+         "report_ready": False,
+         "created_at": now,
+         "updated_at": now,
++        "archived": False,
++        "archived_at": None,
++        "attempt": 1,
++        "retry_of": None,
+         "runtime": {
+             "container_id": None,
+             "host_port": None,
+@@ -204,13 +348,143 @@
+ 
+ @app.get("/cases/{case_id}", response_model=CaseResponse)
+ async def get_case_status(case_id: str) -> CaseResponse:
+-    data = get_case(case_id) or {}
+-    if not data:
+-        raise HTTPException(status_code=404, detail="Case not found")
++    data = get_case_or_404(case_id)
+     data.pop("case_id", None)
+     return build_case_response(case_id, data)
+ 
+ 
++def handle_case_action(case_id: str, action: str, env: Optional[Dict[str, str]] = None) -> CaseActionResponse:
++    data = get_case_or_404(case_id)
++    action_key = action.lower()
++    runtime = data.get("runtime") or {}
++    container_id = data.get("container_id") or runtime.get("container_id")
++
++    if action_key == "stop":
++        if not container_id:
++            raise HTTPException(status_code=400, detail="No running container for case")
++        container = get_managed_container(case_id, container_id)
++        try:
++            container.stop(timeout=10)
++        except Exception:
++            container.kill()
++        container.reload()
++        exit_code = container.attrs.get("State", {}).get("ExitCode")
++        update_case(
++            case_id,
++            {
++                "status": "STOPPED",
++                "stage": "run",
++                "error_code": "STOPPED_BY_USER",
++                "error_message": "Stopped by user",
++                "runtime": {
++                    **runtime,
++                    "exited_at": time.time(),
++                    "exit_code": exit_code,
++                },
++            },
++        )
++        append_system_log(case_id, "Container stopped by user")
++        return CaseActionResponse(case_id=case_id, action=action_key, status="STOPPED", message="Stopped")
++
++    if action_key == "restart":
++        if not container_id:
++            raise HTTPException(status_code=400, detail="No existing container to restart")
++        container = get_managed_container(case_id, container_id)
++        container.start()
++        wait_for_container_running(docker.from_env(), container_id, STARTUP_TIMEOUT_SECONDS)
++        container.reload()
++        container_port = data.get("container_port")
++        host_port = data.get("host_port") or runtime.get("host_port") or resolve_host_port(container, container_port)
++        access_url = data.get("access_url") or runtime.get("access_url")
++        if host_port and not access_url:
++            access_url = f"http://{PUBLIC_HOST}:{host_port}"
++        update_case(
++            case_id,
++            {
++                "status": "RUNNING",
++                "stage": "run",
++                "error_code": None,
++                "error_message": None,
++                "container_id": container_id,
++                "host_port": host_port,
++                "access_url": access_url,
++                "runtime": {
++                    **runtime,
++                    "container_id": container_id,
++                    "host_port": host_port,
++                    "access_url": access_url,
++                    "started_at": time.time(),
++                    "exited_at": None,
++                    "exit_code": None,
++                },
++            },
++        )
++        append_system_log(case_id, "Container restarted")
++        return CaseActionResponse(case_id=case_id, action=action_key, status="RUNNING", message="Restarted")
++
++    if action_key == "retry":
++        repo_url = data.get("repo_url")
++        if not repo_url:
++            raise HTTPException(status_code=400, detail="Missing repo_url for retry")
++        ref = data.get("ref") or data.get("branch") or DEFAULT_BRANCH
++        container_port = data.get("container_port")
++        retry_env = env or {}
++        env_keys = sorted(retry_env.keys()) if retry_env else sorted(data.get("env_keys") or [])
++        attempt = int(data.get("attempt") or 1) + 1
++        retry_of = data.get("retry_of") or case_id
++        update_case(
++            case_id,
++            {
++                "status": "PENDING",
++                "stage": "system",
++                "error_code": None,
++                "error_message": None,
++                "env_keys": env_keys,
++                "attempt": attempt,
++                "retry_of": retry_of,
++            },
++        )
++        append_system_log(case_id, "Retry requested")
++        build_and_run.delay(case_id, repo_url, ref, container_port, retry_env, False)
++        return CaseActionResponse(case_id=case_id, action=action_key, status="PENDING", message="Retry started")
++
++    if action_key == "archive":
++        update_case(case_id, {"archived": True, "archived_at": time.time()})
++        append_system_log(case_id, "Case archived")
++        return CaseActionResponse(case_id=case_id, action=action_key, status="ARCHIVED", message="Archived")
++
++    raise HTTPException(status_code=400, detail="Unsupported action")
++
++
++@app.post("/cases/{case_id}/actions", response_model=CaseActionResponse)
++async def case_actions(case_id: str, payload: CaseActionRequest) -> CaseActionResponse:
++    return handle_case_action(case_id, payload.action, payload.env)
++
++
++@app.post("/cases/{case_id}/stop", response_model=CaseActionResponse)
++async def case_stop(case_id: str) -> CaseActionResponse:
++    return handle_case_action(case_id, "stop")
++
++
++@app.post("/cases/{case_id}/restart", response_model=CaseActionResponse)
++async def case_restart(case_id: str) -> CaseActionResponse:
++    return handle_case_action(case_id, "restart")
++
++
++@app.post("/cases/{case_id}/retry", response_model=CaseActionResponse)
++async def case_retry(
++    case_id: str,
++    payload: CaseRetryRequest = Body(default_factory=CaseRetryRequest),
++) -> CaseActionResponse:
++    env = payload.env
++    return handle_case_action(case_id, "retry", env)
++
++
++@app.post("/cases/{case_id}/archive", response_model=CaseActionResponse)
++async def case_archive(case_id: str) -> CaseActionResponse:
++    return handle_case_action(case_id, "archive")
++
++
+ @app.post("/cases/{case_id}/analyze")
+ async def trigger_analyze(case_id: str) -> Dict[str, str]:
+     data = get_case(case_id)
+@@ -254,5 +528,27 @@
+ 
+ 
+ @app.get("/cases/{case_id}/logs")
+-async def http_logs(case_id: str) -> List[Dict[str, Any]]:
+-    return get_logs(case_id)
++async def http_logs(
++    case_id: str,
++    limit: int = Query(200, ge=1, le=2000, description="Number of lines from tail"),
++    offset: int = Query(0, ge=0, description="Offset from tail"),
++    format: Optional[str] = Query(None, description="json | jsonl"),
++) -> Any:
++    get_case_or_404(case_id)
++    entries = get_logs_slice(case_id, offset=offset, limit=limit)
++    if format == "jsonl":
++        return PlainTextResponse(build_jsonl(entries), media_type="application/jsonl")
++    return entries
++
++
++@app.get("/cases/{case_id}/logs/download")
++async def download_logs(
++    case_id: str,
++    limit: int = Query(1000, ge=1, le=2000, description="Number of lines from tail"),
++    offset: int = Query(0, ge=0, description="Offset from tail"),
++) -> StreamingResponse:
++    get_case_or_404(case_id)
++    entries = get_logs_slice(case_id, offset=offset, limit=limit)
++    payload = build_jsonl(entries).encode("utf-8")
++    headers = {"Content-Disposition": f"attachment; filename={case_id}.jsonl"}
++    return StreamingResponse(iter([payload]), media_type="application/jsonl", headers=headers)
+--- storage.py
++++ storage.py
+@@ -39,6 +39,19 @@
+     return {key: json.loads(value) for key, value in raw.items()}
+ 
+ 
++def list_case_ids() -> List[str]:
++    client = get_redis_client()
++    cursor = 0
++    keys: List[str] = []
++    pattern = f"{CASE_PREFIX}*"
++    while True:
++        cursor, batch = client.scan(cursor=cursor, match=pattern, count=200)
++        keys.extend(batch)
++        if cursor == 0:
++            break
++    return [key.replace(CASE_PREFIX, "", 1) for key in keys]
++
++
+ def append_log(case_id: str, message: LogRaw) -> Dict[str, Any]:
+     client = get_redis_client()
+     payload = _decode_log_entry(message)
+@@ -57,6 +70,21 @@
+     return [_decode_log_entry(entry) for entry in entries]
+ 
+ 
++def get_logs_slice(case_id: str, offset: int = 0, limit: int = 200) -> List[Dict[str, Any]]:
++    if limit <= 0:
++        return []
++    if offset < 0:
++        offset = 0
++    entries = get_logs(case_id)
++    if not entries:
++        return []
++    end = len(entries) - offset
++    if end <= 0:
++        return []
++    start = max(0, end - limit)
++    return entries[start:end]
++
++
+ def log_channel(case_id: str) -> str:
+     return f"{WS_LOG_CHANNEL_PREFIX}{case_id}"
+ 
+--- worker.py
++++ worker.py
+@@ -11,6 +11,8 @@
+ 
+ from config import (
+     BUILD_ROOT,
++    CASE_LABEL_KEY,
++    CASE_LABEL_MANAGED,
+     DEFAULT_BRANCH,
+     DOCKER_BUILD_TIMEOUT_SECONDS,
+     PORT_MODE,
+@@ -188,13 +190,15 @@
+         dockerfile = ensure_dockerfile(target_dir)
+         resolved_port = container_port or detect_exposed_port(dockerfile)
+ 
++        existing = get_case(case_id) or {}
++        env_keys = sorted(env.keys()) if env else sorted(existing.get("env_keys") or [])
+         update_case(
+             case_id,
+             {
+                 "status": "BUILDING",
+                 "stage": "build",
+                 "container_port": resolved_port,
+-                "env_keys": sorted(env.keys()),
++                "env_keys": env_keys,
+             },
+         )
+ 
+@@ -207,11 +211,25 @@
+ 
+         update_case(case_id, {"status": "STARTING", "stage": "run"})
+ 
++        labels = {CASE_LABEL_KEY: case_id, CASE_LABEL_MANAGED: "true"}
+         if PORT_MODE == "dynamic":
+-            container_id, host_port = run_container_dynamic(client, tag, resolved_port, env)
++            container_id, host_port = run_container_dynamic(
++                client,
++                tag,
++                resolved_port,
++                env,
++                labels=labels,
++            )
+         else:
+             host_port = reserve_port(case_id)
+-            container_id = run_container_fixed(client, tag, resolved_port, host_port, env)
++            container_id = run_container_fixed(
++                client,
++                tag,
++                resolved_port,
++                host_port,
++                env,
++                labels=labels,
++            )
+ 
+         wait_for_container_running(client, container_id, STARTUP_TIMEOUT_SECONDS)
+         access_url = f"http://{PUBLIC_HOST}:{host_port}"
+--- third.md
++++ third.md
+@@ -0,0 +1,126 @@
++# Phase 3 可展示并且管理验收报告
++
++## 1. 概述 / 范围 / 结论
++- 验收范围：Dashboard 列表管理、搜索/筛选/分页、详情管理动作（Stop/Restart/Retry/Archive）、日志导出、OpenAPI 对齐、Demo 脚本与 E2E 证据。
++- 结论：PASS（管理 API + 前端控制台闭环完成，可用于演示与基础运维操作）。
++
++## 2. 新增能力清单
++- Dashboard（/）：列表管理、搜索、状态筛选、分页、归档可见控制。
++- 详情页管理动作：Stop / Restart / Retry / Archive（均带二次确认与结果提示）。
++- 日志管理：历史日志查询 + JSONL 下载导出。
++- 容器可识别性：所有容器打 label（`antihub.case_id`、`antihub.managed=true`），动作只操作带 label 的容器。
++
++## 3. 管理 API 契约（OpenAPI 可见）
++
++### 3.1 列表查询
++- `GET /cases?q=&status=&stage=&page=&size=&include_archived=`
++- 返回：`items[] + {total,page,size}`
++- 示例（节选）：`.devlogs/phase3_cases_page1.json`
++```json
++{
++  "items": [
++    {
++      "case_id": "c_95d61d",
++      "status": "RUNNING",
++      "stage": "run",
++      "repo_url": "/home/user2643/code/AntiHub/test-repos/hello-world",
++      "ref": "master",
++      "runtime": {"host_port":30000,"access_url":"http://localhost:30000"},
++      "updated_at": 1769088996.6860673
++    }
++  ],
++  "total": 1,
++  "page": 1,
++  "size": 5
++}
++```
++
++### 3.2 管理动作
++- `POST /cases/{id}/stop`
++- `POST /cases/{id}/restart`
++- `POST /cases/{id}/retry`（可带 `env` 覆盖）
++- `POST /cases/{id}/archive`
++- 示例（Stop）：`.devlogs/phase3_case1_stop.json`
++```json
++{"case_id":"c_95d61d","action":"stop","status":"STOPPED","message":"Stopped"}
++```
++- 示例（Restart）：`.devlogs/phase3_case1_restart.json`
++```json
++{"case_id":"c_95d61d","action":"restart","status":"RUNNING","message":"Restarted"}
++```
++- 示例（Retry）：`.devlogs/phase3_case3_retry.json`
++```json
++{"case_id":"c_a88c95","action":"retry","status":"PENDING","message":"Retry started"}
++```
++- 示例（Archive）：`.devlogs/phase3_case2_archive.json`
++```json
++{"case_id":"c_d2be0f","action":"archive","status":"ARCHIVED","message":"Archived"}
++```
++
++### 3.3 日志查询/导出
++- `GET /cases/{id}/logs?limit=1000&offset=0&format=jsonl`
++- `GET /cases/{id}/logs/download?limit=1000`（浏览器下载）
++- 示例（JSONL 导出）：`.devlogs/phase3_case1_logs.jsonl`
++```json
++{"ts": 1769088996.689066, "stream": "system", "level": "INFO", "line": "Container started: http://localhost:30000"}
++```
++
++## 4. Demo Script（5 分钟）
++1) 打开控制台 `http://127.0.0.1:5173`，进入 Dashboard
++2) 新建案例：填写 `repo_url` + 可选 `ref` + env（只填 key 或打码 value）
++3) 返回列表：看到新 case 出现在顶部，状态变化可见
++4) 进入详情：查看状态/阶段、运行信息、env_keys、实时日志
++5) 点击 Stop：状态变为 STOPPED（提示成功）
++6) 点击 Restart：状态恢复 RUNNING
++7) 点击“下载 1000 行”：导出日志 JSONL
++8) 点击 Archive：列表默认隐藏；切换“显示归档”可再次看到
++
++## 5. E2E 用例证据
++
++### 用例 1：轻量仓 hello-world（RUNNING + Stop/Restart + 日志导出）
++- 创建响应：`.devlogs/phase3_case1_create.json`（`case_id = c_95d61d`）
++- 列表可见：`.devlogs/phase3_cases_page1.json`
++- 运行状态：`.devlogs/phase3_case1_status.json`
++- 访问验证：`curl http://localhost:30000/` -> `HTTP/1.0 200 OK`
++- Stop：`.devlogs/phase3_case1_stop.json`，状态：`.devlogs/phase3_case1_stopped_status.json`
++- Restart：`.devlogs/phase3_case1_restart.json`，状态：`.devlogs/phase3_case1_restart_status.json`
++- 日志导出：`.devlogs/phase3_case1_logs.jsonl`
++- 结论：PASS
++
++### 用例 2：MetaGPT 场景（RUNNING）
++- 创建响应：`.devlogs/phase3_case4_create.json`（`case_id = c_f02478`）
++- 状态响应：`.devlogs/phase3_case4_status.json`（`RUNNING`，`env_keys=["OPENAI_API_KEY"]`）
++- 访问验证：`curl http://localhost:30000/` -> `HTTP/1.0 200 OK`
++- 结论：PASS
++
++### 用例 3：失败场景 + Retry + Archive
++- 失败构建：`.devlogs/phase3_case3_status.json`（`error_code=DOCKER_BUILD_FAILED`）
++- Retry：`.devlogs/phase3_case3_retry.json` 与 `.devlogs/phase3_case3_retry_status.json`（attempt=2，env_keys 保留）
++- Archive：`.devlogs/phase3_case2_archive.json`；列表默认隐藏 `.devlogs/phase3_cases_no_archived.json`；include_archived 显示 `.devlogs/phase3_cases_with_archived.json`
++- 结论：PASS
++
++## 6. 问题清单与修复记录
++1) 管理动作需要可识别容器
++- 修复：新增容器 label（`antihub.case_id` / `antihub.managed=true`），仅对带 label 容器执行 stop/restart
++
++2) Retry 的 env_keys 展示
++- 修复：当 Retry 未提供 env 时，沿用已有 env_keys（不存 env value）
++
++3) 日志导出
++- 修复：新增 JSONL 导出与下载接口，并在前端提供按钮
++
++Patch：`phase3.patch`
++- 应用：`patch -p0 < phase3.patch`
++- 回滚：`patch -p0 -R < phase3.patch`
++
++## 7. 启动说明
++- 后端：`./dev.sh up`
++- 前端：`cd frontend && npm i && npm run dev`
++- 说明：如在 WSL 环境，请使用 WSL 内部 Node/npm（避免 Windows npm 访问 UNC 路径失败）
++
++## 8. Phase 4 建议
++1) 列表性能与索引（Redis 索引/分页优化）
++2) 多项目视角与角色权限
++3) 日志与指标聚合（服务级别状态视图）
++4) 长任务治理（重试策略、队列可视化）
++5) 容器生命周期与资源配额管理
+--- frontend/src/App.tsx
++++ frontend/src/App.tsx
+@@ -22,6 +22,27 @@
+   error_message?: string | null;
+   created_at?: number | null;
+   updated_at?: number | null;
++  repo_url?: string | null;
++  ref?: string | null;
++  branch?: string | null;
++  archived?: boolean;
++  archived_at?: number | null;
++  attempt?: number | null;
++  retry_of?: string | null;
++};
++
++type CaseListResponse = {
++  items: CaseResponse[];
++  total: number;
++  page: number;
++  size: number;
++};
++
++type CaseActionResponse = {
++  case_id: string;
++  action: string;
++  status: string;
++  message: string;
+ };
+ 
+ type LogEntry = {
+@@ -31,7 +52,13 @@
+   line: string;
+ };
+ 
++type Toast = {
++  type: "success" | "error";
++  message: string;
++};
++
+ type Route =
++  | { type: "dashboard" }
+   | { type: "create" }
+   | {
+       type: "case";
+@@ -47,6 +74,7 @@
+   GIT_CLONE_TIMEOUT: "Git 克隆超时，请重试或使用更小的仓库。",
+   STARTUP_TIMEOUT: "容器启动超时，请确认监听 0.0.0.0 且 EXPOSE 端口正确。",
+   CONTAINER_EXIT_NONZERO: "容器非零退出，请查看容器日志。",
++  STOPPED_BY_USER: "已由用户手动停止。",
+   UNEXPECTED_ERROR: "未知错误，请查看日志详情。",
+ };
+ 
+@@ -71,29 +99,12 @@
+   BUILDING: "构建中",
+   STARTING: "启动中",
+   RUNNING: "运行中",
++  STOPPED: "已停止",
+   FAILED: "失败",
+   FINISHED: "已结束",
+   ANALYZING: "分析中",
+ };
+ 
+-function streamLabel(stream: string) {
+-  return STREAM_LABELS[stream] || stream;
+-}
+-
+-function statusLabel(status?: string) {
+-  if (!status) return "-";
+-  const normalized = status.toUpperCase();
+-  const label = STATUS_LABELS[normalized];
+-  return label ? `${label} (${normalized})` : normalized;
+-}
+-
+-function stageLabel(stage?: string) {
+-  if (!stage) return "-";
+-  const normalized = stage.toLowerCase();
+-  const label = STAGE_LABELS[normalized];
+-  return label ? `${label} (${normalized})` : stage;
+-}
+-
+ function joinUrl(base: string, path: string) {
+   const trimmed = base.replace(/\/+$/, "");
+   return `${trimmed}${path}`;
+@@ -110,11 +121,14 @@
+ }
+ 
+ function parseRoute(pathname: string): Route {
++  if (pathname.startsWith("/create")) {
++    return { type: "create" };
++  }
+   const match = pathname.match(/^\/cases\/([^/]+)$/);
+   if (match && match[1]) {
+     return { type: "case", caseId: match[1] };
+   }
+-  return { type: "create" };
++  return { type: "dashboard" };
+ }
+ 
+ function useRoute() {
+@@ -144,6 +158,7 @@
+   const normalized = (status || "").toUpperCase();
+   if (normalized === "RUNNING") return "running";
+   if (normalized === "FAILED") return "failed";
++  if (normalized === "STOPPED") return "neutral";
+   if (normalized === "BUILDING" || normalized === "CLONING" || normalized === "STARTING") {
+     return "working";
+   }
+@@ -151,6 +166,24 @@
+   return "neutral";
+ }
+ 
++function streamLabel(stream: string) {
++  return STREAM_LABELS[stream] || stream;
++}
++
++function statusLabel(status?: string) {
++  if (!status) return "-";
++  const normalized = status.toUpperCase();
++  const label = STATUS_LABELS[normalized];
++  return label ? `${label} (${normalized})` : normalized;
++}
++
++function stageLabel(stage?: string) {
++  if (!stage) return "-";
++  const normalized = stage.toLowerCase();
++  const label = STAGE_LABELS[normalized];
++  return label ? `${label} (${normalized})` : stage;
++}
++
+ function App() {
+   const { route, navigate } = useRoute();
+   const [flashCaseId, setFlashCaseId] = useState<string | null>(null);
+@@ -159,21 +192,27 @@
+     <div className="app">
+       <header className="topbar">
+         <div className="brand">
+-            <div className="brand-mark">AH</div>
++          <div className="brand-mark">AH</div>
+           <div>
+             <div className="brand-title">AntiHub 控制台</div>
+-            <div className="brand-sub">阶段 2 - 创建、观测、对齐</div>
++            <div className="brand-sub">阶段 3 - 可展示与管理</div>
+           </div>
+         </div>
+         <div className="topbar-actions">
+-          <button className="ghost" onClick={() => navigate("/")}>新建案例</button>
++          <button className="ghost" onClick={() => navigate("/")}>控制台</button>
++          <button className="ghost" onClick={() => navigate("/create")}>新建案例</button>
+           <a className="ghost" href="http://127.0.0.1:8010/docs" target="_blank" rel="noreferrer">
+             API 文档
+           </a>
+         </div>
+       </header>
+       <main className="main">
+-        {route.type === "create" ? (
++        {route.type === "dashboard" ? (
++          <Dashboard
++            onOpen={(caseId) => navigate(`/cases/${caseId}`)}
++            onCreate={() => navigate("/create")}
++          />
++        ) : route.type === "create" ? (
+           <CreateCase
+             onCreated={(caseId) => {
+               setFlashCaseId(caseId);
+@@ -373,6 +412,283 @@
+   );
+ }
+ 
++function Dashboard({ onOpen, onCreate }: { onOpen: (caseId: string) => void; onCreate: () => void }) {
++  const [cases, setCases] = useState<CaseResponse[]>([]);
++  const [total, setTotal] = useState(0);
++  const [page, setPage] = useState(1);
++  const [size, setSize] = useState(10);
++  const [query, setQuery] = useState("");
++  const [status, setStatus] = useState("");
++  const [stage, setStage] = useState("");
++  const [includeArchived, setIncludeArchived] = useState(false);
++  const [loading, setLoading] = useState(false);
++  const [error, setError] = useState<string | null>(null);
++  const [toast, setToast] = useState<Toast | null>(null);
++
++  const fetchCases = useCallback(async () => {
++    setLoading(true);
++    setError(null);
++    try {
++      const params = new URLSearchParams();
++      params.set("page", String(page));
++      params.set("size", String(size));
++      if (query.trim()) params.set("q", query.trim());
++      if (status) params.set("status", status);
++      if (stage) params.set("stage", stage);
++      if (includeArchived) params.set("include_archived", "true");
++      const response = await fetch(joinUrl(API_BASE, `/cases?${params.toString()}`));
++      if (!response.ok) {
++        throw new Error(`请求失败 (${response.status})`);
++      }
++      const data = (await response.json()) as CaseListResponse;
++      setCases(data.items || []);
++      setTotal(data.total || 0);
++    } catch (err) {
++      setError(err instanceof Error ? err.message : "加载失败");
++    } finally {
++      setLoading(false);
++    }
++  }, [page, size, query, status, stage, includeArchived]);
++
++  useEffect(() => {
++    fetchCases();
++  }, [fetchCases]);
++
++  useEffect(() => {
++    if (!toast) return undefined;
++    const timer = window.setTimeout(() => setToast(null), 3000);
++    return () => window.clearTimeout(timer);
++  }, [toast]);
++
++  const totalPages = Math.max(1, Math.ceil(total / size));
++  const runningCount = cases.filter((item) => item.status?.toUpperCase() === "RUNNING").length;
++  const failedCount = cases.filter((item) => item.status?.toUpperCase() === "FAILED").length;
++
++  const handleAction = async (caseId: string, action: "stop" | "retry" | "archive") => {
++    const confirmText =
++      action === "stop"
++        ? "确认停止该运行中的案例？"
++        : action === "retry"
++        ? "确认重试该失败案例？"
++        : "确认归档该案例？";
++    if (!window.confirm(confirmText)) return;
++    try {
++      const response = await fetch(joinUrl(API_BASE, `/cases/${caseId}/${action}`), {
++        method: "POST",
++        headers: { "Content-Type": "application/json" },
++        body: action === "retry" ? JSON.stringify({}) : undefined,
++      });
++      if (!response.ok) {
++        const text = await response.text();
++        throw new Error(text || `操作失败 (${response.status})`);
++      }
++      const data = (await response.json()) as CaseActionResponse;
++      setToast({ type: "success", message: `操作成功：${data.message}` });
++      fetchCases();
++    } catch (err) {
++      setToast({ type: "error", message: err instanceof Error ? err.message : "操作失败" });
++    }
++  };
++
++  return (
++    <div className="dashboard">
++      <div className="dashboard-head">
++        <div>
++          <div className="section-title">案例列表</div>
++          <div className="section-sub">支持搜索、筛选、分页与管理动作。</div>
++        </div>
++        <div className="dashboard-actions">
++          <button className="ghost" type="button" onClick={fetchCases}>
++            刷新列表
++          </button>
++          <button className="primary" type="button" onClick={onCreate}>
++            新建案例
++          </button>
++        </div>
++      </div>
++
++      <div className="stats">
++        <div className="card stat-card">
++          <div className="stat-title">总数</div>
++          <div className="stat-value">{total}</div>
++        </div>
++        <div className="card stat-card">
++          <div className="stat-title">运行中</div>
++          <div className="stat-value">{runningCount}</div>
++        </div>
++        <div className="card stat-card">
++          <div className="stat-title">失败</div>
++          <div className="stat-value">{failedCount}</div>
++        </div>
++      </div>
++
++      <div className="filters-panel card">
++        <label className="field">
++          <span>搜索</span>
++          <input
++            type="text"
++            placeholder="case_id / repo / ref"
++            value={query}
++            onChange={(event) => {
++              setQuery(event.target.value);
++              setPage(1);
++            }}
++          />
++        </label>
++        <label className="field">
++          <span>状态</span>
++          <select
++            value={status}
++            onChange={(event) => {
++              setStatus(event.target.value);
++              setPage(1);
++            }}
++          >
++            <option value="">全部</option>
++            <option value="RUNNING">RUNNING</option>
++            <option value="FAILED">FAILED</option>
++            <option value="STOPPED">STOPPED</option>
++            <option value="PENDING">PENDING</option>
++            <option value="BUILDING">BUILDING</option>
++          </select>
++        </label>
++        <label className="field">
++          <span>阶段</span>
++          <select
++            value={stage}
++            onChange={(event) => {
++              setStage(event.target.value);
++              setPage(1);
++            }}
++          >
++            <option value="">全部</option>
++            <option value="clone">clone</option>
++            <option value="build">build</option>
++            <option value="run">run</option>
++            <option value="analyze">analyze</option>
++            <option value="system">system</option>
++          </select>
++        </label>
++        <label className="field checkbox">
++          <span>显示归档</span>
++          <input
++            type="checkbox"
++            checked={includeArchived}
++            onChange={(event) => {
++              setIncludeArchived(event.target.checked);
++              setPage(1);
++            }}
++          />
++        </label>
++        <label className="field">
++          <span>每页</span>
++          <select
++            value={String(size)}
++            onChange={(event) => {
++              setSize(Number(event.target.value));
++              setPage(1);
++            }}
++          >
++            <option value="10">10</option>
++            <option value="20">20</option>
++            <option value="50">50</option>
++          </select>
++        </label>
++      </div>
++
++      {toast ? (
++        <div className={toast.type === "success" ? "success-banner" : "error-banner"}>{toast.message}</div>
++      ) : null}
++      {error ? <div className="error-banner">{error}</div> : null}
++
++      <div className="card table-card">
++        <div className="table">
++          <div className="table-header">
++            <span>case_id</span>
++            <span>repo/ref</span>
++            <span>状态/阶段</span>
++            <span>更新时间</span>
++            <span>访问</span>
++            <span>错误码</span>
++            <span>操作</span>
++          </div>
++          {loading ? (
++            <div className="table-empty">加载中...</div>
++          ) : cases.length ? (
++            cases.map((item) => {
++              const runtime = item.runtime || {};
++              const statusUpper = (item.status || "").toUpperCase();
++              return (
++                <div className="table-row" key={item.case_id}>
++                  <span className="mono">{item.case_id}</span>
++                  <span className="table-repo">
++                    <div className="mono">{item.repo_url || "-"}</div>
++                    <div className="muted">{item.ref || item.branch || "-"}</div>
++                  </span>
++                  <span>
++                    <span className={`badge badge--${statusTone(item.status)}`}>{statusLabel(item.status)}</span>
++                    <span className="stage">{stageLabel(item.stage)}</span>
++                  </span>
++                  <span>{formatTime(item.updated_at)}</span>
++                  <span>
++                    {runtime.access_url ? (
++                      <a href={runtime.access_url} target="_blank" rel="noreferrer">
++                        {runtime.access_url}
++                      </a>
++                    ) : runtime.host_port ? (
++                      <span>{runtime.host_port}</span>
++                    ) : (
++                      "-"
++                    )}
++                  </span>
++                  <span className="mono">{statusUpper === "FAILED" ? item.error_code || "-" : "-"}</span>
++                  <span className="table-actions">
++                    <button className="ghost" onClick={() => onOpen(item.case_id)}>详情</button>
++                    <button
++                      className="ghost"
++                      disabled={statusUpper !== "RUNNING"}
++                      onClick={() => handleAction(item.case_id, "stop")}
++                    >
++                      停止
++                    </button>
++                    <button
++                      className="ghost"
++                      disabled={statusUpper !== "FAILED"}
++                      onClick={() => handleAction(item.case_id, "retry")}
++                    >
++                      重试
++                    </button>
++                    <button className="ghost" onClick={() => handleAction(item.case_id, "archive")}>
++                      归档
++                    </button>
++                  </span>
++                </div>
++              );
++            })
++          ) : (
++            <div className="table-empty">暂无案例</div>
++          )}
++        </div>
++        <div className="pagination">
++          <button className="ghost" disabled={page <= 1} onClick={() => setPage((p) => Math.max(1, p - 1))}>
++            上一页
++          </button>
++          <span>
++            第 {page} / {totalPages} 页
++          </span>
++          <button
++            className="ghost"
++            disabled={page >= totalPages}
++            onClick={() => setPage((p) => Math.min(totalPages, p + 1))}
++          >
++            下一页
++          </button>
++        </div>
++      </div>
++    </div>
++  );
++}
++
+ function CaseDetail({
+   caseId,
+   onBack,
+@@ -387,6 +703,7 @@
+   const [caseData, setCaseData] = useState<CaseResponse | null>(null);
+   const [loadError, setLoadError] = useState<string | null>(null);
+   const [loading, setLoading] = useState(false);
++  const [toast, setToast] = useState<Toast | null>(null);
+   const statusRef = useRef<string>("");
+   const fetchLock = useRef(false);
+ 
+@@ -443,7 +760,7 @@
+       if (cancelled) return;
+       await fetchCase(true);
+       const status = statusRef.current.toUpperCase();
+-      const slow = status === "RUNNING" || status === "FAILED" || status === "FINISHED";
++      const slow = status === "RUNNING" || status === "FAILED" || status === "STOPPED" || status === "FINISHED";
+       const delay = slow ? 5000 : 2000;
+       timer = window.setTimeout(poll, delay);
+     };
+@@ -462,10 +779,63 @@
+     return undefined;
+   }, [flashCaseId, clearFlash]);
+ 
++  useEffect(() => {
++    if (!toast) return undefined;
++    const timer = window.setTimeout(() => setToast(null), 3000);
++    return () => window.clearTimeout(timer);
++  }, [toast]);
++
+   const runtime = caseData?.runtime || {};
+   const envKeys = caseData?.env_keys || [];
+   const errorCode = caseData?.error_code || undefined;
+   const errorMessage = caseData?.error_message || undefined;
++  const statusUpper = (caseData?.status || "").toUpperCase();
++
++  const runAction = async (action: "stop" | "restart" | "retry" | "archive") => {
++    const confirmText =
++      action === "stop"
++        ? "确认停止该运行中的案例？"
++        : action === "restart"
++        ? "确认重新启动该案例？"
++        : action === "retry"
++        ? "确认重新构建并运行该案例？"
++        : "确认归档该案例？";
++    if (!window.confirm(confirmText)) return;
++    try {
++      const response = await fetch(joinUrl(API_BASE, `/cases/${caseId}/${action}`), {
++        method: "POST",
++        headers: { "Content-Type": "application/json" },
++        body: action === "retry" ? JSON.stringify({}) : undefined,
++      });
++      if (!response.ok) {
++        const text = await response.text();
++        throw new Error(text || `操作失败 (${response.status})`);
++      }
++      const data = (await response.json()) as CaseActionResponse;
++      setToast({ type: "success", message: `操作成功：${data.message}` });
++      fetchCase();
++    } catch (err) {
++      setToast({ type: "error", message: err instanceof Error ? err.message : "操作失败" });
++    }
++  };
++
++  const copyLogs = async () => {
++    try {
++      const response = await fetch(joinUrl(API_BASE, `/cases/${caseId}/logs?limit=1000&format=jsonl`));
++      if (!response.ok) {
++        throw new Error(`导出失败 (${response.status})`);
++      }
++      const text = await response.text();
++      await navigator.clipboard.writeText(text);
++      setToast({ type: "success", message: "已复制最近 1000 行日志" });
++    } catch (err) {
++      setToast({ type: "error", message: err instanceof Error ? err.message : "导出失败" });
++    }
++  };
++
++  const downloadLogs = () => {
++    window.open(joinUrl(API_BASE, `/cases/${caseId}/logs/download?limit=1000`), "_blank");
++  };
+ 
+   return (
+     <div className="detail">
+@@ -479,6 +849,9 @@
+         </button>
+       </div>
+       {flashCaseId ? <div className="success-banner">创建成功：{flashCaseId}</div> : null}
++      {toast ? (
++        <div className={toast.type === "success" ? "success-banner" : "error-banner"}>{toast.message}</div>
++      ) : null}
+       {loadError ? <div className="error-banner">{loadError}</div> : null}
+       <div className="detail-grid">
+         <section className="card" style={{ animationDelay: "0.05s" }}>
+@@ -522,6 +895,27 @@
+           </div>
+         </section>
+         <section className="card" style={{ animationDelay: "0.18s" }}>
++          <div className="section-title">管理动作</div>
++          <div className="action-grid">
++            <button className="ghost" disabled={statusUpper !== "RUNNING"} onClick={() => runAction("stop")}>
++              停止
++            </button>
++            <button
++              className="ghost"
++              disabled={!(statusUpper === "STOPPED" || statusUpper === "FAILED")}
++              onClick={() => runAction("restart")}
++            >
++              重启
++            </button>
++            <button className="ghost" disabled={statusUpper !== "FAILED"} onClick={() => runAction("retry")}>
++              重试
++            </button>
++            <button className="ghost" onClick={() => runAction("archive")}>
++              归档
++            </button>
++          </div>
++        </section>
++        <section className="card" style={{ animationDelay: "0.2s" }}>
+           <div className="section-title">环境变量键</div>
+           {envKeys.length ? (
+             <div className="chips">
+@@ -546,7 +940,7 @@
+           </section>
+         ) : null}
+         <section className="card logs" style={{ animationDelay: "0.3s" }}>
+-          <LogPanel caseId={caseId} />
++          <LogPanel caseId={caseId} onCopyLogs={copyLogs} onDownloadLogs={downloadLogs} />
+         </section>
+       </div>
+     </div>
+@@ -573,7 +967,15 @@
+   );
+ }
+ 
+-function LogPanel({ caseId }: { caseId: string }) {
++function LogPanel({
++  caseId,
++  onCopyLogs,
++  onDownloadLogs,
++}: {
++  caseId: string;
++  onCopyLogs: () => void;
++  onDownloadLogs: () => void;
++}) {
+   const [logs, setLogs] = useState<LogEntry[]>([]);
+   const [autoScroll, setAutoScroll] = useState(true);
+   const [status, setStatus] = useState<"connecting" | "open" | "closed" | "error">(
+@@ -668,6 +1070,12 @@
+           </div>
+         </div>
+         <div className="logs-actions">
++          <button className="ghost" type="button" onClick={onCopyLogs}>
++            复制 JSONL
++          </button>
++          <button className="ghost" type="button" onClick={onDownloadLogs}>
++            下载 1000 行
++          </button>
+           <button className="ghost" type="button" onClick={() => setAutoScroll((value) => !value)}>
+             {autoScroll ? "暂停滚动" : "自动滚动"}
+           </button>
+--- frontend/src/styles.css
++++ frontend/src/styles.css
+@@ -300,6 +300,128 @@
+   font-size: 14px;
+ }
+ 
++.dashboard {
++  display: flex;
++  flex-direction: column;
++  gap: 20px;
++}
++
++.dashboard-head {
++  display: flex;
++  justify-content: space-between;
++  align-items: center;
++  gap: 16px;
++}
++
++.dashboard-actions {
++  display: flex;
++  gap: 12px;
++}
++
++.stats {
++  display: grid;
++  grid-template-columns: repeat(3, 1fr);
++  gap: 16px;
++}
++
++.stat-card {
++  display: flex;
++  flex-direction: column;
++  gap: 6px;
++}
++
++.stat-title {
++  color: var(--muted);
++  font-size: 13px;
++}
++
++.stat-value {
++  font-size: 24px;
++  font-weight: 700;
++}
++
++.filters-panel {
++  display: grid;
++  grid-template-columns: repeat(5, minmax(0, 1fr));
++  gap: 12px;
++  align-items: end;
++}
++
++.filters-panel select,
++.filters-panel input {
++  padding: 10px 12px;
++  border-radius: 12px;
++  border: 1px solid var(--border);
++}
++
++.table-card {
++  padding: 0;
++  overflow: hidden;
++}
++
++.table {
++  display: grid;
++}
++
++.table-header,
++.table-row {
++  display: grid;
++  grid-template-columns: 1.2fr 2fr 1.6fr 1.2fr 1.6fr 1fr 1.6fr;
++  gap: 12px;
++  padding: 16px 20px;
++  align-items: center;
++}
++
++.table-header {
++  font-size: 13px;
++  font-weight: 600;
++  color: var(--muted);
++  text-transform: uppercase;
++  letter-spacing: 0.5px;
++  background: rgba(30, 111, 122, 0.06);
++}
++
++.table-row {
++  border-top: 1px solid var(--border);
++  font-size: 14px;
++}
++
++.table-row a {
++  color: var(--accent-strong);
++  text-decoration: none;
++}
++
++.table-repo {
++  display: flex;
++  flex-direction: column;
++  gap: 4px;
++}
++
++.table-actions {
++  display: flex;
++  gap: 8px;
++  flex-wrap: wrap;
++}
++
++.table-empty {
++  padding: 24px;
++  color: var(--muted);
++}
++
++.pagination {
++  display: flex;
++  justify-content: space-between;
++  align-items: center;
++  padding: 16px 20px;
++  border-top: 1px solid var(--border);
++}
++
++.action-grid {
++  display: grid;
++  grid-template-columns: repeat(2, minmax(0, 1fr));
++  gap: 10px;
++}
++
+ .detail {
+   display: flex;
+   flex-direction: column;
+@@ -574,6 +696,14 @@
+     grid-template-columns: 1fr;
+   }
+ 
++  .stats {
++    grid-template-columns: 1fr;
++  }
++
++  .filters-panel {
++    grid-template-columns: 1fr;
++  }
++
+   .detail-grid {
+     grid-template-columns: 1fr;
+   }
+@@ -597,4 +727,15 @@
+   .log-line {
+     grid-template-columns: 1fr;
+   }
++
++  .table-header,
++  .table-row {
++    grid-template-columns: 1fr;
++    gap: 6px;
++  }
++
++  .pagination {
++    flex-direction: column;
++    gap: 12px;
++  }
+ }
diff -ruN '--exclude=.devlogs' '--exclude=venv' '--exclude=node_modules' '--exclude=__pycache__' /tmp/AntiHub.phase3.base/phase4.patch /home/user2643/code/AntiHub/phase4.patch
--- /tmp/AntiHub.phase3.base/phase4.patch	1970-01-01 08:00:00.000000000 +0800
+++ /home/user2643/code/AntiHub/phase4.patch	2026-01-23 00:23:04.810565638 +0800
@@ -0,0 +1,9765 @@
+diff -ruN '--exclude=.devlogs' '--exclude=venv' '--exclude=node_modules' '--exclude=__pycache__' /tmp/AntiHub.phase3.base/config.py /home/user2643/code/AntiHub/config.py
+--- /tmp/AntiHub.phase3.base/config.py	2026-01-22 21:52:23.262380687 +0800
++++ /home/user2643/code/AntiHub/config.py	2026-01-22 22:43:15.719418211 +0800
+@@ -1,28 +1,83 @@
+-import os
+-
+-REDIS_URL = os.getenv("REDIS_URL", "redis://localhost:6379/0")
+-PUBLIC_HOST = os.getenv("PUBLIC_HOST", "localhost")
+-DEFAULT_BRANCH = os.getenv("DEFAULT_BRANCH", "main")
+-BUILD_ROOT = os.getenv("BUILD_ROOT", "/tmp/builds")
+-
+-PORT_POOL_START = int(os.getenv("PORT_POOL_START", "30000"))
+-PORT_POOL_END = int(os.getenv("PORT_POOL_END", "30100"))
+-PORT_MODE = os.getenv("PORT_MODE", "pool")  # pool | dynamic
+-
+-LOG_RETENTION_LINES = int(os.getenv("LOG_RETENTION_LINES", "2000"))
+-LOG_LIST_PREFIX = os.getenv("LOG_LIST_PREFIX", "logs:")
+-WS_LOG_CHANNEL_PREFIX = os.getenv("WS_LOG_CHANNEL_PREFIX", "build_logs:")
+-CASE_PREFIX = os.getenv("CASE_PREFIX", "case:")
++import os
++from typing import Any, Dict
++
++import yaml
++
++ROOT_DIR = os.path.dirname(__file__)
++APP_ENV = os.getenv("APP_ENV", "dev")
++CONFIG_PATH = os.getenv("CONFIG_PATH", os.path.join(ROOT_DIR, "config.yaml"))
++
++
++def _load_config(path: str, env: str) -> Dict[str, Any]:
++    if not os.path.exists(path):
++        return {}
++    try:
++        with open(path, "r", encoding="utf-8") as handle:
++            data = yaml.safe_load(handle) or {}
++    except Exception:
++        return {}
++    if isinstance(data, dict) and env in data and isinstance(data[env], dict):
++        return data[env]
++    if isinstance(data, dict):
++        return data
++    return {}
++
++
++_CONFIG = _load_config(CONFIG_PATH, APP_ENV)
++
++
++def _get(name: str, default: Any) -> Any:
++    if name in os.environ:
++        return os.environ[name]
++    if isinstance(_CONFIG, dict):
++        if name in _CONFIG:
++            return _CONFIG[name]
++        lower = name.lower()
++        if lower in _CONFIG:
++            return _CONFIG[lower]
++    return default
++
++
++REDIS_URL = _get("REDIS_URL", "redis://localhost:6379/0")
++PUBLIC_HOST = _get("PUBLIC_HOST", "localhost")
++DEFAULT_BRANCH = _get("DEFAULT_BRANCH", "main")
++BUILD_ROOT = _get("BUILD_ROOT", "/tmp/builds")
++MANUAL_ROOT = _get("MANUAL_ROOT", "/tmp/manuals")
++AUTO_MANUAL = str(_get("AUTO_MANUAL", "false")).lower() in {"1", "true", "yes"}
++MANUAL_TREE_DEPTH = int(_get("MANUAL_TREE_DEPTH", "2"))
++MANUAL_MAX_README_CHARS = int(_get("MANUAL_MAX_README_CHARS", "1200"))
++MANUAL_GENERATOR_VERSION = str(_get("MANUAL_GENERATOR_VERSION", "v0.4"))
++
++PORT_POOL_START = int(_get("PORT_POOL_START", "30000"))
++PORT_POOL_END = int(_get("PORT_POOL_END", "30100"))
++PORT_MODE = str(_get("PORT_MODE", "pool"))  # pool | dynamic
++
++LOG_RETENTION_LINES = int(_get("LOG_RETENTION_LINES", "2000"))
++LOG_LIST_PREFIX = _get("LOG_LIST_PREFIX", "logs:")
++WS_LOG_CHANNEL_PREFIX = _get("WS_LOG_CHANNEL_PREFIX", "build_logs:")
++CASE_PREFIX = _get("CASE_PREFIX", "case:")
++MANUAL_PREFIX = _get("MANUAL_PREFIX", "manual:")
++MANUAL_META_PREFIX = _get("MANUAL_META_PREFIX", "manual_meta:")
++MANUAL_STATUS_PREFIX = _get("MANUAL_STATUS_PREFIX", "manual_status:")
++MANUAL_STATS_KEY = _get("MANUAL_STATS_KEY", "manual_stats")
+ 
+ CORS_ORIGINS = [
+     origin.strip()
+-    for origin in os.getenv(
+-        "CORS_ORIGINS",
+-        "http://127.0.0.1:5173,http://localhost:5173",
++    for origin in str(
++        _get(
++            "CORS_ORIGINS",
++            "http://127.0.0.1:5173,http://localhost:5173",
++        )
+     ).split(",")
+     if origin.strip()
+ ]
+-
+-GIT_CLONE_TIMEOUT_SECONDS = int(os.getenv("GIT_CLONE_TIMEOUT_SECONDS", "120"))
+-DOCKER_BUILD_TIMEOUT_SECONDS = int(os.getenv("DOCKER_BUILD_TIMEOUT_SECONDS", "1800"))
+-STARTUP_TIMEOUT_SECONDS = int(os.getenv("STARTUP_TIMEOUT_SECONDS", "120"))
++
++CASE_LABEL_KEY = _get("CASE_LABEL_KEY", "antihub.case_id")
++CASE_LABEL_MANAGED = _get("CASE_LABEL_MANAGED", "antihub.managed")
++
++GIT_CLONE_TIMEOUT_SECONDS = int(_get("GIT_CLONE_TIMEOUT_SECONDS", "120"))
++DOCKER_BUILD_TIMEOUT_SECONDS = int(_get("DOCKER_BUILD_TIMEOUT_SECONDS", "1800"))
++STARTUP_TIMEOUT_SECONDS = int(_get("STARTUP_TIMEOUT_SECONDS", "120"))
++ANALYZE_TIMEOUT_SECONDS = int(_get("ANALYZE_TIMEOUT_SECONDS", "300"))
++
++CASE_TEMPLATES = _get("CASE_TEMPLATES", [])
+diff -ruN '--exclude=.devlogs' '--exclude=venv' '--exclude=node_modules' '--exclude=__pycache__' /tmp/AntiHub.phase3.base/config.yaml /home/user2643/code/AntiHub/config.yaml
+--- /tmp/AntiHub.phase3.base/config.yaml	1970-01-01 08:00:00.000000000 +0800
++++ /home/user2643/code/AntiHub/config.yaml	2026-01-22 22:46:56.591476419 +0800
+@@ -0,0 +1,43 @@
++dev:
++  public_host: "localhost"
++  auto_manual: false
++  manual_root: "/tmp/manuals"
++  manual_tree_depth: 2
++  manual_max_readme_chars: 1200
++  manual_generator_version: "v0.4"
++  git_clone_timeout_seconds: 120
++  docker_build_timeout_seconds: 1800
++  startup_timeout_seconds: 120
++  analyze_timeout_seconds: 300
++  case_templates:
++    - name: "Hello World"
++      repo_url: "/home/user2643/code/AntiHub/test-repos/hello-world"
++      ref: "master"
++      default_env_keys: []
++      build_mode: "light"
++      port_mode: "pool"
++      timeouts:
++        clone: 120
++        build: 1800
++        run: 120
++        analyze: 300
++    - name: "MetaGPT Demo"
++      repo_url: "/home/user2643/code/AntiHub/test-repos/metagpt-min"
++      ref: "master"
++      default_env_keys:
++        - "OPENAI_API_KEY"
++      build_mode: "standard"
++      port_mode: "pool"
++      timeouts:
++        clone: 120
++        build: 1800
++        run: 120
++        analyze: 300
++prod:
++  public_host: "127.0.0.1"
++  auto_manual: true
++  manual_root: "/data/manuals"
++  manual_tree_depth: 2
++  manual_max_readme_chars: 1200
++  manual_generator_version: "v0.4"
++  case_templates: []
+diff -ruN '--exclude=.devlogs' '--exclude=venv' '--exclude=node_modules' '--exclude=__pycache__' /tmp/AntiHub.phase3.base/docker_ops.py /home/user2643/code/AntiHub/docker_ops.py
+--- /tmp/AntiHub.phase3.base/docker_ops.py	2026-01-20 20:43:28.985769484 +0800
++++ /home/user2643/code/AntiHub/docker_ops.py	2026-01-22 21:21:11.782959255 +0800
+@@ -66,12 +66,14 @@
+     image: str,
+     container_port: int,
+     environment: Optional[Dict[str, str]] = None,
++    labels: Optional[Dict[str, str]] = None,
+ ) -> Tuple[str, int]:
+     container = client.containers.run(
+         image,
+         detach=True,
+         ports={f"{container_port}/tcp": None},
+         environment=environment or {},
++        labels=labels or {},
+     )
+     container.reload()
+     ports = container.attrs.get("NetworkSettings", {}).get("Ports", {})
+@@ -88,12 +90,14 @@
+     container_port: int,
+     host_port: int,
+     environment: Optional[Dict[str, str]] = None,
++    labels: Optional[Dict[str, str]] = None,
+ ) -> str:
+     container = client.containers.run(
+         image,
+         detach=True,
+         ports={f"{container_port}/tcp": host_port},
+         environment=environment or {},
++        labels=labels or {},
+     )
+     return container.id
+ 
+diff -ruN '--exclude=.devlogs' '--exclude=venv' '--exclude=node_modules' '--exclude=__pycache__' /tmp/AntiHub.phase3.base/errors.py /home/user2643/code/AntiHub/errors.py
+--- /tmp/AntiHub.phase3.base/errors.py	1970-01-01 08:00:00.000000000 +0800
++++ /home/user2643/code/AntiHub/errors.py	2026-01-22 22:53:19.796045952 +0800
+@@ -0,0 +1,90 @@
++from typing import Dict
++
++ERROR_CODE_MAP: Dict[str, Dict[str, str]] = {
++    "PORT_POOL_EXHAUSTED": {
++        "message": "端口池已满",
++        "hint": "停止旧容器或扩大端口范围。",
++    },
++    "PORT_IN_USE": {
++        "message": "端口已被占用",
++        "hint": "请等待端口释放或改用其他端口。",
++    },
++    "GIT_CLONE_FAILED": {
++        "message": "Git 克隆失败",
++        "hint": "检查仓库地址、网络与权限配置。",
++    },
++    "GIT_CLONE_TIMEOUT": {
++        "message": "Git 克隆超时",
++        "hint": "缩小仓库或提升克隆超时。",
++    },
++    "DOCKER_BUILD_FAILED": {
++        "message": "Docker 构建失败",
++        "hint": "检查 Dockerfile 与构建日志。",
++    },
++    "DOCKER_API_ERROR": {
++        "message": "Docker 守护进程异常",
++        "hint": "确认 Docker 服务可用、磁盘空间充足。",
++    },
++    "DOCKERFILE_MISSING": {
++        "message": "Dockerfile 缺失",
++        "hint": "请在仓库根目录补齐 Dockerfile。",
++    },
++    "CONTAINER_EXITED": {
++        "message": "容器启动阶段退出",
++        "hint": "确认进程持续运行且监听端口正确。",
++    },
++    "CONTAINER_EXIT_NONZERO": {
++        "message": "容器非零退出",
++        "hint": "检查应用启动日志与依赖配置。",
++    },
++    "STARTUP_TIMEOUT": {
++        "message": "容器启动超时",
++        "hint": "确认应用监听 0.0.0.0 且端口匹配 EXPOSE。",
++    },
++    "TIMEOUT_CLONE": {
++        "message": "克隆超时",
++        "hint": "优化仓库体积或提升超时配置。",
++    },
++    "TIMEOUT_BUILD": {
++        "message": "构建超时",
++        "hint": "减少构建步骤或提升超时配置。",
++    },
++    "TIMEOUT_RUN": {
++        "message": "启动超时",
++        "hint": "检查应用启动耗时与健康检查。",
++    },
++    "TIMEOUT_ANALYZE": {
++        "message": "分析超时",
++        "hint": "简化分析步骤或提升超时配置。",
++    },
++    "STOPPED_BY_USER": {
++        "message": "已手动停止",
++        "hint": "可使用 Restart 重新启动。",
++    },
++    "ARCHIVED": {
++        "message": "已归档",
++        "hint": "可在列表中启用 include_archived 查看。",
++    },
++    "MANUAL_GENERATION_FAILED": {
++        "message": "说明书生成失败",
++        "hint": "检查仓库结构与 README，稍后重试。",
++    },
++    "MANUAL_CLONE_FAILED": {
++        "message": "说明书克隆失败",
++        "hint": "确认仓库地址可访问。",
++    },
++    "MANUAL_PARSE_FAILED": {
++        "message": "说明书解析失败",
++        "hint": "检查仓库文件编码与权限。",
++    },
++    "UNEXPECTED_ERROR": {
++        "message": "未知错误",
++        "hint": "查看日志详情或联系管理员。",
++    },
++}
++
++
++def explain_error(code: str | None) -> Dict[str, str] | None:
++    if not code:
++        return None
++    return ERROR_CODE_MAP.get(code)
+diff -ruN '--exclude=.devlogs' '--exclude=venv' '--exclude=node_modules' '--exclude=__pycache__' /tmp/AntiHub.phase3.base/fourth.md /home/user2643/code/AntiHub/fourth.md
+--- /tmp/AntiHub.phase3.base/fourth.md	1970-01-01 08:00:00.000000000 +0800
++++ /home/user2643/code/AntiHub/fourth.md	2026-01-23 00:22:56.582925795 +0800
+@@ -0,0 +1,157 @@
++# Phase 4 智能展厅 + 体验打磨·配置升级验收报告
++
++## 1. 概述 / 范围 / 结论
++- 范围：在 Phase 3 Dashboard + 运维动作 + 日志导出基础上，新增“说明书自动生成 + Mermaid + 前端展示”，补齐错误码字典、healthz、配置体系与模板、端口池锁、超时控制与日志脱敏。
++- 结论：**PASS**（后端与核心能力完成；前端依赖已在 WSL 内安装成功，启动步骤见第 11 节）。
++
++## 2. 新增能力清单（Phase 4）
++- 智能展厅：支持每个 case 生成说明书 Markdown（含 Mermaid 图），支持状态查询与手动重新生成。
++- Dashboard：新增说明书状态列、模板创建入口、管理动作与分页筛选。
++- 详情页：Tab 化（Overview / Logs / Manual），Manual 支持 Markdown + Mermaid 渲染。
++- 体验打磨：错误统一 toast（带详情展开）、日志搜索/过滤/跳到最新/自动重连。
++- 后端稳定性：healthz、错误码字典、日志敏感信息脱敏、端口池锁优化。
++- 配置体系：`config.yaml` + 环境变量覆盖，新增 Case Template 方案。
++
++## 3. Manual 模板与信号来源说明
++- README：优先 `README.md/README.MD/README`，截取前 1200 字摘要。
++- Tree：默认深度 2，过滤 `.git/node_modules/venv/dist/build` 等目录。
++- 配置文件：识别 `.env(.example)`、`*.yaml/yml/toml/json`、`docker-compose.yml`、`pyproject.toml`、`package.json`、`requirements.txt`。
++- Dockerfile：解析 base image、EXPOSE、CMD/ENTRYPOINT；无 Dockerfile 则在说明书提示。
++- 降级策略：README 缺失时仍输出最小可用说明书（signals.has_readme = false）。
++
++## 4. Manual API 契约（OpenAPI 可见）
++- `POST /cases/{id}/manual`：触发生成，返回状态。
++- `GET /cases/{id}/manual/status`：查询状态（PENDING/RUNNING/SUCCESS/FAILED）。
++- `GET /cases/{id}/manual`：获取说明书 Markdown + meta。
++- 管理接口：`GET /cases`、`POST /cases/{id}/stop|restart|retry|archive`、`GET /cases/{id}/logs`。
++- 相关管理 API：`GET /case-templates`、`GET /error-codes`、`GET /stats`、`GET /healthz`。
++
++示例：
++```json
++// POST /cases/{id}/manual
++{"case_id":"c_ddec58","status":"PENDING"}
++```
++```json
++// GET /cases/{id}/manual
++{
++  "case_id":"c_ddec58",
++  "manual_markdown":"# ...",
++  "meta":{
++    "generated_at":1769096734.13,
++    "generator_version":"v0.4",
++    "signals":{"has_readme":true,"has_dockerfile":true,"tree_depth":2,"file_count":3},
++    "time_cost_ms":12
++  }
++}
++```
++
++## 5. Mermaid 示例（来自说明书）
++```mermaid
++flowchart TD
++  A[Repo Source] --> B[Build Image]
++  B --> C[Container Runtime]
++  C --> D[Access URL]
++  C --> E[Logs Stream]
++```
++
++## 6. UX 打磨项
++- 全局错误提示：统一 toast + 详情展开。
++- 日志体验：关键词搜索 + stream 过滤 + 自动滚动/暂停 + “跳到最新” + 断线自动重连（指数退避）。
++- 危险操作：Stop/Retry/Archive/Regenerate 二次确认 + 操作反馈。
++- 空态/加载态：Manual 未生成、日志为空、请求失败均有提示。
++
++## 7. 配置体系说明（config.yaml + env 覆盖）
++- 新增 `config.yaml`：支持 dev/prod 配置，支持 `APP_ENV` / `CONFIG_PATH` 覆盖。
++- Case Template：`name/repo_url/ref/default_env_keys/build_mode/port_mode/timeouts`。
++- 说明书生成配置：`manual_root/manual_tree_depth/manual_max_readme_chars`。
++
++## 8. 端口池 / 状态机 / 错误码字典
++- 状态机：PENDING/CLONING/BUILDING/STARTING/RUNNING/FAILED/STOPPED/FINISHED/ARCHIVED（归档为软删除，不影响运行状态）。
++- 端口池：Redis 端口锁，容器退出或 stop 时释放，防止并发冲突。
++- 错误码字典：`/error-codes` 提供 message + hint（如 TIMEOUT_*、PORT_*、DOCKER_*）。
++
++## 9. 测试证据（6 项 + 2 仓库 E2E）
++1) 说明书生成（README 正常）：
++- case：`c_ddec58`
++- 证据：`.devlogs/phase4_case3_manual.json`
++
++2) 说明书降级（README 缺失）：
++- case：`c_d8cd8e`
++- 证据：`.devlogs/phase4_fail_manual.json`（signals.has_readme=false）
++
++3) Regenerate 更新：
++- case：`c_ddec58`
++- 证据：`.devlogs/phase4_case3_manual_regen.json`
++
++4) 安全脱敏（日志中 *_KEY/*TOKEN/*SECRET）：
++- case：`c_ddec58`
++- 证据：`.devlogs/phase4_case3_logs_scrub.jsonl`（value 已替换为 ***）
++
++5) /healthz 正常与 Redis Down：
++- 证据：`.devlogs/phase4_healthz_ok.json`、`.devlogs/phase4_healthz_redis_down.json`
++
++6) 端口池并发（3 个 case 同时启动）：
++- 证据：`.devlogs/phase4_port_pool_status2.json`（30000/30001/30002）
++
++E2E 用例 1（hello-world RUNNING）：
++- case：`c_ddec58`
++- 状态：`.devlogs/phase4_case3_status.json`
++- 日志：`.devlogs/phase4_case3_logs.jsonl`
++- 访问：`http://localhost:30000` -> 200
++
++E2E 用例 2（metagpt-min RUNNING）：
++- case：`c_2c1376`
++- 状态：`.devlogs/phase4_case_metagpt_status.json`
++- 日志：`.devlogs/phase4_case_metagpt_logs.jsonl`
++- 访问：`http://localhost:30003` -> 200
++
++失败/重试/归档链路：
++- case：`c_d8cd8e`
++- 失败：`.devlogs/phase4_fail_status.json`
++- Retry：`.devlogs/phase4_fail_retry.json`、`.devlogs/phase4_fail_status_after_retry.json`
++- Archive：`.devlogs/phase4_fail_archive.json` + 列表对比（`.devlogs/phase4_list_no_archived2.json` / `.devlogs/phase4_list_include_archived2.json`）
++
++## 10. 演示脚本（5 分钟）
++1) 进入 Dashboard，刷新列表与筛选状态。
++2) 进入 Create 页面，选择模板 / 填写 repo，创建 case。
++3) 列表中出现新 case，进入详情页查看状态与 access_url。
++4) 打开 Logs 页，演示搜索/过滤/自动重连。
++5) 切换 Manual 页，展示说明书与 Mermaid。
++6) 点击 Stop -> Restart，查看状态变化。
++7) 触发 Retry（失败 case）并查看错误码。
++8) 导出日志 JSONL。
++9) Archive 隐藏 case，include_archived 再查看。
++
++## 11. 启动说明
++- 后端：`./dev.sh up`
++- 前端：`cd frontend && npm install && npm run dev`
++- 配置：`config.yaml`（可用 `APP_ENV` / `CONFIG_PATH` 覆盖）
++
++## 12. 问题清单与修复记录（含 patch）
++- 已修复：说明书生成、配置体系、错误码字典、healthz、端口锁与日志脱敏。
++- 已修复：前端依赖安装 UNC 路径问题（WSL 内使用 Node 18 后安装成功）。
++- 当前阻塞：无。
++
++Patch：`phase4.patch`
++- 应用：`patch -p0 < phase4.patch`
++- 回滚：`patch -R -p0 < phase4.patch`
++
++## 13. 对接/沟通清单 + SLA
++对接清单（需甲方确认）：
++- 镜像源/镜像仓库（私有仓库账号与白名单）
++- 资源配额（CPU/Mem/GPU、磁盘、并发限制）
++- 网络策略（出站限制、域名白名单、端口范围）
++- 运行域名与 HTTPS 证书
++- 日志与监控平台接入方式
++
++响应机制（建议 SLA）：
++- P0（全站不可用）：1 小时内响应、4 小时内恢复
++- P1（核心功能不可用）：4 小时内响应、24 小时内恢复
++- P2（局部/边缘问题）：1 个工作日内响应
++
++## 14. Phase 5 建议
++1) 生产化部署（镜像化、多环境配置、CI/CD）
++2) 说明书模板可编辑与版本对比
++3) 更完善的权限与审计
++4) 扩展观测指标（Prometheus/Grafana）
++5) 产出完整交付包与运维手册
+diff -ruN '--exclude=.devlogs' '--exclude=venv' '--exclude=node_modules' '--exclude=__pycache__' /tmp/AntiHub.phase3.base/frontend/package-lock.json /home/user2643/code/AntiHub/frontend/package-lock.json
+--- /tmp/AntiHub.phase3.base/frontend/package-lock.json	2026-01-22 21:52:23.262380687 +0800
++++ /home/user2643/code/AntiHub/frontend/package-lock.json	2026-01-23 00:21:40.859431137 +0800
+@@ -8,6 +8,8 @@
+       "name": "antihub-console",
+       "version": "0.0.0",
+       "dependencies": {
++        "marked": "^12.0.2",
++        "mermaid": "^10.9.1",
+         "react": "^18.3.1",
+         "react-dom": "^18.3.1"
+       },
+@@ -301,6 +303,12 @@
+         "node": ">=6.9.0"
+       }
+     },
++    "node_modules/@braintree/sanitize-url": {
++      "version": "6.0.4",
++      "resolved": "https://registry.npmjs.org/@braintree/sanitize-url/-/sanitize-url-6.0.4.tgz",
++      "integrity": "sha512-s3jaWicZd0pkP0jf5ysyHUI/RE7MHos6qlToFcGWXVp+ykHOy77OUMrfbgJ9it2C5bow7OIQwYYaHjk9XlBQ2A==",
++      "license": "MIT"
++    },
+     "node_modules/@esbuild/aix-ppc64": {
+       "version": "0.21.5",
+       "resolved": "https://registry.npmjs.org/@esbuild/aix-ppc64/-/aix-ppc64-0.21.5.tgz",
+@@ -1144,6 +1152,36 @@
+         "@babel/types": "^7.28.2"
+       }
+     },
++    "node_modules/@types/d3-scale": {
++      "version": "4.0.9",
++      "resolved": "https://registry.npmjs.org/@types/d3-scale/-/d3-scale-4.0.9.tgz",
++      "integrity": "sha512-dLmtwB8zkAeO/juAMfnV+sItKjlsw2lKdZVVy6LRr0cBmegxSABiLEpGVmSJJ8O08i4+sGR6qQtb6WtuwJdvVw==",
++      "license": "MIT",
++      "dependencies": {
++        "@types/d3-time": "*"
++      }
++    },
++    "node_modules/@types/d3-scale-chromatic": {
++      "version": "3.1.0",
++      "resolved": "https://registry.npmjs.org/@types/d3-scale-chromatic/-/d3-scale-chromatic-3.1.0.tgz",
++      "integrity": "sha512-iWMJgwkK7yTRmWqRB5plb1kadXyQ5Sj8V/zYlFGMUBbIPKQScw+Dku9cAAMgJG+z5GYDoMjWGLVOvjghDEFnKQ==",
++      "license": "MIT"
++    },
++    "node_modules/@types/d3-time": {
++      "version": "3.0.4",
++      "resolved": "https://registry.npmjs.org/@types/d3-time/-/d3-time-3.0.4.tgz",
++      "integrity": "sha512-yuzZug1nkAAaBlBBikKZTgzCeA+k1uy4ZFwWANOfKw5z5LRhV0gNA7gNkKm7HoK+HRN0wX3EkxGk0fpbWhmB7g==",
++      "license": "MIT"
++    },
++    "node_modules/@types/debug": {
++      "version": "4.1.12",
++      "resolved": "https://registry.npmjs.org/@types/debug/-/debug-4.1.12.tgz",
++      "integrity": "sha512-vIChWdVG3LG1SMxEvI/AK+FWJthlrqlTu7fbrlywTkkaONwk/UAGaULXRlf8vkzFBLVm0zkMdCquhL5aOjhXPQ==",
++      "license": "MIT",
++      "dependencies": {
++        "@types/ms": "*"
++      }
++    },
+     "node_modules/@types/estree": {
+       "version": "1.0.8",
+       "resolved": "https://registry.npmjs.org/@types/estree/-/estree-1.0.8.tgz",
+@@ -1151,6 +1189,21 @@
+       "dev": true,
+       "license": "MIT"
+     },
++    "node_modules/@types/mdast": {
++      "version": "3.0.15",
++      "resolved": "https://registry.npmjs.org/@types/mdast/-/mdast-3.0.15.tgz",
++      "integrity": "sha512-LnwD+mUEfxWMa1QpDraczIn6k0Ee3SMicuYSSzS6ZYl2gKS09EClnJYGd8Du6rfc5r/GZEk5o1mRb8TaTj03sQ==",
++      "license": "MIT",
++      "dependencies": {
++        "@types/unist": "^2"
++      }
++    },
++    "node_modules/@types/ms": {
++      "version": "2.1.0",
++      "resolved": "https://registry.npmjs.org/@types/ms/-/ms-2.1.0.tgz",
++      "integrity": "sha512-GsCCIZDE/p3i96vtEqx+7dBUGXrc7zeSK3wwPHIaRThS+9OhWIXRqzs4d6k1SVU8g91DrNRWxWUGhp5KXQb2VA==",
++      "license": "MIT"
++    },
+     "node_modules/@types/prop-types": {
+       "version": "15.7.15",
+       "resolved": "https://registry.npmjs.org/@types/prop-types/-/prop-types-15.7.15.tgz",
+@@ -1179,6 +1232,19 @@
+         "@types/react": "^18.0.0"
+       }
+     },
++    "node_modules/@types/trusted-types": {
++      "version": "2.0.7",
++      "resolved": "https://registry.npmjs.org/@types/trusted-types/-/trusted-types-2.0.7.tgz",
++      "integrity": "sha512-ScaPdn1dQczgbl0QFTeTOmVHFULt394XJgOQNoyVhZ6r2vLnMLJfBPd53SB52T/3G36VI1/g2MZaX0cwDuXsfw==",
++      "license": "MIT",
++      "optional": true
++    },
++    "node_modules/@types/unist": {
++      "version": "2.0.11",
++      "resolved": "https://registry.npmjs.org/@types/unist/-/unist-2.0.11.tgz",
++      "integrity": "sha512-CmBKiL6NNo/OqgmMn95Fk9Whlp2mtvIv+KNpQKN2F4SjvrEesubTRWGYSg+BnWZOnlCaSTU1sMpsBOzgbYhnsA==",
++      "license": "MIT"
++    },
+     "node_modules/@vitejs/plugin-react": {
+       "version": "4.7.0",
+       "resolved": "https://registry.npmjs.org/@vitejs/plugin-react/-/plugin-react-4.7.0.tgz",
+@@ -1265,6 +1331,25 @@
+       ],
+       "license": "CC-BY-4.0"
+     },
++    "node_modules/character-entities": {
++      "version": "2.0.2",
++      "resolved": "https://registry.npmjs.org/character-entities/-/character-entities-2.0.2.tgz",
++      "integrity": "sha512-shx7oQ0Awen/BRIdkjkvz54PnEEI/EjwXDSIZp86/KKdbafHh1Df/RYGBhn4hbe2+uKC9FnT5UCEdyPz3ai9hQ==",
++      "license": "MIT",
++      "funding": {
++        "type": "github",
++        "url": "https://github.com/sponsors/wooorm"
++      }
++    },
++    "node_modules/commander": {
++      "version": "7.2.0",
++      "resolved": "https://registry.npmjs.org/commander/-/commander-7.2.0.tgz",
++      "integrity": "sha512-QrWXB+ZQSVPmIWIhtEO9H+gwHaMGYiF5ChvoJ+K9ZGHG/sVsa6yiesAD1GC/x46sET00Xlwo1u49RVVVzvcSkw==",
++      "license": "MIT",
++      "engines": {
++        "node": ">= 10"
++      }
++    },
+     "node_modules/convert-source-map": {
+       "version": "2.0.0",
+       "resolved": "https://registry.npmjs.org/convert-source-map/-/convert-source-map-2.0.0.tgz",
+@@ -1272,6 +1357,15 @@
+       "dev": true,
+       "license": "MIT"
+     },
++    "node_modules/cose-base": {
++      "version": "1.0.3",
++      "resolved": "https://registry.npmjs.org/cose-base/-/cose-base-1.0.3.tgz",
++      "integrity": "sha512-s9whTXInMSgAp/NVXVNuVxVKzGH2qck3aQlVHxDCdAEPgtMKwc4Wq6/QKhgdEdgbLSi9rBTAcPoRa6JpiG4ksg==",
++      "license": "MIT",
++      "dependencies": {
++        "layout-base": "^1.0.0"
++      }
++    },
+     "node_modules/csstype": {
+       "version": "3.2.3",
+       "resolved": "https://registry.npmjs.org/csstype/-/csstype-3.2.3.tgz",
+@@ -1279,11 +1373,488 @@
+       "dev": true,
+       "license": "MIT"
+     },
++    "node_modules/cytoscape": {
++      "version": "3.33.1",
++      "resolved": "https://registry.npmjs.org/cytoscape/-/cytoscape-3.33.1.tgz",
++      "integrity": "sha512-iJc4TwyANnOGR1OmWhsS9ayRS3s+XQ185FmuHObThD+5AeJCakAAbWv8KimMTt08xCCLNgneQwFp+JRJOr9qGQ==",
++      "license": "MIT",
++      "engines": {
++        "node": ">=0.10"
++      }
++    },
++    "node_modules/cytoscape-cose-bilkent": {
++      "version": "4.1.0",
++      "resolved": "https://registry.npmjs.org/cytoscape-cose-bilkent/-/cytoscape-cose-bilkent-4.1.0.tgz",
++      "integrity": "sha512-wgQlVIUJF13Quxiv5e1gstZ08rnZj2XaLHGoFMYXz7SkNfCDOOteKBE6SYRfA9WxxI/iBc3ajfDoc6hb/MRAHQ==",
++      "license": "MIT",
++      "dependencies": {
++        "cose-base": "^1.0.0"
++      },
++      "peerDependencies": {
++        "cytoscape": "^3.2.0"
++      }
++    },
++    "node_modules/d3": {
++      "version": "7.9.0",
++      "resolved": "https://registry.npmjs.org/d3/-/d3-7.9.0.tgz",
++      "integrity": "sha512-e1U46jVP+w7Iut8Jt8ri1YsPOvFpg46k+K8TpCb0P+zjCkjkPnV7WzfDJzMHy1LnA+wj5pLT1wjO901gLXeEhA==",
++      "license": "ISC",
++      "dependencies": {
++        "d3-array": "3",
++        "d3-axis": "3",
++        "d3-brush": "3",
++        "d3-chord": "3",
++        "d3-color": "3",
++        "d3-contour": "4",
++        "d3-delaunay": "6",
++        "d3-dispatch": "3",
++        "d3-drag": "3",
++        "d3-dsv": "3",
++        "d3-ease": "3",
++        "d3-fetch": "3",
++        "d3-force": "3",
++        "d3-format": "3",
++        "d3-geo": "3",
++        "d3-hierarchy": "3",
++        "d3-interpolate": "3",
++        "d3-path": "3",
++        "d3-polygon": "3",
++        "d3-quadtree": "3",
++        "d3-random": "3",
++        "d3-scale": "4",
++        "d3-scale-chromatic": "3",
++        "d3-selection": "3",
++        "d3-shape": "3",
++        "d3-time": "3",
++        "d3-time-format": "4",
++        "d3-timer": "3",
++        "d3-transition": "3",
++        "d3-zoom": "3"
++      },
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/d3-array": {
++      "version": "3.2.4",
++      "resolved": "https://registry.npmjs.org/d3-array/-/d3-array-3.2.4.tgz",
++      "integrity": "sha512-tdQAmyA18i4J7wprpYq8ClcxZy3SC31QMeByyCFyRt7BVHdREQZ5lpzoe5mFEYZUWe+oq8HBvk9JjpibyEV4Jg==",
++      "license": "ISC",
++      "dependencies": {
++        "internmap": "1 - 2"
++      },
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/d3-axis": {
++      "version": "3.0.0",
++      "resolved": "https://registry.npmjs.org/d3-axis/-/d3-axis-3.0.0.tgz",
++      "integrity": "sha512-IH5tgjV4jE/GhHkRV0HiVYPDtvfjHQlQfJHs0usq7M30XcSBvOotpmH1IgkcXsO/5gEQZD43B//fc7SRT5S+xw==",
++      "license": "ISC",
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/d3-brush": {
++      "version": "3.0.0",
++      "resolved": "https://registry.npmjs.org/d3-brush/-/d3-brush-3.0.0.tgz",
++      "integrity": "sha512-ALnjWlVYkXsVIGlOsuWH1+3udkYFI48Ljihfnh8FZPF2QS9o+PzGLBslO0PjzVoHLZ2KCVgAM8NVkXPJB2aNnQ==",
++      "license": "ISC",
++      "dependencies": {
++        "d3-dispatch": "1 - 3",
++        "d3-drag": "2 - 3",
++        "d3-interpolate": "1 - 3",
++        "d3-selection": "3",
++        "d3-transition": "3"
++      },
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/d3-chord": {
++      "version": "3.0.1",
++      "resolved": "https://registry.npmjs.org/d3-chord/-/d3-chord-3.0.1.tgz",
++      "integrity": "sha512-VE5S6TNa+j8msksl7HwjxMHDM2yNK3XCkusIlpX5kwauBfXuyLAtNg9jCp/iHH61tgI4sb6R/EIMWCqEIdjT/g==",
++      "license": "ISC",
++      "dependencies": {
++        "d3-path": "1 - 3"
++      },
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/d3-color": {
++      "version": "3.1.0",
++      "resolved": "https://registry.npmjs.org/d3-color/-/d3-color-3.1.0.tgz",
++      "integrity": "sha512-zg/chbXyeBtMQ1LbD/WSoW2DpC3I0mpmPdW+ynRTj/x2DAWYrIY7qeZIHidozwV24m4iavr15lNwIwLxRmOxhA==",
++      "license": "ISC",
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/d3-contour": {
++      "version": "4.0.2",
++      "resolved": "https://registry.npmjs.org/d3-contour/-/d3-contour-4.0.2.tgz",
++      "integrity": "sha512-4EzFTRIikzs47RGmdxbeUvLWtGedDUNkTcmzoeyg4sP/dvCexO47AaQL7VKy/gul85TOxw+IBgA8US2xwbToNA==",
++      "license": "ISC",
++      "dependencies": {
++        "d3-array": "^3.2.0"
++      },
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/d3-delaunay": {
++      "version": "6.0.4",
++      "resolved": "https://registry.npmjs.org/d3-delaunay/-/d3-delaunay-6.0.4.tgz",
++      "integrity": "sha512-mdjtIZ1XLAM8bm/hx3WwjfHt6Sggek7qH043O8KEjDXN40xi3vx/6pYSVTwLjEgiXQTbvaouWKynLBiUZ6SK6A==",
++      "license": "ISC",
++      "dependencies": {
++        "delaunator": "5"
++      },
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/d3-dispatch": {
++      "version": "3.0.1",
++      "resolved": "https://registry.npmjs.org/d3-dispatch/-/d3-dispatch-3.0.1.tgz",
++      "integrity": "sha512-rzUyPU/S7rwUflMyLc1ETDeBj0NRuHKKAcvukozwhshr6g6c5d8zh4c2gQjY2bZ0dXeGLWc1PF174P2tVvKhfg==",
++      "license": "ISC",
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/d3-drag": {
++      "version": "3.0.0",
++      "resolved": "https://registry.npmjs.org/d3-drag/-/d3-drag-3.0.0.tgz",
++      "integrity": "sha512-pWbUJLdETVA8lQNJecMxoXfH6x+mO2UQo8rSmZ+QqxcbyA3hfeprFgIT//HW2nlHChWeIIMwS2Fq+gEARkhTkg==",
++      "license": "ISC",
++      "dependencies": {
++        "d3-dispatch": "1 - 3",
++        "d3-selection": "3"
++      },
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/d3-dsv": {
++      "version": "3.0.1",
++      "resolved": "https://registry.npmjs.org/d3-dsv/-/d3-dsv-3.0.1.tgz",
++      "integrity": "sha512-UG6OvdI5afDIFP9w4G0mNq50dSOsXHJaRE8arAS5o9ApWnIElp8GZw1Dun8vP8OyHOZ/QJUKUJwxiiCCnUwm+Q==",
++      "license": "ISC",
++      "dependencies": {
++        "commander": "7",
++        "iconv-lite": "0.6",
++        "rw": "1"
++      },
++      "bin": {
++        "csv2json": "bin/dsv2json.js",
++        "csv2tsv": "bin/dsv2dsv.js",
++        "dsv2dsv": "bin/dsv2dsv.js",
++        "dsv2json": "bin/dsv2json.js",
++        "json2csv": "bin/json2dsv.js",
++        "json2dsv": "bin/json2dsv.js",
++        "json2tsv": "bin/json2dsv.js",
++        "tsv2csv": "bin/dsv2dsv.js",
++        "tsv2json": "bin/dsv2json.js"
++      },
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/d3-ease": {
++      "version": "3.0.1",
++      "resolved": "https://registry.npmjs.org/d3-ease/-/d3-ease-3.0.1.tgz",
++      "integrity": "sha512-wR/XK3D3XcLIZwpbvQwQ5fK+8Ykds1ip7A2Txe0yxncXSdq1L9skcG7blcedkOX+ZcgxGAmLX1FrRGbADwzi0w==",
++      "license": "BSD-3-Clause",
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/d3-fetch": {
++      "version": "3.0.1",
++      "resolved": "https://registry.npmjs.org/d3-fetch/-/d3-fetch-3.0.1.tgz",
++      "integrity": "sha512-kpkQIM20n3oLVBKGg6oHrUchHM3xODkTzjMoj7aWQFq5QEM+R6E4WkzT5+tojDY7yjez8KgCBRoj4aEr99Fdqw==",
++      "license": "ISC",
++      "dependencies": {
++        "d3-dsv": "1 - 3"
++      },
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/d3-force": {
++      "version": "3.0.0",
++      "resolved": "https://registry.npmjs.org/d3-force/-/d3-force-3.0.0.tgz",
++      "integrity": "sha512-zxV/SsA+U4yte8051P4ECydjD/S+qeYtnaIyAs9tgHCqfguma/aAQDjo85A9Z6EKhBirHRJHXIgJUlffT4wdLg==",
++      "license": "ISC",
++      "dependencies": {
++        "d3-dispatch": "1 - 3",
++        "d3-quadtree": "1 - 3",
++        "d3-timer": "1 - 3"
++      },
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/d3-format": {
++      "version": "3.1.2",
++      "resolved": "https://registry.npmjs.org/d3-format/-/d3-format-3.1.2.tgz",
++      "integrity": "sha512-AJDdYOdnyRDV5b6ArilzCPPwc1ejkHcoyFarqlPqT7zRYjhavcT3uSrqcMvsgh2CgoPbK3RCwyHaVyxYcP2Arg==",
++      "license": "ISC",
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/d3-geo": {
++      "version": "3.1.1",
++      "resolved": "https://registry.npmjs.org/d3-geo/-/d3-geo-3.1.1.tgz",
++      "integrity": "sha512-637ln3gXKXOwhalDzinUgY83KzNWZRKbYubaG+fGVuc/dxO64RRljtCTnf5ecMyE1RIdtqpkVcq0IbtU2S8j2Q==",
++      "license": "ISC",
++      "dependencies": {
++        "d3-array": "2.5.0 - 3"
++      },
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/d3-hierarchy": {
++      "version": "3.1.2",
++      "resolved": "https://registry.npmjs.org/d3-hierarchy/-/d3-hierarchy-3.1.2.tgz",
++      "integrity": "sha512-FX/9frcub54beBdugHjDCdikxThEqjnR93Qt7PvQTOHxyiNCAlvMrHhclk3cD5VeAaq9fxmfRp+CnWw9rEMBuA==",
++      "license": "ISC",
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/d3-interpolate": {
++      "version": "3.0.1",
++      "resolved": "https://registry.npmjs.org/d3-interpolate/-/d3-interpolate-3.0.1.tgz",
++      "integrity": "sha512-3bYs1rOD33uo8aqJfKP3JWPAibgw8Zm2+L9vBKEHJ2Rg+viTR7o5Mmv5mZcieN+FRYaAOWX5SJATX6k1PWz72g==",
++      "license": "ISC",
++      "dependencies": {
++        "d3-color": "1 - 3"
++      },
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/d3-path": {
++      "version": "3.1.0",
++      "resolved": "https://registry.npmjs.org/d3-path/-/d3-path-3.1.0.tgz",
++      "integrity": "sha512-p3KP5HCf/bvjBSSKuXid6Zqijx7wIfNW+J/maPs+iwR35at5JCbLUT0LzF1cnjbCHWhqzQTIN2Jpe8pRebIEFQ==",
++      "license": "ISC",
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/d3-polygon": {
++      "version": "3.0.1",
++      "resolved": "https://registry.npmjs.org/d3-polygon/-/d3-polygon-3.0.1.tgz",
++      "integrity": "sha512-3vbA7vXYwfe1SYhED++fPUQlWSYTTGmFmQiany/gdbiWgU/iEyQzyymwL9SkJjFFuCS4902BSzewVGsHHmHtXg==",
++      "license": "ISC",
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/d3-quadtree": {
++      "version": "3.0.1",
++      "resolved": "https://registry.npmjs.org/d3-quadtree/-/d3-quadtree-3.0.1.tgz",
++      "integrity": "sha512-04xDrxQTDTCFwP5H6hRhsRcb9xxv2RzkcsygFzmkSIOJy3PeRJP7sNk3VRIbKXcog561P9oU0/rVH6vDROAgUw==",
++      "license": "ISC",
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/d3-random": {
++      "version": "3.0.1",
++      "resolved": "https://registry.npmjs.org/d3-random/-/d3-random-3.0.1.tgz",
++      "integrity": "sha512-FXMe9GfxTxqd5D6jFsQ+DJ8BJS4E/fT5mqqdjovykEB2oFbTMDVdg1MGFxfQW+FBOGoB++k8swBrgwSHT1cUXQ==",
++      "license": "ISC",
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/d3-sankey": {
++      "version": "0.12.3",
++      "resolved": "https://registry.npmjs.org/d3-sankey/-/d3-sankey-0.12.3.tgz",
++      "integrity": "sha512-nQhsBRmM19Ax5xEIPLMY9ZmJ/cDvd1BG3UVvt5h3WRxKg5zGRbvnteTyWAbzeSvlh3tW7ZEmq4VwR5mB3tutmQ==",
++      "license": "BSD-3-Clause",
++      "dependencies": {
++        "d3-array": "1 - 2",
++        "d3-shape": "^1.2.0"
++      }
++    },
++    "node_modules/d3-sankey/node_modules/d3-array": {
++      "version": "2.12.1",
++      "resolved": "https://registry.npmjs.org/d3-array/-/d3-array-2.12.1.tgz",
++      "integrity": "sha512-B0ErZK/66mHtEsR1TkPEEkwdy+WDesimkM5gpZr5Dsg54BiTA5RXtYW5qTLIAcekaS9xfZrzBLF/OAkB3Qn1YQ==",
++      "license": "BSD-3-Clause",
++      "dependencies": {
++        "internmap": "^1.0.0"
++      }
++    },
++    "node_modules/d3-sankey/node_modules/d3-path": {
++      "version": "1.0.9",
++      "resolved": "https://registry.npmjs.org/d3-path/-/d3-path-1.0.9.tgz",
++      "integrity": "sha512-VLaYcn81dtHVTjEHd8B+pbe9yHWpXKZUC87PzoFmsFrJqgFwDe/qxfp5MlfsfM1V5E/iVt0MmEbWQ7FVIXh/bg==",
++      "license": "BSD-3-Clause"
++    },
++    "node_modules/d3-sankey/node_modules/d3-shape": {
++      "version": "1.3.7",
++      "resolved": "https://registry.npmjs.org/d3-shape/-/d3-shape-1.3.7.tgz",
++      "integrity": "sha512-EUkvKjqPFUAZyOlhY5gzCxCeI0Aep04LwIRpsZ/mLFelJiUfnK56jo5JMDSE7yyP2kLSb6LtF+S5chMk7uqPqw==",
++      "license": "BSD-3-Clause",
++      "dependencies": {
++        "d3-path": "1"
++      }
++    },
++    "node_modules/d3-sankey/node_modules/internmap": {
++      "version": "1.0.1",
++      "resolved": "https://registry.npmjs.org/internmap/-/internmap-1.0.1.tgz",
++      "integrity": "sha512-lDB5YccMydFBtasVtxnZ3MRBHuaoE8GKsppq+EchKL2U4nK/DmEpPHNH8MZe5HkMtpSiTSOZwfN0tzYjO/lJEw==",
++      "license": "ISC"
++    },
++    "node_modules/d3-scale": {
++      "version": "4.0.2",
++      "resolved": "https://registry.npmjs.org/d3-scale/-/d3-scale-4.0.2.tgz",
++      "integrity": "sha512-GZW464g1SH7ag3Y7hXjf8RoUuAFIqklOAq3MRl4OaWabTFJY9PN/E1YklhXLh+OQ3fM9yS2nOkCoS+WLZ6kvxQ==",
++      "license": "ISC",
++      "dependencies": {
++        "d3-array": "2.10.0 - 3",
++        "d3-format": "1 - 3",
++        "d3-interpolate": "1.2.0 - 3",
++        "d3-time": "2.1.1 - 3",
++        "d3-time-format": "2 - 4"
++      },
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/d3-scale-chromatic": {
++      "version": "3.1.0",
++      "resolved": "https://registry.npmjs.org/d3-scale-chromatic/-/d3-scale-chromatic-3.1.0.tgz",
++      "integrity": "sha512-A3s5PWiZ9YCXFye1o246KoscMWqf8BsD9eRiJ3He7C9OBaxKhAd5TFCdEx/7VbKtxxTsu//1mMJFrEt572cEyQ==",
++      "license": "ISC",
++      "dependencies": {
++        "d3-color": "1 - 3",
++        "d3-interpolate": "1 - 3"
++      },
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/d3-selection": {
++      "version": "3.0.0",
++      "resolved": "https://registry.npmjs.org/d3-selection/-/d3-selection-3.0.0.tgz",
++      "integrity": "sha512-fmTRWbNMmsmWq6xJV8D19U/gw/bwrHfNXxrIN+HfZgnzqTHp9jOmKMhsTUjXOJnZOdZY9Q28y4yebKzqDKlxlQ==",
++      "license": "ISC",
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/d3-shape": {
++      "version": "3.2.0",
++      "resolved": "https://registry.npmjs.org/d3-shape/-/d3-shape-3.2.0.tgz",
++      "integrity": "sha512-SaLBuwGm3MOViRq2ABk3eLoxwZELpH6zhl3FbAoJ7Vm1gofKx6El1Ib5z23NUEhF9AsGl7y+dzLe5Cw2AArGTA==",
++      "license": "ISC",
++      "dependencies": {
++        "d3-path": "^3.1.0"
++      },
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/d3-time": {
++      "version": "3.1.0",
++      "resolved": "https://registry.npmjs.org/d3-time/-/d3-time-3.1.0.tgz",
++      "integrity": "sha512-VqKjzBLejbSMT4IgbmVgDjpkYrNWUYJnbCGo874u7MMKIWsILRX+OpX/gTk8MqjpT1A/c6HY2dCA77ZN0lkQ2Q==",
++      "license": "ISC",
++      "dependencies": {
++        "d3-array": "2 - 3"
++      },
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/d3-time-format": {
++      "version": "4.1.0",
++      "resolved": "https://registry.npmjs.org/d3-time-format/-/d3-time-format-4.1.0.tgz",
++      "integrity": "sha512-dJxPBlzC7NugB2PDLwo9Q8JiTR3M3e4/XANkreKSUxF8vvXKqm1Yfq4Q5dl8budlunRVlUUaDUgFt7eA8D6NLg==",
++      "license": "ISC",
++      "dependencies": {
++        "d3-time": "1 - 3"
++      },
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/d3-timer": {
++      "version": "3.0.1",
++      "resolved": "https://registry.npmjs.org/d3-timer/-/d3-timer-3.0.1.tgz",
++      "integrity": "sha512-ndfJ/JxxMd3nw31uyKoY2naivF+r29V+Lc0svZxe1JvvIRmi8hUsrMvdOwgS1o6uBHmiz91geQ0ylPP0aj1VUA==",
++      "license": "ISC",
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/d3-transition": {
++      "version": "3.0.1",
++      "resolved": "https://registry.npmjs.org/d3-transition/-/d3-transition-3.0.1.tgz",
++      "integrity": "sha512-ApKvfjsSR6tg06xrL434C0WydLr7JewBB3V+/39RMHsaXTOG0zmt/OAXeng5M5LBm0ojmxJrpomQVZ1aPvBL4w==",
++      "license": "ISC",
++      "dependencies": {
++        "d3-color": "1 - 3",
++        "d3-dispatch": "1 - 3",
++        "d3-ease": "1 - 3",
++        "d3-interpolate": "1 - 3",
++        "d3-timer": "1 - 3"
++      },
++      "engines": {
++        "node": ">=12"
++      },
++      "peerDependencies": {
++        "d3-selection": "2 - 3"
++      }
++    },
++    "node_modules/d3-zoom": {
++      "version": "3.0.0",
++      "resolved": "https://registry.npmjs.org/d3-zoom/-/d3-zoom-3.0.0.tgz",
++      "integrity": "sha512-b8AmV3kfQaqWAuacbPuNbL6vahnOJflOhexLzMMNLga62+/nh0JzvJ0aO/5a5MVgUFGS7Hu1P9P03o3fJkDCyw==",
++      "license": "ISC",
++      "dependencies": {
++        "d3-dispatch": "1 - 3",
++        "d3-drag": "2 - 3",
++        "d3-interpolate": "1 - 3",
++        "d3-selection": "2 - 3",
++        "d3-transition": "2 - 3"
++      },
++      "engines": {
++        "node": ">=12"
++      }
++    },
++    "node_modules/dagre-d3-es": {
++      "version": "7.0.13",
++      "resolved": "https://registry.npmjs.org/dagre-d3-es/-/dagre-d3-es-7.0.13.tgz",
++      "integrity": "sha512-efEhnxpSuwpYOKRm/L5KbqoZmNNukHa/Flty4Wp62JRvgH2ojwVgPgdYyr4twpieZnyRDdIH7PY2mopX26+j2Q==",
++      "license": "MIT",
++      "dependencies": {
++        "d3": "^7.9.0",
++        "lodash-es": "^4.17.21"
++      }
++    },
++    "node_modules/dayjs": {
++      "version": "1.11.19",
++      "resolved": "https://registry.npmjs.org/dayjs/-/dayjs-1.11.19.tgz",
++      "integrity": "sha512-t5EcLVS6QPBNqM2z8fakk/NKel+Xzshgt8FFKAn+qwlD1pzZWxh0nVCrvFK7ZDb6XucZeF9z8C7CBWTRIVApAw==",
++      "license": "MIT"
++    },
+     "node_modules/debug": {
+       "version": "4.4.3",
+       "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
+       "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
+-      "dev": true,
+       "license": "MIT",
+       "dependencies": {
+         "ms": "^2.1.3"
+@@ -1297,13 +1868,68 @@
+         }
+       }
+     },
++    "node_modules/decode-named-character-reference": {
++      "version": "1.3.0",
++      "resolved": "https://registry.npmjs.org/decode-named-character-reference/-/decode-named-character-reference-1.3.0.tgz",
++      "integrity": "sha512-GtpQYB283KrPp6nRw50q3U9/VfOutZOe103qlN7BPP6Ad27xYnOIWv4lPzo8HCAL+mMZofJ9KEy30fq6MfaK6Q==",
++      "license": "MIT",
++      "dependencies": {
++        "character-entities": "^2.0.0"
++      },
++      "funding": {
++        "type": "github",
++        "url": "https://github.com/sponsors/wooorm"
++      }
++    },
++    "node_modules/delaunator": {
++      "version": "5.0.1",
++      "resolved": "https://registry.npmjs.org/delaunator/-/delaunator-5.0.1.tgz",
++      "integrity": "sha512-8nvh+XBe96aCESrGOqMp/84b13H9cdKbG5P2ejQCh4d4sK9RL4371qou9drQjMhvnPmhWl5hnmqbEE0fXr9Xnw==",
++      "license": "ISC",
++      "dependencies": {
++        "robust-predicates": "^3.0.2"
++      }
++    },
++    "node_modules/dequal": {
++      "version": "2.0.3",
++      "resolved": "https://registry.npmjs.org/dequal/-/dequal-2.0.3.tgz",
++      "integrity": "sha512-0je+qPKHEMohvfRTCEo3CrPG6cAzAYgmzKyxRiYSSDkS6eGJdyVJm7WaYA5ECaAD9wLB2T4EEeymA5aFVcYXCA==",
++      "license": "MIT",
++      "engines": {
++        "node": ">=6"
++      }
++    },
++    "node_modules/diff": {
++      "version": "5.2.2",
++      "resolved": "https://registry.npmjs.org/diff/-/diff-5.2.2.tgz",
++      "integrity": "sha512-vtcDfH3TOjP8UekytvnHH1o1P4FcUdt4eQ1Y+Abap1tk/OB2MWQvcwS2ClCd1zuIhc3JKOx6p3kod8Vfys3E+A==",
++      "license": "BSD-3-Clause",
++      "engines": {
++        "node": ">=0.3.1"
++      }
++    },
++    "node_modules/dompurify": {
++      "version": "3.3.1",
++      "resolved": "https://registry.npmjs.org/dompurify/-/dompurify-3.3.1.tgz",
++      "integrity": "sha512-qkdCKzLNtrgPFP1Vo+98FRzJnBRGe4ffyCea9IwHB1fyxPOeNTHpLKYGd4Uk9xvNoH0ZoOjwZxNptyMwqrId1Q==",
++      "license": "(MPL-2.0 OR Apache-2.0)",
++      "optionalDependencies": {
++        "@types/trusted-types": "^2.0.7"
++      }
++    },
+     "node_modules/electron-to-chromium": {
+-      "version": "1.5.267",
+-      "resolved": "https://registry.npmjs.org/electron-to-chromium/-/electron-to-chromium-1.5.267.tgz",
+-      "integrity": "sha512-0Drusm6MVRXSOJpGbaSVgcQsuB4hEkMpHXaVstcPmhu5LIedxs1xNK/nIxmQIU/RPC0+1/o0AVZfBTkTNJOdUw==",
++      "version": "1.5.277",
++      "resolved": "https://registry.npmjs.org/electron-to-chromium/-/electron-to-chromium-1.5.277.tgz",
++      "integrity": "sha512-wKXFZw4erWmmOz5N/grBoJ2XrNJGDFMu2+W5ACHza5rHtvsqrK4gb6rnLC7XxKB9WlJ+RmyQatuEXmtm86xbnw==",
+       "dev": true,
+       "license": "ISC"
+     },
++    "node_modules/elkjs": {
++      "version": "0.9.3",
++      "resolved": "https://registry.npmjs.org/elkjs/-/elkjs-0.9.3.tgz",
++      "integrity": "sha512-f/ZeWvW/BCXbhGEf1Ujp29EASo/lk1FDnETgNKwJrsVvGZhUWCZyg3xLJjAsxfOmt8KjswHmI5EwCQcPMpOYhQ==",
++      "license": "EPL-2.0"
++    },
+     "node_modules/esbuild": {
+       "version": "0.21.5",
+       "resolved": "https://registry.npmjs.org/esbuild/-/esbuild-0.21.5.tgz",
+@@ -1378,6 +2004,27 @@
+         "node": ">=6.9.0"
+       }
+     },
++    "node_modules/iconv-lite": {
++      "version": "0.6.3",
++      "resolved": "https://registry.npmjs.org/iconv-lite/-/iconv-lite-0.6.3.tgz",
++      "integrity": "sha512-4fCk79wshMdzMp2rH06qWrJE4iolqLhCUH+OiuIgU++RB0+94NlDL81atO7GX55uUKueo0txHNtvEyI6D7WdMw==",
++      "license": "MIT",
++      "dependencies": {
++        "safer-buffer": ">= 2.1.2 < 3.0.0"
++      },
++      "engines": {
++        "node": ">=0.10.0"
++      }
++    },
++    "node_modules/internmap": {
++      "version": "2.0.3",
++      "resolved": "https://registry.npmjs.org/internmap/-/internmap-2.0.3.tgz",
++      "integrity": "sha512-5Hh7Y1wQbvY5ooGgPbDaL5iYLAPzMTUrjMulskHLH6wnv/A+1q5rgEaiuqEjB+oxGXIVZs1FF+R/KPN3ZSQYYg==",
++      "license": "ISC",
++      "engines": {
++        "node": ">=12"
++      }
++    },
+     "node_modules/js-tokens": {
+       "version": "4.0.0",
+       "resolved": "https://registry.npmjs.org/js-tokens/-/js-tokens-4.0.0.tgz",
+@@ -1410,6 +2057,57 @@
+         "node": ">=6"
+       }
+     },
++    "node_modules/katex": {
++      "version": "0.16.27",
++      "resolved": "https://registry.npmjs.org/katex/-/katex-0.16.27.tgz",
++      "integrity": "sha512-aeQoDkuRWSqQN6nSvVCEFvfXdqo1OQiCmmW1kc9xSdjutPv7BGO7pqY9sQRJpMOGrEdfDgF2TfRXe5eUAD2Waw==",
++      "funding": [
++        "https://opencollective.com/katex",
++        "https://github.com/sponsors/katex"
++      ],
++      "license": "MIT",
++      "dependencies": {
++        "commander": "^8.3.0"
++      },
++      "bin": {
++        "katex": "cli.js"
++      }
++    },
++    "node_modules/katex/node_modules/commander": {
++      "version": "8.3.0",
++      "resolved": "https://registry.npmjs.org/commander/-/commander-8.3.0.tgz",
++      "integrity": "sha512-OkTL9umf+He2DZkUq8f8J9of7yL6RJKI24dVITBmNfZBmri9zYZQrKkuXiKhyfPSu8tUhnVBB1iKXevvnlR4Ww==",
++      "license": "MIT",
++      "engines": {
++        "node": ">= 12"
++      }
++    },
++    "node_modules/khroma": {
++      "version": "2.1.0",
++      "resolved": "https://registry.npmjs.org/khroma/-/khroma-2.1.0.tgz",
++      "integrity": "sha512-Ls993zuzfayK269Svk9hzpeGUKob/sIgZzyHYdjQoAdQetRKpOLj+k/QQQ/6Qi0Yz65mlROrfd+Ev+1+7dz9Kw=="
++    },
++    "node_modules/kleur": {
++      "version": "4.1.5",
++      "resolved": "https://registry.npmjs.org/kleur/-/kleur-4.1.5.tgz",
++      "integrity": "sha512-o+NO+8WrRiQEE4/7nwRJhN1HWpVmJm511pBHUxPLtp0BUISzlBplORYSmTclCnJvQq2tKu/sgl3xVpkc7ZWuQQ==",
++      "license": "MIT",
++      "engines": {
++        "node": ">=6"
++      }
++    },
++    "node_modules/layout-base": {
++      "version": "1.0.2",
++      "resolved": "https://registry.npmjs.org/layout-base/-/layout-base-1.0.2.tgz",
++      "integrity": "sha512-8h2oVEZNktL4BH2JCOI90iD1yXwL6iNW7KcCKT2QZgQJR2vbqDsldCTPRU9NifTCqHZci57XvQQ15YTu+sTYPg==",
++      "license": "MIT"
++    },
++    "node_modules/lodash-es": {
++      "version": "4.17.23",
++      "resolved": "https://registry.npmjs.org/lodash-es/-/lodash-es-4.17.23.tgz",
++      "integrity": "sha512-kVI48u3PZr38HdYz98UmfPnXl2DXrpdctLrFLCd3kOx1xUkOmpFPx7gCWWM5MPkL/fD8zb+Ph0QzjGFs4+hHWg==",
++      "license": "MIT"
++    },
+     "node_modules/loose-envify": {
+       "version": "1.4.0",
+       "resolved": "https://registry.npmjs.org/loose-envify/-/loose-envify-1.4.0.tgz",
+@@ -1432,11 +2130,538 @@
+         "yallist": "^3.0.2"
+       }
+     },
++    "node_modules/marked": {
++      "version": "12.0.2",
++      "resolved": "https://registry.npmjs.org/marked/-/marked-12.0.2.tgz",
++      "integrity": "sha512-qXUm7e/YKFoqFPYPa3Ukg9xlI5cyAtGmyEIzMfW//m6kXwCy2Ps9DYf5ioijFKQ8qyuscrHoY04iJGctu2Kg0Q==",
++      "license": "MIT",
++      "bin": {
++        "marked": "bin/marked.js"
++      },
++      "engines": {
++        "node": ">= 18"
++      }
++    },
++    "node_modules/mdast-util-from-markdown": {
++      "version": "1.3.1",
++      "resolved": "https://registry.npmjs.org/mdast-util-from-markdown/-/mdast-util-from-markdown-1.3.1.tgz",
++      "integrity": "sha512-4xTO/M8c82qBcnQc1tgpNtubGUW/Y1tBQ1B0i5CtSoelOLKFYlElIr3bvgREYYO5iRqbMY1YuqZng0GVOI8Qww==",
++      "license": "MIT",
++      "dependencies": {
++        "@types/mdast": "^3.0.0",
++        "@types/unist": "^2.0.0",
++        "decode-named-character-reference": "^1.0.0",
++        "mdast-util-to-string": "^3.1.0",
++        "micromark": "^3.0.0",
++        "micromark-util-decode-numeric-character-reference": "^1.0.0",
++        "micromark-util-decode-string": "^1.0.0",
++        "micromark-util-normalize-identifier": "^1.0.0",
++        "micromark-util-symbol": "^1.0.0",
++        "micromark-util-types": "^1.0.0",
++        "unist-util-stringify-position": "^3.0.0",
++        "uvu": "^0.5.0"
++      },
++      "funding": {
++        "type": "opencollective",
++        "url": "https://opencollective.com/unified"
++      }
++    },
++    "node_modules/mdast-util-to-string": {
++      "version": "3.2.0",
++      "resolved": "https://registry.npmjs.org/mdast-util-to-string/-/mdast-util-to-string-3.2.0.tgz",
++      "integrity": "sha512-V4Zn/ncyN1QNSqSBxTrMOLpjr+IKdHl2v3KVLoWmDPscP4r9GcCi71gjgvUV1SFSKh92AjAG4peFuBl2/YgCJg==",
++      "license": "MIT",
++      "dependencies": {
++        "@types/mdast": "^3.0.0"
++      },
++      "funding": {
++        "type": "opencollective",
++        "url": "https://opencollective.com/unified"
++      }
++    },
++    "node_modules/mermaid": {
++      "version": "10.9.5",
++      "resolved": "https://registry.npmjs.org/mermaid/-/mermaid-10.9.5.tgz",
++      "integrity": "sha512-eRlKEjzak4z1rcXeCd1OAlyawhrptClQDo8OuI8n6bSVqJ9oMfd5Lrf3Q+TdJHewi/9AIOc3UmEo8Fz+kNzzuQ==",
++      "license": "MIT",
++      "dependencies": {
++        "@braintree/sanitize-url": "^6.0.1",
++        "@types/d3-scale": "^4.0.3",
++        "@types/d3-scale-chromatic": "^3.0.0",
++        "cytoscape": "^3.28.1",
++        "cytoscape-cose-bilkent": "^4.1.0",
++        "d3": "^7.4.0",
++        "d3-sankey": "^0.12.3",
++        "dagre-d3-es": "7.0.13",
++        "dayjs": "^1.11.7",
++        "dompurify": "^3.2.4",
++        "elkjs": "^0.9.0",
++        "katex": "^0.16.9",
++        "khroma": "^2.0.0",
++        "lodash-es": "^4.17.21",
++        "mdast-util-from-markdown": "^1.3.0",
++        "non-layered-tidy-tree-layout": "^2.0.2",
++        "stylis": "^4.1.3",
++        "ts-dedent": "^2.2.0",
++        "uuid": "^9.0.0",
++        "web-worker": "^1.2.0"
++      }
++    },
++    "node_modules/micromark": {
++      "version": "3.2.0",
++      "resolved": "https://registry.npmjs.org/micromark/-/micromark-3.2.0.tgz",
++      "integrity": "sha512-uD66tJj54JLYq0De10AhWycZWGQNUvDI55xPgk2sQM5kn1JYlhbCMTtEeT27+vAhW2FBQxLlOmS3pmA7/2z4aA==",
++      "funding": [
++        {
++          "type": "GitHub Sponsors",
++          "url": "https://github.com/sponsors/unifiedjs"
++        },
++        {
++          "type": "OpenCollective",
++          "url": "https://opencollective.com/unified"
++        }
++      ],
++      "license": "MIT",
++      "dependencies": {
++        "@types/debug": "^4.0.0",
++        "debug": "^4.0.0",
++        "decode-named-character-reference": "^1.0.0",
++        "micromark-core-commonmark": "^1.0.1",
++        "micromark-factory-space": "^1.0.0",
++        "micromark-util-character": "^1.0.0",
++        "micromark-util-chunked": "^1.0.0",
++        "micromark-util-combine-extensions": "^1.0.0",
++        "micromark-util-decode-numeric-character-reference": "^1.0.0",
++        "micromark-util-encode": "^1.0.0",
++        "micromark-util-normalize-identifier": "^1.0.0",
++        "micromark-util-resolve-all": "^1.0.0",
++        "micromark-util-sanitize-uri": "^1.0.0",
++        "micromark-util-subtokenize": "^1.0.0",
++        "micromark-util-symbol": "^1.0.0",
++        "micromark-util-types": "^1.0.1",
++        "uvu": "^0.5.0"
++      }
++    },
++    "node_modules/micromark-core-commonmark": {
++      "version": "1.1.0",
++      "resolved": "https://registry.npmjs.org/micromark-core-commonmark/-/micromark-core-commonmark-1.1.0.tgz",
++      "integrity": "sha512-BgHO1aRbolh2hcrzL2d1La37V0Aoz73ymF8rAcKnohLy93titmv62E0gP8Hrx9PKcKrqCZ1BbLGbP3bEhoXYlw==",
++      "funding": [
++        {
++          "type": "GitHub Sponsors",
++          "url": "https://github.com/sponsors/unifiedjs"
++        },
++        {
++          "type": "OpenCollective",
++          "url": "https://opencollective.com/unified"
++        }
++      ],
++      "license": "MIT",
++      "dependencies": {
++        "decode-named-character-reference": "^1.0.0",
++        "micromark-factory-destination": "^1.0.0",
++        "micromark-factory-label": "^1.0.0",
++        "micromark-factory-space": "^1.0.0",
++        "micromark-factory-title": "^1.0.0",
++        "micromark-factory-whitespace": "^1.0.0",
++        "micromark-util-character": "^1.0.0",
++        "micromark-util-chunked": "^1.0.0",
++        "micromark-util-classify-character": "^1.0.0",
++        "micromark-util-html-tag-name": "^1.0.0",
++        "micromark-util-normalize-identifier": "^1.0.0",
++        "micromark-util-resolve-all": "^1.0.0",
++        "micromark-util-subtokenize": "^1.0.0",
++        "micromark-util-symbol": "^1.0.0",
++        "micromark-util-types": "^1.0.1",
++        "uvu": "^0.5.0"
++      }
++    },
++    "node_modules/micromark-factory-destination": {
++      "version": "1.1.0",
++      "resolved": "https://registry.npmjs.org/micromark-factory-destination/-/micromark-factory-destination-1.1.0.tgz",
++      "integrity": "sha512-XaNDROBgx9SgSChd69pjiGKbV+nfHGDPVYFs5dOoDd7ZnMAE+Cuu91BCpsY8RT2NP9vo/B8pds2VQNCLiu0zhg==",
++      "funding": [
++        {
++          "type": "GitHub Sponsors",
++          "url": "https://github.com/sponsors/unifiedjs"
++        },
++        {
++          "type": "OpenCollective",
++          "url": "https://opencollective.com/unified"
++        }
++      ],
++      "license": "MIT",
++      "dependencies": {
++        "micromark-util-character": "^1.0.0",
++        "micromark-util-symbol": "^1.0.0",
++        "micromark-util-types": "^1.0.0"
++      }
++    },
++    "node_modules/micromark-factory-label": {
++      "version": "1.1.0",
++      "resolved": "https://registry.npmjs.org/micromark-factory-label/-/micromark-factory-label-1.1.0.tgz",
++      "integrity": "sha512-OLtyez4vZo/1NjxGhcpDSbHQ+m0IIGnT8BoPamh+7jVlzLJBH98zzuCoUeMxvM6WsNeh8wx8cKvqLiPHEACn0w==",
++      "funding": [
++        {
++          "type": "GitHub Sponsors",
++          "url": "https://github.com/sponsors/unifiedjs"
++        },
++        {
++          "type": "OpenCollective",
++          "url": "https://opencollective.com/unified"
++        }
++      ],
++      "license": "MIT",
++      "dependencies": {
++        "micromark-util-character": "^1.0.0",
++        "micromark-util-symbol": "^1.0.0",
++        "micromark-util-types": "^1.0.0",
++        "uvu": "^0.5.0"
++      }
++    },
++    "node_modules/micromark-factory-space": {
++      "version": "1.1.0",
++      "resolved": "https://registry.npmjs.org/micromark-factory-space/-/micromark-factory-space-1.1.0.tgz",
++      "integrity": "sha512-cRzEj7c0OL4Mw2v6nwzttyOZe8XY/Z8G0rzmWQZTBi/jjwyw/U4uqKtUORXQrR5bAZZnbTI/feRV/R7hc4jQYQ==",
++      "funding": [
++        {
++          "type": "GitHub Sponsors",
++          "url": "https://github.com/sponsors/unifiedjs"
++        },
++        {
++          "type": "OpenCollective",
++          "url": "https://opencollective.com/unified"
++        }
++      ],
++      "license": "MIT",
++      "dependencies": {
++        "micromark-util-character": "^1.0.0",
++        "micromark-util-types": "^1.0.0"
++      }
++    },
++    "node_modules/micromark-factory-title": {
++      "version": "1.1.0",
++      "resolved": "https://registry.npmjs.org/micromark-factory-title/-/micromark-factory-title-1.1.0.tgz",
++      "integrity": "sha512-J7n9R3vMmgjDOCY8NPw55jiyaQnH5kBdV2/UXCtZIpnHH3P6nHUKaH7XXEYuWwx/xUJcawa8plLBEjMPU24HzQ==",
++      "funding": [
++        {
++          "type": "GitHub Sponsors",
++          "url": "https://github.com/sponsors/unifiedjs"
++        },
++        {
++          "type": "OpenCollective",
++          "url": "https://opencollective.com/unified"
++        }
++      ],
++      "license": "MIT",
++      "dependencies": {
++        "micromark-factory-space": "^1.0.0",
++        "micromark-util-character": "^1.0.0",
++        "micromark-util-symbol": "^1.0.0",
++        "micromark-util-types": "^1.0.0"
++      }
++    },
++    "node_modules/micromark-factory-whitespace": {
++      "version": "1.1.0",
++      "resolved": "https://registry.npmjs.org/micromark-factory-whitespace/-/micromark-factory-whitespace-1.1.0.tgz",
++      "integrity": "sha512-v2WlmiymVSp5oMg+1Q0N1Lxmt6pMhIHD457whWM7/GUlEks1hI9xj5w3zbc4uuMKXGisksZk8DzP2UyGbGqNsQ==",
++      "funding": [
++        {
++          "type": "GitHub Sponsors",
++          "url": "https://github.com/sponsors/unifiedjs"
++        },
++        {
++          "type": "OpenCollective",
++          "url": "https://opencollective.com/unified"
++        }
++      ],
++      "license": "MIT",
++      "dependencies": {
++        "micromark-factory-space": "^1.0.0",
++        "micromark-util-character": "^1.0.0",
++        "micromark-util-symbol": "^1.0.0",
++        "micromark-util-types": "^1.0.0"
++      }
++    },
++    "node_modules/micromark-util-character": {
++      "version": "1.2.0",
++      "resolved": "https://registry.npmjs.org/micromark-util-character/-/micromark-util-character-1.2.0.tgz",
++      "integrity": "sha512-lXraTwcX3yH/vMDaFWCQJP1uIszLVebzUa3ZHdrgxr7KEU/9mL4mVgCpGbyhvNLNlauROiNUq7WN5u7ndbY6xg==",
++      "funding": [
++        {
++          "type": "GitHub Sponsors",
++          "url": "https://github.com/sponsors/unifiedjs"
++        },
++        {
++          "type": "OpenCollective",
++          "url": "https://opencollective.com/unified"
++        }
++      ],
++      "license": "MIT",
++      "dependencies": {
++        "micromark-util-symbol": "^1.0.0",
++        "micromark-util-types": "^1.0.0"
++      }
++    },
++    "node_modules/micromark-util-chunked": {
++      "version": "1.1.0",
++      "resolved": "https://registry.npmjs.org/micromark-util-chunked/-/micromark-util-chunked-1.1.0.tgz",
++      "integrity": "sha512-Ye01HXpkZPNcV6FiyoW2fGZDUw4Yc7vT0E9Sad83+bEDiCJ1uXu0S3mr8WLpsz3HaG3x2q0HM6CTuPdcZcluFQ==",
++      "funding": [
++        {
++          "type": "GitHub Sponsors",
++          "url": "https://github.com/sponsors/unifiedjs"
++        },
++        {
++          "type": "OpenCollective",
++          "url": "https://opencollective.com/unified"
++        }
++      ],
++      "license": "MIT",
++      "dependencies": {
++        "micromark-util-symbol": "^1.0.0"
++      }
++    },
++    "node_modules/micromark-util-classify-character": {
++      "version": "1.1.0",
++      "resolved": "https://registry.npmjs.org/micromark-util-classify-character/-/micromark-util-classify-character-1.1.0.tgz",
++      "integrity": "sha512-SL0wLxtKSnklKSUplok1WQFoGhUdWYKggKUiqhX+Swala+BtptGCu5iPRc+xvzJ4PXE/hwM3FNXsfEVgoZsWbw==",
++      "funding": [
++        {
++          "type": "GitHub Sponsors",
++          "url": "https://github.com/sponsors/unifiedjs"
++        },
++        {
++          "type": "OpenCollective",
++          "url": "https://opencollective.com/unified"
++        }
++      ],
++      "license": "MIT",
++      "dependencies": {
++        "micromark-util-character": "^1.0.0",
++        "micromark-util-symbol": "^1.0.0",
++        "micromark-util-types": "^1.0.0"
++      }
++    },
++    "node_modules/micromark-util-combine-extensions": {
++      "version": "1.1.0",
++      "resolved": "https://registry.npmjs.org/micromark-util-combine-extensions/-/micromark-util-combine-extensions-1.1.0.tgz",
++      "integrity": "sha512-Q20sp4mfNf9yEqDL50WwuWZHUrCO4fEyeDCnMGmG5Pr0Cz15Uo7KBs6jq+dq0EgX4DPwwrh9m0X+zPV1ypFvUA==",
++      "funding": [
++        {
++          "type": "GitHub Sponsors",
++          "url": "https://github.com/sponsors/unifiedjs"
++        },
++        {
++          "type": "OpenCollective",
++          "url": "https://opencollective.com/unified"
++        }
++      ],
++      "license": "MIT",
++      "dependencies": {
++        "micromark-util-chunked": "^1.0.0",
++        "micromark-util-types": "^1.0.0"
++      }
++    },
++    "node_modules/micromark-util-decode-numeric-character-reference": {
++      "version": "1.1.0",
++      "resolved": "https://registry.npmjs.org/micromark-util-decode-numeric-character-reference/-/micromark-util-decode-numeric-character-reference-1.1.0.tgz",
++      "integrity": "sha512-m9V0ExGv0jB1OT21mrWcuf4QhP46pH1KkfWy9ZEezqHKAxkj4mPCy3nIH1rkbdMlChLHX531eOrymlwyZIf2iw==",
++      "funding": [
++        {
++          "type": "GitHub Sponsors",
++          "url": "https://github.com/sponsors/unifiedjs"
++        },
++        {
++          "type": "OpenCollective",
++          "url": "https://opencollective.com/unified"
++        }
++      ],
++      "license": "MIT",
++      "dependencies": {
++        "micromark-util-symbol": "^1.0.0"
++      }
++    },
++    "node_modules/micromark-util-decode-string": {
++      "version": "1.1.0",
++      "resolved": "https://registry.npmjs.org/micromark-util-decode-string/-/micromark-util-decode-string-1.1.0.tgz",
++      "integrity": "sha512-YphLGCK8gM1tG1bd54azwyrQRjCFcmgj2S2GoJDNnh4vYtnL38JS8M4gpxzOPNyHdNEpheyWXCTnnTDY3N+NVQ==",
++      "funding": [
++        {
++          "type": "GitHub Sponsors",
++          "url": "https://github.com/sponsors/unifiedjs"
++        },
++        {
++          "type": "OpenCollective",
++          "url": "https://opencollective.com/unified"
++        }
++      ],
++      "license": "MIT",
++      "dependencies": {
++        "decode-named-character-reference": "^1.0.0",
++        "micromark-util-character": "^1.0.0",
++        "micromark-util-decode-numeric-character-reference": "^1.0.0",
++        "micromark-util-symbol": "^1.0.0"
++      }
++    },
++    "node_modules/micromark-util-encode": {
++      "version": "1.1.0",
++      "resolved": "https://registry.npmjs.org/micromark-util-encode/-/micromark-util-encode-1.1.0.tgz",
++      "integrity": "sha512-EuEzTWSTAj9PA5GOAs992GzNh2dGQO52UvAbtSOMvXTxv3Criqb6IOzJUBCmEqrrXSblJIJBbFFv6zPxpreiJw==",
++      "funding": [
++        {
++          "type": "GitHub Sponsors",
++          "url": "https://github.com/sponsors/unifiedjs"
++        },
++        {
++          "type": "OpenCollective",
++          "url": "https://opencollective.com/unified"
++        }
++      ],
++      "license": "MIT"
++    },
++    "node_modules/micromark-util-html-tag-name": {
++      "version": "1.2.0",
++      "resolved": "https://registry.npmjs.org/micromark-util-html-tag-name/-/micromark-util-html-tag-name-1.2.0.tgz",
++      "integrity": "sha512-VTQzcuQgFUD7yYztuQFKXT49KghjtETQ+Wv/zUjGSGBioZnkA4P1XXZPT1FHeJA6RwRXSF47yvJ1tsJdoxwO+Q==",
++      "funding": [
++        {
++          "type": "GitHub Sponsors",
++          "url": "https://github.com/sponsors/unifiedjs"
++        },
++        {
++          "type": "OpenCollective",
++          "url": "https://opencollective.com/unified"
++        }
++      ],
++      "license": "MIT"
++    },
++    "node_modules/micromark-util-normalize-identifier": {
++      "version": "1.1.0",
++      "resolved": "https://registry.npmjs.org/micromark-util-normalize-identifier/-/micromark-util-normalize-identifier-1.1.0.tgz",
++      "integrity": "sha512-N+w5vhqrBihhjdpM8+5Xsxy71QWqGn7HYNUvch71iV2PM7+E3uWGox1Qp90loa1ephtCxG2ftRV/Conitc6P2Q==",
++      "funding": [
++        {
++          "type": "GitHub Sponsors",
++          "url": "https://github.com/sponsors/unifiedjs"
++        },
++        {
++          "type": "OpenCollective",
++          "url": "https://opencollective.com/unified"
++        }
++      ],
++      "license": "MIT",
++      "dependencies": {
++        "micromark-util-symbol": "^1.0.0"
++      }
++    },
++    "node_modules/micromark-util-resolve-all": {
++      "version": "1.1.0",
++      "resolved": "https://registry.npmjs.org/micromark-util-resolve-all/-/micromark-util-resolve-all-1.1.0.tgz",
++      "integrity": "sha512-b/G6BTMSg+bX+xVCshPTPyAu2tmA0E4X98NSR7eIbeC6ycCqCeE7wjfDIgzEbkzdEVJXRtOG4FbEm/uGbCRouA==",
++      "funding": [
++        {
++          "type": "GitHub Sponsors",
++          "url": "https://github.com/sponsors/unifiedjs"
++        },
++        {
++          "type": "OpenCollective",
++          "url": "https://opencollective.com/unified"
++        }
++      ],
++      "license": "MIT",
++      "dependencies": {
++        "micromark-util-types": "^1.0.0"
++      }
++    },
++    "node_modules/micromark-util-sanitize-uri": {
++      "version": "1.2.0",
++      "resolved": "https://registry.npmjs.org/micromark-util-sanitize-uri/-/micromark-util-sanitize-uri-1.2.0.tgz",
++      "integrity": "sha512-QO4GXv0XZfWey4pYFndLUKEAktKkG5kZTdUNaTAkzbuJxn2tNBOr+QtxR2XpWaMhbImT2dPzyLrPXLlPhph34A==",
++      "funding": [
++        {
++          "type": "GitHub Sponsors",
++          "url": "https://github.com/sponsors/unifiedjs"
++        },
++        {
++          "type": "OpenCollective",
++          "url": "https://opencollective.com/unified"
++        }
++      ],
++      "license": "MIT",
++      "dependencies": {
++        "micromark-util-character": "^1.0.0",
++        "micromark-util-encode": "^1.0.0",
++        "micromark-util-symbol": "^1.0.0"
++      }
++    },
++    "node_modules/micromark-util-subtokenize": {
++      "version": "1.1.0",
++      "resolved": "https://registry.npmjs.org/micromark-util-subtokenize/-/micromark-util-subtokenize-1.1.0.tgz",
++      "integrity": "sha512-kUQHyzRoxvZO2PuLzMt2P/dwVsTiivCK8icYTeR+3WgbuPqfHgPPy7nFKbeqRivBvn/3N3GBiNC+JRTMSxEC7A==",
++      "funding": [
++        {
++          "type": "GitHub Sponsors",
++          "url": "https://github.com/sponsors/unifiedjs"
++        },
++        {
++          "type": "OpenCollective",
++          "url": "https://opencollective.com/unified"
++        }
++      ],
++      "license": "MIT",
++      "dependencies": {
++        "micromark-util-chunked": "^1.0.0",
++        "micromark-util-symbol": "^1.0.0",
++        "micromark-util-types": "^1.0.0",
++        "uvu": "^0.5.0"
++      }
++    },
++    "node_modules/micromark-util-symbol": {
++      "version": "1.1.0",
++      "resolved": "https://registry.npmjs.org/micromark-util-symbol/-/micromark-util-symbol-1.1.0.tgz",
++      "integrity": "sha512-uEjpEYY6KMs1g7QfJ2eX1SQEV+ZT4rUD3UcF6l57acZvLNK7PBZL+ty82Z1qhK1/yXIY4bdx04FKMgR0g4IAag==",
++      "funding": [
++        {
++          "type": "GitHub Sponsors",
++          "url": "https://github.com/sponsors/unifiedjs"
++        },
++        {
++          "type": "OpenCollective",
++          "url": "https://opencollective.com/unified"
++        }
++      ],
++      "license": "MIT"
++    },
++    "node_modules/micromark-util-types": {
++      "version": "1.1.0",
++      "resolved": "https://registry.npmjs.org/micromark-util-types/-/micromark-util-types-1.1.0.tgz",
++      "integrity": "sha512-ukRBgie8TIAcacscVHSiddHjO4k/q3pnedmzMQ4iwDcK0FtFCohKOlFbaOL/mPgfnPsL3C1ZyxJa4sbWrBl3jg==",
++      "funding": [
++        {
++          "type": "GitHub Sponsors",
++          "url": "https://github.com/sponsors/unifiedjs"
++        },
++        {
++          "type": "OpenCollective",
++          "url": "https://opencollective.com/unified"
++        }
++      ],
++      "license": "MIT"
++    },
++    "node_modules/mri": {
++      "version": "1.2.0",
++      "resolved": "https://registry.npmjs.org/mri/-/mri-1.2.0.tgz",
++      "integrity": "sha512-tzzskb3bG8LvYGFF/mDTpq3jpI6Q9wc3LEmBaghu+DdCssd1FakN7Bc0hVNmEyGq1bq3RgfkCb3cmQLpNPOroA==",
++      "license": "MIT",
++      "engines": {
++        "node": ">=4"
++      }
++    },
+     "node_modules/ms": {
+       "version": "2.1.3",
+       "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
+       "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
+-      "dev": true,
+       "license": "MIT"
+     },
+     "node_modules/nanoid": {
+@@ -1465,6 +2690,12 @@
+       "dev": true,
+       "license": "MIT"
+     },
++    "node_modules/non-layered-tidy-tree-layout": {
++      "version": "2.0.2",
++      "resolved": "https://registry.npmjs.org/non-layered-tidy-tree-layout/-/non-layered-tidy-tree-layout-2.0.2.tgz",
++      "integrity": "sha512-gkXMxRzUH+PB0ax9dUN0yYF0S25BqeAYqhgMaLUFmpXLEk7Fcu8f4emJuOAY0V8kjDICxROIKsTAKsV/v355xw==",
++      "license": "MIT"
++    },
+     "node_modules/picocolors": {
+       "version": "1.1.1",
+       "resolved": "https://registry.npmjs.org/picocolors/-/picocolors-1.1.1.tgz",
+@@ -1536,6 +2767,12 @@
+         "node": ">=0.10.0"
+       }
+     },
++    "node_modules/robust-predicates": {
++      "version": "3.0.2",
++      "resolved": "https://registry.npmjs.org/robust-predicates/-/robust-predicates-3.0.2.tgz",
++      "integrity": "sha512-IXgzBWvWQwE6PrDI05OvmXUIruQTcoMDzRsOd5CDvHCVLcLHMTSYvOK5Cm46kWqlV3yAbuSpBZdJ5oP5OUoStg==",
++      "license": "Unlicense"
++    },
+     "node_modules/rollup": {
+       "version": "4.56.0",
+       "resolved": "https://registry.npmjs.org/rollup/-/rollup-4.56.0.tgz",
+@@ -1581,6 +2818,30 @@
+         "fsevents": "~2.3.2"
+       }
+     },
++    "node_modules/rw": {
++      "version": "1.3.3",
++      "resolved": "https://registry.npmjs.org/rw/-/rw-1.3.3.tgz",
++      "integrity": "sha512-PdhdWy89SiZogBLaw42zdeqtRJ//zFd2PgQavcICDUgJT5oW10QCRKbJ6bg4r0/UY2M6BWd5tkxuGFRvCkgfHQ==",
++      "license": "BSD-3-Clause"
++    },
++    "node_modules/sade": {
++      "version": "1.8.1",
++      "resolved": "https://registry.npmjs.org/sade/-/sade-1.8.1.tgz",
++      "integrity": "sha512-xal3CZX1Xlo/k4ApwCFrHVACi9fBqJ7V+mwhBsuf/1IOKbBy098Fex+Wa/5QMubw09pSZ/u8EY8PWgevJsXp1A==",
++      "license": "MIT",
++      "dependencies": {
++        "mri": "^1.1.0"
++      },
++      "engines": {
++        "node": ">=6"
++      }
++    },
++    "node_modules/safer-buffer": {
++      "version": "2.1.2",
++      "resolved": "https://registry.npmjs.org/safer-buffer/-/safer-buffer-2.1.2.tgz",
++      "integrity": "sha512-YZo3K82SD7Riyi0E1EQPojLz7kpepnSQI9IyPbHHg1XXXevb5dJI7tpyN2ADxGcQbHG7vcyRHk0cbwqcQriUtg==",
++      "license": "MIT"
++    },
+     "node_modules/scheduler": {
+       "version": "0.23.2",
+       "resolved": "https://registry.npmjs.org/scheduler/-/scheduler-0.23.2.tgz",
+@@ -1610,6 +2871,21 @@
+         "node": ">=0.10.0"
+       }
+     },
++    "node_modules/stylis": {
++      "version": "4.3.6",
++      "resolved": "https://registry.npmjs.org/stylis/-/stylis-4.3.6.tgz",
++      "integrity": "sha512-yQ3rwFWRfwNUY7H5vpU0wfdkNSnvnJinhF9830Swlaxl03zsOjCfmX0ugac+3LtK0lYSgwL/KXc8oYL3mG4YFQ==",
++      "license": "MIT"
++    },
++    "node_modules/ts-dedent": {
++      "version": "2.2.0",
++      "resolved": "https://registry.npmjs.org/ts-dedent/-/ts-dedent-2.2.0.tgz",
++      "integrity": "sha512-q5W7tVM71e2xjHZTlgfTDoPF/SmqKG5hddq9SzR49CH2hayqRKJtQ4mtRlSxKaJlR/+9rEM+mnBHf7I2/BQcpQ==",
++      "license": "MIT",
++      "engines": {
++        "node": ">=6.10"
++      }
++    },
+     "node_modules/typescript": {
+       "version": "5.9.3",
+       "resolved": "https://registry.npmjs.org/typescript/-/typescript-5.9.3.tgz",
+@@ -1624,6 +2900,19 @@
+         "node": ">=14.17"
+       }
+     },
++    "node_modules/unist-util-stringify-position": {
++      "version": "3.0.3",
++      "resolved": "https://registry.npmjs.org/unist-util-stringify-position/-/unist-util-stringify-position-3.0.3.tgz",
++      "integrity": "sha512-k5GzIBZ/QatR8N5X2y+drfpWG8IDBzdnVj6OInRNWm1oXrzydiaAT2OQiA8DPRRZyAKb9b6I2a6PxYklZD0gKg==",
++      "license": "MIT",
++      "dependencies": {
++        "@types/unist": "^2.0.0"
++      },
++      "funding": {
++        "type": "opencollective",
++        "url": "https://opencollective.com/unified"
++      }
++    },
+     "node_modules/update-browserslist-db": {
+       "version": "1.2.3",
+       "resolved": "https://registry.npmjs.org/update-browserslist-db/-/update-browserslist-db-1.2.3.tgz",
+@@ -1655,6 +2944,37 @@
+         "browserslist": ">= 4.21.0"
+       }
+     },
++    "node_modules/uuid": {
++      "version": "9.0.1",
++      "resolved": "https://registry.npmjs.org/uuid/-/uuid-9.0.1.tgz",
++      "integrity": "sha512-b+1eJOlsR9K8HJpow9Ok3fiWOWSIcIzXodvv0rQjVoOVNpWMpxf1wZNpt4y9h10odCNrqnYp1OBzRktckBe3sA==",
++      "funding": [
++        "https://github.com/sponsors/broofa",
++        "https://github.com/sponsors/ctavan"
++      ],
++      "license": "MIT",
++      "bin": {
++        "uuid": "dist/bin/uuid"
++      }
++    },
++    "node_modules/uvu": {
++      "version": "0.5.6",
++      "resolved": "https://registry.npmjs.org/uvu/-/uvu-0.5.6.tgz",
++      "integrity": "sha512-+g8ENReyr8YsOc6fv/NVJs2vFdHBnBNdfE49rshrTzDWOlUx4Gq7KOS2GD8eqhy2j+Ejq29+SbKH8yjkAqXqoA==",
++      "license": "MIT",
++      "dependencies": {
++        "dequal": "^2.0.0",
++        "diff": "^5.0.0",
++        "kleur": "^4.0.3",
++        "sade": "^1.7.3"
++      },
++      "bin": {
++        "uvu": "bin.js"
++      },
++      "engines": {
++        "node": ">=8"
++      }
++    },
+     "node_modules/vite": {
+       "version": "5.4.21",
+       "resolved": "https://registry.npmjs.org/vite/-/vite-5.4.21.tgz",
+@@ -1715,6 +3035,12 @@
+         }
+       }
+     },
++    "node_modules/web-worker": {
++      "version": "1.5.0",
++      "resolved": "https://registry.npmjs.org/web-worker/-/web-worker-1.5.0.tgz",
++      "integrity": "sha512-RiMReJrTAiA+mBjGONMnjVDP2u3p9R1vkcGz6gDIrOMT3oGuYwX2WRMYI9ipkphSuE5XKEhydbhNEJh4NY9mlw==",
++      "license": "Apache-2.0"
++    },
+     "node_modules/yallist": {
+       "version": "3.1.1",
+       "resolved": "https://registry.npmjs.org/yallist/-/yallist-3.1.1.tgz",
+diff -ruN '--exclude=.devlogs' '--exclude=venv' '--exclude=node_modules' '--exclude=__pycache__' /tmp/AntiHub.phase3.base/frontend/package.json /home/user2643/code/AntiHub/frontend/package.json
+--- /tmp/AntiHub.phase3.base/frontend/package.json	2026-01-22 21:52:23.262380687 +0800
++++ /home/user2643/code/AntiHub/frontend/package.json	2026-01-22 23:26:38.562408408 +0800
+@@ -9,6 +9,8 @@
+     "preview": "vite preview"
+   },
+   "dependencies": {
++    "marked": "^12.0.2",
++    "mermaid": "^10.9.1",
+     "react": "^18.3.1",
+     "react-dom": "^18.3.1"
+   },
+diff -ruN '--exclude=.devlogs' '--exclude=venv' '--exclude=node_modules' '--exclude=__pycache__' /tmp/AntiHub.phase3.base/frontend/src/App.tsx /home/user2643/code/AntiHub/frontend/src/App.tsx
+--- /tmp/AntiHub.phase3.base/frontend/src/App.tsx	2026-01-22 21:52:23.262380687 +0800
++++ /home/user2643/code/AntiHub/frontend/src/App.tsx	2026-01-22 23:27:37.640750450 +0800
+@@ -1,4 +1,6 @@
+ import React, { useCallback, useEffect, useMemo, useRef, useState } from "react";
++import { marked } from "marked";
++import mermaid from "mermaid";
+ 
+ const API_BASE = import.meta.env.VITE_API_BASE || "http://127.0.0.1:8010";
+ 
+@@ -22,6 +24,31 @@
+   error_message?: string | null;
+   created_at?: number | null;
+   updated_at?: number | null;
++  repo_url?: string | null;
++  ref?: string | null;
++  branch?: string | null;
++  archived?: boolean;
++  archived_at?: number | null;
++  attempt?: number | null;
++  retry_of?: string | null;
++  manual_status?: string | null;
++  manual_generated_at?: number | null;
++  manual_error_code?: string | null;
++  manual_error_message?: string | null;
++};
++
++type CaseListResponse = {
++  items: CaseResponse[];
++  total: number;
++  page: number;
++  size: number;
++};
++
++type CaseActionResponse = {
++  case_id: string;
++  action: string;
++  status: string;
++  message: string;
+ };
+ 
+ type LogEntry = {
+@@ -31,7 +58,49 @@
+   line: string;
+ };
+ 
++type Toast = {
++  type: "success" | "error";
++  message: string;
++  detail?: string;
++  code?: string;
++};
++
++type ErrorCodeMap = Record<string, { message: string; hint: string }>;
++
++type ManualMeta = {
++  generated_at: number;
++  generator_version: string;
++  signals: Record<string, unknown>;
++  time_cost_ms: number;
++};
++
++type ManualStatusResponse = {
++  case_id: string;
++  status: string;
++  generated_at?: number | null;
++  error_code?: string | null;
++  error_message?: string | null;
++};
++
++type ManualResponse = {
++  case_id: string;
++  manual_markdown: string;
++  meta: ManualMeta;
++};
++
++type CaseTemplate = {
++  name: string;
++  repo_url?: string | null;
++  git_url?: string | null;
++  ref?: string | null;
++  default_env_keys?: string[];
++  build_mode?: string | null;
++  port_mode?: string | null;
++  timeouts?: Record<string, number>;
++};
++
+ type Route =
++  | { type: "dashboard" }
+   | { type: "create" }
+   | {
+       type: "case";
+@@ -40,14 +109,21 @@
+ 
+ const ERROR_EXPLAIN: Record<string, string> = {
+   PORT_POOL_EXHAUSTED: "端口池已满，请停止旧容器或扩大端口范围。",
++  PORT_IN_USE: "端口已被占用，请稍后重试。",
+   DOCKER_BUILD_FAILED: "Docker 镜像构建失败，请检查 Dockerfile 与构建日志。",
+   DOCKER_API_ERROR: "Docker 守护进程错误，请确认 Docker 正常运行且端口未被占用。",
+   DOCKERFILE_MISSING: "仓库根目录缺少 Dockerfile。",
+   GIT_CLONE_FAILED: "Git 克隆失败，请检查仓库地址与权限。",
+   GIT_CLONE_TIMEOUT: "Git 克隆超时，请重试或使用更小的仓库。",
+-  STARTUP_TIMEOUT: "容器启动超时，请确认监听 0.0.0.0 且 EXPOSE 端口正确。",
++  TIMEOUT_CLONE: "克隆超时，请检查仓库体积或超时配置。",
++  TIMEOUT_BUILD: "构建超时，请检查构建步骤与超时配置。",
++  TIMEOUT_RUN: "启动超时，请确认监听 0.0.0.0 且端口匹配 EXPOSE。",
++  TIMEOUT_ANALYZE: "分析超时，请稍后重试。",
++  STARTUP_TIMEOUT: "容器启动超时，请确认监听 0.0.0.0 且端口匹配 EXPOSE。",
+   CONTAINER_EXIT_NONZERO: "容器非零退出，请查看容器日志。",
++  STOPPED_BY_USER: "已由用户手动停止。",
+   UNEXPECTED_ERROR: "未知错误，请查看日志详情。",
++  MANUAL_GENERATION_FAILED: "说明书生成失败，请检查仓库文件。",
+ };
+ 
+ const STREAM_LABELS: Record<string, string> = {
+@@ -71,29 +147,12 @@
+   BUILDING: "构建中",
+   STARTING: "启动中",
+   RUNNING: "运行中",
++  STOPPED: "已停止",
+   FAILED: "失败",
+   FINISHED: "已结束",
+   ANALYZING: "分析中",
+ };
+ 
+-function streamLabel(stream: string) {
+-  return STREAM_LABELS[stream] || stream;
+-}
+-
+-function statusLabel(status?: string) {
+-  if (!status) return "-";
+-  const normalized = status.toUpperCase();
+-  const label = STATUS_LABELS[normalized];
+-  return label ? `${label} (${normalized})` : normalized;
+-}
+-
+-function stageLabel(stage?: string) {
+-  if (!stage) return "-";
+-  const normalized = stage.toLowerCase();
+-  const label = STAGE_LABELS[normalized];
+-  return label ? `${label} (${normalized})` : stage;
+-}
+-
+ function joinUrl(base: string, path: string) {
+   const trimmed = base.replace(/\/+$/, "");
+   return `${trimmed}${path}`;
+@@ -110,11 +169,14 @@
+ }
+ 
+ function parseRoute(pathname: string): Route {
++  if (pathname.startsWith("/create")) {
++    return { type: "create" };
++  }
+   const match = pathname.match(/^\/cases\/([^/]+)$/);
+   if (match && match[1]) {
+     return { type: "case", caseId: match[1] };
+   }
+-  return { type: "create" };
++  return { type: "dashboard" };
+ }
+ 
+ function useRoute() {
+@@ -134,9 +196,11 @@
+   return { route, navigate };
+ }
+ 
+-function formatTime(ts?: number | null) {
++function formatTime(ts?: number | string | null) {
+   if (!ts) return "-";
+-  const date = new Date(ts * 1000);
++  const value = typeof ts === "string" ? Number(ts) : ts;
++  if (!value || Number.isNaN(value)) return "-";
++  const date = new Date(value * 1000);
+   return date.toLocaleString();
+ }
+ 
+@@ -144,6 +208,7 @@
+   const normalized = (status || "").toUpperCase();
+   if (normalized === "RUNNING") return "running";
+   if (normalized === "FAILED") return "failed";
++  if (normalized === "STOPPED") return "neutral";
+   if (normalized === "BUILDING" || normalized === "CLONING" || normalized === "STARTING") {
+     return "working";
+   }
+@@ -151,34 +216,113 @@
+   return "neutral";
+ }
+ 
++function streamLabel(stream: string) {
++  return STREAM_LABELS[stream] || stream;
++}
++
++function statusLabel(status?: string) {
++  if (!status) return "-";
++  const normalized = status.toUpperCase();
++  const label = STATUS_LABELS[normalized];
++  return label ? `${label} (${normalized})` : normalized;
++}
++
++function stageLabel(stage?: string) {
++  if (!stage) return "-";
++  const normalized = stage.toLowerCase();
++  const label = STAGE_LABELS[normalized];
++  return label ? `${label} (${normalized})` : stage;
++}
++
++function manualStatusLabel(status?: string | null) {
++  const normalized = (status || "").toUpperCase();
++  if (!normalized || normalized === "NOT_STARTED") return "未生成";
++  if (normalized === "PENDING" || normalized === "RUNNING") return "生成中";
++  if (normalized === "SUCCESS") return "已生成";
++  if (normalized === "FAILED") return "生成失败";
++  return normalized;
++}
++
++function resolveErrorHint(code: string | null | undefined, errorCodes: ErrorCodeMap) {
++  if (!code) return null;
++  if (errorCodes[code]) {
++    return `${errorCodes[code].message} ${errorCodes[code].hint}`.trim();
++  }
++  return ERROR_EXPLAIN[code] || null;
++}
++
+ function App() {
+   const { route, navigate } = useRoute();
+   const [flashCaseId, setFlashCaseId] = useState<string | null>(null);
++  const [toast, setToast] = useState<Toast | null>(null);
++  const [errorCodes, setErrorCodes] = useState<ErrorCodeMap>({});
++
++  useEffect(() => {
++    mermaid.initialize({ startOnLoad: false, theme: "neutral" });
++  }, []);
++
++  useEffect(() => {
++    let alive = true;
++    const fetchErrorCodes = async () => {
++      try {
++        const response = await fetch(joinUrl(API_BASE, "/error-codes"));
++        if (!response.ok) return;
++        const data = (await response.json()) as ErrorCodeMap;
++        if (alive) setErrorCodes(data || {});
++      } catch (err) {
++        if (alive) setErrorCodes({});
++      }
++    };
++    fetchErrorCodes();
++    return () => {
++      alive = false;
++    };
++  }, []);
++
++  useEffect(() => {
++    if (!toast) return undefined;
++    const timer = window.setTimeout(() => setToast(null), 3200);
++    return () => window.clearTimeout(timer);
++  }, [toast]);
++
++  const pushToast = useCallback((next: Toast) => {
++    setToast(next);
++  }, []);
+ 
+   return (
+     <div className="app">
+       <header className="topbar">
+         <div className="brand">
+-            <div className="brand-mark">AH</div>
++          <div className="brand-mark">AH</div>
+           <div>
+-            <div className="brand-title">AntiHub 控制台</div>
+-            <div className="brand-sub">阶段 2 - 创建、观测、对齐</div>
++            <div className="brand-title">AntiHub 智能展厅</div>
++            <div className="brand-sub">阶段 4 - 说明书与体验打磨</div>
+           </div>
+         </div>
+         <div className="topbar-actions">
+-          <button className="ghost" onClick={() => navigate("/")}>新建案例</button>
++          <button className="ghost" onClick={() => navigate("/")}>控制台</button>
++          <button className="ghost" onClick={() => navigate("/create")}>新建案例</button>
+           <a className="ghost" href="http://127.0.0.1:8010/docs" target="_blank" rel="noreferrer">
+             API 文档
+           </a>
+         </div>
+       </header>
+       <main className="main">
+-        {route.type === "create" ? (
++        {toast ? <ToastBanner toast={toast} onClose={() => setToast(null)} /> : null}
++        {route.type === "dashboard" ? (
++          <Dashboard
++            onOpen={(caseId) => navigate(`/cases/${caseId}`)}
++            onCreate={() => navigate("/create")}
++            errorCodes={errorCodes}
++            pushToast={pushToast}
++          />
++        ) : route.type === "create" ? (
+           <CreateCase
+             onCreated={(caseId) => {
+               setFlashCaseId(caseId);
+               navigate(`/cases/${caseId}`);
+             }}
++            pushToast={pushToast}
+           />
+         ) : (
+           <CaseDetail
+@@ -186,6 +330,8 @@
+             onBack={() => navigate("/")}
+             flashCaseId={flashCaseId}
+             clearFlash={() => setFlashCaseId(null)}
++            pushToast={pushToast}
++            errorCodes={errorCodes}
+           />
+         )}
+       </main>
+@@ -195,16 +341,78 @@
+ 
+ type EnvRow = { id: string; key: string; value: string };
+ 
+-function CreateCase({ onCreated }: { onCreated: (caseId: string) => void }) {
++function ToastBanner({ toast, onClose }: { toast: Toast; onClose: () => void }) {
++  const [expanded, setExpanded] = useState(false);
++  return (
++    <div className={`toast-banner ${toast.type === "success" ? "toast-success" : "toast-error"}`}>
++      <div>
++        <div className="toast-title">{toast.message}</div>
++        {toast.code ? <div className="toast-code">{toast.code}</div> : null}
++        {toast.detail ? (
++          <button className="toast-detail" type="button" onClick={() => setExpanded((v) => !v)}>
++            {expanded ? "收起详情" : "查看详情"}
++          </button>
++        ) : null}
++        {expanded && toast.detail ? <div className="toast-body">{toast.detail}</div> : null}
++      </div>
++      <button className="ghost" type="button" onClick={onClose}>
++        关闭
++      </button>
++    </div>
++  );
++}
++
++function CreateCase({ onCreated, pushToast }: { onCreated: (caseId: string) => void; pushToast: (t: Toast) => void }) {
+   const [repoUrl, setRepoUrl] = useState("");
+   const [ref, setRef] = useState("");
+   const [autoAnalyze, setAutoAnalyze] = useState(false);
+   const [envRows, setEnvRows] = useState<EnvRow[]>([
+     { id: `env-${Date.now()}`, key: "", value: "" },
+   ]);
++  const [templates, setTemplates] = useState<CaseTemplate[]>([]);
++  const [selectedTemplate, setSelectedTemplate] = useState("");
+   const [submitting, setSubmitting] = useState(false);
+   const [error, setError] = useState<string | null>(null);
+ 
++  useEffect(() => {
++    let alive = true;
++    const fetchTemplates = async () => {
++      try {
++        const response = await fetch(joinUrl(API_BASE, "/case-templates"));
++        if (!response.ok) return;
++        const data = (await response.json()) as CaseTemplate[];
++        if (alive) setTemplates(data || []);
++      } catch (err) {
++        if (alive) setTemplates([]);
++      }
++    };
++    fetchTemplates();
++    return () => {
++      alive = false;
++    };
++  }, []);
++
++  const applyTemplate = (name: string) => {
++    setSelectedTemplate(name);
++    const tpl = templates.find((item) => item.name === name);
++    if (!tpl) return;
++    const nextRepo = tpl.repo_url || tpl.git_url || "";
++    setRepoUrl(nextRepo);
++    setRef(tpl.ref || "");
++    const nextEnvKeys = (tpl.default_env_keys || []).filter(Boolean);
++    if (nextEnvKeys.length) {
++      setEnvRows(
++        nextEnvKeys.map((key, index) => ({
++          id: `tpl-${Date.now()}-${index}`,
++          key,
++          value: "",
++        }))
++      );
++    } else {
++      setEnvRows([{ id: `env-${Date.now()}`, key: "", value: "" }]);
++    }
++  };
++
+   const addRow = () => {
+     setEnvRows((rows) => [...rows, { id: `env-${Date.now()}-${rows.length}`, key: "", value: "" }]);
+   };
+@@ -264,15 +472,19 @@
+           if (text) message = text;
+         }
+         setError(message);
++        pushToast({ type: "error", message: "创建失败", detail: message });
+         return;
+       }
+       const data = (await response.json()) as CaseResponse;
+       setEnvRows([{ id: `env-${Date.now()}`, key: "", value: "" }]);
+       setRepoUrl("");
+       setRef("");
++      setSelectedTemplate("");
+       onCreated(data.case_id);
++      pushToast({ type: "success", message: "创建成功", detail: `case_id: ${data.case_id}` });
+     } catch (err) {
+       setError("网络错误，请检查 API 连接。");
++      pushToast({ type: "error", message: "创建失败", detail: "网络错误" });
+     } finally {
+       setSubmitting(false);
+     }
+@@ -282,8 +494,21 @@
+     <div className="create-grid">
+       <section className="card card-hero" style={{ animationDelay: "0.05s" }}>
+         <div className="section-title">创建案例</div>
+-        <p className="section-sub">几秒内启动仓库并可视化全流程日志。</p>
++        <p className="section-sub">选择模板或填入仓库地址，即可生成可展示的案例说明书。</p>
+         <form className="form" onSubmit={handleSubmit}>
++          {templates.length ? (
++            <label className="field">
++              <span>案例模板</span>
++              <select value={selectedTemplate} onChange={(event) => applyTemplate(event.target.value)}>
++                <option value="">请选择模板</option>
++                {templates.map((tpl) => (
++                  <option key={tpl.name} value={tpl.name}>
++                    {tpl.name}
++                  </option>
++                ))}
++              </select>
++            </label>
++          ) : null}
+           <label className="field">
+             <span>仓库地址</span>
+             <input
+@@ -359,7 +584,7 @@
+         <ul className="list">
+           <li>2 秒内返回 case_id</li>
+           <li>WS 日志回放 + 实时追踪</li>
+-          <li>访问地址可点击/复制</li>
++          <li>自动生成仓库说明书 + Mermaid 图</li>
+           <li>仅展示 env 键名</li>
+         </ul>
+         <div className="note">
+@@ -373,20 +598,316 @@
+   );
+ }
+ 
++function Dashboard({
++  onOpen,
++  onCreate,
++  errorCodes,
++  pushToast,
++}: {
++  onOpen: (caseId: string) => void;
++  onCreate: () => void;
++  errorCodes: ErrorCodeMap;
++  pushToast: (t: Toast) => void;
++}) {
++  const [cases, setCases] = useState<CaseResponse[]>([]);
++  const [total, setTotal] = useState(0);
++  const [page, setPage] = useState(1);
++  const [size, setSize] = useState(10);
++  const [query, setQuery] = useState("");
++  const [status, setStatus] = useState("");
++  const [stage, setStage] = useState("");
++  const [includeArchived, setIncludeArchived] = useState(false);
++  const [loading, setLoading] = useState(false);
++  const [error, setError] = useState<string | null>(null);
++
++  const fetchCases = useCallback(async () => {
++    setLoading(true);
++    setError(null);
++    try {
++      const params = new URLSearchParams();
++      params.set("page", String(page));
++      params.set("size", String(size));
++      if (query.trim()) params.set("q", query.trim());
++      if (status) params.set("status", status);
++      if (stage) params.set("stage", stage);
++      if (includeArchived) params.set("include_archived", "true");
++      const response = await fetch(joinUrl(API_BASE, `/cases?${params.toString()}`));
++      if (!response.ok) {
++        throw new Error(`请求失败 (${response.status})`);
++      }
++      const data = (await response.json()) as CaseListResponse;
++      setCases(data.items || []);
++      setTotal(data.total || 0);
++    } catch (err) {
++      setError(err instanceof Error ? err.message : "加载失败");
++      pushToast({ type: "error", message: "加载失败", detail: String(err) });
++    } finally {
++      setLoading(false);
++    }
++  }, [page, size, query, status, stage, includeArchived, pushToast]);
++
++  useEffect(() => {
++    fetchCases();
++  }, [fetchCases]);
++
++  const totalPages = Math.max(1, Math.ceil(total / size));
++  const runningCount = cases.filter((item) => item.status?.toUpperCase() === "RUNNING").length;
++  const failedCount = cases.filter((item) => item.status?.toUpperCase() === "FAILED").length;
++
++  const handleAction = async (caseId: string, action: "stop" | "retry" | "archive") => {
++    const confirmText =
++      action === "stop"
++        ? "确认停止该运行中的案例？"
++        : action === "retry"
++        ? "确认重试该失败案例？"
++        : "确认归档该案例？";
++    if (!window.confirm(confirmText)) return;
++    try {
++      const response = await fetch(joinUrl(API_BASE, `/cases/${caseId}/${action}`), {
++        method: "POST",
++        headers: { "Content-Type": "application/json" },
++        body: action === "retry" ? JSON.stringify({}) : undefined,
++      });
++      if (!response.ok) {
++        const text = await response.text();
++        throw new Error(text || `操作失败 (${response.status})`);
++      }
++      const data = (await response.json()) as CaseActionResponse;
++      pushToast({ type: "success", message: "操作成功", detail: data.message });
++      fetchCases();
++    } catch (err) {
++      pushToast({ type: "error", message: "操作失败", detail: String(err) });
++    }
++  };
++
++  return (
++    <div className="dashboard">
++      <div className="dashboard-head">
++        <div>
++          <div className="section-title">案例列表</div>
++          <div className="section-sub">支持搜索、筛选、分页与管理动作。</div>
++        </div>
++        <div className="dashboard-actions">
++          <button className="ghost" type="button" onClick={fetchCases}>
++            刷新列表
++          </button>
++          <button className="primary" type="button" onClick={onCreate}>
++            新建案例
++          </button>
++        </div>
++      </div>
++
++      <div className="stats">
++        <div className="card stat-card">
++          <div className="stat-title">总数</div>
++          <div className="stat-value">{total}</div>
++        </div>
++        <div className="card stat-card">
++          <div className="stat-title">运行中</div>
++          <div className="stat-value">{runningCount}</div>
++        </div>
++        <div className="card stat-card">
++          <div className="stat-title">失败</div>
++          <div className="stat-value">{failedCount}</div>
++        </div>
++      </div>
++
++      <div className="filters-panel card">
++        <label className="field">
++          <span>搜索</span>
++          <input
++            type="text"
++            placeholder="case_id / repo / ref"
++            value={query}
++            onChange={(event) => {
++              setQuery(event.target.value);
++              setPage(1);
++            }}
++          />
++        </label>
++        <label className="field">
++          <span>状态</span>
++          <select
++            value={status}
++            onChange={(event) => {
++              setStatus(event.target.value);
++              setPage(1);
++            }}
++          >
++            <option value="">全部</option>
++            <option value="RUNNING">RUNNING</option>
++            <option value="FAILED">FAILED</option>
++            <option value="STOPPED">STOPPED</option>
++            <option value="PENDING">PENDING</option>
++            <option value="BUILDING">BUILDING</option>
++          </select>
++        </label>
++        <label className="field">
++          <span>阶段</span>
++          <select
++            value={stage}
++            onChange={(event) => {
++              setStage(event.target.value);
++              setPage(1);
++            }}
++          >
++            <option value="">全部</option>
++            <option value="clone">clone</option>
++            <option value="build">build</option>
++            <option value="run">run</option>
++            <option value="analyze">analyze</option>
++            <option value="system">system</option>
++          </select>
++        </label>
++        <label className="field checkbox">
++          <span>显示归档</span>
++          <input
++            type="checkbox"
++            checked={includeArchived}
++            onChange={(event) => {
++              setIncludeArchived(event.target.checked);
++              setPage(1);
++            }}
++          />
++        </label>
++        <label className="field">
++          <span>每页</span>
++          <select
++            value={String(size)}
++            onChange={(event) => {
++              setSize(Number(event.target.value));
++              setPage(1);
++            }}
++          >
++            <option value="10">10</option>
++            <option value="20">20</option>
++            <option value="50">50</option>
++          </select>
++        </label>
++      </div>
++
++      {error ? <div className="error-banner">{error}</div> : null}
++
++      <div className="card table-card">
++        <div className="table">
++          <div className="table-header">
++            <span>case_id</span>
++            <span>repo/ref</span>
++            <span>状态/阶段</span>
++            <span>更新时间</span>
++            <span>访问</span>
++            <span>错误码</span>
++            <span>说明书</span>
++            <span>操作</span>
++          </div>
++          {loading ? (
++            <div className="table-empty">加载中...</div>
++          ) : cases.length ? (
++            cases.map((item) => {
++              const runtime = item.runtime || {};
++              const statusUpper = (item.status || "").toUpperCase();
++              const errorHint = resolveErrorHint(item.error_code, errorCodes);
++              return (
++                <div className="table-row" key={item.case_id}>
++                  <span className="mono">{item.case_id}</span>
++                  <span className="table-repo">
++                    <div className="mono">{item.repo_url || "-"}</div>
++                    <div className="muted">{item.ref || item.branch || "-"}</div>
++                  </span>
++                  <span>
++                    <span className={`badge badge--${statusTone(item.status)}`}>{statusLabel(item.status)}</span>
++                    <span className="stage">{stageLabel(item.stage)}</span>
++                  </span>
++                  <span>{formatTime(item.updated_at)}</span>
++                  <span>
++                    {runtime.access_url ? (
++                      <a href={runtime.access_url} target="_blank" rel="noreferrer">
++                        {runtime.access_url}
++                      </a>
++                    ) : runtime.host_port ? (
++                      <span>{runtime.host_port}</span>
++                    ) : (
++                      "-"
++                    )}
++                  </span>
++                  <span className="mono">
++                    {statusUpper === "FAILED" ? item.error_code || "-" : "-"}
++                    {statusUpper === "FAILED" && errorHint ? (
++                      <div className="muted">{errorHint}</div>
++                    ) : null}
++                  </span>
++                  <span className="manual-status">
++                    <span>{manualStatusLabel(item.manual_status)}</span>
++                    {item.manual_generated_at ? (
++                      <div className="muted">{formatTime(item.manual_generated_at)}</div>
++                    ) : null}
++                  </span>
++                  <span className="table-actions">
++                    <button className="ghost" onClick={() => onOpen(item.case_id)}>详情</button>
++                    <button
++                      className="ghost"
++                      disabled={statusUpper !== "RUNNING"}
++                      onClick={() => handleAction(item.case_id, "stop")}
++                    >
++                      停止
++                    </button>
++                    <button
++                      className="ghost"
++                      disabled={statusUpper !== "FAILED"}
++                      onClick={() => handleAction(item.case_id, "retry")}
++                    >
++                      重试
++                    </button>
++                    <button className="ghost" onClick={() => handleAction(item.case_id, "archive")}>
++                      归档
++                    </button>
++                  </span>
++                </div>
++              );
++            })
++          ) : (
++            <div className="table-empty">暂无案例</div>
++          )}
++        </div>
++        <div className="pagination">
++          <button className="ghost" disabled={page <= 1} onClick={() => setPage((p) => Math.max(1, p - 1))}>
++            上一页
++          </button>
++          <span>
++            第 {page} / {totalPages} 页
++          </span>
++          <button
++            className="ghost"
++            disabled={page >= totalPages}
++            onClick={() => setPage((p) => Math.min(totalPages, p + 1))}
++          >
++            下一页
++          </button>
++        </div>
++      </div>
++    </div>
++  );
++}
++
+ function CaseDetail({
+   caseId,
+   onBack,
+   flashCaseId,
+   clearFlash,
++  pushToast,
++  errorCodes,
+ }: {
+   caseId: string;
+   onBack: () => void;
+   flashCaseId: string | null;
+   clearFlash: () => void;
++  pushToast: (t: Toast) => void;
++  errorCodes: ErrorCodeMap;
+ }) {
+   const [caseData, setCaseData] = useState<CaseResponse | null>(null);
+   const [loadError, setLoadError] = useState<string | null>(null);
+   const [loading, setLoading] = useState(false);
++  const [activeTab, setActiveTab] = useState<"overview" | "logs" | "manual">("overview");
+   const statusRef = useRef<string>("");
+   const fetchLock = useRef(false);
+ 
+@@ -412,12 +933,14 @@
+             if (text) message = text;
+           }
+           setLoadError(message);
++          pushToast({ type: "error", message: "加载失败", detail: message });
+           return;
+         }
+         const data = (await response.json()) as CaseResponse;
+         setCaseData(data);
+       } catch (err) {
+         setLoadError("网络错误，请检查 API 连接。");
++        pushToast({ type: "error", message: "加载失败", detail: "网络错误" });
+       } finally {
+         fetchLock.current = false;
+         if (!silent) {
+@@ -425,7 +948,7 @@
+         }
+       }
+     },
+-    [caseId]
++    [caseId, pushToast]
+   );
+ 
+   useEffect(() => {
+@@ -443,7 +966,7 @@
+       if (cancelled) return;
+       await fetchCase(true);
+       const status = statusRef.current.toUpperCase();
+-      const slow = status === "RUNNING" || status === "FAILED" || status === "FINISHED";
++      const slow = status === "RUNNING" || status === "FAILED" || status === "STOPPED" || status === "FINISHED";
+       const delay = slow ? 5000 : 2000;
+       timer = window.setTimeout(poll, delay);
+     };
+@@ -466,6 +989,54 @@
+   const envKeys = caseData?.env_keys || [];
+   const errorCode = caseData?.error_code || undefined;
+   const errorMessage = caseData?.error_message || undefined;
++  const statusUpper = (caseData?.status || "").toUpperCase();
++  const errorHint = resolveErrorHint(errorCode, errorCodes);
++
++  const runAction = async (action: "stop" | "restart" | "retry" | "archive") => {
++    const confirmText =
++      action === "stop"
++        ? "确认停止该运行中的案例？"
++        : action === "restart"
++        ? "确认重新启动该案例？"
++        : action === "retry"
++        ? "确认重新构建并运行该案例？"
++        : "确认归档该案例？";
++    if (!window.confirm(confirmText)) return;
++    try {
++      const response = await fetch(joinUrl(API_BASE, `/cases/${caseId}/${action}`), {
++        method: "POST",
++        headers: { "Content-Type": "application/json" },
++        body: action === "retry" ? JSON.stringify({}) : undefined,
++      });
++      if (!response.ok) {
++        const text = await response.text();
++        throw new Error(text || `操作失败 (${response.status})`);
++      }
++      const data = (await response.json()) as CaseActionResponse;
++      pushToast({ type: "success", message: "操作成功", detail: data.message });
++      fetchCase();
++    } catch (err) {
++      pushToast({ type: "error", message: "操作失败", detail: String(err) });
++    }
++  };
++
++  const copyLogs = async () => {
++    try {
++      const response = await fetch(joinUrl(API_BASE, `/cases/${caseId}/logs?limit=1000&format=jsonl`));
++      if (!response.ok) {
++        throw new Error(`导出失败 (${response.status})`);
++      }
++      const text = await response.text();
++      await navigator.clipboard.writeText(text);
++      pushToast({ type: "success", message: "已复制日志", detail: "最近 1000 行 JSONL 已复制" });
++    } catch (err) {
++      pushToast({ type: "error", message: "导出失败", detail: String(err) });
++    }
++  };
++
++  const downloadLogs = () => {
++    window.open(joinUrl(API_BASE, `/cases/${caseId}/logs/download?limit=1000`), "_blank");
++  };
+ 
+   return (
+     <div className="detail">
+@@ -480,79 +1051,339 @@
+       </div>
+       {flashCaseId ? <div className="success-banner">创建成功：{flashCaseId}</div> : null}
+       {loadError ? <div className="error-banner">{loadError}</div> : null}
+-      <div className="detail-grid">
+-        <section className="card" style={{ animationDelay: "0.05s" }}>
+-          <div className="section-title">状态</div>
+-          <div className="status-row">
+-            <span className={`badge badge--${statusTone(caseData?.status)}`}>
+-              {statusLabel(caseData?.status)}
+-            </span>
+-            <span className="stage">阶段：{stageLabel(caseData?.stage)}</span>
+-          </div>
+-          <div className="meta">
+-            <div>更新时间：{formatTime(caseData?.updated_at)}</div>
+-            <div>创建时间：{formatTime(caseData?.created_at)}</div>
+-            <div>提交：{caseData?.commit_sha || "-"}</div>
+-          </div>
+-        </section>
+-        <section className="card" style={{ animationDelay: "0.12s" }}>
+-          <div className="section-title">运行信息</div>
+-          <div className="runtime">
+-            <div className="runtime-row">
+-              <span>访问地址</span>
+-              {runtime.access_url ? (
+-                <div className="runtime-actions">
+-                  <a href={runtime.access_url} target="_blank" rel="noreferrer">
+-                    {runtime.access_url}
+-                  </a>
+-                  <CopyButton value={runtime.access_url} />
+-                </div>
+-              ) : (
+-                <span>-</span>
+-              )}
++
++      <div className="tabs">
++        <button
++          className={activeTab === "overview" ? "tab active" : "tab"}
++          onClick={() => setActiveTab("overview")}
++        >
++          概览
++        </button>
++        <button
++          className={activeTab === "logs" ? "tab active" : "tab"}
++          onClick={() => setActiveTab("logs")}
++        >
++          日志
++        </button>
++        <button
++          className={activeTab === "manual" ? "tab active" : "tab"}
++          onClick={() => setActiveTab("manual")}
++        >
++          说明书
++        </button>
++      </div>
++
++      {activeTab === "overview" ? (
++        <div className="detail-grid">
++          <section className="card" style={{ animationDelay: "0.05s" }}>
++            <div className="section-title">状态</div>
++            <div className="status-row">
++              <span className={`badge badge--${statusTone(caseData?.status)}`}>
++                {statusLabel(caseData?.status)}
++              </span>
++              <span className="stage">阶段：{stageLabel(caseData?.stage)}</span>
+             </div>
+-            <div className="runtime-row">
+-              <span>主机端口</span>
+-              <span>{runtime.host_port ?? "-"}</span>
++            <div className="meta">
++              <div>更新时间：{formatTime(caseData?.updated_at)}</div>
++              <div>创建时间：{formatTime(caseData?.created_at)}</div>
++              <div>提交：{caseData?.commit_sha || "-"}</div>
+             </div>
+-            <div className="runtime-row">
+-              <span>容器 ID</span>
+-              <span className="mono">{runtime.container_id ?? "-"}</span>
++          </section>
++          <section className="card" style={{ animationDelay: "0.12s" }}>
++            <div className="section-title">运行信息</div>
++            <div className="runtime">
++              <div className="runtime-row">
++                <span>访问地址</span>
++                {runtime.access_url ? (
++                  <div className="runtime-actions">
++                    <a href={runtime.access_url} target="_blank" rel="noreferrer">
++                      {runtime.access_url}
++                    </a>
++                    <CopyButton value={runtime.access_url} />
++                  </div>
++                ) : (
++                  <span>-</span>
++                )}
++              </div>
++              <div className="runtime-row">
++                <span>主机端口</span>
++                <span>{runtime.host_port ?? "-"}</span>
++              </div>
++              <div className="runtime-row">
++                <span>容器 ID</span>
++                <span className="mono">{runtime.container_id ?? "-"}</span>
++              </div>
+             </div>
+-          </div>
+-        </section>
+-        <section className="card" style={{ animationDelay: "0.18s" }}>
+-          <div className="section-title">环境变量键</div>
+-          {envKeys.length ? (
+-            <div className="chips">
+-              {envKeys.map((key) => (
+-                <span key={key} className="chip">
+-                  {key}
+-                </span>
+-              ))}
++          </section>
++          <section className="card" style={{ animationDelay: "0.18s" }}>
++            <div className="section-title">管理动作</div>
++            <div className="action-grid">
++              <button className="ghost" disabled={statusUpper !== "RUNNING"} onClick={() => runAction("stop")}>
++                停止
++              </button>
++              <button
++                className="ghost"
++                disabled={!(statusUpper === "STOPPED" || statusUpper === "FAILED")}
++                onClick={() => runAction("restart")}
++              >
++                重启
++              </button>
++              <button className="ghost" disabled={statusUpper !== "FAILED"} onClick={() => runAction("retry")}>
++                重试
++              </button>
++              <button className="ghost" onClick={() => runAction("archive")}>
++                归档
++              </button>
+             </div>
+-          ) : (
+-            <div className="muted">暂无 env 键名。</div>
+-          )}
+-        </section>
+-        {caseData?.status?.toUpperCase() === "FAILED" ? (
+-          <section className="card error-card" style={{ animationDelay: "0.24s" }}>
+-            <div className="section-title">错误</div>
+-            <div className="error-code">{errorCode || "UNKNOWN"}</div>
+-            <div className="error-message">{errorMessage || "未知错误。"}</div>
+-            <div className="error-hint">
+-              {ERROR_EXPLAIN[errorCode || ""] || "请查看日志详情。"}
++          </section>
++          <section className="card" style={{ animationDelay: "0.2s" }}>
++            <div className="section-title">环境变量键</div>
++            {envKeys.length ? (
++              <div className="chips">
++                {envKeys.map((key) => (
++                  <span key={key} className="chip">
++                    {key}
++                  </span>
++                ))}
++              </div>
++            ) : (
++              <div className="muted">暂无 env 键名。</div>
++            )}
++          </section>
++          {caseData?.status?.toUpperCase() === "FAILED" ? (
++            <section className="card error-card" style={{ animationDelay: "0.24s" }}>
++              <div className="section-title">错误</div>
++              <div className="error-code">{errorCode || "UNKNOWN"}</div>
++              <div className="error-message">{errorMessage || "未知错误。"}</div>
++              <div className="error-hint">{errorHint || "请查看日志详情。"}</div>
++            </section>
++          ) : null}
++          <section className="card" style={{ animationDelay: "0.28s" }}>
++            <div className="section-title">说明书状态</div>
++            <div className="meta">
++              <div>状态：{manualStatusLabel(caseData?.manual_status)}</div>
++              <div>生成时间：{formatTime(caseData?.manual_generated_at)}</div>
+             </div>
+           </section>
+-        ) : null}
++        </div>
++      ) : null}
++
++      {activeTab === "logs" ? (
+         <section className="card logs" style={{ animationDelay: "0.3s" }}>
+-          <LogPanel caseId={caseId} />
++          <LogPanel caseId={caseId} onCopyLogs={copyLogs} onDownloadLogs={downloadLogs} />
+         </section>
++      ) : null}
++
++      {activeTab === "manual" ? (
++        <ManualPanel
++          caseId={caseId}
++          manualStatus={caseData?.manual_status}
++          manualGeneratedAt={caseData?.manual_generated_at}
++          manualErrorCode={caseData?.manual_error_code}
++          manualErrorMessage={caseData?.manual_error_message}
++          errorCodes={errorCodes}
++          pushToast={pushToast}
++        />
++      ) : null}
++    </div>
++  );
++}
++
++function ManualPanel({
++  caseId,
++  manualStatus,
++  manualGeneratedAt,
++  manualErrorCode,
++  manualErrorMessage,
++  errorCodes,
++  pushToast,
++}: {
++  caseId: string;
++  manualStatus?: string | null;
++  manualGeneratedAt?: number | null;
++  manualErrorCode?: string | null;
++  manualErrorMessage?: string | null;
++  errorCodes: ErrorCodeMap;
++  pushToast: (t: Toast) => void;
++}) {
++  const [status, setStatus] = useState<ManualStatusResponse | null>(null);
++  const [manual, setManual] = useState<ManualResponse | null>(null);
++  const [loading, setLoading] = useState(false);
++  const [polling, setPolling] = useState(false);
++
++  const fetchStatus = useCallback(async () => {
++    try {
++      const response = await fetch(joinUrl(API_BASE, `/cases/${caseId}/manual/status`));
++      if (!response.ok) {
++        throw new Error(`获取状态失败 (${response.status})`);
++      }
++      const data = (await response.json()) as ManualStatusResponse;
++      setStatus(data);
++      return data;
++    } catch (err) {
++      pushToast({ type: "error", message: "获取说明书状态失败", detail: String(err) });
++      return null;
++    }
++  }, [caseId, pushToast]);
++
++  const fetchManual = useCallback(async () => {
++    setLoading(true);
++    try {
++      const response = await fetch(joinUrl(API_BASE, `/cases/${caseId}/manual`));
++      if (!response.ok) {
++        throw new Error(`获取说明书失败 (${response.status})`);
++      }
++      const data = (await response.json()) as ManualResponse;
++      setManual(data);
++      return data;
++    } catch (err) {
++      pushToast({ type: "error", message: "获取说明书失败", detail: String(err) });
++      return null;
++    } finally {
++      setLoading(false);
++    }
++  }, [caseId, pushToast]);
++
++  const triggerManual = async () => {
++    if (!window.confirm("确认重新生成说明书？")) return;
++    try {
++      const response = await fetch(joinUrl(API_BASE, `/cases/${caseId}/manual`), {
++        method: "POST",
++      });
++      if (!response.ok) {
++        const text = await response.text();
++        throw new Error(text || `触发失败 (${response.status})`);
++      }
++      const data = (await response.json()) as ManualStatusResponse;
++      setStatus(data);
++      setManual(null);
++      pushToast({ type: "success", message: "已触发说明书生成" });
++      setPolling(true);
++    } catch (err) {
++      pushToast({ type: "error", message: "触发失败", detail: String(err) });
++    }
++  };
++
++  useEffect(() => {
++    fetchStatus().then((data) => {
++      if (data?.status === "SUCCESS") {
++        fetchManual();
++      } else if (data?.status === "PENDING" || data?.status === "RUNNING") {
++        setPolling(true);
++      }
++    });
++  }, [fetchStatus, fetchManual]);
++
++  useEffect(() => {
++    if (!polling) return undefined;
++    let timer: number | undefined;
++    let cancelled = false;
++    const poll = async () => {
++      if (cancelled) return;
++      const data = await fetchStatus();
++      if (data?.status === "SUCCESS") {
++        await fetchManual();
++        setPolling(false);
++        return;
++      }
++      if (data?.status === "FAILED") {
++        setPolling(false);
++        return;
++      }
++      timer = window.setTimeout(poll, 2000);
++    };
++    poll();
++    return () => {
++      cancelled = true;
++      if (timer) window.clearTimeout(timer);
++    };
++  }, [polling, fetchManual, fetchStatus]);
++
++  const displayStatus = (status?.status || manualStatus || "NOT_STARTED").toUpperCase();
++  const displayGeneratedAt = status?.generated_at || manualGeneratedAt || undefined;
++  const displayErrorCode = status?.error_code || manualErrorCode || undefined;
++  const displayErrorMessage = status?.error_message || manualErrorMessage || undefined;
++  const displayErrorHint = resolveErrorHint(displayErrorCode, errorCodes);
++
++  return (
++    <div className="manual">
++      <div className="manual-head card">
++        <div>
++          <div className="section-title">说明书</div>
++          <div className="manual-meta">
++            <span>状态：{manualStatusLabel(displayStatus)}</span>
++            <span>生成时间：{formatTime(displayGeneratedAt)}</span>
++          </div>
++        </div>
++        <div className="manual-actions">
++          <button
++            className="ghost"
++            onClick={triggerManual}
++            disabled={displayStatus === "RUNNING" || displayStatus === "PENDING"}
++          >
++            重新生成
++          </button>
++        </div>
+       </div>
++
++      {displayStatus === "FAILED" ? (
++        <div className="card error-card">
++          <div className="section-title">生成失败</div>
++          <div className="error-code">{displayErrorCode || "MANUAL_FAILED"}</div>
++          <div className="error-message">{displayErrorMessage || "请稍后重试。"}</div>
++          <div className="error-hint">{displayErrorHint || "请检查仓库文件与权限。"}</div>
++        </div>
++      ) : null}
++
++      {loading ? <div className="card">说明书加载中...</div> : null}
++
++      {manual ? (
++        <div className="card manual-body">
++          <ManualSummary meta={manual.meta} />
++          <MarkdownRenderer markdown={manual.manual_markdown} />
++        </div>
++      ) : displayStatus === "PENDING" || displayStatus === "RUNNING" ? (
++        <div className="card empty-state">说明书生成中，请稍候刷新。</div>
++      ) : displayStatus === "NOT_STARTED" ? (
++        <div className="card empty-state">暂无说明书，请点击“重新生成”。</div>
++      ) : null}
++    </div>
++  );
++}
++
++function ManualSummary({ meta }: { meta: ManualMeta }) {
++  return (
++    <div className="manual-summary">
++      <div>generator_version: {meta.generator_version}</div>
++      <div>generated_at: {formatTime(meta.generated_at)}</div>
++      <div>time_cost_ms: {meta.time_cost_ms}</div>
++      <div>signals: {JSON.stringify(meta.signals)}</div>
+     </div>
+   );
+ }
+ 
++function MarkdownRenderer({ markdown }: { markdown: string }) {
++  const containerRef = useRef<HTMLDivElement | null>(null);
++  const html = useMemo(() => marked.parse(markdown, { breaks: true }), [markdown]);
++
++  useEffect(() => {
++    if (!containerRef.current) return;
++    const container = containerRef.current;
++    const blocks = container.querySelectorAll("pre code.language-mermaid, pre code.lang-mermaid, pre code.mermaid");
++    blocks.forEach((block) => {
++      const parent = block.parentElement;
++      if (!parent) return;
++      const wrapper = document.createElement("div");
++      wrapper.className = "mermaid";
++      wrapper.textContent = block.textContent || "";
++      parent.replaceWith(wrapper);
++    });
++    mermaid.run({ nodes: container.querySelectorAll(".mermaid") });
++  }, [html]);
++
++  return <div className="markdown" ref={containerRef} dangerouslySetInnerHTML={{ __html: html }} />;
++}
++
+ function CopyButton({ value }: { value: string }) {
+   const [copied, setCopied] = useState(false);
+ 
+@@ -573,7 +1404,15 @@
+   );
+ }
+ 
+-function LogPanel({ caseId }: { caseId: string }) {
++function LogPanel({
++  caseId,
++  onCopyLogs,
++  onDownloadLogs,
++}: {
++  caseId: string;
++  onCopyLogs: () => void;
++  onDownloadLogs: () => void;
++}) {
+   const [logs, setLogs] = useState<LogEntry[]>([]);
+   const [autoScroll, setAutoScroll] = useState(true);
+   const [status, setStatus] = useState<"connecting" | "open" | "closed" | "error">(
+@@ -585,21 +1424,56 @@
+     analyze: true,
+     system: true,
+   });
++  const [keyword, setKeyword] = useState("");
++  const [reconnectIn, setReconnectIn] = useState<number | null>(null);
+   const wsRef = useRef<WebSocket | null>(null);
+   const bottomRef = useRef<HTMLDivElement | null>(null);
++  const reconnectAttempt = useRef(0);
++  const reconnectTimer = useRef<number | null>(null);
++  const connectRef = useRef<() => void>(() => {});
+ 
+   const wsUrl = joinUrl(toWsUrl(API_BASE), `/ws/logs/${caseId}`);
+ 
++  const clearReconnect = () => {
++    if (reconnectTimer.current) {
++      window.clearTimeout(reconnectTimer.current);
++      reconnectTimer.current = null;
++    }
++    setReconnectIn(null);
++  };
++
++  const scheduleReconnect = useCallback(() => {
++    if (reconnectTimer.current) return;
++    reconnectAttempt.current += 1;
++    const delay = Math.min(30000, 1000 * 2 ** (reconnectAttempt.current - 1));
++    setReconnectIn(delay);
++    reconnectTimer.current = window.setTimeout(() => {
++      reconnectTimer.current = null;
++      connectRef.current();
++    }, delay);
++  }, []);
++
+   const connect = useCallback(() => {
+     if (wsRef.current) {
+       wsRef.current.close();
+     }
++    clearReconnect();
+     setStatus("connecting");
+     const ws = new WebSocket(wsUrl);
+     wsRef.current = ws;
+-    ws.onopen = () => setStatus("open");
+-    ws.onclose = () => setStatus("closed");
+-    ws.onerror = () => setStatus("error");
++    ws.onopen = () => {
++      reconnectAttempt.current = 0;
++      setStatus("open");
++      setReconnectIn(null);
++    };
++    ws.onclose = () => {
++      setStatus("closed");
++      scheduleReconnect();
++    };
++    ws.onerror = () => {
++      setStatus("error");
++      scheduleReconnect();
++    };
+     ws.onmessage = (event) => {
+       let parsed: LogEntry = {
+         ts: Date.now() / 1000,
+@@ -631,12 +1505,17 @@
+         return next;
+       });
+     };
+-  }, [wsUrl]);
++  }, [wsUrl, scheduleReconnect]);
++
++  useEffect(() => {
++    connectRef.current = connect;
++  }, [connect]);
+ 
+   useEffect(() => {
+     setLogs([]);
+     connect();
+     return () => {
++      clearReconnect();
+       if (wsRef.current) {
+         wsRef.current.close();
+       }
+@@ -651,12 +1530,20 @@
+   }, [logs, autoScroll]);
+ 
+   const visibleLogs = useMemo(() => {
++    const needle = keyword.trim().toLowerCase();
+     return logs.filter((entry) => {
+       const key = entry.stream as keyof typeof filters;
+-      if (filters[key] === undefined) return true;
+-      return filters[key];
++      if (filters[key] === false) return false;
++      if (needle && !entry.line.toLowerCase().includes(needle)) return false;
++      return true;
+     });
+-  }, [logs, filters]);
++  }, [logs, filters, keyword]);
++
++  const jumpToLatest = () => {
++    if (bottomRef.current) {
++      bottomRef.current.scrollIntoView({ behavior: "smooth" });
++    }
++  };
+ 
+   return (
+     <div className="logs-panel">
+@@ -665,18 +1552,36 @@
+           <div className="section-title">日志</div>
+           <div className={`ws-status ws-${status}`}>
+             {status === "open" ? "已连接" : status === "connecting" ? "连接中" : "已断开"}
++            {reconnectIn ? ` · ${Math.ceil(reconnectIn / 1000)}s 后重连` : ""}
+           </div>
+         </div>
+         <div className="logs-actions">
++          <button className="ghost" type="button" onClick={onCopyLogs}>
++            复制 JSONL
++          </button>
++          <button className="ghost" type="button" onClick={onDownloadLogs}>
++            下载 1000 行
++          </button>
+           <button className="ghost" type="button" onClick={() => setAutoScroll((value) => !value)}>
+             {autoScroll ? "暂停滚动" : "自动滚动"}
+           </button>
++          <button className="ghost" type="button" onClick={jumpToLatest}>
++            跳到最新
++          </button>
+           <button className="ghost" type="button" onClick={connect}>
+             重连
+           </button>
+         </div>
+       </div>
+       <div className="filters">
++        <div className="filter search">
++          <input
++            type="text"
++            placeholder="搜索关键词"
++            value={keyword}
++            onChange={(event) => setKeyword(event.target.value)}
++          />
++        </div>
+         {(
+           [
+             { id: "build", label: "构建" },
+diff -ruN '--exclude=.devlogs' '--exclude=venv' '--exclude=node_modules' '--exclude=__pycache__' /tmp/AntiHub.phase3.base/frontend/src/styles.css /home/user2643/code/AntiHub/frontend/src/styles.css
+--- /tmp/AntiHub.phase3.base/frontend/src/styles.css	2026-01-22 21:52:23.262380687 +0800
++++ /home/user2643/code/AntiHub/frontend/src/styles.css	2026-01-22 23:29:23.402663450 +0800
+@@ -179,6 +179,14 @@
+   font-size: 15px;
+ }
+ 
++.field select {
++  padding: 12px 14px;
++  border-radius: 12px;
++  border: 1px solid var(--border);
++  font-size: 15px;
++  background: white;
++}
++
+ .field-row {
+   display: grid;
+   grid-template-columns: 1fr auto;
+@@ -300,6 +308,128 @@
+   font-size: 14px;
+ }
+ 
++.dashboard {
++  display: flex;
++  flex-direction: column;
++  gap: 20px;
++}
++
++.dashboard-head {
++  display: flex;
++  justify-content: space-between;
++  align-items: center;
++  gap: 16px;
++}
++
++.dashboard-actions {
++  display: flex;
++  gap: 12px;
++}
++
++.stats {
++  display: grid;
++  grid-template-columns: repeat(3, 1fr);
++  gap: 16px;
++}
++
++.stat-card {
++  display: flex;
++  flex-direction: column;
++  gap: 6px;
++}
++
++.stat-title {
++  color: var(--muted);
++  font-size: 13px;
++}
++
++.stat-value {
++  font-size: 24px;
++  font-weight: 700;
++}
++
++.filters-panel {
++  display: grid;
++  grid-template-columns: repeat(5, minmax(0, 1fr));
++  gap: 12px;
++  align-items: end;
++}
++
++.filters-panel select,
++.filters-panel input {
++  padding: 10px 12px;
++  border-radius: 12px;
++  border: 1px solid var(--border);
++}
++
++.table-card {
++  padding: 0;
++  overflow: hidden;
++}
++
++.table {
++  display: grid;
++}
++
++.table-header,
++.table-row {
++  display: grid;
++  grid-template-columns: 1.1fr 2fr 1.6fr 1.2fr 1.6fr 1.2fr 1.1fr 1.6fr;
++  gap: 12px;
++  padding: 16px 20px;
++  align-items: center;
++}
++
++.table-header {
++  font-size: 13px;
++  font-weight: 600;
++  color: var(--muted);
++  text-transform: uppercase;
++  letter-spacing: 0.5px;
++  background: rgba(30, 111, 122, 0.06);
++}
++
++.table-row {
++  border-top: 1px solid var(--border);
++  font-size: 14px;
++}
++
++.table-row a {
++  color: var(--accent-strong);
++  text-decoration: none;
++}
++
++.table-repo {
++  display: flex;
++  flex-direction: column;
++  gap: 4px;
++}
++
++.table-actions {
++  display: flex;
++  gap: 8px;
++  flex-wrap: wrap;
++}
++
++.table-empty {
++  padding: 24px;
++  color: var(--muted);
++}
++
++.pagination {
++  display: flex;
++  justify-content: space-between;
++  align-items: center;
++  padding: 16px 20px;
++  border-top: 1px solid var(--border);
++}
++
++.action-grid {
++  display: grid;
++  grid-template-columns: repeat(2, minmax(0, 1fr));
++  gap: 10px;
++}
++
+ .detail {
+   display: flex;
+   flex-direction: column;
+@@ -569,11 +699,182 @@
+   color: var(--accent-strong);
+ }
+ 
++.toast-banner {
++  display: flex;
++  justify-content: space-between;
++  align-items: flex-start;
++  gap: 16px;
++  padding: 16px;
++  border-radius: 16px;
++  margin-bottom: 16px;
++}
++
++.toast-success {
++  background: rgba(30, 111, 122, 0.12);
++  border: 1px solid rgba(30, 111, 122, 0.3);
++  color: var(--accent-strong);
++}
++
++.toast-error {
++  background: rgba(186, 53, 36, 0.12);
++  border: 1px solid rgba(186, 53, 36, 0.3);
++  color: #8d1f12;
++}
++
++.toast-title {
++  font-weight: 600;
++}
++
++.toast-code {
++  font-size: 12px;
++  color: var(--muted);
++  margin-top: 4px;
++}
++
++.toast-detail {
++  margin-top: 8px;
++  background: transparent;
++  border: none;
++  color: inherit;
++  text-decoration: underline;
++  cursor: pointer;
++}
++
++.toast-body {
++  margin-top: 8px;
++  font-size: 13px;
++  color: inherit;
++  white-space: pre-wrap;
++}
++
++.tabs {
++  display: flex;
++  gap: 12px;
++  margin: 12px 0 20px;
++}
++
++.tab {
++  border: 1px solid var(--border);
++  background: transparent;
++  padding: 8px 16px;
++  border-radius: 999px;
++  color: var(--muted);
++}
++
++.tab.active {
++  background: var(--accent);
++  color: white;
++  border-color: transparent;
++}
++
++.manual {
++  display: flex;
++  flex-direction: column;
++  gap: 16px;
++}
++
++.manual-head {
++  display: flex;
++  justify-content: space-between;
++  align-items: center;
++}
++
++.manual-meta {
++  display: flex;
++  gap: 16px;
++  color: var(--muted);
++  font-size: 13px;
++}
++
++.manual-body {
++  display: flex;
++  flex-direction: column;
++  gap: 16px;
++}
++
++.manual-summary {
++  font-size: 12px;
++  color: var(--muted);
++  display: grid;
++  gap: 4px;
++}
++
++.empty-state {
++  text-align: center;
++  color: var(--muted);
++}
++
++.markdown {
++  line-height: 1.6;
++}
++
++.markdown h1,
++.markdown h2,
++.markdown h3 {
++  margin-top: 16px;
++}
++
++.markdown pre {
++  background: #1d1914;
++  color: #f5efe6;
++  padding: 12px;
++  border-radius: 12px;
++  overflow-x: auto;
++}
++
++.markdown code {
++  font-family: "IBM Plex Mono", "Courier New", monospace;
++}
++
++.markdown table {
++  width: 100%;
++  border-collapse: collapse;
++  margin: 12px 0;
++}
++
++.markdown th,
++.markdown td {
++  border: 1px solid var(--border);
++  padding: 6px 8px;
++  text-align: left;
++  font-size: 13px;
++}
++
++.manual-status {
++  display: flex;
++  flex-direction: column;
++  gap: 4px;
++}
++
++.mermaid {
++  background: white;
++  border: 1px solid var(--border);
++  border-radius: 12px;
++  padding: 12px;
++  overflow-x: auto;
++}
++
++.filters .search input {
++  padding: 8px 12px;
++  border-radius: 12px;
++  border: 1px solid var(--border);
++  background: rgba(255, 255, 255, 0.7);
++  color: var(--ink);
++}
++
+ @media (max-width: 980px) {
+   .create-grid {
+     grid-template-columns: 1fr;
+   }
+ 
++  .stats {
++    grid-template-columns: 1fr;
++  }
++
++  .filters-panel {
++    grid-template-columns: 1fr;
++  }
++
+   .detail-grid {
+     grid-template-columns: 1fr;
+   }
+@@ -597,4 +898,19 @@
+   .log-line {
+     grid-template-columns: 1fr;
+   }
++
++  .table-header,
++  .table-row {
++    grid-template-columns: 1fr;
++    gap: 6px;
++  }
++
++  .pagination {
++    flex-direction: column;
++    gap: 12px;
++  }
++
++  .tabs {
++    flex-wrap: wrap;
++  }
+ }
+diff -ruN '--exclude=.devlogs' '--exclude=venv' '--exclude=node_modules' '--exclude=__pycache__' /tmp/AntiHub.phase3.base/main.py /home/user2643/code/AntiHub/main.py
+--- /tmp/AntiHub.phase3.base/main.py	2026-01-22 21:52:23.262380687 +0800
++++ /home/user2643/code/AntiHub/main.py	2026-01-22 23:49:01.285958861 +0800
+@@ -1,18 +1,49 @@
+ from __future__ import annotations
+ 
++import json
+ import time
+ import uuid
+ from typing import Any, Dict, List, Optional
+ 
+-from fastapi import FastAPI, HTTPException, WebSocket, WebSocketDisconnect
++import docker
++from fastapi import Body, FastAPI, HTTPException, Query, WebSocket, WebSocketDisconnect
+ from fastapi.middleware.cors import CORSMiddleware
++from fastapi.responses import PlainTextResponse, StreamingResponse
+ from pydantic import BaseModel, ConfigDict, Field
+ 
+-from config import CORS_ORIGINS, DEFAULT_BRANCH
+-from storage import decode_log_entry, get_async_redis_client, get_case, get_logs, log_channel, set_case
+-from worker import analyze_case, build_and_run
++from config import (
++    AUTO_MANUAL,
++    CASE_LABEL_KEY,
++    CASE_LABEL_MANAGED,
++    CASE_TEMPLATES,
++    CORS_ORIGINS,
++    DEFAULT_BRANCH,
++    PORT_MODE,
++    PUBLIC_HOST,
++    STARTUP_TIMEOUT_SECONDS,
++)
++from docker_ops import wait_for_container_running
++from errors import ERROR_CODE_MAP
++from storage import (
++    append_log,
++    decode_log_entry,
++    get_async_redis_client,
++    get_manual,
++    get_manual_stats,
++    get_manual_status,
++    get_redis_client,
++    get_case,
++    get_logs,
++    get_logs_slice,
++    list_case_ids,
++    log_channel,
++    set_manual_status,
++    set_case,
++    update_case,
++)
++from worker import BuildError, analyze_case, build_and_run, generate_manual_task, release_port, reserve_specific_port
+ 
+-app = FastAPI(title="Agent Platform", version="0.2.0")
++app = FastAPI(title="Agent Platform", version="0.4.0")
+ app.add_middleware(
+     CORSMiddleware,
+     allow_origins=CORS_ORIGINS,
+@@ -28,9 +59,11 @@
+     "BUILDING": "build",
+     "STARTING": "run",
+     "RUNNING": "run",
++    "STOPPED": "run",
+     "FINISHED": "run",
+     "FAILED": "system",
+     "ANALYZING": "analyze",
++    "ARCHIVED": "system",
+ }
+ 
+ 
+@@ -61,6 +94,21 @@
+     model_config = ConfigDict(extra="ignore")
+ 
+ 
++class CaseActionRequest(BaseModel):
++    action: str = Field(..., description="stop | restart | retry | archive")
++    env: Dict[str, str] = Field(
++        default_factory=dict,
++        description="Optional env override for retry (values are not stored).",
++    )
++
++
++class CaseRetryRequest(BaseModel):
++    env: Dict[str, str] = Field(
++        default_factory=dict,
++        description="Optional env override for retry (values are not stored).",
++    )
++
++
+ class RuntimeInfo(BaseModel):
+     container_id: Optional[str] = None
+     host_port: Optional[int] = None
+@@ -81,6 +129,10 @@
+     error_message: Optional[str] = None
+     created_at: Optional[float] = None
+     updated_at: Optional[float] = None
++    archived: bool = False
++    archived_at: Optional[float] = None
++    attempt: Optional[int] = None
++    retry_of: Optional[str] = None
+     repo_url: Optional[str] = None
+     ref: Optional[str] = None
+     branch: Optional[str] = None
+@@ -91,6 +143,56 @@
+     image_tag: Optional[str] = None
+     last_log_at: Optional[float] = None
+     report_ready: bool = False
++    manual_status: Optional[str] = None
++    manual_generated_at: Optional[float] = None
++    manual_error_code: Optional[str] = None
++    manual_error_message: Optional[str] = None
++
++
++class CaseListResponse(BaseModel):
++    items: List[CaseResponse]
++    total: int
++    page: int
++    size: int
++
++
++class CaseActionResponse(BaseModel):
++    case_id: str
++    action: str
++    status: str
++    message: str
++
++
++class ManualMeta(BaseModel):
++    generated_at: float
++    generator_version: str
++    signals: Dict[str, Any]
++    time_cost_ms: int
++
++
++class ManualResponse(BaseModel):
++    case_id: str
++    manual_markdown: str
++    meta: ManualMeta
++
++
++class ManualStatusResponse(BaseModel):
++    case_id: str
++    status: str
++    generated_at: Optional[float] = None
++    error_code: Optional[str] = None
++    error_message: Optional[str] = None
++
++
++class CaseTemplate(BaseModel):
++    name: str
++    repo_url: Optional[str] = None
++    git_url: Optional[str] = None
++    ref: Optional[str] = None
++    default_env_keys: List[str] = Field(default_factory=list)
++    build_mode: Optional[str] = None
++    port_mode: Optional[str] = None
++    timeouts: Dict[str, int] = Field(default_factory=dict)
+ 
+ 
+ def normalize_stage(raw_stage: Optional[str], status: Optional[str]) -> str:
+@@ -142,6 +244,10 @@
+         error_message=error_message,
+         created_at=data.get("created_at"),
+         updated_at=data.get("updated_at"),
++        archived=bool(data.get("archived", False)),
++        archived_at=data.get("archived_at"),
++        attempt=data.get("attempt"),
++        retry_of=data.get("retry_of"),
+         repo_url=data.get("repo_url"),
+         ref=ref_value,
+         branch=branch_value,
+@@ -152,12 +258,136 @@
+         image_tag=data.get("image_tag"),
+         last_log_at=data.get("last_log_at"),
+         report_ready=bool(data.get("report_ready", False)),
++        manual_status=data.get("manual_status"),
++        manual_generated_at=data.get("manual_generated_at"),
++        manual_error_code=data.get("manual_error_code"),
++        manual_error_message=data.get("manual_error_message"),
+     )
+ 
+ 
++def matches_query(case_id: str, data: Dict[str, Any], query: str) -> bool:
++    q = query.lower().strip()
++    if not q:
++        return True
++    haystacks = [
++        case_id,
++        str(data.get("repo_url") or ""),
++        str(data.get("ref") or data.get("branch") or ""),
++    ]
++    return any(q in (value or "").lower() for value in haystacks)
++
++
++def get_case_or_404(case_id: str) -> Dict[str, Any]:
++    data = get_case(case_id) or {}
++    if not data:
++        raise HTTPException(status_code=404, detail="Case not found")
++    return data
++
++
++def get_managed_container(case_id: str, container_id: str) -> docker.models.containers.Container:
++    client = docker.from_env()
++    container = client.containers.get(container_id)
++    labels = container.labels or {}
++    if labels.get(CASE_LABEL_KEY) != case_id or labels.get(CASE_LABEL_MANAGED) != "true":
++        raise HTTPException(status_code=400, detail="Container is not managed by AntiHub")
++    return container
++
++
++def append_system_log(case_id: str, line: str, level: str = "INFO") -> None:
++    append_log(case_id, {"ts": time.time(), "stream": "system", "level": level, "line": line})
++
++
++def build_jsonl(entries: List[Dict[str, Any]]) -> str:
++    return "\n".join(json.dumps(entry, ensure_ascii=False) for entry in entries) + ("\n" if entries else "")
++
++
++def resolve_host_port(container: docker.models.containers.Container, container_port: Optional[int]) -> Optional[int]:
++    ports = container.attrs.get("NetworkSettings", {}).get("Ports", {}) or {}
++    if container_port:
++        binding = ports.get(f"{container_port}/tcp")
++        if binding:
++            return int(binding[0]["HostPort"])
++    for binding in ports.values():
++        if binding:
++            return int(binding[0]["HostPort"])
++    return None
++
++
+ @app.get("/healthz")
+ async def healthz() -> dict:
+-    return {"status": "ok"}
++    health = {"status": "ok", "api": "ok", "redis": "ok", "docker": "ok", "details": {}}
++    try:
++        client = get_redis_client()
++        client.ping()
++    except Exception as exc:  # noqa: BLE001
++        health["redis"] = "error"
++        health["details"]["redis"] = str(exc)
++        health["status"] = "degraded"
++    try:
++        docker.from_env().ping()
++    except Exception as exc:  # noqa: BLE001
++        health["docker"] = "error"
++        health["details"]["docker"] = str(exc)
++        health["status"] = "degraded"
++    return health
++
++
++@app.get("/error-codes")
++async def error_codes() -> Dict[str, Dict[str, str]]:
++    return ERROR_CODE_MAP
++
++
++@app.get("/stats")
++async def stats() -> Dict[str, Any]:
++    return {"manual": get_manual_stats()}
++
++
++@app.get("/case-templates", response_model=List[CaseTemplate])
++async def case_templates() -> List[CaseTemplate]:
++    templates: List[CaseTemplate] = []
++    raw_templates = CASE_TEMPLATES if isinstance(CASE_TEMPLATES, list) else []
++    for item in raw_templates:
++        if not isinstance(item, dict):
++            continue
++        payload = dict(item)
++        env_keys = payload.get("default_env_keys") or []
++        if not isinstance(env_keys, list):
++            env_keys = []
++        payload["default_env_keys"] = [str(key) for key in env_keys]
++        templates.append(CaseTemplate(**payload))
++    return templates
++
++
++@app.get("/cases", response_model=CaseListResponse)
++async def list_cases(
++    q: Optional[str] = Query(None, description="Search by case_id/repo/ref"),
++    status: Optional[str] = Query(None, description="Filter by status"),
++    stage: Optional[str] = Query(None, description="Filter by stage"),
++    page: int = Query(1, ge=1, description="Page number"),
++    size: int = Query(20, ge=1, le=200, description="Page size"),
++    include_archived: bool = Query(False, description="Include archived cases"),
++) -> CaseListResponse:
++    ids = list_case_ids()
++    items: List[CaseResponse] = []
++    for case_id in ids:
++        data = get_case(case_id) or {}
++        if not data:
++            continue
++        if not include_archived and bool(data.get("archived", False)):
++            continue
++        if status and (data.get("status") or "").upper() != status.upper():
++            continue
++        normalized_stage = normalize_stage(data.get("stage"), data.get("status"))
++        if stage and normalized_stage != stage.lower():
++            continue
++        if q and not matches_query(case_id, data, q):
++            continue
++        items.append(build_case_response(case_id, data))
++    items.sort(key=lambda item: item.updated_at or item.created_at or 0, reverse=True)
++    total = len(items)
++    start = (page - 1) * size
++    end = start + size
++    return CaseListResponse(items=items[start:end], total=total, page=page, size=size)
+ 
+ 
+ @app.post("/cases", response_model=CaseResponse)
+@@ -181,6 +411,14 @@
+         "report_ready": False,
+         "created_at": now,
+         "updated_at": now,
++        "archived": False,
++        "archived_at": None,
++        "attempt": 1,
++        "retry_of": None,
++        "manual_status": "NOT_STARTED",
++        "manual_generated_at": None,
++        "manual_error_code": None,
++        "manual_error_message": None,
+         "runtime": {
+             "container_id": None,
+             "host_port": None,
+@@ -199,18 +437,160 @@
+         payload.env,
+         payload.auto_analyze,
+     )
++    if AUTO_MANUAL:
++        update_case(case_id, {"manual_status": "PENDING"})
++        data["manual_status"] = "PENDING"
++        generate_manual_task.delay(case_id)
+     return build_case_response(case_id, data)
+ 
+ 
+ @app.get("/cases/{case_id}", response_model=CaseResponse)
+ async def get_case_status(case_id: str) -> CaseResponse:
+-    data = get_case(case_id) or {}
+-    if not data:
+-        raise HTTPException(status_code=404, detail="Case not found")
++    data = get_case_or_404(case_id)
+     data.pop("case_id", None)
+     return build_case_response(case_id, data)
+ 
+ 
++def handle_case_action(case_id: str, action: str, env: Optional[Dict[str, str]] = None) -> CaseActionResponse:
++    data = get_case_or_404(case_id)
++    action_key = action.lower()
++    runtime = data.get("runtime") or {}
++    container_id = data.get("container_id") or runtime.get("container_id")
++    host_port = data.get("host_port") or runtime.get("host_port")
++
++    if action_key == "stop":
++        if not container_id:
++            raise HTTPException(status_code=400, detail="No running container for case")
++        container = get_managed_container(case_id, container_id)
++        try:
++            container.stop(timeout=10)
++        except Exception:
++            container.kill()
++        container.reload()
++        exit_code = container.attrs.get("State", {}).get("ExitCode")
++        update_case(
++            case_id,
++            {
++                "status": "STOPPED",
++                "stage": "run",
++                "error_code": "STOPPED_BY_USER",
++                "error_message": "Stopped by user",
++                "runtime": {
++                    **runtime,
++                    "exited_at": time.time(),
++                    "exit_code": exit_code,
++                },
++            },
++        )
++        append_system_log(case_id, "Container stopped by user")
++        if PORT_MODE != "dynamic":
++            release_port(host_port)
++        return CaseActionResponse(case_id=case_id, action=action_key, status="STOPPED", message="Stopped")
++
++    if action_key == "restart":
++        if not container_id:
++            raise HTTPException(status_code=400, detail="No existing container to restart")
++        container = get_managed_container(case_id, container_id)
++        if PORT_MODE != "dynamic" and host_port:
++            try:
++                reserve_specific_port(case_id, int(host_port))
++            except BuildError as exc:
++                raise HTTPException(status_code=409, detail=f"{exc.code}: {exc}") from exc
++        container.start()
++        wait_for_container_running(docker.from_env(), container_id, STARTUP_TIMEOUT_SECONDS)
++        container.reload()
++        container_port = data.get("container_port")
++        host_port = host_port or resolve_host_port(container, container_port)
++        access_url = data.get("access_url") or runtime.get("access_url")
++        if host_port and not access_url:
++            access_url = f"http://{PUBLIC_HOST}:{host_port}"
++        update_case(
++            case_id,
++            {
++                "status": "RUNNING",
++                "stage": "run",
++                "error_code": None,
++                "error_message": None,
++                "container_id": container_id,
++                "host_port": host_port,
++                "access_url": access_url,
++                "runtime": {
++                    **runtime,
++                    "container_id": container_id,
++                    "host_port": host_port,
++                    "access_url": access_url,
++                    "started_at": time.time(),
++                    "exited_at": None,
++                    "exit_code": None,
++                },
++            },
++        )
++        append_system_log(case_id, "Container restarted")
++        return CaseActionResponse(case_id=case_id, action=action_key, status="RUNNING", message="Restarted")
++
++    if action_key == "retry":
++        repo_url = data.get("repo_url")
++        if not repo_url:
++            raise HTTPException(status_code=400, detail="Missing repo_url for retry")
++        ref = data.get("ref") or data.get("branch") or DEFAULT_BRANCH
++        container_port = data.get("container_port")
++        retry_env = env or {}
++        env_keys = sorted(retry_env.keys()) if retry_env else sorted(data.get("env_keys") or [])
++        attempt = int(data.get("attempt") or 1) + 1
++        retry_of = data.get("retry_of") or case_id
++        update_case(
++            case_id,
++            {
++                "status": "PENDING",
++                "stage": "system",
++                "error_code": None,
++                "error_message": None,
++                "env_keys": env_keys,
++                "attempt": attempt,
++                "retry_of": retry_of,
++            },
++        )
++        append_system_log(case_id, "Retry requested")
++        build_and_run.delay(case_id, repo_url, ref, container_port, retry_env, False)
++        return CaseActionResponse(case_id=case_id, action=action_key, status="PENDING", message="Retry started")
++
++    if action_key == "archive":
++        update_case(case_id, {"archived": True, "archived_at": time.time()})
++        append_system_log(case_id, "Case archived")
++        return CaseActionResponse(case_id=case_id, action=action_key, status="ARCHIVED", message="Archived")
++
++    raise HTTPException(status_code=400, detail="Unsupported action")
++
++
++@app.post("/cases/{case_id}/actions", response_model=CaseActionResponse)
++async def case_actions(case_id: str, payload: CaseActionRequest) -> CaseActionResponse:
++    return handle_case_action(case_id, payload.action, payload.env)
++
++
++@app.post("/cases/{case_id}/stop", response_model=CaseActionResponse)
++async def case_stop(case_id: str) -> CaseActionResponse:
++    return handle_case_action(case_id, "stop")
++
++
++@app.post("/cases/{case_id}/restart", response_model=CaseActionResponse)
++async def case_restart(case_id: str) -> CaseActionResponse:
++    return handle_case_action(case_id, "restart")
++
++
++@app.post("/cases/{case_id}/retry", response_model=CaseActionResponse)
++async def case_retry(
++    case_id: str,
++    payload: CaseRetryRequest = Body(default_factory=CaseRetryRequest),
++) -> CaseActionResponse:
++    env = payload.env
++    return handle_case_action(case_id, "retry", env)
++
++
++@app.post("/cases/{case_id}/archive", response_model=CaseActionResponse)
++async def case_archive(case_id: str) -> CaseActionResponse:
++    return handle_case_action(case_id, "archive")
++
++
+ @app.post("/cases/{case_id}/analyze")
+ async def trigger_analyze(case_id: str) -> Dict[str, str]:
+     data = get_case(case_id)
+@@ -228,6 +608,45 @@
+     raise HTTPException(status_code=404, detail="Report not ready (stub)")
+ 
+ 
++@app.post("/cases/{case_id}/manual", response_model=ManualStatusResponse)
++async def trigger_manual(case_id: str) -> ManualStatusResponse:
++    get_case_or_404(case_id)
++    update_case(
++        case_id,
++        {
++            "manual_status": "PENDING",
++            "manual_error_code": None,
++            "manual_error_message": None,
++        },
++    )
++    set_manual_status(case_id, "PENDING")
++    generate_manual_task.delay(case_id)
++    return ManualStatusResponse(case_id=case_id, status="PENDING")
++
++
++@app.get("/cases/{case_id}/manual/status", response_model=ManualStatusResponse)
++async def manual_status(case_id: str) -> ManualStatusResponse:
++    data = get_case_or_404(case_id)
++    status_data = get_manual_status(case_id) or {}
++    status = status_data.get("status") or data.get("manual_status") or "NOT_STARTED"
++    return ManualStatusResponse(
++        case_id=case_id,
++        status=status,
++        generated_at=status_data.get("generated_at") or data.get("manual_generated_at"),
++        error_code=status_data.get("error_code") or data.get("manual_error_code"),
++        error_message=status_data.get("error_message") or data.get("manual_error_message"),
++    )
++
++
++@app.get("/cases/{case_id}/manual", response_model=ManualResponse)
++async def get_manual_content(case_id: str) -> ManualResponse:
++    get_case_or_404(case_id)
++    markdown, meta = get_manual(case_id)
++    if not markdown or not meta:
++        raise HTTPException(status_code=404, detail="Manual not found")
++    return ManualResponse(case_id=case_id, manual_markdown=markdown, meta=ManualMeta(**meta))
++
++
+ @app.websocket("/cases/{case_id}/logs")
+ @app.websocket("/ws/logs/{case_id}")
+ async def case_logs(websocket: WebSocket, case_id: str) -> None:
+@@ -254,5 +673,27 @@
+ 
+ 
+ @app.get("/cases/{case_id}/logs")
+-async def http_logs(case_id: str) -> List[Dict[str, Any]]:
+-    return get_logs(case_id)
++async def http_logs(
++    case_id: str,
++    limit: int = Query(200, ge=1, le=2000, description="Number of lines from tail"),
++    offset: int = Query(0, ge=0, description="Offset from tail"),
++    format: Optional[str] = Query(None, description="json | jsonl"),
++) -> Any:
++    get_case_or_404(case_id)
++    entries = get_logs_slice(case_id, offset=offset, limit=limit)
++    if format == "jsonl":
++        return PlainTextResponse(build_jsonl(entries), media_type="application/jsonl")
++    return entries
++
++
++@app.get("/cases/{case_id}/logs/download")
++async def download_logs(
++    case_id: str,
++    limit: int = Query(1000, ge=1, le=2000, description="Number of lines from tail"),
++    offset: int = Query(0, ge=0, description="Offset from tail"),
++) -> StreamingResponse:
++    get_case_or_404(case_id)
++    entries = get_logs_slice(case_id, offset=offset, limit=limit)
++    payload = build_jsonl(entries).encode("utf-8")
++    headers = {"Content-Disposition": f"attachment; filename={case_id}.jsonl"}
++    return StreamingResponse(iter([payload]), media_type="application/jsonl", headers=headers)
+diff -ruN '--exclude=.devlogs' '--exclude=venv' '--exclude=node_modules' '--exclude=__pycache__' /tmp/AntiHub.phase3.base/manual_generator.py /home/user2643/code/AntiHub/manual_generator.py
+--- /tmp/AntiHub.phase3.base/manual_generator.py	1970-01-01 08:00:00.000000000 +0800
++++ /home/user2643/code/AntiHub/manual_generator.py	2026-01-22 22:46:46.722142245 +0800
+@@ -0,0 +1,351 @@
++import json
++import os
++import re
++import time
++from pathlib import Path
++from typing import Any, Dict, List, Optional, Tuple
++
++from config import MANUAL_GENERATOR_VERSION, MANUAL_MAX_README_CHARS, MANUAL_TREE_DEPTH
++
++README_CANDIDATES = ["README.md", "README.MD", "README"]
++IGNORED_DIRS = {
++    ".git",
++    ".hg",
++    ".svn",
++    ".idea",
++    ".vscode",
++    "__pycache__",
++    "node_modules",
++    "venv",
++    ".venv",
++    "dist",
++    "build",
++    ".tox",
++}
++
++CONFIG_FILE_PATTERNS = {
++    ".env",
++    ".env.example",
++    "docker-compose.yml",
++    "docker-compose.yaml",
++    "pyproject.toml",
++    "package.json",
++    "requirements.txt",
++}
++CONFIG_SUFFIXES = (".yaml", ".yml", ".toml", ".json")
++
++
++def generate_manual(
++    repo_path: Path,
++    env_keys: List[str],
++    repo_name: Optional[str] = None,
++    tree_depth: Optional[int] = None,
++    readme_max_chars: Optional[int] = None,
++) -> Tuple[str, Dict[str, Any]]:
++    start = time.time()
++    repo_name = repo_name or repo_path.name
++    tree_depth = tree_depth if tree_depth is not None else MANUAL_TREE_DEPTH
++    readme_max_chars = readme_max_chars if readme_max_chars is not None else MANUAL_MAX_README_CHARS
++
++    readme_path, readme_text = _read_readme(repo_path, readme_max_chars)
++    dockerfile_path = repo_path / "Dockerfile"
++    has_dockerfile = dockerfile_path.exists()
++    docker_info = _parse_dockerfile(dockerfile_path) if has_dockerfile else {}
++    tree_output, file_count = _build_tree(repo_path, tree_depth)
++    config_files = _find_config_files(repo_path, tree_depth)
++
++    one_liner, features = _summarize_readme(readme_text, repo_name)
++    local_run = _infer_local_run(repo_path)
++    docker_run = _infer_docker_run(repo_name, docker_info)
++    port_hint = docker_info.get("expose") or "-"
++    env_keys = sorted({key for key in env_keys if key})
++
++    manual_markdown = _render_manual(
++        repo_name=repo_name,
++        one_liner=one_liner,
++        features=features,
++        local_run=local_run,
++        docker_run=docker_run,
++        env_keys=env_keys,
++        port_hint=port_hint,
++        config_files=config_files,
++        tree_output=tree_output,
++        docker_info=docker_info,
++        readme_path=readme_path,
++    )
++
++    time_cost_ms = int((time.time() - start) * 1000)
++    meta = {
++        "generated_at": time.time(),
++        "generator_version": MANUAL_GENERATOR_VERSION,
++        "signals": {
++            "has_readme": bool(readme_text),
++            "has_dockerfile": has_dockerfile,
++            "config_files": config_files,
++            "tree_depth": tree_depth,
++            "file_count": file_count,
++        },
++        "time_cost_ms": time_cost_ms,
++    }
++    manual_markdown = (
++        manual_markdown.replace("{generated_at}", str(meta["generated_at"]))
++        .replace("{generator_version}", str(meta["generator_version"]))
++        .replace("{signals}", json.dumps(meta["signals"], ensure_ascii=False))
++        .replace("{time_cost_ms}", str(meta["time_cost_ms"]))
++    )
++    return manual_markdown, meta
++
++
++def _read_readme(repo_path: Path, max_chars: int) -> Tuple[Optional[str], str]:
++    for name in README_CANDIDATES:
++        path = repo_path / name
++        if path.exists():
++            try:
++                text = path.read_text(encoding="utf-8", errors="replace")
++            except Exception:
++                text = ""
++            return str(path.name), text[:max_chars]
++    return None, ""
++
++
++def _summarize_readme(readme_text: str, repo_name: str) -> Tuple[str, List[str]]:
++    lines = [line.strip() for line in readme_text.splitlines() if line.strip()]
++    one_liner = ""
++    features: List[str] = []
++    if lines:
++        title = ""
++        for line in lines:
++            if line.startswith("#"):
++                title = line.lstrip("#").strip()
++                continue
++            one_liner = line
++            break
++        if not one_liner:
++            one_liner = title or f"{repo_name} 的服务示例。"
++        for line in lines:
++            if line.startswith(("- ", "* ")):
++                feature = line.lstrip("-* ").strip()
++                if feature and feature not in features:
++                    features.append(feature)
++            if line.startswith("## "):
++                heading = line[3:].strip()
++                if heading and heading not in features:
++                    features.append(heading)
++            if len(features) >= 5:
++                break
++    if not one_liner:
++        one_liner = f"{repo_name} 的部署与运行说明。"
++    if not features:
++        features = [
++            "一键部署与运行",
++            "结构化日志与状态可视化",
++            "可扩展的配置与环境变量",
++        ]
++    return one_liner, features
++
++
++def _infer_local_run(repo_path: Path) -> List[str]:
++    commands: List[str] = []
++    pkg_path = repo_path / "package.json"
++    if pkg_path.exists():
++        commands.append("依赖：Node.js 18+ / npm")
++        commands.append("npm install")
++        script = _resolve_node_script(pkg_path)
++        commands.append(script or "npm run dev")
++        return commands
++
++    if (repo_path / "requirements.txt").exists() or (repo_path / "pyproject.toml").exists():
++        commands.append("依赖：Python 3.9+")
++        if (repo_path / "requirements.txt").exists():
++            commands.append("pip install -r requirements.txt")
++        else:
++            commands.append("pip install -U pip && pip install -e .")
++        if (repo_path / "main.py").exists():
++            commands.append("python main.py")
++        else:
++            commands.append("python -m uvicorn main:app --host 0.0.0.0 --port 8000")
++        return commands
++
++    commands.append("依赖：按 README 指引准备")
++    commands.append("启动命令：请参考 README 或 Dockerfile")
++    return commands
++
++
++def _resolve_node_script(pkg_path: Path) -> Optional[str]:
++    try:
++        data = json.loads(pkg_path.read_text(encoding="utf-8", errors="replace"))
++    except Exception:
++        return None
++    scripts = data.get("scripts") if isinstance(data, dict) else {}
++    if isinstance(scripts, dict):
++        if "dev" in scripts:
++            return "npm run dev"
++        if "start" in scripts:
++            return "npm start"
++    return None
++
++
++def _infer_docker_run(repo_name: str, docker_info: Dict[str, Any]) -> List[str]:
++    expose = docker_info.get("expose") or "8080"
++    commands = [
++        f"docker build -t {repo_name.lower()}:local .",
++        f"docker run --rm -p 8080:{expose} {repo_name.lower()}:local",
++    ]
++    return commands
++
++
++def _parse_dockerfile(path: Path) -> Dict[str, Any]:
++    info: Dict[str, Any] = {"base": None, "expose": None, "cmd": None, "entrypoint": None}
++    if not path.exists():
++        return info
++    try:
++        contents = path.read_text(encoding="utf-8", errors="replace")
++    except Exception:
++        return info
++    for line in contents.splitlines():
++        line = line.strip()
++        if not line or line.startswith("#"):
++            continue
++        if line.upper().startswith("FROM "):
++            info["base"] = line.split(" ", 1)[1].strip()
++        if line.upper().startswith("EXPOSE "):
++            match = re.search(r"EXPOSE\s+(\d+)", line, re.IGNORECASE)
++            if match:
++                info["expose"] = match.group(1)
++        if line.upper().startswith("CMD "):
++            info["cmd"] = line
++        if line.upper().startswith("ENTRYPOINT "):
++            info["entrypoint"] = line
++    return info
++
++
++def _build_tree(repo_path: Path, depth: int) -> Tuple[str, int]:
++    lines: List[str] = []
++    file_count = 0
++
++    def walk(current: Path, prefix: str, current_depth: int) -> None:
++        nonlocal file_count
++        if current_depth > depth:
++            return
++        entries = [p for p in sorted(current.iterdir(), key=lambda p: (not p.is_dir(), p.name.lower()))]
++        entries = [p for p in entries if p.name not in IGNORED_DIRS]
++        for idx, entry in enumerate(entries):
++            connector = "└──" if idx == len(entries) - 1 else "├──"
++            name = f"{entry.name}/" if entry.is_dir() else entry.name
++            lines.append(f"{prefix}{connector} {name}")
++            if entry.is_dir():
++                next_prefix = prefix + ("    " if idx == len(entries) - 1 else "│   ")
++                walk(entry, next_prefix, current_depth + 1)
++            else:
++                file_count += 1
++
++    lines.append(f"{repo_path.name}/")
++    try:
++        walk(repo_path, "", 1)
++    except Exception:
++        lines.append("(目录解析失败)")
++
++    return "\n".join(lines), file_count
++
++
++def _find_config_files(repo_path: Path, depth: int) -> List[str]:
++    config_files: List[str] = []
++    for root, dirs, files in os.walk(repo_path):
++        rel = Path(root).relative_to(repo_path)
++        if any(part in IGNORED_DIRS for part in rel.parts):
++            dirs[:] = []
++            continue
++        if len(rel.parts) > depth:
++            dirs[:] = []
++            continue
++        for file in files:
++            name = file
++            lower = name.lower()
++            if lower in CONFIG_FILE_PATTERNS or lower.endswith(CONFIG_SUFFIXES):
++                path = str((Path(root) / file).relative_to(repo_path))
++                if path not in config_files:
++                    config_files.append(path)
++    return sorted(config_files)
++
++
++def _render_manual(
++    repo_name: str,
++    one_liner: str,
++    features: List[str],
++    local_run: List[str],
++    docker_run: List[str],
++    env_keys: List[str],
++    port_hint: str,
++    config_files: List[str],
++    tree_output: str,
++    docker_info: Dict[str, Any],
++    readme_path: Optional[str],
++) -> str:
++    feature_lines = "\n".join([f"- [ ] {item}" for item in features])
++    local_lines = "\n".join([f"- {item}" for item in local_run])
++    docker_lines = "\n".join([f"- {item}" for item in docker_run])
++    env_lines = "\n".join([f"  - {item}" for item in env_keys]) or "  - (无)"
++    config_lines = "\n".join([f"  - {item}" for item in config_files]) or "  - (无)"
++    docker_notes = []
++    if docker_info.get("base"):
++        docker_notes.append(f"Dockerfile 基础镜像：{docker_info['base']}")
++    if docker_info.get("cmd"):
++        docker_notes.append(f"Dockerfile CMD：{docker_info['cmd']}")
++    if docker_info.get("entrypoint"):
++        docker_notes.append(f"Dockerfile ENTRYPOINT：{docker_info['entrypoint']}")
++    docker_note_block = "\n".join(f"- {item}" for item in docker_notes) or "- (未解析到 Dockerfile 关键指令)"
++    readme_note = readme_path or "README 缺失"
++
++    return f"""# {repo_name} 说明书
++## 1. 一句话简介
++- {one_liner}
++
++## 2. 功能概览
++{feature_lines}
++
++## 3. 快速开始
++### 3.1 一键部署（本平台）
++- 创建 Case：在控制台填写 repo/ref/env_keys，提交后获取 case_id
++- 访问地址：RUNNING 后使用 access_url 打开
++
++### 3.2 本地运行（如可推断）
++{local_lines}
++
++### 3.3 Docker 运行（如可推断）
++{docker_lines}
++
++## 4. 配置与环境变量（只展示 keys）
++- 端口：{port_hint}
++- 环境变量：
++{env_lines}
++- 关键配置文件：
++{config_lines}
++
++## 5. 目录结构解读
++```text
++{tree_output}
++```
++关键目录/文件说明：
++- Dockerfile: {docker_info.get('expose') or '-'} 端口与镜像构建入口
++- README: {readme_note}
++
++## 6. 架构/流程图（Mermaid）
++```mermaid
++flowchart TD
++  A[Repo Source] --> B[Build Image]
++  B --> C[Container Runtime]
++  C --> D[Access URL]
++  C --> E[Logs Stream]
++```
++
++## 7. 常见问题与注意事项
++- Dockerfile 缺失：请在仓库根目录补齐 Dockerfile
++- 端口不可访问：确认 EXPOSE 与应用监听端口一致
++- 环境变量未生效：仅支持 key 注入，请检查键名是否正确
++
++## 8. 版本与生成信息
++- generated_at: {{generated_at}}
++- generator_version: {{generator_version}}
++- signals: {{signals}}
++- time_cost_ms: {{time_cost_ms}}
++"""
+diff -ruN '--exclude=.devlogs' '--exclude=venv' '--exclude=node_modules' '--exclude=__pycache__' /tmp/AntiHub.phase3.base/phase2.patch /home/user2643/code/AntiHub/phase2.patch
+--- /tmp/AntiHub.phase3.base/phase2.patch	1970-01-01 08:00:00.000000000 +0800
++++ /home/user2643/code/AntiHub/phase2.patch	2026-01-22 17:27:17.190205944 +0800
+@@ -0,0 +1,3705 @@
++--- README.md
+++++ README.md
++@@ -1,13 +1,13 @@
++-# AntiHub Phase 1 快速上手（中文傻瓜版）
+++# AntiHub
++ 
++ 目标：用本地 MetaGPT 仓库一键跑通 “创建 case -> 构建/运行 -> 实时日志 -> 查询状态”。
++ 
++-## 0. 项目概览 & 作用
+++## 0. 项目概览
++ - 作用：给任意代码仓库做一键容器化部署，实时回放 build/run 日志，并暴露 API/WS 便于集成上层智能体。
++ - 特点：env 安全（只存 key）、状态机可达 RUNNING/FAILED（含错误码）、WS 支持历史回放+实时推送、默认一键脚本 `dev.sh up`（端口 8010）。
++ - 适用场景：本地/WSL 上快速验证 Agent 生成代码，或将已有仓库打成可访问的容器实例。
++ 
++-### 核心流程（文字版）
+++### 核心流程
++ 1) `POST /cases`：记录 env_keys、排队构建。
++ 2) clone + Docker build（log: stream=build）。
++ 3) run 容器，探活成功后状态转 RUNNING（log: system/run）。
++@@ -40,7 +40,7 @@
++ 
++ ## 3. 一键启动（推荐）
++ ```bash
++-./dev.sh up
+++bash ./dev.sh up
++ # 停止：./dev.sh down
++ # 日志：.devlogs/api.log 与 .devlogs/worker.log
++ ```
++@@ -106,7 +106,7 @@
++ - 端口映射：查看 `GET /cases/{id}` 返回的 `host_port`，浏览器访问 `http://localhost:{host_port}`
++ - 容器日志：`docker logs <container_id>`（从接口返回的 runtime.container_id 获取）
++ 
++-## 10. 冒烟测试（curl 串行）
+++## 10. 测试（curl 串行）
++ ```bash
++ ./dev.sh up
++ export OPENAI_API_KEY=sk-xxx
++--- config.py
+++++ config.py
++@@ -13,6 +13,15 @@
++ LOG_LIST_PREFIX = os.getenv("LOG_LIST_PREFIX", "logs:")
++ WS_LOG_CHANNEL_PREFIX = os.getenv("WS_LOG_CHANNEL_PREFIX", "build_logs:")
++ CASE_PREFIX = os.getenv("CASE_PREFIX", "case:")
+++
+++CORS_ORIGINS = [
+++    origin.strip()
+++    for origin in os.getenv(
+++        "CORS_ORIGINS",
+++        "http://127.0.0.1:5173,http://localhost:5173",
+++    ).split(",")
+++    if origin.strip()
+++]
++ 
++ GIT_CLONE_TIMEOUT_SECONDS = int(os.getenv("GIT_CLONE_TIMEOUT_SECONDS", "120"))
++ DOCKER_BUILD_TIMEOUT_SECONDS = int(os.getenv("DOCKER_BUILD_TIMEOUT_SECONDS", "1800"))
++--- main.py
+++++ main.py
++@@ -1,26 +1,64 @@
++ from __future__ import annotations
++ 
+++import time
++ import uuid
++ from typing import Any, Dict, List, Optional
++ 
++ from fastapi import FastAPI, HTTPException, WebSocket, WebSocketDisconnect
+++from fastapi.middleware.cors import CORSMiddleware
++ from pydantic import BaseModel, ConfigDict, Field
++ 
++-from config import DEFAULT_BRANCH
+++from config import CORS_ORIGINS, DEFAULT_BRANCH
++ from storage import decode_log_entry, get_async_redis_client, get_case, get_logs, log_channel, set_case
++ from worker import analyze_case, build_and_run
++ 
++ app = FastAPI(title="Agent Platform", version="0.2.0")
++-
++-
++-class CreateCaseRequest(BaseModel):
++-    repo_url: str = Field(..., alias="git_url", description="Git repository URL")
++-    branch: str = Field(DEFAULT_BRANCH, alias="ref", description="Git branch")
+++app.add_middleware(
+++    CORSMiddleware,
+++    allow_origins=CORS_ORIGINS,
+++    allow_credentials=True,
+++    allow_methods=["*"],
+++    allow_headers=["*"],
+++)
+++
+++STAGE_VALUES = {"clone", "build", "run", "analyze", "system"}
+++STATUS_STAGE_MAP = {
+++    "PENDING": "system",
+++    "CLONING": "clone",
+++    "BUILDING": "build",
+++    "STARTING": "run",
+++    "RUNNING": "run",
+++    "FINISHED": "run",
+++    "FAILED": "system",
+++    "ANALYZING": "analyze",
+++}
+++
+++
+++class CaseCreateRequest(BaseModel):
+++    git_url: Optional[str] = Field(
+++        None,
+++        description="Git repository URL (alias for repo_url).",
+++    )
+++    repo_url: Optional[str] = Field(
+++        None,
+++        description="Git repository URL.",
+++    )
+++    ref: Optional[str] = Field(
+++        None,
+++        description="Git ref (alias for branch).",
+++    )
+++    branch: Optional[str] = Field(
+++        None,
+++        description="Git branch (alias for ref).",
+++    )
++     container_port: Optional[int] = Field(None, description="Container port override")
++-    env: Dict[str, str] = Field(default_factory=dict, description="Environment variables")
++-    auto_analyze: bool = Field(True, description="Trigger analysis after deploy")
+++    env: Dict[str, str] = Field(
+++        default_factory=dict,
+++        description="Environment variables (values are not stored).",
+++    )
+++    auto_analyze: bool = Field(False, description="Trigger analysis after deploy")
++ 
++-    model_config = ConfigDict(populate_by_name=True)
+++    model_config = ConfigDict(extra="ignore")
++ 
++ 
++ class RuntimeInfo(BaseModel):
++@@ -35,21 +73,86 @@
++ class CaseResponse(BaseModel):
++     case_id: str
++     status: str
++-    repo_url: str
++-    branch: str
+++    stage: str
+++    commit_sha: Optional[str] = None
+++    runtime: RuntimeInfo = Field(default_factory=RuntimeInfo)
+++    env_keys: List[str] = Field(default_factory=list)
+++    error_code: Optional[str] = None
+++    error_message: Optional[str] = None
+++    created_at: Optional[float] = None
+++    updated_at: Optional[float] = None
+++    repo_url: Optional[str] = None
+++    ref: Optional[str] = None
+++    branch: Optional[str] = None
++     container_port: Optional[int] = None
++     container_id: Optional[str] = None
++     host_port: Optional[int] = None
++     access_url: Optional[str] = None
++     image_tag: Optional[str] = None
++-    error_code: Optional[str] = None
++-    error_message: Optional[str] = None
++     last_log_at: Optional[float] = None
++-    env_keys: List[str] = Field(default_factory=list)
++-    commit_sha: Optional[str] = None
++-    stage: Optional[str] = None
++     report_ready: bool = False
++-    runtime: Optional[RuntimeInfo] = None
+++
+++
+++def normalize_stage(raw_stage: Optional[str], status: Optional[str]) -> str:
+++    if raw_stage:
+++        normalized = raw_stage.lower()
+++        if normalized in STAGE_VALUES:
+++            return normalized
+++    if status:
+++        return STATUS_STAGE_MAP.get(status.upper(), "system")
+++    return "system"
+++
+++
+++def build_case_response(case_id: str, data: Dict[str, Any]) -> CaseResponse:
+++    status = (data.get("status") or "PENDING").upper()
+++    stage = normalize_stage(data.get("stage"), status)
+++    runtime_data = data.get("runtime") or {}
+++    if not isinstance(runtime_data, dict):
+++        runtime_data = {}
+++    runtime = RuntimeInfo(**runtime_data)
+++    container_id = data.get("container_id") or runtime.container_id
+++    host_port = data.get("host_port") or runtime.host_port
+++    access_url = data.get("access_url") or runtime.access_url
+++    runtime = RuntimeInfo(
+++        container_id=container_id,
+++        host_port=host_port,
+++        access_url=access_url,
+++        started_at=runtime.started_at,
+++        exited_at=runtime.exited_at,
+++        exit_code=runtime.exit_code,
+++    )
+++    env_keys = sorted(data.get("env_keys") or [])
+++    error_code = data.get("error_code")
+++    error_message = data.get("error_message")
+++    if status == "FAILED":
+++        if not error_code:
+++            error_code = "UNEXPECTED_ERROR"
+++        if not error_message:
+++            error_message = "Unknown failure"
+++    ref_value = data.get("ref") or data.get("branch")
+++    branch_value = data.get("branch") or ref_value
+++    return CaseResponse(
+++        case_id=case_id,
+++        status=status,
+++        stage=stage,
+++        commit_sha=data.get("commit_sha"),
+++        runtime=runtime,
+++        env_keys=env_keys,
+++        error_code=error_code,
+++        error_message=error_message,
+++        created_at=data.get("created_at"),
+++        updated_at=data.get("updated_at"),
+++        repo_url=data.get("repo_url"),
+++        ref=ref_value,
+++        branch=branch_value,
+++        container_port=data.get("container_port"),
+++        container_id=container_id,
+++        host_port=host_port,
+++        access_url=access_url,
+++        image_tag=data.get("image_tag"),
+++        last_log_at=data.get("last_log_at"),
+++        report_ready=bool(data.get("report_ready", False)),
+++    )
++ 
++ 
++ @app.get("/healthz")
++@@ -58,22 +161,45 @@
++ 
++ 
++ @app.post("/cases", response_model=CaseResponse)
++-async def create_case(payload: CreateCaseRequest) -> CaseResponse:
+++async def create_case(payload: CaseCreateRequest) -> CaseResponse:
+++    repo_url = payload.repo_url or payload.git_url
+++    if not repo_url:
+++        raise HTTPException(status_code=422, detail="git_url or repo_url is required")
+++    ref = payload.ref or payload.branch or DEFAULT_BRANCH
++     case_id = f"c_{uuid.uuid4().hex[:6]}"
+++    now = time.time()
++     env_keys = sorted(list((payload.env or {}).keys()))
++     data: Dict[str, Any] = {
++         "case_id": case_id,
++         "status": "PENDING",
++-        "stage": "PENDING",
++-        "repo_url": payload.repo_url,
++-        "branch": payload.branch,
+++        "stage": "system",
+++        "repo_url": repo_url,
+++        "ref": ref,
+++        "branch": ref,
++         "container_port": payload.container_port,
++         "env_keys": env_keys,
++         "report_ready": False,
+++        "created_at": now,
+++        "updated_at": now,
+++        "runtime": {
+++            "container_id": None,
+++            "host_port": None,
+++            "access_url": None,
+++            "started_at": None,
+++            "exited_at": None,
+++            "exit_code": None,
+++        },
++     }
++     set_case(case_id, data)
++-    build_and_run.delay(case_id, payload.repo_url, payload.branch, payload.container_port, payload.env, payload.auto_analyze)
++-    return CaseResponse(**data)
+++    build_and_run.delay(
+++        case_id,
+++        repo_url,
+++        ref,
+++        payload.container_port,
+++        payload.env,
+++        payload.auto_analyze,
+++    )
+++    return build_case_response(case_id, data)
++ 
++ 
++ @app.get("/cases/{case_id}", response_model=CaseResponse)
++@@ -82,7 +208,7 @@
++     if not data:
++         raise HTTPException(status_code=404, detail="Case not found")
++     data.pop("case_id", None)
++-    return CaseResponse(case_id=case_id, **data)
+++    return build_case_response(case_id, data)
++ 
++ 
++ @app.post("/cases/{case_id}/analyze")
++--- requirements.txt
+++++ requirements.txt
++@@ -1,6 +1,7 @@
++-fastapi==0.112.0
++-uvicorn==0.30.5
++-celery==5.4.0
++-redis==5.0.8
++-docker==7.1.0
++-pydantic==2.8.2
++\ No newline at end of file
+++fastapi==0.112.0
+++uvicorn==0.30.5
+++celery==5.4.0
+++redis==5.0.8
+++docker==7.1.0
+++pydantic==2.8.2
+++websockets==12.0
++--- storage.py
+++++ storage.py
++@@ -25,6 +25,8 @@
++ def update_case(case_id: str, data: Dict[str, Any]) -> None:
++     if not data:
++         return
+++    data = dict(data)
+++    data["updated_at"] = time.time()
++     client = get_redis_client()
++     client.hset(f"{CASE_PREFIX}{case_id}", mapping=_encode_data(data))
++ 
++--- worker.py
+++++ worker.py
++@@ -123,7 +123,7 @@
++                 case_id,
++                 {
++                     "status": "FINISHED",
++-                    "stage": "FINISHED",
+++                    "stage": "run",
++                     "runtime": {
++                         **runtime,
++                         "exited_at": finished_at,
++@@ -137,7 +137,7 @@
++                 case_id,
++                 {
++                     "status": "FAILED",
++-                    "stage": "FAILED",
+++                    "stage": "run",
++                     "error_code": "CONTAINER_EXIT_NONZERO",
++                     "error_message": f"Container exited with code {exit_code}",
++                     "runtime": {
++@@ -159,19 +159,19 @@
++ def build_and_run(
++     case_id: str,
++     repo_url: str,
++-    branch: Optional[str] = None,
+++    ref: Optional[str] = None,
++     container_port: Optional[int] = None,
++     env: Optional[Dict[str, str]] = None,
++-    auto_analyze: bool = True,
+++    auto_analyze: bool = False,
++ ) -> dict:
++-    branch = branch or DEFAULT_BRANCH
+++    ref = ref or DEFAULT_BRANCH
++     env = env or {}
++-    update_case(case_id, {"status": "CLONING", "stage": "CLONING"})
+++    update_case(case_id, {"status": "CLONING", "stage": "clone"})
++     target_dir = Path(BUILD_ROOT) / case_id
++     host_port: Optional[int] = None
++     try:
++-        publish_log(case_id, "system", f"Cloning repo {repo_url} (branch {branch})...")
++-        clone_repo(repo_url, branch, target_dir)
+++        publish_log(case_id, "system", f"Cloning repo {repo_url} (ref {ref})...")
+++        clone_repo(repo_url, ref, target_dir)
++         publish_log(case_id, "system", "Clone completed")
++         try:
++             commit_sha = (
++@@ -192,7 +192,7 @@
++             case_id,
++             {
++                 "status": "BUILDING",
++-                "stage": "BUILDING",
+++                "stage": "build",
++                 "container_port": resolved_port,
++                 "env_keys": sorted(env.keys()),
++             },
++@@ -205,7 +205,7 @@
++         for event in build_image(client, target_dir, tag):
++             log_event(case_id, event)
++ 
++-        update_case(case_id, {"status": "STARTING", "stage": "STARTING"})
+++        update_case(case_id, {"status": "STARTING", "stage": "run"})
++ 
++         if PORT_MODE == "dynamic":
++             container_id, host_port = run_container_dynamic(client, tag, resolved_port, env)
++@@ -219,7 +219,7 @@
++             case_id,
++             {
++                 "status": "RUNNING",
++-                "stage": "RUNNING",
+++                "stage": "run",
++                 "container_id": container_id,
++                 "host_port": host_port,
++                 "access_url": access_url,
++@@ -239,11 +239,13 @@
++         return {"container_id": container_id, "host_port": host_port}
++     except Exception as exc:  # noqa: BLE001
++         error_code, error_message = classify_error(exc)
+++        existing = get_case(case_id) or {}
+++        stage = existing.get("stage") or "system"
++         update_case(
++             case_id,
++             {
++                 "status": "FAILED",
++-                "stage": "FAILED",
+++                "stage": stage,
++                 "error_code": error_code,
++                 "error_message": error_message,
++             },
++@@ -263,4 +265,8 @@
++ 
++ @celery_app.task(name="analyze_case")
++ def analyze_case(case_id: str) -> None:
+++    existing = get_case(case_id) or {}
+++    status = existing.get("status") or "RUNNING"
+++    if status not in {"FAILED", "FINISHED"}:
+++        update_case(case_id, {"status": status, "stage": "analyze"})
++     publish_log(case_id, "analyze", "ANALYZE_QUEUED (stub)")
++--- second.md
+++++ second.md
++@@ -0,0 +1,149 @@
+++# Phase 2 前端交互与后端对齐验收报告
+++
+++## 1. 概述 / 范围 / 结论
+++- 验收范围：创建 case -> build/run -> WS 实时日志 -> 状态与运行信息 -> ENV 注入安全，新增前端控制台与后端接口契约对齐。
+++- 结论：PASS（前后端对齐完成，WS 回放+订阅稳定，接口契约与 OpenAPI 同步；端口池冲突属于已知问题，详见第 6 节）。
+++
+++## 2. 启动与基线确认
+++- 启动：`./dev.sh up`
+++- /docs：`http://127.0.0.1:8010/docs` -> 200
+++- /openapi.json：字段已更新（见第 3 节摘要）
+++- Phase1 基线：完成创建 case、WS 日志回放、状态查询（示例：`c_536b9e`）
+++
+++## 3. 接口契约（以 OpenAPI 为准）
+++
+++### 3.1 CaseCreateRequest
+++- 字段：`git_url | repo_url`（二选一）、`ref | branch`（二选一）、`env`、`auto_analyze`、`container_port`
+++- 说明：
+++  - `git_url` / `repo_url` 兼容输入；内部统一为 `repo_url`
+++  - `ref` / `branch` 兼容输入；内部统一为 `ref`
+++  - `auto_analyze` 默认 `false`
+++  - `env` 仅用于容器注入，不持久化 value（只保留 `env_keys`）
+++
+++### 3.2 CaseResponse / CaseStatusResponse
+++- 必备字段：`case_id`, `status`, `stage`, `commit_sha`, `runtime`, `env_keys`, `error_code`, `error_message`, `created_at`, `updated_at`
+++- 运行信息：`runtime = { container_id?, host_port?, access_url? }`（含 started/exited/exit_code）
+++- 兼容字段：`repo_url`, `ref`, `branch`, `container_port`, `container_id`, `host_port`, `access_url`, `image_tag`, `last_log_at`
+++
+++### 3.3 状态/阶段定义
+++- `status`：`PENDING/CLONING/BUILDING/STARTING/RUNNING/FAILED/FINISHED`（保持现有实现）
+++- `stage`：`clone/build/run/analyze/system`（已统一为小写）
+++
+++### 3.4 WS 日志格式
+++- JSON 行：`{"ts":<epoch_seconds>,"stream":"build|run|analyze|system","level":"INFO|ERROR","line":"..."}`
+++- 机制：WS 连接后先回放 Redis List，再订阅 Redis Pub/Sub
+++
+++### 3.5 跨域与依赖
+++- CORS：允许 `http://127.0.0.1:5173` / `http://localhost:5173`
+++- 依赖：`websockets` 已加入 `requirements.txt`
+++
+++## 4. 前端功能清单（frontend/）
+++- Create Case 页面
+++  - 表单：`repo_url`、`ref`、`env`（可增删行）、`auto_analyze`
+++  - 提交后展示 `case_id` 并跳转到 `/cases/:id`
+++- Case Detail 页面
+++  - 状态 Badge + stage + 更新时间
+++  - Runtime 卡片：`access_url`（点击/复制）、`host_port`、`container_id`
+++  - Env Keys 卡片：仅显示 key
+++  - 错误卡片：`FAILED` 时显示 `error_code`、`error_message` + 可解释文案
+++  - 日志面板：WS 回放+实时、自动滚动/暂停、按 stream 过滤、断线提示与一键重连
+++  - 底部状态刷新按钮 + 轮询（2s，RUNNING/FAILED 后降频 5s）
+++- 安全：不写入 localStorage，不打印 env value，不在页面显示明文值
+++- 构建验证：`npm run build` 通过
+++
+++## 5. 联调用例证据（2 个）
+++
+++### 用例 1：轻量仓 hello-world（RUNNING）
+++- 创建请求（env value 已打码）：
+++```json
+++{
+++  "repo_url": "/home/user2643/code/AntiHub/test-repos/hello-world",
+++  "ref": "master",
+++  "env": {"FOO": "***"},
+++  "auto_analyze": false
+++}
+++```
+++- 创建响应：`case_id = c_db5ef1`（秒回）
+++- WS 日志（摘录）：`.devlogs/phase2_case1_ws.jsonl`
+++```json
+++{"ts":1768981005.8472288,"stream":"system","level":"INFO","line":"Cloning repo /home/user2643/code/AntiHub/test-repos/hello-world (ref master)..."}
+++{"ts":1768981006.0443277,"stream":"build","level":"INFO","line":"Step 1/5 : FROM nikolaik/python-nodejs:python3.9-nodejs20-slim"}
+++```
+++- 状态响应（摘录）：`.devlogs/phase2_case1_status.json`
+++```json
+++{"case_id":"c_db5ef1","status":"RUNNING","stage":"run","runtime":{"host_port":30000,"access_url":"http://localhost:30000"},"env_keys":["FOO"],"error_code":null}
+++```
+++- 访问验证：`curl http://localhost:30000/` -> `HTTP/1.0 200 OK`
+++- 前端页面行为：
+++  - 状态卡：RUNNING / stage=run / 更新时间显示
+++  - Runtime 卡：access_url 可点击与复制
+++  - Env Keys：展示 `FOO`
+++  - 日志面板：build/system 实时日志可见、支持过滤与暂停
+++- 结论：PASS
+++
+++### 用例 2：MetaGPT 场景仓（RUNNING）
+++- 创建请求（env value 已打码）：
+++```json
+++{
+++  "repo_url": "/home/user2643/code/AntiHub/test-repos/metagpt-min",
+++  "ref": "master",
+++  "env": {"OPENAI_API_KEY": "sk-****"},
+++  "auto_analyze": false
+++}
+++```
+++- 创建响应：`case_id = c_c6547a`（秒回）
+++- WS 日志（摘录）：`.devlogs/phase2_case2_ws.jsonl`
+++```json
+++{"ts":1768981050.0024369,"stream":"system","level":"INFO","line":"Cloning repo /home/user2643/code/AntiHub/test-repos/metagpt-min (ref master)..."}
+++{"ts":1768981050.195938,"stream":"build","level":"INFO","line":"Step 1/5 : FROM nikolaik/python-nodejs:python3.9-nodejs20-slim"}
+++```
+++- 状态响应（摘录）：`.devlogs/phase2_case2_status.json`
+++```json
+++{"case_id":"c_c6547a","status":"RUNNING","stage":"run","runtime":{"host_port":30000,"access_url":"http://localhost:30000"},"env_keys":["OPENAI_API_KEY"],"error_code":null}
+++```
+++- 访问验证：`curl http://localhost:30000/` -> `HTTP/1.0 200 OK`
+++- 前端页面行为：
+++  - 状态卡：RUNNING / stage=run
+++  - Env Keys：展示 `OPENAI_API_KEY`
+++  - 日志面板：build/system 可见，支持过滤与暂停
+++- 结论：PASS
+++
+++## 6. 发现问题与修复记录（含 patch）
+++1) WebSocket 依赖缺失
+++- 修复：`requirements.txt` 加入 `websockets==12.0`
+++
+++2) 接口契约对齐
+++- 修复：新增 `CaseCreateRequest`/`CaseResponse` 字段与默认值，补齐 `runtime`、`env_keys`、`error_code`、`created_at/updated_at`，统一 `stage` 枚举；OpenAPI 同步更新
+++
+++3) CORS/前端联调
+++- 修复：后端允许 `http://127.0.0.1:5173` / `http://localhost:5173`
+++
+++4) 前端控制台
+++- 修复：新增 `frontend/`（Vite + React + TS），支持创建、详情、WS 日志与可视化状态
+++
+++5) 端口池冲突（已知问题）
+++- 现象：若已有容器占用 30000，新的 case 会在启动阶段报错 `port is already allocated`
+++- 本次处理：停用旧容器释放端口后重试（对业务逻辑无侵入）
+++
+++Patch：`phase2.patch`
+++- 应用方式（项目根目录）：`patch -p0 < phase2.patch`
+++
+++## 7. 启动说明
+++- 后端：`./dev.sh up`
+++- 前端：`cd frontend && npm i && npm run dev`
+++- 并发启动（可选）：开两终端分别执行上述两条命令
+++## 7.1 前端操作教程（快速上手）
+++1) 启动前端：`cd frontend && npm i && npm run dev`，浏览器打开 `http://127.0.0.1:5173`  
+++2) 创建案例：在“创建案例”页填写 `repo_url`、可选 `ref`，按需添加 env（只填 key 或打码 value），点击“创建案例”  
+++3) 查看详情：提交后自动跳转到 `/cases/:id`，顶部显示状态与阶段  
+++4) 运行信息：可点击访问 `access_url`，点击“复制”复制地址  
+++5) 日志面板：支持按 `构建/运行/分析/系统` 过滤，支持“暂停滚动 / 自动滚动”切换  
+++6) 断线处理：若 WS 断开，面板提示“已断开”，点击“重连”恢复  
+++7) 状态刷新：点击“刷新状态”立即拉取；系统也会自动轮询
+++
+++## 8. 下一步（Phase 3）建议
+++1) Case 列表/检索与生命周期管理（停止/重启/清理）
+++2) 项目维度视图（按 repo/branch 统计与对比）
+++3) 环境变量与凭据管理（仅 key 可见，支持模板与复用）
+++4) 运行观测（资源用量、容器健康、失败聚类）
+++5) 多租户/权限控制与审计日志
++\ No newline at end of file
++--- frontend/index.html
+++++ frontend/index.html
++@@ -0,0 +1,12 @@
+++<!doctype html>
+++<html lang="zh-CN">
+++  <head>
+++    <meta charset="UTF-8" />
+++    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
+++    <title>AntiHub 控制台</title>
+++  </head>
+++  <body>
+++    <div id="root"></div>
+++    <script type="module" src="/src/main.tsx"></script>
+++  </body>
+++</html>
++--- frontend/package.json
+++++ frontend/package.json
++@@ -0,0 +1,22 @@
+++{
+++  "name": "antihub-console",
+++  "private": true,
+++  "version": "0.0.0",
+++  "type": "module",
+++  "scripts": {
+++    "dev": "vite",
+++    "build": "vite build",
+++    "preview": "vite preview"
+++  },
+++  "dependencies": {
+++    "react": "^18.3.1",
+++    "react-dom": "^18.3.1"
+++  },
+++  "devDependencies": {
+++    "@types/react": "^18.3.3",
+++    "@types/react-dom": "^18.3.0",
+++    "@vitejs/plugin-react": "^4.3.1",
+++    "typescript": "^5.5.4",
+++    "vite": "^5.4.2"
+++  }
+++}
++--- frontend/package-lock.json
+++++ frontend/package-lock.json
++@@ -0,0 +1,1726 @@
+++{
+++  "name": "antihub-console",
+++  "version": "0.0.0",
+++  "lockfileVersion": 3,
+++  "requires": true,
+++  "packages": {
+++    "": {
+++      "name": "antihub-console",
+++      "version": "0.0.0",
+++      "dependencies": {
+++        "react": "^18.3.1",
+++        "react-dom": "^18.3.1"
+++      },
+++      "devDependencies": {
+++        "@types/react": "^18.3.3",
+++        "@types/react-dom": "^18.3.0",
+++        "@vitejs/plugin-react": "^4.3.1",
+++        "typescript": "^5.5.4",
+++        "vite": "^5.4.2"
+++      }
+++    },
+++    "node_modules/@babel/code-frame": {
+++      "version": "7.28.6",
+++      "resolved": "https://registry.npmjs.org/@babel/code-frame/-/code-frame-7.28.6.tgz",
+++      "integrity": "sha512-JYgintcMjRiCvS8mMECzaEn+m3PfoQiyqukOMCCVQtoJGYJw8j/8LBJEiqkHLkfwCcs74E3pbAUFNg7d9VNJ+Q==",
+++      "dev": true,
+++      "license": "MIT",
+++      "dependencies": {
+++        "@babel/helper-validator-identifier": "^7.28.5",
+++        "js-tokens": "^4.0.0",
+++        "picocolors": "^1.1.1"
+++      },
+++      "engines": {
+++        "node": ">=6.9.0"
+++      }
+++    },
+++    "node_modules/@babel/compat-data": {
+++      "version": "7.28.6",
+++      "resolved": "https://registry.npmjs.org/@babel/compat-data/-/compat-data-7.28.6.tgz",
+++      "integrity": "sha512-2lfu57JtzctfIrcGMz992hyLlByuzgIk58+hhGCxjKZ3rWI82NnVLjXcaTqkI2NvlcvOskZaiZ5kjUALo3Lpxg==",
+++      "dev": true,
+++      "license": "MIT",
+++      "engines": {
+++        "node": ">=6.9.0"
+++      }
+++    },
+++    "node_modules/@babel/core": {
+++      "version": "7.28.6",
+++      "resolved": "https://registry.npmjs.org/@babel/core/-/core-7.28.6.tgz",
+++      "integrity": "sha512-H3mcG6ZDLTlYfaSNi0iOKkigqMFvkTKlGUYlD8GW7nNOYRrevuA46iTypPyv+06V3fEmvvazfntkBU34L0azAw==",
+++      "dev": true,
+++      "license": "MIT",
+++      "dependencies": {
+++        "@babel/code-frame": "^7.28.6",
+++        "@babel/generator": "^7.28.6",
+++        "@babel/helper-compilation-targets": "^7.28.6",
+++        "@babel/helper-module-transforms": "^7.28.6",
+++        "@babel/helpers": "^7.28.6",
+++        "@babel/parser": "^7.28.6",
+++        "@babel/template": "^7.28.6",
+++        "@babel/traverse": "^7.28.6",
+++        "@babel/types": "^7.28.6",
+++        "@jridgewell/remapping": "^2.3.5",
+++        "convert-source-map": "^2.0.0",
+++        "debug": "^4.1.0",
+++        "gensync": "^1.0.0-beta.2",
+++        "json5": "^2.2.3",
+++        "semver": "^6.3.1"
+++      },
+++      "engines": {
+++        "node": ">=6.9.0"
+++      },
+++      "funding": {
+++        "type": "opencollective",
+++        "url": "https://opencollective.com/babel"
+++      }
+++    },
+++    "node_modules/@babel/generator": {
+++      "version": "7.28.6",
+++      "resolved": "https://registry.npmjs.org/@babel/generator/-/generator-7.28.6.tgz",
+++      "integrity": "sha512-lOoVRwADj8hjf7al89tvQ2a1lf53Z+7tiXMgpZJL3maQPDxh0DgLMN62B2MKUOFcoodBHLMbDM6WAbKgNy5Suw==",
+++      "dev": true,
+++      "license": "MIT",
+++      "dependencies": {
+++        "@babel/parser": "^7.28.6",
+++        "@babel/types": "^7.28.6",
+++        "@jridgewell/gen-mapping": "^0.3.12",
+++        "@jridgewell/trace-mapping": "^0.3.28",
+++        "jsesc": "^3.0.2"
+++      },
+++      "engines": {
+++        "node": ">=6.9.0"
+++      }
+++    },
+++    "node_modules/@babel/helper-compilation-targets": {
+++      "version": "7.28.6",
+++      "resolved": "https://registry.npmjs.org/@babel/helper-compilation-targets/-/helper-compilation-targets-7.28.6.tgz",
+++      "integrity": "sha512-JYtls3hqi15fcx5GaSNL7SCTJ2MNmjrkHXg4FSpOA/grxK8KwyZ5bubHsCq8FXCkua6xhuaaBit+3b7+VZRfcA==",
+++      "dev": true,
+++      "license": "MIT",
+++      "dependencies": {
+++        "@babel/compat-data": "^7.28.6",
+++        "@babel/helper-validator-option": "^7.27.1",
+++        "browserslist": "^4.24.0",
+++        "lru-cache": "^5.1.1",
+++        "semver": "^6.3.1"
+++      },
+++      "engines": {
+++        "node": ">=6.9.0"
+++      }
+++    },
+++    "node_modules/@babel/helper-globals": {
+++      "version": "7.28.0",
+++      "resolved": "https://registry.npmjs.org/@babel/helper-globals/-/helper-globals-7.28.0.tgz",
+++      "integrity": "sha512-+W6cISkXFa1jXsDEdYA8HeevQT/FULhxzR99pxphltZcVaugps53THCeiWA8SguxxpSp3gKPiuYfSWopkLQ4hw==",
+++      "dev": true,
+++      "license": "MIT",
+++      "engines": {
+++        "node": ">=6.9.0"
+++      }
+++    },
+++    "node_modules/@babel/helper-module-imports": {
+++      "version": "7.28.6",
+++      "resolved": "https://registry.npmjs.org/@babel/helper-module-imports/-/helper-module-imports-7.28.6.tgz",
+++      "integrity": "sha512-l5XkZK7r7wa9LucGw9LwZyyCUscb4x37JWTPz7swwFE/0FMQAGpiWUZn8u9DzkSBWEcK25jmvubfpw2dnAMdbw==",
+++      "dev": true,
+++      "license": "MIT",
+++      "dependencies": {
+++        "@babel/traverse": "^7.28.6",
+++        "@babel/types": "^7.28.6"
+++      },
+++      "engines": {
+++        "node": ">=6.9.0"
+++      }
+++    },
+++    "node_modules/@babel/helper-module-transforms": {
+++      "version": "7.28.6",
+++      "resolved": "https://registry.npmjs.org/@babel/helper-module-transforms/-/helper-module-transforms-7.28.6.tgz",
+++      "integrity": "sha512-67oXFAYr2cDLDVGLXTEABjdBJZ6drElUSI7WKp70NrpyISso3plG9SAGEF6y7zbha/wOzUByWWTJvEDVNIUGcA==",
+++      "dev": true,
+++      "license": "MIT",
+++      "dependencies": {
+++        "@babel/helper-module-imports": "^7.28.6",
+++        "@babel/helper-validator-identifier": "^7.28.5",
+++        "@babel/traverse": "^7.28.6"
+++      },
+++      "engines": {
+++        "node": ">=6.9.0"
+++      },
+++      "peerDependencies": {
+++        "@babel/core": "^7.0.0"
+++      }
+++    },
+++    "node_modules/@babel/helper-plugin-utils": {
+++      "version": "7.28.6",
+++      "resolved": "https://registry.npmjs.org/@babel/helper-plugin-utils/-/helper-plugin-utils-7.28.6.tgz",
+++      "integrity": "sha512-S9gzZ/bz83GRysI7gAD4wPT/AI3uCnY+9xn+Mx/KPs2JwHJIz1W8PZkg2cqyt3RNOBM8ejcXhV6y8Og7ly/Dug==",
+++      "dev": true,
+++      "license": "MIT",
+++      "engines": {
+++        "node": ">=6.9.0"
+++      }
+++    },
+++    "node_modules/@babel/helper-string-parser": {
+++      "version": "7.27.1",
+++      "resolved": "https://registry.npmjs.org/@babel/helper-string-parser/-/helper-string-parser-7.27.1.tgz",
+++      "integrity": "sha512-qMlSxKbpRlAridDExk92nSobyDdpPijUq2DW6oDnUqd0iOGxmQjyqhMIihI9+zv4LPyZdRje2cavWPbCbWm3eA==",
+++      "dev": true,
+++      "license": "MIT",
+++      "engines": {
+++        "node": ">=6.9.0"
+++      }
+++    },
+++    "node_modules/@babel/helper-validator-identifier": {
+++      "version": "7.28.5",
+++      "resolved": "https://registry.npmjs.org/@babel/helper-validator-identifier/-/helper-validator-identifier-7.28.5.tgz",
+++      "integrity": "sha512-qSs4ifwzKJSV39ucNjsvc6WVHs6b7S03sOh2OcHF9UHfVPqWWALUsNUVzhSBiItjRZoLHx7nIarVjqKVusUZ1Q==",
+++      "dev": true,
+++      "license": "MIT",
+++      "engines": {
+++        "node": ">=6.9.0"
+++      }
+++    },
+++    "node_modules/@babel/helper-validator-option": {
+++      "version": "7.27.1",
+++      "resolved": "https://registry.npmjs.org/@babel/helper-validator-option/-/helper-validator-option-7.27.1.tgz",
+++      "integrity": "sha512-YvjJow9FxbhFFKDSuFnVCe2WxXk1zWc22fFePVNEaWJEu8IrZVlda6N0uHwzZrUM1il7NC9Mlp4MaJYbYd9JSg==",
+++      "dev": true,
+++      "license": "MIT",
+++      "engines": {
+++        "node": ">=6.9.0"
+++      }
+++    },
+++    "node_modules/@babel/helpers": {
+++      "version": "7.28.6",
+++      "resolved": "https://registry.npmjs.org/@babel/helpers/-/helpers-7.28.6.tgz",
+++      "integrity": "sha512-xOBvwq86HHdB7WUDTfKfT/Vuxh7gElQ+Sfti2Cy6yIWNW05P8iUslOVcZ4/sKbE+/jQaukQAdz/gf3724kYdqw==",
+++      "dev": true,
+++      "license": "MIT",
+++      "dependencies": {
+++        "@babel/template": "^7.28.6",
+++        "@babel/types": "^7.28.6"
+++      },
+++      "engines": {
+++        "node": ">=6.9.0"
+++      }
+++    },
+++    "node_modules/@babel/parser": {
+++      "version": "7.28.6",
+++      "resolved": "https://registry.npmjs.org/@babel/parser/-/parser-7.28.6.tgz",
+++      "integrity": "sha512-TeR9zWR18BvbfPmGbLampPMW+uW1NZnJlRuuHso8i87QZNq2JRF9i6RgxRqtEq+wQGsS19NNTWr2duhnE49mfQ==",
+++      "dev": true,
+++      "license": "MIT",
+++      "dependencies": {
+++        "@babel/types": "^7.28.6"
+++      },
+++      "bin": {
+++        "parser": "bin/babel-parser.js"
+++      },
+++      "engines": {
+++        "node": ">=6.0.0"
+++      }
+++    },
+++    "node_modules/@babel/plugin-transform-react-jsx-self": {
+++      "version": "7.27.1",
+++      "resolved": "https://registry.npmjs.org/@babel/plugin-transform-react-jsx-self/-/plugin-transform-react-jsx-self-7.27.1.tgz",
+++      "integrity": "sha512-6UzkCs+ejGdZ5mFFC/OCUrv028ab2fp1znZmCZjAOBKiBK2jXD1O+BPSfX8X2qjJ75fZBMSnQn3Rq2mrBJK2mw==",
+++      "dev": true,
+++      "license": "MIT",
+++      "dependencies": {
+++        "@babel/helper-plugin-utils": "^7.27.1"
+++      },
+++      "engines": {
+++        "node": ">=6.9.0"
+++      },
+++      "peerDependencies": {
+++        "@babel/core": "^7.0.0-0"
+++      }
+++    },
+++    "node_modules/@babel/plugin-transform-react-jsx-source": {
+++      "version": "7.27.1",
+++      "resolved": "https://registry.npmjs.org/@babel/plugin-transform-react-jsx-source/-/plugin-transform-react-jsx-source-7.27.1.tgz",
+++      "integrity": "sha512-zbwoTsBruTeKB9hSq73ha66iFeJHuaFkUbwvqElnygoNbj/jHRsSeokowZFN3CZ64IvEqcmmkVe89OPXc7ldAw==",
+++      "dev": true,
+++      "license": "MIT",
+++      "dependencies": {
+++        "@babel/helper-plugin-utils": "^7.27.1"
+++      },
+++      "engines": {
+++        "node": ">=6.9.0"
+++      },
+++      "peerDependencies": {
+++        "@babel/core": "^7.0.0-0"
+++      }
+++    },
+++    "node_modules/@babel/template": {
+++      "version": "7.28.6",
+++      "resolved": "https://registry.npmjs.org/@babel/template/-/template-7.28.6.tgz",
+++      "integrity": "sha512-YA6Ma2KsCdGb+WC6UpBVFJGXL58MDA6oyONbjyF/+5sBgxY/dwkhLogbMT2GXXyU84/IhRw/2D1Os1B/giz+BQ==",
+++      "dev": true,
+++      "license": "MIT",
+++      "dependencies": {
+++        "@babel/code-frame": "^7.28.6",
+++        "@babel/parser": "^7.28.6",
+++        "@babel/types": "^7.28.6"
+++      },
+++      "engines": {
+++        "node": ">=6.9.0"
+++      }
+++    },
+++    "node_modules/@babel/traverse": {
+++      "version": "7.28.6",
+++      "resolved": "https://registry.npmjs.org/@babel/traverse/-/traverse-7.28.6.tgz",
+++      "integrity": "sha512-fgWX62k02qtjqdSNTAGxmKYY/7FSL9WAS1o2Hu5+I5m9T0yxZzr4cnrfXQ/MX0rIifthCSs6FKTlzYbJcPtMNg==",
+++      "dev": true,
+++      "license": "MIT",
+++      "dependencies": {
+++        "@babel/code-frame": "^7.28.6",
+++        "@babel/generator": "^7.28.6",
+++        "@babel/helper-globals": "^7.28.0",
+++        "@babel/parser": "^7.28.6",
+++        "@babel/template": "^7.28.6",
+++        "@babel/types": "^7.28.6",
+++        "debug": "^4.3.1"
+++      },
+++      "engines": {
+++        "node": ">=6.9.0"
+++      }
+++    },
+++    "node_modules/@babel/types": {
+++      "version": "7.28.6",
+++      "resolved": "https://registry.npmjs.org/@babel/types/-/types-7.28.6.tgz",
+++      "integrity": "sha512-0ZrskXVEHSWIqZM/sQZ4EV3jZJXRkio/WCxaqKZP1g//CEWEPSfeZFcms4XeKBCHU0ZKnIkdJeU/kF+eRp5lBg==",
+++      "dev": true,
+++      "license": "MIT",
+++      "dependencies": {
+++        "@babel/helper-string-parser": "^7.27.1",
+++        "@babel/helper-validator-identifier": "^7.28.5"
+++      },
+++      "engines": {
+++        "node": ">=6.9.0"
+++      }
+++    },
+++    "node_modules/@esbuild/aix-ppc64": {
+++      "version": "0.21.5",
+++      "resolved": "https://registry.npmjs.org/@esbuild/aix-ppc64/-/aix-ppc64-0.21.5.tgz",
+++      "integrity": "sha512-1SDgH6ZSPTlggy1yI6+Dbkiz8xzpHJEVAlF/AM1tHPLsf5STom9rwtjE4hKAF20FfXXNTFqEYXyJNWh1GiZedQ==",
+++      "cpu": [
+++        "ppc64"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "aix"
+++      ],
+++      "engines": {
+++        "node": ">=12"
+++      }
+++    },
+++    "node_modules/@esbuild/android-arm": {
+++      "version": "0.21.5",
+++      "resolved": "https://registry.npmjs.org/@esbuild/android-arm/-/android-arm-0.21.5.tgz",
+++      "integrity": "sha512-vCPvzSjpPHEi1siZdlvAlsPxXl7WbOVUBBAowWug4rJHb68Ox8KualB+1ocNvT5fjv6wpkX6o/iEpbDrf68zcg==",
+++      "cpu": [
+++        "arm"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "android"
+++      ],
+++      "engines": {
+++        "node": ">=12"
+++      }
+++    },
+++    "node_modules/@esbuild/android-arm64": {
+++      "version": "0.21.5",
+++      "resolved": "https://registry.npmjs.org/@esbuild/android-arm64/-/android-arm64-0.21.5.tgz",
+++      "integrity": "sha512-c0uX9VAUBQ7dTDCjq+wdyGLowMdtR/GoC2U5IYk/7D1H1JYC0qseD7+11iMP2mRLN9RcCMRcjC4YMclCzGwS/A==",
+++      "cpu": [
+++        "arm64"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "android"
+++      ],
+++      "engines": {
+++        "node": ">=12"
+++      }
+++    },
+++    "node_modules/@esbuild/android-x64": {
+++      "version": "0.21.5",
+++      "resolved": "https://registry.npmjs.org/@esbuild/android-x64/-/android-x64-0.21.5.tgz",
+++      "integrity": "sha512-D7aPRUUNHRBwHxzxRvp856rjUHRFW1SdQATKXH2hqA0kAZb1hKmi02OpYRacl0TxIGz/ZmXWlbZgjwWYaCakTA==",
+++      "cpu": [
+++        "x64"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "android"
+++      ],
+++      "engines": {
+++        "node": ">=12"
+++      }
+++    },
+++    "node_modules/@esbuild/darwin-arm64": {
+++      "version": "0.21.5",
+++      "resolved": "https://registry.npmjs.org/@esbuild/darwin-arm64/-/darwin-arm64-0.21.5.tgz",
+++      "integrity": "sha512-DwqXqZyuk5AiWWf3UfLiRDJ5EDd49zg6O9wclZ7kUMv2WRFr4HKjXp/5t8JZ11QbQfUS6/cRCKGwYhtNAY88kQ==",
+++      "cpu": [
+++        "arm64"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "darwin"
+++      ],
+++      "engines": {
+++        "node": ">=12"
+++      }
+++    },
+++    "node_modules/@esbuild/darwin-x64": {
+++      "version": "0.21.5",
+++      "resolved": "https://registry.npmjs.org/@esbuild/darwin-x64/-/darwin-x64-0.21.5.tgz",
+++      "integrity": "sha512-se/JjF8NlmKVG4kNIuyWMV/22ZaerB+qaSi5MdrXtd6R08kvs2qCN4C09miupktDitvh8jRFflwGFBQcxZRjbw==",
+++      "cpu": [
+++        "x64"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "darwin"
+++      ],
+++      "engines": {
+++        "node": ">=12"
+++      }
+++    },
+++    "node_modules/@esbuild/freebsd-arm64": {
+++      "version": "0.21.5",
+++      "resolved": "https://registry.npmjs.org/@esbuild/freebsd-arm64/-/freebsd-arm64-0.21.5.tgz",
+++      "integrity": "sha512-5JcRxxRDUJLX8JXp/wcBCy3pENnCgBR9bN6JsY4OmhfUtIHe3ZW0mawA7+RDAcMLrMIZaf03NlQiX9DGyB8h4g==",
+++      "cpu": [
+++        "arm64"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "freebsd"
+++      ],
+++      "engines": {
+++        "node": ">=12"
+++      }
+++    },
+++    "node_modules/@esbuild/freebsd-x64": {
+++      "version": "0.21.5",
+++      "resolved": "https://registry.npmjs.org/@esbuild/freebsd-x64/-/freebsd-x64-0.21.5.tgz",
+++      "integrity": "sha512-J95kNBj1zkbMXtHVH29bBriQygMXqoVQOQYA+ISs0/2l3T9/kj42ow2mpqerRBxDJnmkUDCaQT/dfNXWX/ZZCQ==",
+++      "cpu": [
+++        "x64"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "freebsd"
+++      ],
+++      "engines": {
+++        "node": ">=12"
+++      }
+++    },
+++    "node_modules/@esbuild/linux-arm": {
+++      "version": "0.21.5",
+++      "resolved": "https://registry.npmjs.org/@esbuild/linux-arm/-/linux-arm-0.21.5.tgz",
+++      "integrity": "sha512-bPb5AHZtbeNGjCKVZ9UGqGwo8EUu4cLq68E95A53KlxAPRmUyYv2D6F0uUI65XisGOL1hBP5mTronbgo+0bFcA==",
+++      "cpu": [
+++        "arm"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "linux"
+++      ],
+++      "engines": {
+++        "node": ">=12"
+++      }
+++    },
+++    "node_modules/@esbuild/linux-arm64": {
+++      "version": "0.21.5",
+++      "resolved": "https://registry.npmjs.org/@esbuild/linux-arm64/-/linux-arm64-0.21.5.tgz",
+++      "integrity": "sha512-ibKvmyYzKsBeX8d8I7MH/TMfWDXBF3db4qM6sy+7re0YXya+K1cem3on9XgdT2EQGMu4hQyZhan7TeQ8XkGp4Q==",
+++      "cpu": [
+++        "arm64"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "linux"
+++      ],
+++      "engines": {
+++        "node": ">=12"
+++      }
+++    },
+++    "node_modules/@esbuild/linux-ia32": {
+++      "version": "0.21.5",
+++      "resolved": "https://registry.npmjs.org/@esbuild/linux-ia32/-/linux-ia32-0.21.5.tgz",
+++      "integrity": "sha512-YvjXDqLRqPDl2dvRODYmmhz4rPeVKYvppfGYKSNGdyZkA01046pLWyRKKI3ax8fbJoK5QbxblURkwK/MWY18Tg==",
+++      "cpu": [
+++        "ia32"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "linux"
+++      ],
+++      "engines": {
+++        "node": ">=12"
+++      }
+++    },
+++    "node_modules/@esbuild/linux-loong64": {
+++      "version": "0.21.5",
+++      "resolved": "https://registry.npmjs.org/@esbuild/linux-loong64/-/linux-loong64-0.21.5.tgz",
+++      "integrity": "sha512-uHf1BmMG8qEvzdrzAqg2SIG/02+4/DHB6a9Kbya0XDvwDEKCoC8ZRWI5JJvNdUjtciBGFQ5PuBlpEOXQj+JQSg==",
+++      "cpu": [
+++        "loong64"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "linux"
+++      ],
+++      "engines": {
+++        "node": ">=12"
+++      }
+++    },
+++    "node_modules/@esbuild/linux-mips64el": {
+++      "version": "0.21.5",
+++      "resolved": "https://registry.npmjs.org/@esbuild/linux-mips64el/-/linux-mips64el-0.21.5.tgz",
+++      "integrity": "sha512-IajOmO+KJK23bj52dFSNCMsz1QP1DqM6cwLUv3W1QwyxkyIWecfafnI555fvSGqEKwjMXVLokcV5ygHW5b3Jbg==",
+++      "cpu": [
+++        "mips64el"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "linux"
+++      ],
+++      "engines": {
+++        "node": ">=12"
+++      }
+++    },
+++    "node_modules/@esbuild/linux-ppc64": {
+++      "version": "0.21.5",
+++      "resolved": "https://registry.npmjs.org/@esbuild/linux-ppc64/-/linux-ppc64-0.21.5.tgz",
+++      "integrity": "sha512-1hHV/Z4OEfMwpLO8rp7CvlhBDnjsC3CttJXIhBi+5Aj5r+MBvy4egg7wCbe//hSsT+RvDAG7s81tAvpL2XAE4w==",
+++      "cpu": [
+++        "ppc64"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "linux"
+++      ],
+++      "engines": {
+++        "node": ">=12"
+++      }
+++    },
+++    "node_modules/@esbuild/linux-riscv64": {
+++      "version": "0.21.5",
+++      "resolved": "https://registry.npmjs.org/@esbuild/linux-riscv64/-/linux-riscv64-0.21.5.tgz",
+++      "integrity": "sha512-2HdXDMd9GMgTGrPWnJzP2ALSokE/0O5HhTUvWIbD3YdjME8JwvSCnNGBnTThKGEB91OZhzrJ4qIIxk/SBmyDDA==",
+++      "cpu": [
+++        "riscv64"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "linux"
+++      ],
+++      "engines": {
+++        "node": ">=12"
+++      }
+++    },
+++    "node_modules/@esbuild/linux-s390x": {
+++      "version": "0.21.5",
+++      "resolved": "https://registry.npmjs.org/@esbuild/linux-s390x/-/linux-s390x-0.21.5.tgz",
+++      "integrity": "sha512-zus5sxzqBJD3eXxwvjN1yQkRepANgxE9lgOW2qLnmr8ikMTphkjgXu1HR01K4FJg8h1kEEDAqDcZQtbrRnB41A==",
+++      "cpu": [
+++        "s390x"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "linux"
+++      ],
+++      "engines": {
+++        "node": ">=12"
+++      }
+++    },
+++    "node_modules/@esbuild/linux-x64": {
+++      "version": "0.21.5",
+++      "resolved": "https://registry.npmjs.org/@esbuild/linux-x64/-/linux-x64-0.21.5.tgz",
+++      "integrity": "sha512-1rYdTpyv03iycF1+BhzrzQJCdOuAOtaqHTWJZCWvijKD2N5Xu0TtVC8/+1faWqcP9iBCWOmjmhoH94dH82BxPQ==",
+++      "cpu": [
+++        "x64"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "linux"
+++      ],
+++      "engines": {
+++        "node": ">=12"
+++      }
+++    },
+++    "node_modules/@esbuild/netbsd-x64": {
+++      "version": "0.21.5",
+++      "resolved": "https://registry.npmjs.org/@esbuild/netbsd-x64/-/netbsd-x64-0.21.5.tgz",
+++      "integrity": "sha512-Woi2MXzXjMULccIwMnLciyZH4nCIMpWQAs049KEeMvOcNADVxo0UBIQPfSmxB3CWKedngg7sWZdLvLczpe0tLg==",
+++      "cpu": [
+++        "x64"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "netbsd"
+++      ],
+++      "engines": {
+++        "node": ">=12"
+++      }
+++    },
+++    "node_modules/@esbuild/openbsd-x64": {
+++      "version": "0.21.5",
+++      "resolved": "https://registry.npmjs.org/@esbuild/openbsd-x64/-/openbsd-x64-0.21.5.tgz",
+++      "integrity": "sha512-HLNNw99xsvx12lFBUwoT8EVCsSvRNDVxNpjZ7bPn947b8gJPzeHWyNVhFsaerc0n3TsbOINvRP2byTZ5LKezow==",
+++      "cpu": [
+++        "x64"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "openbsd"
+++      ],
+++      "engines": {
+++        "node": ">=12"
+++      }
+++    },
+++    "node_modules/@esbuild/sunos-x64": {
+++      "version": "0.21.5",
+++      "resolved": "https://registry.npmjs.org/@esbuild/sunos-x64/-/sunos-x64-0.21.5.tgz",
+++      "integrity": "sha512-6+gjmFpfy0BHU5Tpptkuh8+uw3mnrvgs+dSPQXQOv3ekbordwnzTVEb4qnIvQcYXq6gzkyTnoZ9dZG+D4garKg==",
+++      "cpu": [
+++        "x64"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "sunos"
+++      ],
+++      "engines": {
+++        "node": ">=12"
+++      }
+++    },
+++    "node_modules/@esbuild/win32-arm64": {
+++      "version": "0.21.5",
+++      "resolved": "https://registry.npmjs.org/@esbuild/win32-arm64/-/win32-arm64-0.21.5.tgz",
+++      "integrity": "sha512-Z0gOTd75VvXqyq7nsl93zwahcTROgqvuAcYDUr+vOv8uHhNSKROyU961kgtCD1e95IqPKSQKH7tBTslnS3tA8A==",
+++      "cpu": [
+++        "arm64"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "win32"
+++      ],
+++      "engines": {
+++        "node": ">=12"
+++      }
+++    },
+++    "node_modules/@esbuild/win32-ia32": {
+++      "version": "0.21.5",
+++      "resolved": "https://registry.npmjs.org/@esbuild/win32-ia32/-/win32-ia32-0.21.5.tgz",
+++      "integrity": "sha512-SWXFF1CL2RVNMaVs+BBClwtfZSvDgtL//G/smwAc5oVK/UPu2Gu9tIaRgFmYFFKrmg3SyAjSrElf0TiJ1v8fYA==",
+++      "cpu": [
+++        "ia32"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "win32"
+++      ],
+++      "engines": {
+++        "node": ">=12"
+++      }
+++    },
+++    "node_modules/@esbuild/win32-x64": {
+++      "version": "0.21.5",
+++      "resolved": "https://registry.npmjs.org/@esbuild/win32-x64/-/win32-x64-0.21.5.tgz",
+++      "integrity": "sha512-tQd/1efJuzPC6rCFwEvLtci/xNFcTZknmXs98FYDfGE4wP9ClFV98nyKrzJKVPMhdDnjzLhdUyMX4PsQAPjwIw==",
+++      "cpu": [
+++        "x64"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "win32"
+++      ],
+++      "engines": {
+++        "node": ">=12"
+++      }
+++    },
+++    "node_modules/@jridgewell/gen-mapping": {
+++      "version": "0.3.13",
+++      "resolved": "https://registry.npmjs.org/@jridgewell/gen-mapping/-/gen-mapping-0.3.13.tgz",
+++      "integrity": "sha512-2kkt/7niJ6MgEPxF0bYdQ6etZaA+fQvDcLKckhy1yIQOzaoKjBBjSj63/aLVjYE3qhRt5dvM+uUyfCg6UKCBbA==",
+++      "dev": true,
+++      "license": "MIT",
+++      "dependencies": {
+++        "@jridgewell/sourcemap-codec": "^1.5.0",
+++        "@jridgewell/trace-mapping": "^0.3.24"
+++      }
+++    },
+++    "node_modules/@jridgewell/remapping": {
+++      "version": "2.3.5",
+++      "resolved": "https://registry.npmjs.org/@jridgewell/remapping/-/remapping-2.3.5.tgz",
+++      "integrity": "sha512-LI9u/+laYG4Ds1TDKSJW2YPrIlcVYOwi2fUC6xB43lueCjgxV4lffOCZCtYFiH6TNOX+tQKXx97T4IKHbhyHEQ==",
+++      "dev": true,
+++      "license": "MIT",
+++      "dependencies": {
+++        "@jridgewell/gen-mapping": "^0.3.5",
+++        "@jridgewell/trace-mapping": "^0.3.24"
+++      }
+++    },
+++    "node_modules/@jridgewell/resolve-uri": {
+++      "version": "3.1.2",
+++      "resolved": "https://registry.npmjs.org/@jridgewell/resolve-uri/-/resolve-uri-3.1.2.tgz",
+++      "integrity": "sha512-bRISgCIjP20/tbWSPWMEi54QVPRZExkuD9lJL+UIxUKtwVJA8wW1Trb1jMs1RFXo1CBTNZ/5hpC9QvmKWdopKw==",
+++      "dev": true,
+++      "license": "MIT",
+++      "engines": {
+++        "node": ">=6.0.0"
+++      }
+++    },
+++    "node_modules/@jridgewell/sourcemap-codec": {
+++      "version": "1.5.5",
+++      "resolved": "https://registry.npmjs.org/@jridgewell/sourcemap-codec/-/sourcemap-codec-1.5.5.tgz",
+++      "integrity": "sha512-cYQ9310grqxueWbl+WuIUIaiUaDcj7WOq5fVhEljNVgRfOUhY9fy2zTvfoqWsnebh8Sl70VScFbICvJnLKB0Og==",
+++      "dev": true,
+++      "license": "MIT"
+++    },
+++    "node_modules/@jridgewell/trace-mapping": {
+++      "version": "0.3.31",
+++      "resolved": "https://registry.npmjs.org/@jridgewell/trace-mapping/-/trace-mapping-0.3.31.tgz",
+++      "integrity": "sha512-zzNR+SdQSDJzc8joaeP8QQoCQr8NuYx2dIIytl1QeBEZHJ9uW6hebsrYgbz8hJwUQao3TWCMtmfV8Nu1twOLAw==",
+++      "dev": true,
+++      "license": "MIT",
+++      "dependencies": {
+++        "@jridgewell/resolve-uri": "^3.1.0",
+++        "@jridgewell/sourcemap-codec": "^1.4.14"
+++      }
+++    },
+++    "node_modules/@rolldown/pluginutils": {
+++      "version": "1.0.0-beta.27",
+++      "resolved": "https://registry.npmjs.org/@rolldown/pluginutils/-/pluginutils-1.0.0-beta.27.tgz",
+++      "integrity": "sha512-+d0F4MKMCbeVUJwG96uQ4SgAznZNSq93I3V+9NHA4OpvqG8mRCpGdKmK8l/dl02h2CCDHwW2FqilnTyDcAnqjA==",
+++      "dev": true,
+++      "license": "MIT"
+++    },
+++    "node_modules/@rollup/rollup-android-arm-eabi": {
+++      "version": "4.56.0",
+++      "resolved": "https://registry.npmjs.org/@rollup/rollup-android-arm-eabi/-/rollup-android-arm-eabi-4.56.0.tgz",
+++      "integrity": "sha512-LNKIPA5k8PF1+jAFomGe3qN3bbIgJe/IlpDBwuVjrDKrJhVWywgnJvflMt/zkbVNLFtF1+94SljYQS6e99klnw==",
+++      "cpu": [
+++        "arm"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "android"
+++      ]
+++    },
+++    "node_modules/@rollup/rollup-android-arm64": {
+++      "version": "4.56.0",
+++      "resolved": "https://registry.npmjs.org/@rollup/rollup-android-arm64/-/rollup-android-arm64-4.56.0.tgz",
+++      "integrity": "sha512-lfbVUbelYqXlYiU/HApNMJzT1E87UPGvzveGg2h0ktUNlOCxKlWuJ9jtfvs1sKHdwU4fzY7Pl8sAl49/XaEk6Q==",
+++      "cpu": [
+++        "arm64"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "android"
+++      ]
+++    },
+++    "node_modules/@rollup/rollup-darwin-arm64": {
+++      "version": "4.56.0",
+++      "resolved": "https://registry.npmjs.org/@rollup/rollup-darwin-arm64/-/rollup-darwin-arm64-4.56.0.tgz",
+++      "integrity": "sha512-EgxD1ocWfhoD6xSOeEEwyE7tDvwTgZc8Bss7wCWe+uc7wO8G34HHCUH+Q6cHqJubxIAnQzAsyUsClt0yFLu06w==",
+++      "cpu": [
+++        "arm64"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "darwin"
+++      ]
+++    },
+++    "node_modules/@rollup/rollup-darwin-x64": {
+++      "version": "4.56.0",
+++      "resolved": "https://registry.npmjs.org/@rollup/rollup-darwin-x64/-/rollup-darwin-x64-4.56.0.tgz",
+++      "integrity": "sha512-1vXe1vcMOssb/hOF8iv52A7feWW2xnu+c8BV4t1F//m9QVLTfNVpEdja5ia762j/UEJe2Z1jAmEqZAK42tVW3g==",
+++      "cpu": [
+++        "x64"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "darwin"
+++      ]
+++    },
+++    "node_modules/@rollup/rollup-freebsd-arm64": {
+++      "version": "4.56.0",
+++      "resolved": "https://registry.npmjs.org/@rollup/rollup-freebsd-arm64/-/rollup-freebsd-arm64-4.56.0.tgz",
+++      "integrity": "sha512-bof7fbIlvqsyv/DtaXSck4VYQ9lPtoWNFCB/JY4snlFuJREXfZnm+Ej6yaCHfQvofJDXLDMTVxWscVSuQvVWUQ==",
+++      "cpu": [
+++        "arm64"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "freebsd"
+++      ]
+++    },
+++    "node_modules/@rollup/rollup-freebsd-x64": {
+++      "version": "4.56.0",
+++      "resolved": "https://registry.npmjs.org/@rollup/rollup-freebsd-x64/-/rollup-freebsd-x64-4.56.0.tgz",
+++      "integrity": "sha512-KNa6lYHloW+7lTEkYGa37fpvPq+NKG/EHKM8+G/g9WDU7ls4sMqbVRV78J6LdNuVaeeK5WB9/9VAFbKxcbXKYg==",
+++      "cpu": [
+++        "x64"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "freebsd"
+++      ]
+++    },
+++    "node_modules/@rollup/rollup-linux-arm-gnueabihf": {
+++      "version": "4.56.0",
+++      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-arm-gnueabihf/-/rollup-linux-arm-gnueabihf-4.56.0.tgz",
+++      "integrity": "sha512-E8jKK87uOvLrrLN28jnAAAChNq5LeCd2mGgZF+fGF5D507WlG/Noct3lP/QzQ6MrqJ5BCKNwI9ipADB6jyiq2A==",
+++      "cpu": [
+++        "arm"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "linux"
+++      ]
+++    },
+++    "node_modules/@rollup/rollup-linux-arm-musleabihf": {
+++      "version": "4.56.0",
+++      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-arm-musleabihf/-/rollup-linux-arm-musleabihf-4.56.0.tgz",
+++      "integrity": "sha512-jQosa5FMYF5Z6prEpTCCmzCXz6eKr/tCBssSmQGEeozA9tkRUty/5Vx06ibaOP9RCrW1Pvb8yp3gvZhHwTDsJw==",
+++      "cpu": [
+++        "arm"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "linux"
+++      ]
+++    },
+++    "node_modules/@rollup/rollup-linux-arm64-gnu": {
+++      "version": "4.56.0",
+++      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-arm64-gnu/-/rollup-linux-arm64-gnu-4.56.0.tgz",
+++      "integrity": "sha512-uQVoKkrC1KGEV6udrdVahASIsaF8h7iLG0U0W+Xn14ucFwi6uS539PsAr24IEF9/FoDtzMeeJXJIBo5RkbNWvQ==",
+++      "cpu": [
+++        "arm64"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "linux"
+++      ]
+++    },
+++    "node_modules/@rollup/rollup-linux-arm64-musl": {
+++      "version": "4.56.0",
+++      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-arm64-musl/-/rollup-linux-arm64-musl-4.56.0.tgz",
+++      "integrity": "sha512-vLZ1yJKLxhQLFKTs42RwTwa6zkGln+bnXc8ueFGMYmBTLfNu58sl5/eXyxRa2RarTkJbXl8TKPgfS6V5ijNqEA==",
+++      "cpu": [
+++        "arm64"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "linux"
+++      ]
+++    },
+++    "node_modules/@rollup/rollup-linux-loong64-gnu": {
+++      "version": "4.56.0",
+++      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-loong64-gnu/-/rollup-linux-loong64-gnu-4.56.0.tgz",
+++      "integrity": "sha512-FWfHOCub564kSE3xJQLLIC/hbKqHSVxy8vY75/YHHzWvbJL7aYJkdgwD/xGfUlL5UV2SB7otapLrcCj2xnF1dg==",
+++      "cpu": [
+++        "loong64"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "linux"
+++      ]
+++    },
+++    "node_modules/@rollup/rollup-linux-loong64-musl": {
+++      "version": "4.56.0",
+++      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-loong64-musl/-/rollup-linux-loong64-musl-4.56.0.tgz",
+++      "integrity": "sha512-z1EkujxIh7nbrKL1lmIpqFTc/sr0u8Uk0zK/qIEFldbt6EDKWFk/pxFq3gYj4Bjn3aa9eEhYRlL3H8ZbPT1xvA==",
+++      "cpu": [
+++        "loong64"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "linux"
+++      ]
+++    },
+++    "node_modules/@rollup/rollup-linux-ppc64-gnu": {
+++      "version": "4.56.0",
+++      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-ppc64-gnu/-/rollup-linux-ppc64-gnu-4.56.0.tgz",
+++      "integrity": "sha512-iNFTluqgdoQC7AIE8Q34R3AuPrJGJirj5wMUErxj22deOcY7XwZRaqYmB6ZKFHoVGqRcRd0mqO+845jAibKCkw==",
+++      "cpu": [
+++        "ppc64"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "linux"
+++      ]
+++    },
+++    "node_modules/@rollup/rollup-linux-ppc64-musl": {
+++      "version": "4.56.0",
+++      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-ppc64-musl/-/rollup-linux-ppc64-musl-4.56.0.tgz",
+++      "integrity": "sha512-MtMeFVlD2LIKjp2sE2xM2slq3Zxf9zwVuw0jemsxvh1QOpHSsSzfNOTH9uYW9i1MXFxUSMmLpeVeUzoNOKBaWg==",
+++      "cpu": [
+++        "ppc64"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "linux"
+++      ]
+++    },
+++    "node_modules/@rollup/rollup-linux-riscv64-gnu": {
+++      "version": "4.56.0",
+++      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-riscv64-gnu/-/rollup-linux-riscv64-gnu-4.56.0.tgz",
+++      "integrity": "sha512-in+v6wiHdzzVhYKXIk5U74dEZHdKN9KH0Q4ANHOTvyXPG41bajYRsy7a8TPKbYPl34hU7PP7hMVHRvv/5aCSew==",
+++      "cpu": [
+++        "riscv64"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "linux"
+++      ]
+++    },
+++    "node_modules/@rollup/rollup-linux-riscv64-musl": {
+++      "version": "4.56.0",
+++      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-riscv64-musl/-/rollup-linux-riscv64-musl-4.56.0.tgz",
+++      "integrity": "sha512-yni2raKHB8m9NQpI9fPVwN754mn6dHQSbDTwxdr9SE0ks38DTjLMMBjrwvB5+mXrX+C0npX0CVeCUcvvvD8CNQ==",
+++      "cpu": [
+++        "riscv64"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "linux"
+++      ]
+++    },
+++    "node_modules/@rollup/rollup-linux-s390x-gnu": {
+++      "version": "4.56.0",
+++      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-s390x-gnu/-/rollup-linux-s390x-gnu-4.56.0.tgz",
+++      "integrity": "sha512-zhLLJx9nQPu7wezbxt2ut+CI4YlXi68ndEve16tPc/iwoylWS9B3FxpLS2PkmfYgDQtosah07Mj9E0khc3Y+vQ==",
+++      "cpu": [
+++        "s390x"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "linux"
+++      ]
+++    },
+++    "node_modules/@rollup/rollup-linux-x64-gnu": {
+++      "version": "4.56.0",
+++      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-x64-gnu/-/rollup-linux-x64-gnu-4.56.0.tgz",
+++      "integrity": "sha512-MVC6UDp16ZSH7x4rtuJPAEoE1RwS8N4oK9DLHy3FTEdFoUTCFVzMfJl/BVJ330C+hx8FfprA5Wqx4FhZXkj2Kw==",
+++      "cpu": [
+++        "x64"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "linux"
+++      ]
+++    },
+++    "node_modules/@rollup/rollup-linux-x64-musl": {
+++      "version": "4.56.0",
+++      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-x64-musl/-/rollup-linux-x64-musl-4.56.0.tgz",
+++      "integrity": "sha512-ZhGH1eA4Qv0lxaV00azCIS1ChedK0V32952Md3FtnxSqZTBTd6tgil4nZT5cU8B+SIw3PFYkvyR4FKo2oyZIHA==",
+++      "cpu": [
+++        "x64"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "linux"
+++      ]
+++    },
+++    "node_modules/@rollup/rollup-openbsd-x64": {
+++      "version": "4.56.0",
+++      "resolved": "https://registry.npmjs.org/@rollup/rollup-openbsd-x64/-/rollup-openbsd-x64-4.56.0.tgz",
+++      "integrity": "sha512-O16XcmyDeFI9879pEcmtWvD/2nyxR9mF7Gs44lf1vGGx8Vg2DRNx11aVXBEqOQhWb92WN4z7fW/q4+2NYzCbBA==",
+++      "cpu": [
+++        "x64"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "openbsd"
+++      ]
+++    },
+++    "node_modules/@rollup/rollup-openharmony-arm64": {
+++      "version": "4.56.0",
+++      "resolved": "https://registry.npmjs.org/@rollup/rollup-openharmony-arm64/-/rollup-openharmony-arm64-4.56.0.tgz",
+++      "integrity": "sha512-LhN/Reh+7F3RCgQIRbgw8ZMwUwyqJM+8pXNT6IIJAqm2IdKkzpCh/V9EdgOMBKuebIrzswqy4ATlrDgiOwbRcQ==",
+++      "cpu": [
+++        "arm64"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "openharmony"
+++      ]
+++    },
+++    "node_modules/@rollup/rollup-win32-arm64-msvc": {
+++      "version": "4.56.0",
+++      "resolved": "https://registry.npmjs.org/@rollup/rollup-win32-arm64-msvc/-/rollup-win32-arm64-msvc-4.56.0.tgz",
+++      "integrity": "sha512-kbFsOObXp3LBULg1d3JIUQMa9Kv4UitDmpS+k0tinPBz3watcUiV2/LUDMMucA6pZO3WGE27P7DsfaN54l9ing==",
+++      "cpu": [
+++        "arm64"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "win32"
+++      ]
+++    },
+++    "node_modules/@rollup/rollup-win32-ia32-msvc": {
+++      "version": "4.56.0",
+++      "resolved": "https://registry.npmjs.org/@rollup/rollup-win32-ia32-msvc/-/rollup-win32-ia32-msvc-4.56.0.tgz",
+++      "integrity": "sha512-vSSgny54D6P4vf2izbtFm/TcWYedw7f8eBrOiGGecyHyQB9q4Kqentjaj8hToe+995nob/Wv48pDqL5a62EWtg==",
+++      "cpu": [
+++        "ia32"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "win32"
+++      ]
+++    },
+++    "node_modules/@rollup/rollup-win32-x64-gnu": {
+++      "version": "4.56.0",
+++      "resolved": "https://registry.npmjs.org/@rollup/rollup-win32-x64-gnu/-/rollup-win32-x64-gnu-4.56.0.tgz",
+++      "integrity": "sha512-FeCnkPCTHQJFbiGG49KjV5YGW/8b9rrXAM2Mz2kiIoktq2qsJxRD5giEMEOD2lPdgs72upzefaUvS+nc8E3UzQ==",
+++      "cpu": [
+++        "x64"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "win32"
+++      ]
+++    },
+++    "node_modules/@rollup/rollup-win32-x64-msvc": {
+++      "version": "4.56.0",
+++      "resolved": "https://registry.npmjs.org/@rollup/rollup-win32-x64-msvc/-/rollup-win32-x64-msvc-4.56.0.tgz",
+++      "integrity": "sha512-H8AE9Ur/t0+1VXujj90w0HrSOuv0Nq9r1vSZF2t5km20NTfosQsGGUXDaKdQZzwuLts7IyL1fYT4hM95TI9c4g==",
+++      "cpu": [
+++        "x64"
+++      ],
+++      "dev": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "win32"
+++      ]
+++    },
+++    "node_modules/@types/babel__core": {
+++      "version": "7.20.5",
+++      "resolved": "https://registry.npmjs.org/@types/babel__core/-/babel__core-7.20.5.tgz",
+++      "integrity": "sha512-qoQprZvz5wQFJwMDqeseRXWv3rqMvhgpbXFfVyWhbx9X47POIA6i/+dXefEmZKoAgOaTdaIgNSMqMIU61yRyzA==",
+++      "dev": true,
+++      "license": "MIT",
+++      "dependencies": {
+++        "@babel/parser": "^7.20.7",
+++        "@babel/types": "^7.20.7",
+++        "@types/babel__generator": "*",
+++        "@types/babel__template": "*",
+++        "@types/babel__traverse": "*"
+++      }
+++    },
+++    "node_modules/@types/babel__generator": {
+++      "version": "7.27.0",
+++      "resolved": "https://registry.npmjs.org/@types/babel__generator/-/babel__generator-7.27.0.tgz",
+++      "integrity": "sha512-ufFd2Xi92OAVPYsy+P4n7/U7e68fex0+Ee8gSG9KX7eo084CWiQ4sdxktvdl0bOPupXtVJPY19zk6EwWqUQ8lg==",
+++      "dev": true,
+++      "license": "MIT",
+++      "dependencies": {
+++        "@babel/types": "^7.0.0"
+++      }
+++    },
+++    "node_modules/@types/babel__template": {
+++      "version": "7.4.4",
+++      "resolved": "https://registry.npmjs.org/@types/babel__template/-/babel__template-7.4.4.tgz",
+++      "integrity": "sha512-h/NUaSyG5EyxBIp8YRxo4RMe2/qQgvyowRwVMzhYhBCONbW8PUsg4lkFMrhgZhUe5z3L3MiLDuvyJ/CaPa2A8A==",
+++      "dev": true,
+++      "license": "MIT",
+++      "dependencies": {
+++        "@babel/parser": "^7.1.0",
+++        "@babel/types": "^7.0.0"
+++      }
+++    },
+++    "node_modules/@types/babel__traverse": {
+++      "version": "7.28.0",
+++      "resolved": "https://registry.npmjs.org/@types/babel__traverse/-/babel__traverse-7.28.0.tgz",
+++      "integrity": "sha512-8PvcXf70gTDZBgt9ptxJ8elBeBjcLOAcOtoO/mPJjtji1+CdGbHgm77om1GrsPxsiE+uXIpNSK64UYaIwQXd4Q==",
+++      "dev": true,
+++      "license": "MIT",
+++      "dependencies": {
+++        "@babel/types": "^7.28.2"
+++      }
+++    },
+++    "node_modules/@types/estree": {
+++      "version": "1.0.8",
+++      "resolved": "https://registry.npmjs.org/@types/estree/-/estree-1.0.8.tgz",
+++      "integrity": "sha512-dWHzHa2WqEXI/O1E9OjrocMTKJl2mSrEolh1Iomrv6U+JuNwaHXsXx9bLu5gG7BUWFIN0skIQJQ/L1rIex4X6w==",
+++      "dev": true,
+++      "license": "MIT"
+++    },
+++    "node_modules/@types/prop-types": {
+++      "version": "15.7.15",
+++      "resolved": "https://registry.npmjs.org/@types/prop-types/-/prop-types-15.7.15.tgz",
+++      "integrity": "sha512-F6bEyamV9jKGAFBEmlQnesRPGOQqS2+Uwi0Em15xenOxHaf2hv6L8YCVn3rPdPJOiJfPiCnLIRyvwVaqMY3MIw==",
+++      "dev": true,
+++      "license": "MIT"
+++    },
+++    "node_modules/@types/react": {
+++      "version": "18.3.27",
+++      "resolved": "https://registry.npmjs.org/@types/react/-/react-18.3.27.tgz",
+++      "integrity": "sha512-cisd7gxkzjBKU2GgdYrTdtQx1SORymWyaAFhaxQPK9bYO9ot3Y5OikQRvY0VYQtvwjeQnizCINJAenh/V7MK2w==",
+++      "dev": true,
+++      "license": "MIT",
+++      "dependencies": {
+++        "@types/prop-types": "*",
+++        "csstype": "^3.2.2"
+++      }
+++    },
+++    "node_modules/@types/react-dom": {
+++      "version": "18.3.7",
+++      "resolved": "https://registry.npmjs.org/@types/react-dom/-/react-dom-18.3.7.tgz",
+++      "integrity": "sha512-MEe3UeoENYVFXzoXEWsvcpg6ZvlrFNlOQ7EOsvhI3CfAXwzPfO8Qwuxd40nepsYKqyyVQnTdEfv68q91yLcKrQ==",
+++      "dev": true,
+++      "license": "MIT",
+++      "peerDependencies": {
+++        "@types/react": "^18.0.0"
+++      }
+++    },
+++    "node_modules/@vitejs/plugin-react": {
+++      "version": "4.7.0",
+++      "resolved": "https://registry.npmjs.org/@vitejs/plugin-react/-/plugin-react-4.7.0.tgz",
+++      "integrity": "sha512-gUu9hwfWvvEDBBmgtAowQCojwZmJ5mcLn3aufeCsitijs3+f2NsrPtlAWIR6OPiqljl96GVCUbLe0HyqIpVaoA==",
+++      "dev": true,
+++      "license": "MIT",
+++      "dependencies": {
+++        "@babel/core": "^7.28.0",
+++        "@babel/plugin-transform-react-jsx-self": "^7.27.1",
+++        "@babel/plugin-transform-react-jsx-source": "^7.27.1",
+++        "@rolldown/pluginutils": "1.0.0-beta.27",
+++        "@types/babel__core": "^7.20.5",
+++        "react-refresh": "^0.17.0"
+++      },
+++      "engines": {
+++        "node": "^14.18.0 || >=16.0.0"
+++      },
+++      "peerDependencies": {
+++        "vite": "^4.2.0 || ^5.0.0 || ^6.0.0 || ^7.0.0"
+++      }
+++    },
+++    "node_modules/baseline-browser-mapping": {
+++      "version": "2.9.17",
+++      "resolved": "https://registry.npmjs.org/baseline-browser-mapping/-/baseline-browser-mapping-2.9.17.tgz",
+++      "integrity": "sha512-agD0MgJFUP/4nvjqzIB29zRPUuCF7Ge6mEv9s8dHrtYD7QWXRcx75rOADE/d5ah1NI+0vkDl0yorDd5U852IQQ==",
+++      "dev": true,
+++      "license": "Apache-2.0",
+++      "bin": {
+++        "baseline-browser-mapping": "dist/cli.js"
+++      }
+++    },
+++    "node_modules/browserslist": {
+++      "version": "4.28.1",
+++      "resolved": "https://registry.npmjs.org/browserslist/-/browserslist-4.28.1.tgz",
+++      "integrity": "sha512-ZC5Bd0LgJXgwGqUknZY/vkUQ04r8NXnJZ3yYi4vDmSiZmC/pdSN0NbNRPxZpbtO4uAfDUAFffO8IZoM3Gj8IkA==",
+++      "dev": true,
+++      "funding": [
+++        {
+++          "type": "opencollective",
+++          "url": "https://opencollective.com/browserslist"
+++        },
+++        {
+++          "type": "tidelift",
+++          "url": "https://tidelift.com/funding/github/npm/browserslist"
+++        },
+++        {
+++          "type": "github",
+++          "url": "https://github.com/sponsors/ai"
+++        }
+++      ],
+++      "license": "MIT",
+++      "dependencies": {
+++        "baseline-browser-mapping": "^2.9.0",
+++        "caniuse-lite": "^1.0.30001759",
+++        "electron-to-chromium": "^1.5.263",
+++        "node-releases": "^2.0.27",
+++        "update-browserslist-db": "^1.2.0"
+++      },
+++      "bin": {
+++        "browserslist": "cli.js"
+++      },
+++      "engines": {
+++        "node": "^6 || ^7 || ^8 || ^9 || ^10 || ^11 || ^12 || >=13.7"
+++      }
+++    },
+++    "node_modules/caniuse-lite": {
+++      "version": "1.0.30001765",
+++      "resolved": "https://registry.npmjs.org/caniuse-lite/-/caniuse-lite-1.0.30001765.tgz",
+++      "integrity": "sha512-LWcNtSyZrakjECqmpP4qdg0MMGdN368D7X8XvvAqOcqMv0RxnlqVKZl2V6/mBR68oYMxOZPLw/gO7DuisMHUvQ==",
+++      "dev": true,
+++      "funding": [
+++        {
+++          "type": "opencollective",
+++          "url": "https://opencollective.com/browserslist"
+++        },
+++        {
+++          "type": "tidelift",
+++          "url": "https://tidelift.com/funding/github/npm/caniuse-lite"
+++        },
+++        {
+++          "type": "github",
+++          "url": "https://github.com/sponsors/ai"
+++        }
+++      ],
+++      "license": "CC-BY-4.0"
+++    },
+++    "node_modules/convert-source-map": {
+++      "version": "2.0.0",
+++      "resolved": "https://registry.npmjs.org/convert-source-map/-/convert-source-map-2.0.0.tgz",
+++      "integrity": "sha512-Kvp459HrV2FEJ1CAsi1Ku+MY3kasH19TFykTz2xWmMeq6bk2NU3XXvfJ+Q61m0xktWwt+1HSYf3JZsTms3aRJg==",
+++      "dev": true,
+++      "license": "MIT"
+++    },
+++    "node_modules/csstype": {
+++      "version": "3.2.3",
+++      "resolved": "https://registry.npmjs.org/csstype/-/csstype-3.2.3.tgz",
+++      "integrity": "sha512-z1HGKcYy2xA8AGQfwrn0PAy+PB7X/GSj3UVJW9qKyn43xWa+gl5nXmU4qqLMRzWVLFC8KusUX8T/0kCiOYpAIQ==",
+++      "dev": true,
+++      "license": "MIT"
+++    },
+++    "node_modules/debug": {
+++      "version": "4.4.3",
+++      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
+++      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
+++      "dev": true,
+++      "license": "MIT",
+++      "dependencies": {
+++        "ms": "^2.1.3"
+++      },
+++      "engines": {
+++        "node": ">=6.0"
+++      },
+++      "peerDependenciesMeta": {
+++        "supports-color": {
+++          "optional": true
+++        }
+++      }
+++    },
+++    "node_modules/electron-to-chromium": {
+++      "version": "1.5.267",
+++      "resolved": "https://registry.npmjs.org/electron-to-chromium/-/electron-to-chromium-1.5.267.tgz",
+++      "integrity": "sha512-0Drusm6MVRXSOJpGbaSVgcQsuB4hEkMpHXaVstcPmhu5LIedxs1xNK/nIxmQIU/RPC0+1/o0AVZfBTkTNJOdUw==",
+++      "dev": true,
+++      "license": "ISC"
+++    },
+++    "node_modules/esbuild": {
+++      "version": "0.21.5",
+++      "resolved": "https://registry.npmjs.org/esbuild/-/esbuild-0.21.5.tgz",
+++      "integrity": "sha512-mg3OPMV4hXywwpoDxu3Qda5xCKQi+vCTZq8S9J/EpkhB2HzKXq4SNFZE3+NK93JYxc8VMSep+lOUSC/RVKaBqw==",
+++      "dev": true,
+++      "hasInstallScript": true,
+++      "license": "MIT",
+++      "bin": {
+++        "esbuild": "bin/esbuild"
+++      },
+++      "engines": {
+++        "node": ">=12"
+++      },
+++      "optionalDependencies": {
+++        "@esbuild/aix-ppc64": "0.21.5",
+++        "@esbuild/android-arm": "0.21.5",
+++        "@esbuild/android-arm64": "0.21.5",
+++        "@esbuild/android-x64": "0.21.5",
+++        "@esbuild/darwin-arm64": "0.21.5",
+++        "@esbuild/darwin-x64": "0.21.5",
+++        "@esbuild/freebsd-arm64": "0.21.5",
+++        "@esbuild/freebsd-x64": "0.21.5",
+++        "@esbuild/linux-arm": "0.21.5",
+++        "@esbuild/linux-arm64": "0.21.5",
+++        "@esbuild/linux-ia32": "0.21.5",
+++        "@esbuild/linux-loong64": "0.21.5",
+++        "@esbuild/linux-mips64el": "0.21.5",
+++        "@esbuild/linux-ppc64": "0.21.5",
+++        "@esbuild/linux-riscv64": "0.21.5",
+++        "@esbuild/linux-s390x": "0.21.5",
+++        "@esbuild/linux-x64": "0.21.5",
+++        "@esbuild/netbsd-x64": "0.21.5",
+++        "@esbuild/openbsd-x64": "0.21.5",
+++        "@esbuild/sunos-x64": "0.21.5",
+++        "@esbuild/win32-arm64": "0.21.5",
+++        "@esbuild/win32-ia32": "0.21.5",
+++        "@esbuild/win32-x64": "0.21.5"
+++      }
+++    },
+++    "node_modules/escalade": {
+++      "version": "3.2.0",
+++      "resolved": "https://registry.npmjs.org/escalade/-/escalade-3.2.0.tgz",
+++      "integrity": "sha512-WUj2qlxaQtO4g6Pq5c29GTcWGDyd8itL8zTlipgECz3JesAiiOKotd8JU6otB3PACgG6xkJUyVhboMS+bje/jA==",
+++      "dev": true,
+++      "license": "MIT",
+++      "engines": {
+++        "node": ">=6"
+++      }
+++    },
+++    "node_modules/fsevents": {
+++      "version": "2.3.3",
+++      "resolved": "https://registry.npmjs.org/fsevents/-/fsevents-2.3.3.tgz",
+++      "integrity": "sha512-5xoDfX+fL7faATnagmWPpbFtwh/R77WmMMqqHGS65C3vvB0YHrgF+B1YmZ3441tMj5n63k0212XNoJwzlhffQw==",
+++      "dev": true,
+++      "hasInstallScript": true,
+++      "license": "MIT",
+++      "optional": true,
+++      "os": [
+++        "darwin"
+++      ],
+++      "engines": {
+++        "node": "^8.16.0 || ^10.6.0 || >=11.0.0"
+++      }
+++    },
+++    "node_modules/gensync": {
+++      "version": "1.0.0-beta.2",
+++      "resolved": "https://registry.npmjs.org/gensync/-/gensync-1.0.0-beta.2.tgz",
+++      "integrity": "sha512-3hN7NaskYvMDLQY55gnW3NQ+mesEAepTqlg+VEbj7zzqEMBVNhzcGYYeqFo/TlYz6eQiFcp1HcsCZO+nGgS8zg==",
+++      "dev": true,
+++      "license": "MIT",
+++      "engines": {
+++        "node": ">=6.9.0"
+++      }
+++    },
+++    "node_modules/js-tokens": {
+++      "version": "4.0.0",
+++      "resolved": "https://registry.npmjs.org/js-tokens/-/js-tokens-4.0.0.tgz",
+++      "integrity": "sha512-RdJUflcE3cUzKiMqQgsCu06FPu9UdIJO0beYbPhHN4k6apgJtifcoCtT9bcxOpYBtpD2kCM6Sbzg4CausW/PKQ==",
+++      "license": "MIT"
+++    },
+++    "node_modules/jsesc": {
+++      "version": "3.1.0",
+++      "resolved": "https://registry.npmjs.org/jsesc/-/jsesc-3.1.0.tgz",
+++      "integrity": "sha512-/sM3dO2FOzXjKQhJuo0Q173wf2KOo8t4I8vHy6lF9poUp7bKT0/NHE8fPX23PwfhnykfqnC2xRxOnVw5XuGIaA==",
+++      "dev": true,
+++      "license": "MIT",
+++      "bin": {
+++        "jsesc": "bin/jsesc"
+++      },
+++      "engines": {
+++        "node": ">=6"
+++      }
+++    },
+++    "node_modules/json5": {
+++      "version": "2.2.3",
+++      "resolved": "https://registry.npmjs.org/json5/-/json5-2.2.3.tgz",
+++      "integrity": "sha512-XmOWe7eyHYH14cLdVPoyg+GOH3rYX++KpzrylJwSW98t3Nk+U8XOl8FWKOgwtzdb8lXGf6zYwDUzeHMWfxasyg==",
+++      "dev": true,
+++      "license": "MIT",
+++      "bin": {
+++        "json5": "lib/cli.js"
+++      },
+++      "engines": {
+++        "node": ">=6"
+++      }
+++    },
+++    "node_modules/loose-envify": {
+++      "version": "1.4.0",
+++      "resolved": "https://registry.npmjs.org/loose-envify/-/loose-envify-1.4.0.tgz",
+++      "integrity": "sha512-lyuxPGr/Wfhrlem2CL/UcnUc1zcqKAImBDzukY7Y5F/yQiNdko6+fRLevlw1HgMySw7f611UIY408EtxRSoK3Q==",
+++      "license": "MIT",
+++      "dependencies": {
+++        "js-tokens": "^3.0.0 || ^4.0.0"
+++      },
+++      "bin": {
+++        "loose-envify": "cli.js"
+++      }
+++    },
+++    "node_modules/lru-cache": {
+++      "version": "5.1.1",
+++      "resolved": "https://registry.npmjs.org/lru-cache/-/lru-cache-5.1.1.tgz",
+++      "integrity": "sha512-KpNARQA3Iwv+jTA0utUVVbrh+Jlrr1Fv0e56GGzAFOXN7dk/FviaDW8LHmK52DlcH4WP2n6gI8vN1aesBFgo9w==",
+++      "dev": true,
+++      "license": "ISC",
+++      "dependencies": {
+++        "yallist": "^3.0.2"
+++      }
+++    },
+++    "node_modules/ms": {
+++      "version": "2.1.3",
+++      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
+++      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
+++      "dev": true,
+++      "license": "MIT"
+++    },
+++    "node_modules/nanoid": {
+++      "version": "3.3.11",
+++      "resolved": "https://registry.npmjs.org/nanoid/-/nanoid-3.3.11.tgz",
+++      "integrity": "sha512-N8SpfPUnUp1bK+PMYW8qSWdl9U+wwNWI4QKxOYDy9JAro3WMX7p2OeVRF9v+347pnakNevPmiHhNmZ2HbFA76w==",
+++      "dev": true,
+++      "funding": [
+++        {
+++          "type": "github",
+++          "url": "https://github.com/sponsors/ai"
+++        }
+++      ],
+++      "license": "MIT",
+++      "bin": {
+++        "nanoid": "bin/nanoid.cjs"
+++      },
+++      "engines": {
+++        "node": "^10 || ^12 || ^13.7 || ^14 || >=15.0.1"
+++      }
+++    },
+++    "node_modules/node-releases": {
+++      "version": "2.0.27",
+++      "resolved": "https://registry.npmjs.org/node-releases/-/node-releases-2.0.27.tgz",
+++      "integrity": "sha512-nmh3lCkYZ3grZvqcCH+fjmQ7X+H0OeZgP40OierEaAptX4XofMh5kwNbWh7lBduUzCcV/8kZ+NDLCwm2iorIlA==",
+++      "dev": true,
+++      "license": "MIT"
+++    },
+++    "node_modules/picocolors": {
+++      "version": "1.1.1",
+++      "resolved": "https://registry.npmjs.org/picocolors/-/picocolors-1.1.1.tgz",
+++      "integrity": "sha512-xceH2snhtb5M9liqDsmEw56le376mTZkEX/jEb/RxNFyegNul7eNslCXP9FDj/Lcu0X8KEyMceP2ntpaHrDEVA==",
+++      "dev": true,
+++      "license": "ISC"
+++    },
+++    "node_modules/postcss": {
+++      "version": "8.5.6",
+++      "resolved": "https://registry.npmjs.org/postcss/-/postcss-8.5.6.tgz",
+++      "integrity": "sha512-3Ybi1tAuwAP9s0r1UQ2J4n5Y0G05bJkpUIO0/bI9MhwmD70S5aTWbXGBwxHrelT+XM1k6dM0pk+SwNkpTRN7Pg==",
+++      "dev": true,
+++      "funding": [
+++        {
+++          "type": "opencollective",
+++          "url": "https://opencollective.com/postcss/"
+++        },
+++        {
+++          "type": "tidelift",
+++          "url": "https://tidelift.com/funding/github/npm/postcss"
+++        },
+++        {
+++          "type": "github",
+++          "url": "https://github.com/sponsors/ai"
+++        }
+++      ],
+++      "license": "MIT",
+++      "dependencies": {
+++        "nanoid": "^3.3.11",
+++        "picocolors": "^1.1.1",
+++        "source-map-js": "^1.2.1"
+++      },
+++      "engines": {
+++        "node": "^10 || ^12 || >=14"
+++      }
+++    },
+++    "node_modules/react": {
+++      "version": "18.3.1",
+++      "resolved": "https://registry.npmjs.org/react/-/react-18.3.1.tgz",
+++      "integrity": "sha512-wS+hAgJShR0KhEvPJArfuPVN1+Hz1t0Y6n5jLrGQbkb4urgPE/0Rve+1kMB1v/oWgHgm4WIcV+i7F2pTVj+2iQ==",
+++      "license": "MIT",
+++      "dependencies": {
+++        "loose-envify": "^1.1.0"
+++      },
+++      "engines": {
+++        "node": ">=0.10.0"
+++      }
+++    },
+++    "node_modules/react-dom": {
+++      "version": "18.3.1",
+++      "resolved": "https://registry.npmjs.org/react-dom/-/react-dom-18.3.1.tgz",
+++      "integrity": "sha512-5m4nQKp+rZRb09LNH59GM4BxTh9251/ylbKIbpe7TpGxfJ+9kv6BLkLBXIjjspbgbnIBNqlI23tRnTWT0snUIw==",
+++      "license": "MIT",
+++      "dependencies": {
+++        "loose-envify": "^1.1.0",
+++        "scheduler": "^0.23.2"
+++      },
+++      "peerDependencies": {
+++        "react": "^18.3.1"
+++      }
+++    },
+++    "node_modules/react-refresh": {
+++      "version": "0.17.0",
+++      "resolved": "https://registry.npmjs.org/react-refresh/-/react-refresh-0.17.0.tgz",
+++      "integrity": "sha512-z6F7K9bV85EfseRCp2bzrpyQ0Gkw1uLoCel9XBVWPg/TjRj94SkJzUTGfOa4bs7iJvBWtQG0Wq7wnI0syw3EBQ==",
+++      "dev": true,
+++      "license": "MIT",
+++      "engines": {
+++        "node": ">=0.10.0"
+++      }
+++    },
+++    "node_modules/rollup": {
+++      "version": "4.56.0",
+++      "resolved": "https://registry.npmjs.org/rollup/-/rollup-4.56.0.tgz",
+++      "integrity": "sha512-9FwVqlgUHzbXtDg9RCMgodF3Ua4Na6Gau+Sdt9vyCN4RhHfVKX2DCHy3BjMLTDd47ITDhYAnTwGulWTblJSDLg==",
+++      "dev": true,
+++      "license": "MIT",
+++      "dependencies": {
+++        "@types/estree": "1.0.8"
+++      },
+++      "bin": {
+++        "rollup": "dist/bin/rollup"
+++      },
+++      "engines": {
+++        "node": ">=18.0.0",
+++        "npm": ">=8.0.0"
+++      },
+++      "optionalDependencies": {
+++        "@rollup/rollup-android-arm-eabi": "4.56.0",
+++        "@rollup/rollup-android-arm64": "4.56.0",
+++        "@rollup/rollup-darwin-arm64": "4.56.0",
+++        "@rollup/rollup-darwin-x64": "4.56.0",
+++        "@rollup/rollup-freebsd-arm64": "4.56.0",
+++        "@rollup/rollup-freebsd-x64": "4.56.0",
+++        "@rollup/rollup-linux-arm-gnueabihf": "4.56.0",
+++        "@rollup/rollup-linux-arm-musleabihf": "4.56.0",
+++        "@rollup/rollup-linux-arm64-gnu": "4.56.0",
+++        "@rollup/rollup-linux-arm64-musl": "4.56.0",
+++        "@rollup/rollup-linux-loong64-gnu": "4.56.0",
+++        "@rollup/rollup-linux-loong64-musl": "4.56.0",
+++        "@rollup/rollup-linux-ppc64-gnu": "4.56.0",
+++        "@rollup/rollup-linux-ppc64-musl": "4.56.0",
+++        "@rollup/rollup-linux-riscv64-gnu": "4.56.0",
+++        "@rollup/rollup-linux-riscv64-musl": "4.56.0",
+++        "@rollup/rollup-linux-s390x-gnu": "4.56.0",
+++        "@rollup/rollup-linux-x64-gnu": "4.56.0",
+++        "@rollup/rollup-linux-x64-musl": "4.56.0",
+++        "@rollup/rollup-openbsd-x64": "4.56.0",
+++        "@rollup/rollup-openharmony-arm64": "4.56.0",
+++        "@rollup/rollup-win32-arm64-msvc": "4.56.0",
+++        "@rollup/rollup-win32-ia32-msvc": "4.56.0",
+++        "@rollup/rollup-win32-x64-gnu": "4.56.0",
+++        "@rollup/rollup-win32-x64-msvc": "4.56.0",
+++        "fsevents": "~2.3.2"
+++      }
+++    },
+++    "node_modules/scheduler": {
+++      "version": "0.23.2",
+++      "resolved": "https://registry.npmjs.org/scheduler/-/scheduler-0.23.2.tgz",
+++      "integrity": "sha512-UOShsPwz7NrMUqhR6t0hWjFduvOzbtv7toDH1/hIrfRNIDBnnBWd0CwJTGvTpngVlmwGCdP9/Zl/tVrDqcuYzQ==",
+++      "license": "MIT",
+++      "dependencies": {
+++        "loose-envify": "^1.1.0"
+++      }
+++    },
+++    "node_modules/semver": {
+++      "version": "6.3.1",
+++      "resolved": "https://registry.npmjs.org/semver/-/semver-6.3.1.tgz",
+++      "integrity": "sha512-BR7VvDCVHO+q2xBEWskxS6DJE1qRnb7DxzUrogb71CWoSficBxYsiAGd+Kl0mmq/MprG9yArRkyrQxTO6XjMzA==",
+++      "dev": true,
+++      "license": "ISC",
+++      "bin": {
+++        "semver": "bin/semver.js"
+++      }
+++    },
+++    "node_modules/source-map-js": {
+++      "version": "1.2.1",
+++      "resolved": "https://registry.npmjs.org/source-map-js/-/source-map-js-1.2.1.tgz",
+++      "integrity": "sha512-UXWMKhLOwVKb728IUtQPXxfYU+usdybtUrK/8uGE8CQMvrhOpwvzDBwj0QhSL7MQc7vIsISBG8VQ8+IDQxpfQA==",
+++      "dev": true,
+++      "license": "BSD-3-Clause",
+++      "engines": {
+++        "node": ">=0.10.0"
+++      }
+++    },
+++    "node_modules/typescript": {
+++      "version": "5.9.3",
+++      "resolved": "https://registry.npmjs.org/typescript/-/typescript-5.9.3.tgz",
+++      "integrity": "sha512-jl1vZzPDinLr9eUt3J/t7V6FgNEw9QjvBPdysz9KfQDD41fQrC2Y4vKQdiaUpFT4bXlb1RHhLpp8wtm6M5TgSw==",
+++      "dev": true,
+++      "license": "Apache-2.0",
+++      "bin": {
+++        "tsc": "bin/tsc",
+++        "tsserver": "bin/tsserver"
+++      },
+++      "engines": {
+++        "node": ">=14.17"
+++      }
+++    },
+++    "node_modules/update-browserslist-db": {
+++      "version": "1.2.3",
+++      "resolved": "https://registry.npmjs.org/update-browserslist-db/-/update-browserslist-db-1.2.3.tgz",
+++      "integrity": "sha512-Js0m9cx+qOgDxo0eMiFGEueWztz+d4+M3rGlmKPT+T4IS/jP4ylw3Nwpu6cpTTP8R1MAC1kF4VbdLt3ARf209w==",
+++      "dev": true,
+++      "funding": [
+++        {
+++          "type": "opencollective",
+++          "url": "https://opencollective.com/browserslist"
+++        },
+++        {
+++          "type": "tidelift",
+++          "url": "https://tidelift.com/funding/github/npm/browserslist"
+++        },
+++        {
+++          "type": "github",
+++          "url": "https://github.com/sponsors/ai"
+++        }
+++      ],
+++      "license": "MIT",
+++      "dependencies": {
+++        "escalade": "^3.2.0",
+++        "picocolors": "^1.1.1"
+++      },
+++      "bin": {
+++        "update-browserslist-db": "cli.js"
+++      },
+++      "peerDependencies": {
+++        "browserslist": ">= 4.21.0"
+++      }
+++    },
+++    "node_modules/vite": {
+++      "version": "5.4.21",
+++      "resolved": "https://registry.npmjs.org/vite/-/vite-5.4.21.tgz",
+++      "integrity": "sha512-o5a9xKjbtuhY6Bi5S3+HvbRERmouabWbyUcpXXUA1u+GNUKoROi9byOJ8M0nHbHYHkYICiMlqxkg1KkYmm25Sw==",
+++      "dev": true,
+++      "license": "MIT",
+++      "dependencies": {
+++        "esbuild": "^0.21.3",
+++        "postcss": "^8.4.43",
+++        "rollup": "^4.20.0"
+++      },
+++      "bin": {
+++        "vite": "bin/vite.js"
+++      },
+++      "engines": {
+++        "node": "^18.0.0 || >=20.0.0"
+++      },
+++      "funding": {
+++        "url": "https://github.com/vitejs/vite?sponsor=1"
+++      },
+++      "optionalDependencies": {
+++        "fsevents": "~2.3.3"
+++      },
+++      "peerDependencies": {
+++        "@types/node": "^18.0.0 || >=20.0.0",
+++        "less": "*",
+++        "lightningcss": "^1.21.0",
+++        "sass": "*",
+++        "sass-embedded": "*",
+++        "stylus": "*",
+++        "sugarss": "*",
+++        "terser": "^5.4.0"
+++      },
+++      "peerDependenciesMeta": {
+++        "@types/node": {
+++          "optional": true
+++        },
+++        "less": {
+++          "optional": true
+++        },
+++        "lightningcss": {
+++          "optional": true
+++        },
+++        "sass": {
+++          "optional": true
+++        },
+++        "sass-embedded": {
+++          "optional": true
+++        },
+++        "stylus": {
+++          "optional": true
+++        },
+++        "sugarss": {
+++          "optional": true
+++        },
+++        "terser": {
+++          "optional": true
+++        }
+++      }
+++    },
+++    "node_modules/yallist": {
+++      "version": "3.1.1",
+++      "resolved": "https://registry.npmjs.org/yallist/-/yallist-3.1.1.tgz",
+++      "integrity": "sha512-a4UGQaWPH59mOXUYnAG2ewncQS4i4F43Tv3JoAM+s2VDAmS9NsK8GpDMLrCHPksFT7h3K6TOoUNn2pb7RoXx4g==",
+++      "dev": true,
+++      "license": "ISC"
+++    }
+++  }
+++}
++--- frontend/tsconfig.json
+++++ frontend/tsconfig.json
++@@ -0,0 +1,16 @@
+++{
+++  "compilerOptions": {
+++    "target": "ES2020",
+++    "useDefineForClassFields": true,
+++    "lib": ["ES2020", "DOM", "DOM.Iterable"],
+++    "module": "ESNext",
+++    "skipLibCheck": true,
+++    "moduleResolution": "Bundler",
+++    "resolveJsonModule": true,
+++    "isolatedModules": true,
+++    "noEmit": true,
+++    "jsx": "react-jsx",
+++    "strict": true
+++  },
+++  "include": ["src"]
+++}
++--- frontend/vite.config.ts
+++++ frontend/vite.config.ts
++@@ -0,0 +1,9 @@
+++import { defineConfig } from "vite";
+++import react from "@vitejs/plugin-react";
+++
+++export default defineConfig({
+++  plugins: [react()],
+++  server: {
+++    port: 5173,
+++  },
+++});
++--- frontend/src/main.tsx
+++++ frontend/src/main.tsx
++@@ -0,0 +1,10 @@
+++import React from "react";
+++import ReactDOM from "react-dom/client";
+++import App from "./App";
+++import "./styles.css";
+++
+++ReactDOM.createRoot(document.getElementById("root")!).render(
+++  <React.StrictMode>
+++    <App />
+++  </React.StrictMode>
+++);
++--- frontend/src/App.tsx
+++++ frontend/src/App.tsx
++@@ -0,0 +1,721 @@
+++import React, { useCallback, useEffect, useMemo, useRef, useState } from "react";
+++
+++const API_BASE = import.meta.env.VITE_API_BASE || "http://127.0.0.1:8010";
+++
+++type RuntimeInfo = {
+++  container_id?: string | null;
+++  host_port?: number | null;
+++  access_url?: string | null;
+++  started_at?: number | null;
+++  exited_at?: number | null;
+++  exit_code?: number | null;
+++};
+++
+++type CaseResponse = {
+++  case_id: string;
+++  status: string;
+++  stage: string;
+++  commit_sha?: string | null;
+++  runtime?: RuntimeInfo | null;
+++  env_keys?: string[];
+++  error_code?: string | null;
+++  error_message?: string | null;
+++  created_at?: number | null;
+++  updated_at?: number | null;
+++};
+++
+++type LogEntry = {
+++  ts: number | string;
+++  stream: string;
+++  level: string;
+++  line: string;
+++};
+++
+++type Route =
+++  | { type: "create" }
+++  | {
+++      type: "case";
+++      caseId: string;
+++    };
+++
+++const ERROR_EXPLAIN: Record<string, string> = {
+++  PORT_POOL_EXHAUSTED: "端口池已满，请停止旧容器或扩大端口范围。",
+++  DOCKER_BUILD_FAILED: "Docker 镜像构建失败，请检查 Dockerfile 与构建日志。",
+++  DOCKER_API_ERROR: "Docker 守护进程错误，请确认 Docker 正常运行且端口未被占用。",
+++  DOCKERFILE_MISSING: "仓库根目录缺少 Dockerfile。",
+++  GIT_CLONE_FAILED: "Git 克隆失败，请检查仓库地址与权限。",
+++  GIT_CLONE_TIMEOUT: "Git 克隆超时，请重试或使用更小的仓库。",
+++  STARTUP_TIMEOUT: "容器启动超时，请确认监听 0.0.0.0 且 EXPOSE 端口正确。",
+++  CONTAINER_EXIT_NONZERO: "容器非零退出，请查看容器日志。",
+++  UNEXPECTED_ERROR: "未知错误，请查看日志详情。",
+++};
+++
+++const STREAM_LABELS: Record<string, string> = {
+++  build: "构建",
+++  run: "运行",
+++  analyze: "分析",
+++  system: "系统",
+++};
+++
+++const STAGE_LABELS: Record<string, string> = {
+++  clone: "克隆",
+++  build: "构建",
+++  run: "运行",
+++  analyze: "分析",
+++  system: "系统",
+++};
+++
+++const STATUS_LABELS: Record<string, string> = {
+++  PENDING: "待处理",
+++  CLONING: "克隆中",
+++  BUILDING: "构建中",
+++  STARTING: "启动中",
+++  RUNNING: "运行中",
+++  FAILED: "失败",
+++  FINISHED: "已结束",
+++  ANALYZING: "分析中",
+++};
+++
+++function streamLabel(stream: string) {
+++  return STREAM_LABELS[stream] || stream;
+++}
+++
+++function statusLabel(status?: string) {
+++  if (!status) return "-";
+++  const normalized = status.toUpperCase();
+++  const label = STATUS_LABELS[normalized];
+++  return label ? `${label} (${normalized})` : normalized;
+++}
+++
+++function stageLabel(stage?: string) {
+++  if (!stage) return "-";
+++  const normalized = stage.toLowerCase();
+++  const label = STAGE_LABELS[normalized];
+++  return label ? `${label} (${normalized})` : stage;
+++}
+++
+++function joinUrl(base: string, path: string) {
+++  const trimmed = base.replace(/\/+$/, "");
+++  return `${trimmed}${path}`;
+++}
+++
+++function toWsUrl(base: string) {
+++  if (base.startsWith("https://")) {
+++    return base.replace("https://", "wss://");
+++  }
+++  if (base.startsWith("http://")) {
+++    return base.replace("http://", "ws://");
+++  }
+++  return `ws://${base.replace(/^\/*/, "")}`;
+++}
+++
+++function parseRoute(pathname: string): Route {
+++  const match = pathname.match(/^\/cases\/([^/]+)$/);
+++  if (match && match[1]) {
+++    return { type: "case", caseId: match[1] };
+++  }
+++  return { type: "create" };
+++}
+++
+++function useRoute() {
+++  const [route, setRoute] = useState<Route>(() => parseRoute(window.location.pathname));
+++
+++  useEffect(() => {
+++    const onPop = () => setRoute(parseRoute(window.location.pathname));
+++    window.addEventListener("popstate", onPop);
+++    return () => window.removeEventListener("popstate", onPop);
+++  }, []);
+++
+++  const navigate = useCallback((path: string) => {
+++    window.history.pushState({}, "", path);
+++    setRoute(parseRoute(path));
+++  }, []);
+++
+++  return { route, navigate };
+++}
+++
+++function formatTime(ts?: number | null) {
+++  if (!ts) return "-";
+++  const date = new Date(ts * 1000);
+++  return date.toLocaleString();
+++}
+++
+++function statusTone(status?: string) {
+++  const normalized = (status || "").toUpperCase();
+++  if (normalized === "RUNNING") return "running";
+++  if (normalized === "FAILED") return "failed";
+++  if (normalized === "BUILDING" || normalized === "CLONING" || normalized === "STARTING") {
+++    return "working";
+++  }
+++  if (normalized === "FINISHED") return "finished";
+++  return "neutral";
+++}
+++
+++function App() {
+++  const { route, navigate } = useRoute();
+++  const [flashCaseId, setFlashCaseId] = useState<string | null>(null);
+++
+++  return (
+++    <div className="app">
+++      <header className="topbar">
+++        <div className="brand">
+++            <div className="brand-mark">AH</div>
+++          <div>
+++            <div className="brand-title">AntiHub 控制台</div>
+++            <div className="brand-sub">阶段 2 - 创建、观测、对齐</div>
+++          </div>
+++        </div>
+++        <div className="topbar-actions">
+++          <button className="ghost" onClick={() => navigate("/")}>新建案例</button>
+++          <a className="ghost" href="http://127.0.0.1:8010/docs" target="_blank" rel="noreferrer">
+++            API 文档
+++          </a>
+++        </div>
+++      </header>
+++      <main className="main">
+++        {route.type === "create" ? (
+++          <CreateCase
+++            onCreated={(caseId) => {
+++              setFlashCaseId(caseId);
+++              navigate(`/cases/${caseId}`);
+++            }}
+++          />
+++        ) : (
+++          <CaseDetail
+++            caseId={route.caseId}
+++            onBack={() => navigate("/")}
+++            flashCaseId={flashCaseId}
+++            clearFlash={() => setFlashCaseId(null)}
+++          />
+++        )}
+++      </main>
+++    </div>
+++  );
+++}
+++
+++type EnvRow = { id: string; key: string; value: string };
+++
+++function CreateCase({ onCreated }: { onCreated: (caseId: string) => void }) {
+++  const [repoUrl, setRepoUrl] = useState("");
+++  const [ref, setRef] = useState("");
+++  const [autoAnalyze, setAutoAnalyze] = useState(false);
+++  const [envRows, setEnvRows] = useState<EnvRow[]>([
+++    { id: `env-${Date.now()}`, key: "", value: "" },
+++  ]);
+++  const [submitting, setSubmitting] = useState(false);
+++  const [error, setError] = useState<string | null>(null);
+++
+++  const addRow = () => {
+++    setEnvRows((rows) => [...rows, { id: `env-${Date.now()}-${rows.length}`, key: "", value: "" }]);
+++  };
+++
+++  const removeRow = (id: string) => {
+++    setEnvRows((rows) => rows.filter((row) => row.id !== id));
+++  };
+++
+++  const updateRow = (id: string, field: "key" | "value", value: string) => {
+++    setEnvRows((rows) =>
+++      rows.map((row) => (row.id === id ? { ...row, [field]: value } : row))
+++    );
+++  };
+++
+++  const handleSubmit = async (event: React.FormEvent) => {
+++    event.preventDefault();
+++    setError(null);
+++
+++    if (!repoUrl.trim()) {
+++      setError("请填写仓库地址。");
+++      return;
+++    }
+++
+++    const env: Record<string, string> = {};
+++    for (const row of envRows) {
+++      const key = row.key.trim();
+++      if (key) {
+++        env[key] = row.value;
+++      }
+++    }
+++
+++    const payload: Record<string, unknown> = {
+++      repo_url: repoUrl.trim(),
+++      env,
+++      auto_analyze: autoAnalyze,
+++    };
+++    if (ref.trim()) {
+++      payload.ref = ref.trim();
+++    }
+++
+++    setSubmitting(true);
+++    try {
+++      const response = await fetch(joinUrl(API_BASE, "/cases"), {
+++        method: "POST",
+++        headers: { "Content-Type": "application/json" },
+++        body: JSON.stringify(payload),
+++      });
+++      if (!response.ok) {
+++        let message = `请求失败 (${response.status})`;
+++        try {
+++          const body = await response.json();
+++          if (body && body.detail) {
+++            message = body.detail;
+++          }
+++        } catch (err) {
+++          const text = await response.text();
+++          if (text) message = text;
+++        }
+++        setError(message);
+++        return;
+++      }
+++      const data = (await response.json()) as CaseResponse;
+++      setEnvRows([{ id: `env-${Date.now()}`, key: "", value: "" }]);
+++      setRepoUrl("");
+++      setRef("");
+++      onCreated(data.case_id);
+++    } catch (err) {
+++      setError("网络错误，请检查 API 连接。");
+++    } finally {
+++      setSubmitting(false);
+++    }
+++  };
+++
+++  return (
+++    <div className="create-grid">
+++      <section className="card card-hero" style={{ animationDelay: "0.05s" }}>
+++        <div className="section-title">创建案例</div>
+++        <p className="section-sub">几秒内启动仓库并可视化全流程日志。</p>
+++        <form className="form" onSubmit={handleSubmit}>
+++          <label className="field">
+++            <span>仓库地址</span>
+++            <input
+++              type="text"
+++              placeholder="git_url / repo_url"
+++              value={repoUrl}
+++              onChange={(event) => setRepoUrl(event.target.value)}
+++            />
+++          </label>
+++          <div className="field-row">
+++            <label className="field">
+++              <span>Ref/分支</span>
+++              <input
+++                type="text"
+++                placeholder="main / 分支 / 标签"
+++                value={ref}
+++                onChange={(event) => setRef(event.target.value)}
+++              />
+++            </label>
+++            <label className="field checkbox">
+++              <span>自动分析</span>
+++              <input
+++                type="checkbox"
+++                checked={autoAnalyze}
+++                onChange={(event) => setAutoAnalyze(event.target.checked)}
+++              />
+++            </label>
+++          </div>
+++          <div className="env-block">
+++            <div className="env-header">
+++              <div>
+++                <div className="env-title">环境变量</div>
+++                <div className="env-sub">仅提交一次，后端不持久化值。</div>
+++              </div>
+++              <button type="button" className="ghost" onClick={addRow}>
+++                添加一行
+++              </button>
+++            </div>
+++            {envRows.map((row, index) => (
+++              <div className="env-row" key={row.id}>
+++                <input
+++                  type="text"
+++                  placeholder="键名"
+++                  value={row.key}
+++                  onChange={(event) => updateRow(row.id, "key", event.target.value)}
+++                />
+++                <input
+++                  type="password"
+++                  placeholder="值"
+++                  value={row.value}
+++                  onChange={(event) => updateRow(row.id, "value", event.target.value)}
+++                />
+++                <button
+++                  type="button"
+++                  className="danger"
+++                  onClick={() => removeRow(row.id)}
+++                  disabled={envRows.length === 1}
+++                  aria-label={`remove env row ${index + 1}`}
+++                >
+++                  移除
+++                </button>
+++              </div>
+++            ))}
+++          </div>
+++          {error ? <div className="error-banner">{error}</div> : null}
+++          <button className="primary" type="submit" disabled={submitting}>
+++            {submitting ? "创建中..." : "创建案例"}
+++          </button>
+++        </form>
+++      </section>
+++      <section className="card card-glow" style={{ animationDelay: "0.12s" }}>
+++        <div className="section-title">你将获得</div>
+++        <ul className="list">
+++          <li>2 秒内返回 case_id</li>
+++          <li>WS 日志回放 + 实时追踪</li>
+++          <li>访问地址可点击/复制</li>
+++          <li>仅展示 env 键名</li>
+++        </ul>
+++        <div className="note">
+++          <div className="note-title">安全提示</div>
+++          <div className="note-body">
+++            env value 仅用于一次性注入，不会落库或写日志。
+++          </div>
+++        </div>
+++      </section>
+++    </div>
+++  );
+++}
+++
+++function CaseDetail({
+++  caseId,
+++  onBack,
+++  flashCaseId,
+++  clearFlash,
+++}: {
+++  caseId: string;
+++  onBack: () => void;
+++  flashCaseId: string | null;
+++  clearFlash: () => void;
+++}) {
+++  const [caseData, setCaseData] = useState<CaseResponse | null>(null);
+++  const [loadError, setLoadError] = useState<string | null>(null);
+++  const [loading, setLoading] = useState(false);
+++  const statusRef = useRef<string>("");
+++  const fetchLock = useRef(false);
+++
+++  const fetchCase = useCallback(
+++    async (silent = false) => {
+++      if (fetchLock.current) return;
+++      fetchLock.current = true;
+++      if (!silent) {
+++        setLoading(true);
+++      }
+++      setLoadError(null);
+++      try {
+++        const response = await fetch(joinUrl(API_BASE, `/cases/${caseId}`));
+++        if (!response.ok) {
+++          let message = `请求失败 (${response.status})`;
+++          try {
+++            const body = await response.json();
+++            if (body && body.detail) {
+++              message = body.detail;
+++            }
+++          } catch (err) {
+++            const text = await response.text();
+++            if (text) message = text;
+++          }
+++          setLoadError(message);
+++          return;
+++        }
+++        const data = (await response.json()) as CaseResponse;
+++        setCaseData(data);
+++      } catch (err) {
+++        setLoadError("网络错误，请检查 API 连接。");
+++      } finally {
+++        fetchLock.current = false;
+++        if (!silent) {
+++          setLoading(false);
+++        }
+++      }
+++    },
+++    [caseId]
+++  );
+++
+++  useEffect(() => {
+++    fetchCase();
+++  }, [fetchCase]);
+++
+++  useEffect(() => {
+++    statusRef.current = caseData?.status || "";
+++  }, [caseData?.status]);
+++
+++  useEffect(() => {
+++    let timer: number | undefined;
+++    let cancelled = false;
+++    const poll = async () => {
+++      if (cancelled) return;
+++      await fetchCase(true);
+++      const status = statusRef.current.toUpperCase();
+++      const slow = status === "RUNNING" || status === "FAILED" || status === "FINISHED";
+++      const delay = slow ? 5000 : 2000;
+++      timer = window.setTimeout(poll, delay);
+++    };
+++    poll();
+++    return () => {
+++      cancelled = true;
+++      if (timer) window.clearTimeout(timer);
+++    };
+++  }, [fetchCase]);
+++
+++  useEffect(() => {
+++    if (flashCaseId) {
+++      const timer = window.setTimeout(() => clearFlash(), 4000);
+++      return () => window.clearTimeout(timer);
+++    }
+++    return undefined;
+++  }, [flashCaseId, clearFlash]);
+++
+++  const runtime = caseData?.runtime || {};
+++  const envKeys = caseData?.env_keys || [];
+++  const errorCode = caseData?.error_code || undefined;
+++  const errorMessage = caseData?.error_message || undefined;
+++
+++  return (
+++    <div className="detail">
+++      <div className="detail-head">
+++        <button className="ghost" onClick={onBack}>
+++          返回
+++        </button>
+++        <div className="case-id">案例：{caseId}</div>
+++        <button className="ghost" onClick={() => fetchCase()} disabled={loading}>
+++          {loading ? "刷新中..." : "刷新状态"}
+++        </button>
+++      </div>
+++      {flashCaseId ? <div className="success-banner">创建成功：{flashCaseId}</div> : null}
+++      {loadError ? <div className="error-banner">{loadError}</div> : null}
+++      <div className="detail-grid">
+++        <section className="card" style={{ animationDelay: "0.05s" }}>
+++          <div className="section-title">状态</div>
+++          <div className="status-row">
+++            <span className={`badge badge--${statusTone(caseData?.status)}`}>
+++              {statusLabel(caseData?.status)}
+++            </span>
+++            <span className="stage">阶段：{stageLabel(caseData?.stage)}</span>
+++          </div>
+++          <div className="meta">
+++            <div>更新时间：{formatTime(caseData?.updated_at)}</div>
+++            <div>创建时间：{formatTime(caseData?.created_at)}</div>
+++            <div>提交：{caseData?.commit_sha || "-"}</div>
+++          </div>
+++        </section>
+++        <section className="card" style={{ animationDelay: "0.12s" }}>
+++          <div className="section-title">运行信息</div>
+++          <div className="runtime">
+++            <div className="runtime-row">
+++              <span>访问地址</span>
+++              {runtime.access_url ? (
+++                <div className="runtime-actions">
+++                  <a href={runtime.access_url} target="_blank" rel="noreferrer">
+++                    {runtime.access_url}
+++                  </a>
+++                  <CopyButton value={runtime.access_url} />
+++                </div>
+++              ) : (
+++                <span>-</span>
+++              )}
+++            </div>
+++            <div className="runtime-row">
+++              <span>主机端口</span>
+++              <span>{runtime.host_port ?? "-"}</span>
+++            </div>
+++            <div className="runtime-row">
+++              <span>容器 ID</span>
+++              <span className="mono">{runtime.container_id ?? "-"}</span>
+++            </div>
+++          </div>
+++        </section>
+++        <section className="card" style={{ animationDelay: "0.18s" }}>
+++          <div className="section-title">环境变量键</div>
+++          {envKeys.length ? (
+++            <div className="chips">
+++              {envKeys.map((key) => (
+++                <span key={key} className="chip">
+++                  {key}
+++                </span>
+++              ))}
+++            </div>
+++          ) : (
+++            <div className="muted">暂无 env 键名。</div>
+++          )}
+++        </section>
+++        {caseData?.status?.toUpperCase() === "FAILED" ? (
+++          <section className="card error-card" style={{ animationDelay: "0.24s" }}>
+++            <div className="section-title">错误</div>
+++            <div className="error-code">{errorCode || "UNKNOWN"}</div>
+++            <div className="error-message">{errorMessage || "未知错误。"}</div>
+++            <div className="error-hint">
+++              {ERROR_EXPLAIN[errorCode || ""] || "请查看日志详情。"}
+++            </div>
+++          </section>
+++        ) : null}
+++        <section className="card logs" style={{ animationDelay: "0.3s" }}>
+++          <LogPanel caseId={caseId} />
+++        </section>
+++      </div>
+++    </div>
+++  );
+++}
+++
+++function CopyButton({ value }: { value: string }) {
+++  const [copied, setCopied] = useState(false);
+++
+++  const handleCopy = async () => {
+++    try {
+++      await navigator.clipboard.writeText(value);
+++      setCopied(true);
+++      setTimeout(() => setCopied(false), 1500);
+++    } catch (err) {
+++      setCopied(false);
+++    }
+++  };
+++
+++  return (
+++    <button className="ghost" type="button" onClick={handleCopy}>
+++      {copied ? "已复制" : "复制"}
+++    </button>
+++  );
+++}
+++
+++function LogPanel({ caseId }: { caseId: string }) {
+++  const [logs, setLogs] = useState<LogEntry[]>([]);
+++  const [autoScroll, setAutoScroll] = useState(true);
+++  const [status, setStatus] = useState<"connecting" | "open" | "closed" | "error">(
+++    "connecting"
+++  );
+++  const [filters, setFilters] = useState({
+++    build: true,
+++    run: true,
+++    analyze: true,
+++    system: true,
+++  });
+++  const wsRef = useRef<WebSocket | null>(null);
+++  const bottomRef = useRef<HTMLDivElement | null>(null);
+++
+++  const wsUrl = joinUrl(toWsUrl(API_BASE), `/ws/logs/${caseId}`);
+++
+++  const connect = useCallback(() => {
+++    if (wsRef.current) {
+++      wsRef.current.close();
+++    }
+++    setStatus("connecting");
+++    const ws = new WebSocket(wsUrl);
+++    wsRef.current = ws;
+++    ws.onopen = () => setStatus("open");
+++    ws.onclose = () => setStatus("closed");
+++    ws.onerror = () => setStatus("error");
+++    ws.onmessage = (event) => {
+++      let parsed: LogEntry = {
+++        ts: Date.now() / 1000,
+++        stream: "system",
+++        level: "INFO",
+++        line: String(event.data || ""),
+++      };
+++      try {
+++        const data = JSON.parse(event.data as string);
+++        if (data && typeof data === "object") {
+++          parsed = {
+++            ts: data.ts ?? parsed.ts,
+++            stream: data.stream ?? parsed.stream,
+++            level: data.level ?? parsed.level,
+++            line: data.line ?? parsed.line,
+++          };
+++        }
+++      } catch (err) {
+++        parsed = {
+++          ...parsed,
+++          line: String(event.data || ""),
+++        };
+++      }
+++      setLogs((prev) => {
+++        const next = [...prev, parsed];
+++        if (next.length > 2000) {
+++          return next.slice(-2000);
+++        }
+++        return next;
+++      });
+++    };
+++  }, [wsUrl]);
+++
+++  useEffect(() => {
+++    setLogs([]);
+++    connect();
+++    return () => {
+++      if (wsRef.current) {
+++        wsRef.current.close();
+++      }
+++    };
+++  }, [connect, caseId]);
+++
+++  useEffect(() => {
+++    if (!autoScroll) return;
+++    if (bottomRef.current) {
+++      bottomRef.current.scrollIntoView({ behavior: "auto" });
+++    }
+++  }, [logs, autoScroll]);
+++
+++  const visibleLogs = useMemo(() => {
+++    return logs.filter((entry) => {
+++      const key = entry.stream as keyof typeof filters;
+++      if (filters[key] === undefined) return true;
+++      return filters[key];
+++    });
+++  }, [logs, filters]);
+++
+++  return (
+++    <div className="logs-panel">
+++      <div className="logs-header">
+++        <div>
+++          <div className="section-title">日志</div>
+++          <div className={`ws-status ws-${status}`}>
+++            {status === "open" ? "已连接" : status === "connecting" ? "连接中" : "已断开"}
+++          </div>
+++        </div>
+++        <div className="logs-actions">
+++          <button className="ghost" type="button" onClick={() => setAutoScroll((value) => !value)}>
+++            {autoScroll ? "暂停滚动" : "自动滚动"}
+++          </button>
+++          <button className="ghost" type="button" onClick={connect}>
+++            重连
+++          </button>
+++        </div>
+++      </div>
+++      <div className="filters">
+++        {(
+++          [
+++            { id: "build", label: "构建" },
+++            { id: "run", label: "运行" },
+++            { id: "analyze", label: "分析" },
+++            { id: "system", label: "系统" },
+++          ] as const
+++        ).map((item) => (
+++          <label key={item.id} className="filter">
+++            <input
+++              type="checkbox"
+++              checked={filters[item.id]}
+++              onChange={() =>
+++                setFilters((prev) => ({
+++                  ...prev,
+++                  [item.id]: !prev[item.id],
+++                }))
+++              }
+++            />
+++            <span>{item.label}</span>
+++          </label>
+++        ))}
+++      </div>
+++      <div className="log-list">
+++        {visibleLogs.length ? (
+++          visibleLogs.map((entry, index) => (
+++            <div className={`log-line level-${entry.level?.toLowerCase()}`} key={`${index}-${entry.ts}`}>
+++              <span className="log-ts">{typeof entry.ts === "number" ? formatTime(entry.ts) : entry.ts}</span>
+++              <span className={`log-stream stream-${entry.stream}`}>{streamLabel(entry.stream)}</span>
+++              <span className="log-msg">{entry.line}</span>
+++            </div>
+++          ))
+++        ) : (
+++          <div className="muted">暂无日志。</div>
+++        )}
+++        <div ref={bottomRef} />
+++      </div>
+++    </div>
+++  );
+++}
+++
+++export default App;
++--- frontend/src/styles.css
+++++ frontend/src/styles.css
++@@ -0,0 +1,600 @@
+++@import url("https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500&family=Space+Grotesk:wght@400;500;600;700&display=swap");
+++
+++:root {
+++  --bg: #f7f0e6;
+++  --bg-strong: #efe2d0;
+++  --ink: #1f1b16;
+++  --muted: #6b5f52;
+++  --accent: #1e6f7a;
+++  --accent-strong: #16555e;
+++  --accent-warm: #e07a5f;
+++  --card: #ffffffcc;
+++  --border: #e2d1bf;
+++  --shadow: 0 16px 40px rgba(34, 24, 16, 0.08);
+++}
+++
+++* {
+++  box-sizing: border-box;
+++}
+++
+++body {
+++  margin: 0;
+++  font-family: "Space Grotesk", "Helvetica Neue", "Noto Sans", sans-serif;
+++  color: var(--ink);
+++  background-color: var(--bg);
+++  min-height: 100vh;
+++  background-image:
+++    radial-gradient(circle at 20% 20%, rgba(224, 122, 95, 0.16), transparent 55%),
+++    radial-gradient(circle at 80% 10%, rgba(30, 111, 122, 0.14), transparent 50%),
+++    linear-gradient(160deg, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.1));
+++}
+++
+++body::before,
+++body::after {
+++  content: "";
+++  position: fixed;
+++  inset: 0;
+++  pointer-events: none;
+++}
+++
+++body::before {
+++  background-image: radial-gradient(rgba(31, 27, 22, 0.05) 1px, transparent 1px);
+++  background-size: 22px 22px;
+++  opacity: 0.45;
+++}
+++
+++body::after {
+++  background: linear-gradient(120deg, rgba(30, 111, 122, 0.12), transparent 60%);
+++  opacity: 0.5;
+++}
+++
+++.app {
+++  min-height: 100vh;
+++  position: relative;
+++}
+++
+++.topbar {
+++  display: flex;
+++  justify-content: space-between;
+++  align-items: center;
+++  padding: 24px 32px;
+++  border-bottom: 1px solid var(--border);
+++  backdrop-filter: blur(6px);
+++}
+++
+++.brand {
+++  display: flex;
+++  align-items: center;
+++  gap: 16px;
+++}
+++
+++.brand-mark {
+++  width: 48px;
+++  height: 48px;
+++  border-radius: 16px;
+++  background: linear-gradient(130deg, var(--accent), var(--accent-warm));
+++  color: white;
+++  display: grid;
+++  place-items: center;
+++  font-weight: 700;
+++  letter-spacing: 1px;
+++}
+++
+++.brand-title {
+++  font-size: 20px;
+++  font-weight: 700;
+++}
+++
+++.brand-sub {
+++  color: var(--muted);
+++  font-size: 14px;
+++}
+++
+++.topbar-actions {
+++  display: flex;
+++  gap: 12px;
+++}
+++
+++.main {
+++  max-width: 1200px;
+++  margin: 0 auto;
+++  padding: 32px;
+++  animation: fadeIn 0.5s ease;
+++}
+++
+++@keyframes fadeIn {
+++  from {
+++    opacity: 0;
+++    transform: translateY(6px);
+++  }
+++  to {
+++    opacity: 1;
+++    transform: translateY(0);
+++  }
+++}
+++
+++.card {
+++  background: var(--card);
+++  border: 1px solid var(--border);
+++  border-radius: 20px;
+++  padding: 24px;
+++  box-shadow: var(--shadow);
+++  animation: floatIn 0.6s ease both;
+++}
+++
+++.card-hero {
+++  border: 1px solid rgba(30, 111, 122, 0.25);
+++}
+++
+++.card-glow {
+++  background: linear-gradient(150deg, rgba(255, 255, 255, 0.9), rgba(244, 234, 220, 0.9));
+++}
+++
+++@keyframes floatIn {
+++  from {
+++    opacity: 0;
+++    transform: translateY(12px);
+++  }
+++  to {
+++    opacity: 1;
+++    transform: translateY(0);
+++  }
+++}
+++
+++.section-title {
+++  font-size: 18px;
+++  font-weight: 600;
+++  margin-bottom: 8px;
+++}
+++
+++.section-sub {
+++  color: var(--muted);
+++  margin-bottom: 20px;
+++}
+++
+++.create-grid {
+++  display: grid;
+++  grid-template-columns: 2fr 1fr;
+++  gap: 24px;
+++}
+++
+++.form {
+++  display: flex;
+++  flex-direction: column;
+++  gap: 16px;
+++}
+++
+++.field {
+++  display: flex;
+++  flex-direction: column;
+++  gap: 6px;
+++  font-size: 14px;
+++  color: var(--muted);
+++}
+++
+++.field input {
+++  padding: 12px 14px;
+++  border-radius: 12px;
+++  border: 1px solid var(--border);
+++  font-size: 15px;
+++}
+++
+++.field-row {
+++  display: grid;
+++  grid-template-columns: 1fr auto;
+++  gap: 12px;
+++  align-items: end;
+++}
+++
+++.checkbox {
+++  align-items: center;
+++  flex-direction: row;
+++  gap: 12px;
+++}
+++
+++.checkbox input {
+++  width: 20px;
+++  height: 20px;
+++}
+++
+++.env-block {
+++  background: rgba(244, 234, 220, 0.6);
+++  border-radius: 16px;
+++  padding: 16px;
+++  border: 1px dashed rgba(30, 111, 122, 0.2);
+++  display: flex;
+++  flex-direction: column;
+++  gap: 12px;
+++}
+++
+++.env-header {
+++  display: flex;
+++  justify-content: space-between;
+++  align-items: center;
+++}
+++
+++.env-title {
+++  font-weight: 600;
+++}
+++
+++.env-sub {
+++  color: var(--muted);
+++  font-size: 13px;
+++}
+++
+++.env-row {
+++  display: grid;
+++  grid-template-columns: 1fr 1fr auto;
+++  gap: 8px;
+++}
+++
+++.env-row input {
+++  padding: 10px 12px;
+++  border-radius: 10px;
+++  border: 1px solid var(--border);
+++}
+++
+++button {
+++  font-family: "Space Grotesk", "Helvetica Neue", sans-serif;
+++  border: none;
+++  cursor: pointer;
+++}
+++
+++button.primary {
+++  background: var(--accent);
+++  color: white;
+++  padding: 12px 18px;
+++  border-radius: 12px;
+++  font-weight: 600;
+++  transition: background 0.2s ease;
+++}
+++
+++button.primary:hover {
+++  background: var(--accent-strong);
+++}
+++
+++button.ghost {
+++  background: transparent;
+++  color: var(--accent-strong);
+++  border: 1px solid rgba(30, 111, 122, 0.3);
+++  padding: 8px 14px;
+++  border-radius: 999px;
+++}
+++
+++button.danger {
+++  background: rgba(224, 122, 95, 0.12);
+++  color: #8d3b2a;
+++  border: 1px solid rgba(224, 122, 95, 0.4);
+++  padding: 8px 10px;
+++  border-radius: 10px;
+++}
+++
+++button:disabled {
+++  opacity: 0.6;
+++  cursor: not-allowed;
+++}
+++
+++.list {
+++  margin: 0;
+++  padding-left: 18px;
+++  color: var(--muted);
+++  display: flex;
+++  flex-direction: column;
+++  gap: 8px;
+++}
+++
+++.note {
+++  margin-top: 24px;
+++  background: rgba(30, 111, 122, 0.08);
+++  padding: 16px;
+++  border-radius: 14px;
+++}
+++
+++.note-title {
+++  font-weight: 600;
+++  margin-bottom: 6px;
+++}
+++
+++.note-body {
+++  color: var(--muted);
+++  font-size: 14px;
+++}
+++
+++.detail {
+++  display: flex;
+++  flex-direction: column;
+++  gap: 20px;
+++}
+++
+++.detail-head {
+++  display: flex;
+++  justify-content: space-between;
+++  align-items: center;
+++}
+++
+++.case-id {
+++  font-weight: 600;
+++  font-size: 16px;
+++}
+++
+++.detail-grid {
+++  display: grid;
+++  grid-template-columns: repeat(12, 1fr);
+++  gap: 20px;
+++}
+++
+++.detail-grid > .card {
+++  grid-column: span 4;
+++}
+++
+++.detail-grid > .card.logs,
+++.detail-grid > .card.error-card {
+++  grid-column: span 12;
+++}
+++
+++.detail-grid > .card:nth-child(1) {
+++  grid-column: span 4;
+++}
+++
+++.detail-grid > .card:nth-child(2) {
+++  grid-column: span 4;
+++}
+++
+++.detail-grid > .card:nth-child(3) {
+++  grid-column: span 4;
+++}
+++
+++.status-row {
+++  display: flex;
+++  align-items: center;
+++  gap: 12px;
+++  margin-bottom: 12px;
+++}
+++
+++.badge {
+++  padding: 6px 12px;
+++  border-radius: 999px;
+++  font-size: 13px;
+++  font-weight: 600;
+++  text-transform: uppercase;
+++}
+++
+++.badge--running {
+++  background: rgba(30, 111, 122, 0.2);
+++  color: var(--accent-strong);
+++}
+++
+++.badge--working {
+++  background: rgba(224, 122, 95, 0.18);
+++  color: #8d3b2a;
+++}
+++
+++.badge--failed {
+++  background: rgba(186, 53, 36, 0.18);
+++  color: #8d1f12;
+++}
+++
+++.badge--finished {
+++  background: rgba(120, 140, 90, 0.2);
+++  color: #2f4b24;
+++}
+++
+++.badge--neutral {
+++  background: rgba(107, 95, 82, 0.2);
+++  color: var(--muted);
+++}
+++
+++.stage {
+++  color: var(--muted);
+++}
+++
+++.meta {
+++  display: grid;
+++  gap: 4px;
+++  color: var(--muted);
+++  font-size: 14px;
+++}
+++
+++.runtime {
+++  display: grid;
+++  gap: 12px;
+++}
+++
+++.runtime-row {
+++  display: flex;
+++  justify-content: space-between;
+++  gap: 12px;
+++  color: var(--muted);
+++}
+++
+++.runtime-actions {
+++  display: flex;
+++  gap: 8px;
+++  align-items: center;
+++}
+++
+++.runtime-actions a {
+++  color: var(--accent-strong);
+++  text-decoration: none;
+++}
+++
+++.chips {
+++  display: flex;
+++  flex-wrap: wrap;
+++  gap: 8px;
+++}
+++
+++.chip {
+++  background: rgba(30, 111, 122, 0.16);
+++  color: var(--accent-strong);
+++  padding: 6px 10px;
+++  border-radius: 999px;
+++  font-size: 13px;
+++}
+++
+++.error-card {
+++  border: 1px solid rgba(186, 53, 36, 0.3);
+++  background: rgba(255, 236, 234, 0.9);
+++}
+++
+++.error-code {
+++  font-size: 20px;
+++  font-weight: 700;
+++}
+++
+++.error-message {
+++  margin-top: 8px;
+++  color: #8d1f12;
+++}
+++
+++.error-hint {
+++  margin-top: 8px;
+++  color: var(--muted);
+++}
+++
+++.logs {
+++  padding: 0;
+++}
+++
+++.logs-panel {
+++  display: flex;
+++  flex-direction: column;
+++  gap: 12px;
+++}
+++
+++.logs-header {
+++  display: flex;
+++  justify-content: space-between;
+++  align-items: center;
+++  padding: 24px 24px 0;
+++}
+++
+++.logs-actions {
+++  display: flex;
+++  gap: 10px;
+++}
+++
+++.filters {
+++  display: flex;
+++  gap: 12px;
+++  padding: 0 24px;
+++  flex-wrap: wrap;
+++}
+++
+++.filter {
+++  display: flex;
+++  gap: 6px;
+++  align-items: center;
+++  font-size: 13px;
+++  color: var(--muted);
+++}
+++
+++.log-list {
+++  background: #1d1914;
+++  color: #f5efe6;
+++  border-radius: 0 0 20px 20px;
+++  padding: 18px 24px 24px;
+++  font-family: "IBM Plex Mono", "Courier New", monospace;
+++  max-height: 360px;
+++  overflow-y: auto;
+++}
+++
+++.log-line {
+++  display: grid;
+++  grid-template-columns: 160px 80px 1fr;
+++  gap: 12px;
+++  font-size: 12px;
+++  padding: 4px 0;
+++}
+++
+++.log-ts {
+++  color: #a9a096;
+++}
+++
+++.log-stream {
+++  text-transform: uppercase;
+++  font-size: 11px;
+++  padding: 2px 8px;
+++  border-radius: 999px;
+++  justify-self: start;
+++  background: rgba(255, 255, 255, 0.1);
+++}
+++
+++.log-msg {
+++  white-space: pre-wrap;
+++}
+++
+++.ws-status {
+++  font-size: 12px;
+++  color: var(--muted);
+++}
+++
+++.ws-open {
+++  color: #b6f2db;
+++}
+++
+++.ws-connecting {
+++  color: #ffd580;
+++}
+++
+++.ws-closed,
+++.ws-error {
+++  color: #f2a7a0;
+++}
+++
+++.muted {
+++  color: var(--muted);
+++}
+++
+++.mono {
+++  font-family: "IBM Plex Mono", "Courier New", monospace;
+++}
+++
+++.error-banner,
+++.success-banner {
+++  padding: 12px 16px;
+++  border-radius: 12px;
+++  font-size: 14px;
+++}
+++
+++.error-banner {
+++  background: rgba(186, 53, 36, 0.12);
+++  border: 1px solid rgba(186, 53, 36, 0.3);
+++  color: #8d1f12;
+++}
+++
+++.success-banner {
+++  background: rgba(30, 111, 122, 0.12);
+++  border: 1px solid rgba(30, 111, 122, 0.3);
+++  color: var(--accent-strong);
+++}
+++
+++@media (max-width: 980px) {
+++  .create-grid {
+++    grid-template-columns: 1fr;
+++  }
+++
+++  .detail-grid {
+++    grid-template-columns: 1fr;
+++  }
+++
+++  .detail-grid > .card {
+++    grid-column: span 12;
+++  }
+++
+++  .topbar {
+++    flex-direction: column;
+++    gap: 16px;
+++    align-items: flex-start;
+++  }
+++
+++  .detail-head {
+++    flex-direction: column;
+++    align-items: flex-start;
+++    gap: 12px;
+++  }
+++
+++  .log-line {
+++    grid-template-columns: 1fr;
+++  }
+++}
+diff -ruN '--exclude=.devlogs' '--exclude=venv' '--exclude=node_modules' '--exclude=__pycache__' /tmp/AntiHub.phase3.base/phase3.patch /home/user2643/code/AntiHub/phase3.patch
+--- /tmp/AntiHub.phase3.base/phase3.patch	1970-01-01 08:00:00.000000000 +0800
++++ /home/user2643/code/AntiHub/phase3.patch	2026-01-22 21:52:39.967886519 +0800
+@@ -0,0 +1,1437 @@
++--- config.py
+++++ config.py
++@@ -22,6 +22,9 @@
++     ).split(",")
++     if origin.strip()
++ ]
+++
+++CASE_LABEL_KEY = os.getenv("CASE_LABEL_KEY", "antihub.case_id")
+++CASE_LABEL_MANAGED = os.getenv("CASE_LABEL_MANAGED", "antihub.managed")
++ 
++ GIT_CLONE_TIMEOUT_SECONDS = int(os.getenv("GIT_CLONE_TIMEOUT_SECONDS", "120"))
++ DOCKER_BUILD_TIMEOUT_SECONDS = int(os.getenv("DOCKER_BUILD_TIMEOUT_SECONDS", "1800"))
++--- docker_ops.py
+++++ docker_ops.py
++@@ -66,12 +66,14 @@
++     image: str,
++     container_port: int,
++     environment: Optional[Dict[str, str]] = None,
+++    labels: Optional[Dict[str, str]] = None,
++ ) -> Tuple[str, int]:
++     container = client.containers.run(
++         image,
++         detach=True,
++         ports={f"{container_port}/tcp": None},
++         environment=environment or {},
+++        labels=labels or {},
++     )
++     container.reload()
++     ports = container.attrs.get("NetworkSettings", {}).get("Ports", {})
++@@ -88,12 +90,14 @@
++     container_port: int,
++     host_port: int,
++     environment: Optional[Dict[str, str]] = None,
+++    labels: Optional[Dict[str, str]] = None,
++ ) -> str:
++     container = client.containers.run(
++         image,
++         detach=True,
++         ports={f"{container_port}/tcp": host_port},
++         environment=environment or {},
+++        labels=labels or {},
++     )
++     return container.id
++ 
++--- main.py
+++++ main.py
++@@ -1,15 +1,37 @@
++ from __future__ import annotations
++ 
+++import json
++ import time
++ import uuid
++ from typing import Any, Dict, List, Optional
++ 
++-from fastapi import FastAPI, HTTPException, WebSocket, WebSocketDisconnect
+++import docker
+++from fastapi import Body, FastAPI, HTTPException, Query, WebSocket, WebSocketDisconnect
++ from fastapi.middleware.cors import CORSMiddleware
+++from fastapi.responses import PlainTextResponse, StreamingResponse
++ from pydantic import BaseModel, ConfigDict, Field
++ 
++-from config import CORS_ORIGINS, DEFAULT_BRANCH
++-from storage import decode_log_entry, get_async_redis_client, get_case, get_logs, log_channel, set_case
+++from config import (
+++    CASE_LABEL_KEY,
+++    CASE_LABEL_MANAGED,
+++    CORS_ORIGINS,
+++    DEFAULT_BRANCH,
+++    PUBLIC_HOST,
+++    STARTUP_TIMEOUT_SECONDS,
+++)
+++from docker_ops import wait_for_container_running
+++from storage import (
+++    append_log,
+++    decode_log_entry,
+++    get_async_redis_client,
+++    get_case,
+++    get_logs,
+++    get_logs_slice,
+++    list_case_ids,
+++    log_channel,
+++    set_case,
+++    update_case,
+++)
++ from worker import analyze_case, build_and_run
++ 
++ app = FastAPI(title="Agent Platform", version="0.2.0")
++@@ -28,6 +50,7 @@
++     "BUILDING": "build",
++     "STARTING": "run",
++     "RUNNING": "run",
+++    "STOPPED": "run",
++     "FINISHED": "run",
++     "FAILED": "system",
++     "ANALYZING": "analyze",
++@@ -61,6 +84,21 @@
++     model_config = ConfigDict(extra="ignore")
++ 
++ 
+++class CaseActionRequest(BaseModel):
+++    action: str = Field(..., description="stop | restart | retry | archive")
+++    env: Dict[str, str] = Field(
+++        default_factory=dict,
+++        description="Optional env override for retry (values are not stored).",
+++    )
+++
+++
+++class CaseRetryRequest(BaseModel):
+++    env: Dict[str, str] = Field(
+++        default_factory=dict,
+++        description="Optional env override for retry (values are not stored).",
+++    )
+++
+++
++ class RuntimeInfo(BaseModel):
++     container_id: Optional[str] = None
++     host_port: Optional[int] = None
++@@ -81,6 +119,10 @@
++     error_message: Optional[str] = None
++     created_at: Optional[float] = None
++     updated_at: Optional[float] = None
+++    archived: bool = False
+++    archived_at: Optional[float] = None
+++    attempt: Optional[int] = None
+++    retry_of: Optional[str] = None
++     repo_url: Optional[str] = None
++     ref: Optional[str] = None
++     branch: Optional[str] = None
++@@ -93,6 +135,20 @@
++     report_ready: bool = False
++ 
++ 
+++class CaseListResponse(BaseModel):
+++    items: List[CaseResponse]
+++    total: int
+++    page: int
+++    size: int
+++
+++
+++class CaseActionResponse(BaseModel):
+++    case_id: str
+++    action: str
+++    status: str
+++    message: str
+++
+++
++ def normalize_stage(raw_stage: Optional[str], status: Optional[str]) -> str:
++     if raw_stage:
++         normalized = raw_stage.lower()
++@@ -142,6 +198,10 @@
++         error_message=error_message,
++         created_at=data.get("created_at"),
++         updated_at=data.get("updated_at"),
+++        archived=bool(data.get("archived", False)),
+++        archived_at=data.get("archived_at"),
+++        attempt=data.get("attempt"),
+++        retry_of=data.get("retry_of"),
++         repo_url=data.get("repo_url"),
++         ref=ref_value,
++         branch=branch_value,
++@@ -155,11 +215,91 @@
++     )
++ 
++ 
+++def matches_query(case_id: str, data: Dict[str, Any], query: str) -> bool:
+++    q = query.lower().strip()
+++    if not q:
+++        return True
+++    haystacks = [
+++        case_id,
+++        str(data.get("repo_url") or ""),
+++        str(data.get("ref") or data.get("branch") or ""),
+++    ]
+++    return any(q in (value or "").lower() for value in haystacks)
+++
+++
+++def get_case_or_404(case_id: str) -> Dict[str, Any]:
+++    data = get_case(case_id) or {}
+++    if not data:
+++        raise HTTPException(status_code=404, detail="Case not found")
+++    return data
+++
+++
+++def get_managed_container(case_id: str, container_id: str) -> docker.models.containers.Container:
+++    client = docker.from_env()
+++    container = client.containers.get(container_id)
+++    labels = container.labels or {}
+++    if labels.get(CASE_LABEL_KEY) != case_id or labels.get(CASE_LABEL_MANAGED) != "true":
+++        raise HTTPException(status_code=400, detail="Container is not managed by AntiHub")
+++    return container
+++
+++
+++def append_system_log(case_id: str, line: str, level: str = "INFO") -> None:
+++    append_log(case_id, {"ts": time.time(), "stream": "system", "level": level, "line": line})
+++
+++
+++def build_jsonl(entries: List[Dict[str, Any]]) -> str:
+++    return "\n".join(json.dumps(entry, ensure_ascii=False) for entry in entries) + ("\n" if entries else "")
+++
+++
+++def resolve_host_port(container: docker.models.containers.Container, container_port: Optional[int]) -> Optional[int]:
+++    ports = container.attrs.get("NetworkSettings", {}).get("Ports", {}) or {}
+++    if container_port:
+++        binding = ports.get(f"{container_port}/tcp")
+++        if binding:
+++            return int(binding[0]["HostPort"])
+++    for binding in ports.values():
+++        if binding:
+++            return int(binding[0]["HostPort"])
+++    return None
+++
+++
++ @app.get("/healthz")
++ async def healthz() -> dict:
++     return {"status": "ok"}
++ 
++ 
+++@app.get("/cases", response_model=CaseListResponse)
+++async def list_cases(
+++    q: Optional[str] = Query(None, description="Search by case_id/repo/ref"),
+++    status: Optional[str] = Query(None, description="Filter by status"),
+++    stage: Optional[str] = Query(None, description="Filter by stage"),
+++    page: int = Query(1, ge=1, description="Page number"),
+++    size: int = Query(20, ge=1, le=200, description="Page size"),
+++    include_archived: bool = Query(False, description="Include archived cases"),
+++) -> CaseListResponse:
+++    ids = list_case_ids()
+++    items: List[CaseResponse] = []
+++    for case_id in ids:
+++        data = get_case(case_id) or {}
+++        if not data:
+++            continue
+++        if not include_archived and bool(data.get("archived", False)):
+++            continue
+++        if status and (data.get("status") or "").upper() != status.upper():
+++            continue
+++        normalized_stage = normalize_stage(data.get("stage"), data.get("status"))
+++        if stage and normalized_stage != stage.lower():
+++            continue
+++        if q and not matches_query(case_id, data, q):
+++            continue
+++        items.append(build_case_response(case_id, data))
+++    items.sort(key=lambda item: item.updated_at or item.created_at or 0, reverse=True)
+++    total = len(items)
+++    start = (page - 1) * size
+++    end = start + size
+++    return CaseListResponse(items=items[start:end], total=total, page=page, size=size)
+++
+++
++ @app.post("/cases", response_model=CaseResponse)
++ async def create_case(payload: CaseCreateRequest) -> CaseResponse:
++     repo_url = payload.repo_url or payload.git_url
++@@ -181,6 +321,10 @@
++         "report_ready": False,
++         "created_at": now,
++         "updated_at": now,
+++        "archived": False,
+++        "archived_at": None,
+++        "attempt": 1,
+++        "retry_of": None,
++         "runtime": {
++             "container_id": None,
++             "host_port": None,
++@@ -204,13 +348,143 @@
++ 
++ @app.get("/cases/{case_id}", response_model=CaseResponse)
++ async def get_case_status(case_id: str) -> CaseResponse:
++-    data = get_case(case_id) or {}
++-    if not data:
++-        raise HTTPException(status_code=404, detail="Case not found")
+++    data = get_case_or_404(case_id)
++     data.pop("case_id", None)
++     return build_case_response(case_id, data)
++ 
++ 
+++def handle_case_action(case_id: str, action: str, env: Optional[Dict[str, str]] = None) -> CaseActionResponse:
+++    data = get_case_or_404(case_id)
+++    action_key = action.lower()
+++    runtime = data.get("runtime") or {}
+++    container_id = data.get("container_id") or runtime.get("container_id")
+++
+++    if action_key == "stop":
+++        if not container_id:
+++            raise HTTPException(status_code=400, detail="No running container for case")
+++        container = get_managed_container(case_id, container_id)
+++        try:
+++            container.stop(timeout=10)
+++        except Exception:
+++            container.kill()
+++        container.reload()
+++        exit_code = container.attrs.get("State", {}).get("ExitCode")
+++        update_case(
+++            case_id,
+++            {
+++                "status": "STOPPED",
+++                "stage": "run",
+++                "error_code": "STOPPED_BY_USER",
+++                "error_message": "Stopped by user",
+++                "runtime": {
+++                    **runtime,
+++                    "exited_at": time.time(),
+++                    "exit_code": exit_code,
+++                },
+++            },
+++        )
+++        append_system_log(case_id, "Container stopped by user")
+++        return CaseActionResponse(case_id=case_id, action=action_key, status="STOPPED", message="Stopped")
+++
+++    if action_key == "restart":
+++        if not container_id:
+++            raise HTTPException(status_code=400, detail="No existing container to restart")
+++        container = get_managed_container(case_id, container_id)
+++        container.start()
+++        wait_for_container_running(docker.from_env(), container_id, STARTUP_TIMEOUT_SECONDS)
+++        container.reload()
+++        container_port = data.get("container_port")
+++        host_port = data.get("host_port") or runtime.get("host_port") or resolve_host_port(container, container_port)
+++        access_url = data.get("access_url") or runtime.get("access_url")
+++        if host_port and not access_url:
+++            access_url = f"http://{PUBLIC_HOST}:{host_port}"
+++        update_case(
+++            case_id,
+++            {
+++                "status": "RUNNING",
+++                "stage": "run",
+++                "error_code": None,
+++                "error_message": None,
+++                "container_id": container_id,
+++                "host_port": host_port,
+++                "access_url": access_url,
+++                "runtime": {
+++                    **runtime,
+++                    "container_id": container_id,
+++                    "host_port": host_port,
+++                    "access_url": access_url,
+++                    "started_at": time.time(),
+++                    "exited_at": None,
+++                    "exit_code": None,
+++                },
+++            },
+++        )
+++        append_system_log(case_id, "Container restarted")
+++        return CaseActionResponse(case_id=case_id, action=action_key, status="RUNNING", message="Restarted")
+++
+++    if action_key == "retry":
+++        repo_url = data.get("repo_url")
+++        if not repo_url:
+++            raise HTTPException(status_code=400, detail="Missing repo_url for retry")
+++        ref = data.get("ref") or data.get("branch") or DEFAULT_BRANCH
+++        container_port = data.get("container_port")
+++        retry_env = env or {}
+++        env_keys = sorted(retry_env.keys()) if retry_env else sorted(data.get("env_keys") or [])
+++        attempt = int(data.get("attempt") or 1) + 1
+++        retry_of = data.get("retry_of") or case_id
+++        update_case(
+++            case_id,
+++            {
+++                "status": "PENDING",
+++                "stage": "system",
+++                "error_code": None,
+++                "error_message": None,
+++                "env_keys": env_keys,
+++                "attempt": attempt,
+++                "retry_of": retry_of,
+++            },
+++        )
+++        append_system_log(case_id, "Retry requested")
+++        build_and_run.delay(case_id, repo_url, ref, container_port, retry_env, False)
+++        return CaseActionResponse(case_id=case_id, action=action_key, status="PENDING", message="Retry started")
+++
+++    if action_key == "archive":
+++        update_case(case_id, {"archived": True, "archived_at": time.time()})
+++        append_system_log(case_id, "Case archived")
+++        return CaseActionResponse(case_id=case_id, action=action_key, status="ARCHIVED", message="Archived")
+++
+++    raise HTTPException(status_code=400, detail="Unsupported action")
+++
+++
+++@app.post("/cases/{case_id}/actions", response_model=CaseActionResponse)
+++async def case_actions(case_id: str, payload: CaseActionRequest) -> CaseActionResponse:
+++    return handle_case_action(case_id, payload.action, payload.env)
+++
+++
+++@app.post("/cases/{case_id}/stop", response_model=CaseActionResponse)
+++async def case_stop(case_id: str) -> CaseActionResponse:
+++    return handle_case_action(case_id, "stop")
+++
+++
+++@app.post("/cases/{case_id}/restart", response_model=CaseActionResponse)
+++async def case_restart(case_id: str) -> CaseActionResponse:
+++    return handle_case_action(case_id, "restart")
+++
+++
+++@app.post("/cases/{case_id}/retry", response_model=CaseActionResponse)
+++async def case_retry(
+++    case_id: str,
+++    payload: CaseRetryRequest = Body(default_factory=CaseRetryRequest),
+++) -> CaseActionResponse:
+++    env = payload.env
+++    return handle_case_action(case_id, "retry", env)
+++
+++
+++@app.post("/cases/{case_id}/archive", response_model=CaseActionResponse)
+++async def case_archive(case_id: str) -> CaseActionResponse:
+++    return handle_case_action(case_id, "archive")
+++
+++
++ @app.post("/cases/{case_id}/analyze")
++ async def trigger_analyze(case_id: str) -> Dict[str, str]:
++     data = get_case(case_id)
++@@ -254,5 +528,27 @@
++ 
++ 
++ @app.get("/cases/{case_id}/logs")
++-async def http_logs(case_id: str) -> List[Dict[str, Any]]:
++-    return get_logs(case_id)
+++async def http_logs(
+++    case_id: str,
+++    limit: int = Query(200, ge=1, le=2000, description="Number of lines from tail"),
+++    offset: int = Query(0, ge=0, description="Offset from tail"),
+++    format: Optional[str] = Query(None, description="json | jsonl"),
+++) -> Any:
+++    get_case_or_404(case_id)
+++    entries = get_logs_slice(case_id, offset=offset, limit=limit)
+++    if format == "jsonl":
+++        return PlainTextResponse(build_jsonl(entries), media_type="application/jsonl")
+++    return entries
+++
+++
+++@app.get("/cases/{case_id}/logs/download")
+++async def download_logs(
+++    case_id: str,
+++    limit: int = Query(1000, ge=1, le=2000, description="Number of lines from tail"),
+++    offset: int = Query(0, ge=0, description="Offset from tail"),
+++) -> StreamingResponse:
+++    get_case_or_404(case_id)
+++    entries = get_logs_slice(case_id, offset=offset, limit=limit)
+++    payload = build_jsonl(entries).encode("utf-8")
+++    headers = {"Content-Disposition": f"attachment; filename={case_id}.jsonl"}
+++    return StreamingResponse(iter([payload]), media_type="application/jsonl", headers=headers)
++--- storage.py
+++++ storage.py
++@@ -39,6 +39,19 @@
++     return {key: json.loads(value) for key, value in raw.items()}
++ 
++ 
+++def list_case_ids() -> List[str]:
+++    client = get_redis_client()
+++    cursor = 0
+++    keys: List[str] = []
+++    pattern = f"{CASE_PREFIX}*"
+++    while True:
+++        cursor, batch = client.scan(cursor=cursor, match=pattern, count=200)
+++        keys.extend(batch)
+++        if cursor == 0:
+++            break
+++    return [key.replace(CASE_PREFIX, "", 1) for key in keys]
+++
+++
++ def append_log(case_id: str, message: LogRaw) -> Dict[str, Any]:
++     client = get_redis_client()
++     payload = _decode_log_entry(message)
++@@ -57,6 +70,21 @@
++     return [_decode_log_entry(entry) for entry in entries]
++ 
++ 
+++def get_logs_slice(case_id: str, offset: int = 0, limit: int = 200) -> List[Dict[str, Any]]:
+++    if limit <= 0:
+++        return []
+++    if offset < 0:
+++        offset = 0
+++    entries = get_logs(case_id)
+++    if not entries:
+++        return []
+++    end = len(entries) - offset
+++    if end <= 0:
+++        return []
+++    start = max(0, end - limit)
+++    return entries[start:end]
+++
+++
++ def log_channel(case_id: str) -> str:
++     return f"{WS_LOG_CHANNEL_PREFIX}{case_id}"
++ 
++--- worker.py
+++++ worker.py
++@@ -11,6 +11,8 @@
++ 
++ from config import (
++     BUILD_ROOT,
+++    CASE_LABEL_KEY,
+++    CASE_LABEL_MANAGED,
++     DEFAULT_BRANCH,
++     DOCKER_BUILD_TIMEOUT_SECONDS,
++     PORT_MODE,
++@@ -188,13 +190,15 @@
++         dockerfile = ensure_dockerfile(target_dir)
++         resolved_port = container_port or detect_exposed_port(dockerfile)
++ 
+++        existing = get_case(case_id) or {}
+++        env_keys = sorted(env.keys()) if env else sorted(existing.get("env_keys") or [])
++         update_case(
++             case_id,
++             {
++                 "status": "BUILDING",
++                 "stage": "build",
++                 "container_port": resolved_port,
++-                "env_keys": sorted(env.keys()),
+++                "env_keys": env_keys,
++             },
++         )
++ 
++@@ -207,11 +211,25 @@
++ 
++         update_case(case_id, {"status": "STARTING", "stage": "run"})
++ 
+++        labels = {CASE_LABEL_KEY: case_id, CASE_LABEL_MANAGED: "true"}
++         if PORT_MODE == "dynamic":
++-            container_id, host_port = run_container_dynamic(client, tag, resolved_port, env)
+++            container_id, host_port = run_container_dynamic(
+++                client,
+++                tag,
+++                resolved_port,
+++                env,
+++                labels=labels,
+++            )
++         else:
++             host_port = reserve_port(case_id)
++-            container_id = run_container_fixed(client, tag, resolved_port, host_port, env)
+++            container_id = run_container_fixed(
+++                client,
+++                tag,
+++                resolved_port,
+++                host_port,
+++                env,
+++                labels=labels,
+++            )
++ 
++         wait_for_container_running(client, container_id, STARTUP_TIMEOUT_SECONDS)
++         access_url = f"http://{PUBLIC_HOST}:{host_port}"
++--- third.md
+++++ third.md
++@@ -0,0 +1,126 @@
+++# Phase 3 可展示并且管理验收报告
+++
+++## 1. 概述 / 范围 / 结论
+++- 验收范围：Dashboard 列表管理、搜索/筛选/分页、详情管理动作（Stop/Restart/Retry/Archive）、日志导出、OpenAPI 对齐、Demo 脚本与 E2E 证据。
+++- 结论：PASS（管理 API + 前端控制台闭环完成，可用于演示与基础运维操作）。
+++
+++## 2. 新增能力清单
+++- Dashboard（/）：列表管理、搜索、状态筛选、分页、归档可见控制。
+++- 详情页管理动作：Stop / Restart / Retry / Archive（均带二次确认与结果提示）。
+++- 日志管理：历史日志查询 + JSONL 下载导出。
+++- 容器可识别性：所有容器打 label（`antihub.case_id`、`antihub.managed=true`），动作只操作带 label 的容器。
+++
+++## 3. 管理 API 契约（OpenAPI 可见）
+++
+++### 3.1 列表查询
+++- `GET /cases?q=&status=&stage=&page=&size=&include_archived=`
+++- 返回：`items[] + {total,page,size}`
+++- 示例（节选）：`.devlogs/phase3_cases_page1.json`
+++```json
+++{
+++  "items": [
+++    {
+++      "case_id": "c_95d61d",
+++      "status": "RUNNING",
+++      "stage": "run",
+++      "repo_url": "/home/user2643/code/AntiHub/test-repos/hello-world",
+++      "ref": "master",
+++      "runtime": {"host_port":30000,"access_url":"http://localhost:30000"},
+++      "updated_at": 1769088996.6860673
+++    }
+++  ],
+++  "total": 1,
+++  "page": 1,
+++  "size": 5
+++}
+++```
+++
+++### 3.2 管理动作
+++- `POST /cases/{id}/stop`
+++- `POST /cases/{id}/restart`
+++- `POST /cases/{id}/retry`（可带 `env` 覆盖）
+++- `POST /cases/{id}/archive`
+++- 示例（Stop）：`.devlogs/phase3_case1_stop.json`
+++```json
+++{"case_id":"c_95d61d","action":"stop","status":"STOPPED","message":"Stopped"}
+++```
+++- 示例（Restart）：`.devlogs/phase3_case1_restart.json`
+++```json
+++{"case_id":"c_95d61d","action":"restart","status":"RUNNING","message":"Restarted"}
+++```
+++- 示例（Retry）：`.devlogs/phase3_case3_retry.json`
+++```json
+++{"case_id":"c_a88c95","action":"retry","status":"PENDING","message":"Retry started"}
+++```
+++- 示例（Archive）：`.devlogs/phase3_case2_archive.json`
+++```json
+++{"case_id":"c_d2be0f","action":"archive","status":"ARCHIVED","message":"Archived"}
+++```
+++
+++### 3.3 日志查询/导出
+++- `GET /cases/{id}/logs?limit=1000&offset=0&format=jsonl`
+++- `GET /cases/{id}/logs/download?limit=1000`（浏览器下载）
+++- 示例（JSONL 导出）：`.devlogs/phase3_case1_logs.jsonl`
+++```json
+++{"ts": 1769088996.689066, "stream": "system", "level": "INFO", "line": "Container started: http://localhost:30000"}
+++```
+++
+++## 4. Demo Script（5 分钟）
+++1) 打开控制台 `http://127.0.0.1:5173`，进入 Dashboard
+++2) 新建案例：填写 `repo_url` + 可选 `ref` + env（只填 key 或打码 value）
+++3) 返回列表：看到新 case 出现在顶部，状态变化可见
+++4) 进入详情：查看状态/阶段、运行信息、env_keys、实时日志
+++5) 点击 Stop：状态变为 STOPPED（提示成功）
+++6) 点击 Restart：状态恢复 RUNNING
+++7) 点击“下载 1000 行”：导出日志 JSONL
+++8) 点击 Archive：列表默认隐藏；切换“显示归档”可再次看到
+++
+++## 5. E2E 用例证据
+++
+++### 用例 1：轻量仓 hello-world（RUNNING + Stop/Restart + 日志导出）
+++- 创建响应：`.devlogs/phase3_case1_create.json`（`case_id = c_95d61d`）
+++- 列表可见：`.devlogs/phase3_cases_page1.json`
+++- 运行状态：`.devlogs/phase3_case1_status.json`
+++- 访问验证：`curl http://localhost:30000/` -> `HTTP/1.0 200 OK`
+++- Stop：`.devlogs/phase3_case1_stop.json`，状态：`.devlogs/phase3_case1_stopped_status.json`
+++- Restart：`.devlogs/phase3_case1_restart.json`，状态：`.devlogs/phase3_case1_restart_status.json`
+++- 日志导出：`.devlogs/phase3_case1_logs.jsonl`
+++- 结论：PASS
+++
+++### 用例 2：MetaGPT 场景（RUNNING）
+++- 创建响应：`.devlogs/phase3_case4_create.json`（`case_id = c_f02478`）
+++- 状态响应：`.devlogs/phase3_case4_status.json`（`RUNNING`，`env_keys=["OPENAI_API_KEY"]`）
+++- 访问验证：`curl http://localhost:30000/` -> `HTTP/1.0 200 OK`
+++- 结论：PASS
+++
+++### 用例 3：失败场景 + Retry + Archive
+++- 失败构建：`.devlogs/phase3_case3_status.json`（`error_code=DOCKER_BUILD_FAILED`）
+++- Retry：`.devlogs/phase3_case3_retry.json` 与 `.devlogs/phase3_case3_retry_status.json`（attempt=2，env_keys 保留）
+++- Archive：`.devlogs/phase3_case2_archive.json`；列表默认隐藏 `.devlogs/phase3_cases_no_archived.json`；include_archived 显示 `.devlogs/phase3_cases_with_archived.json`
+++- 结论：PASS
+++
+++## 6. 问题清单与修复记录
+++1) 管理动作需要可识别容器
+++- 修复：新增容器 label（`antihub.case_id` / `antihub.managed=true`），仅对带 label 容器执行 stop/restart
+++
+++2) Retry 的 env_keys 展示
+++- 修复：当 Retry 未提供 env 时，沿用已有 env_keys（不存 env value）
+++
+++3) 日志导出
+++- 修复：新增 JSONL 导出与下载接口，并在前端提供按钮
+++
+++Patch：`phase3.patch`
+++- 应用：`patch -p0 < phase3.patch`
+++- 回滚：`patch -p0 -R < phase3.patch`
+++
+++## 7. 启动说明
+++- 后端：`./dev.sh up`
+++- 前端：`cd frontend && npm i && npm run dev`
+++- 说明：如在 WSL 环境，请使用 WSL 内部 Node/npm（避免 Windows npm 访问 UNC 路径失败）
+++
+++## 8. Phase 4 建议
+++1) 列表性能与索引（Redis 索引/分页优化）
+++2) 多项目视角与角色权限
+++3) 日志与指标聚合（服务级别状态视图）
+++4) 长任务治理（重试策略、队列可视化）
+++5) 容器生命周期与资源配额管理
++--- frontend/src/App.tsx
+++++ frontend/src/App.tsx
++@@ -22,6 +22,27 @@
++   error_message?: string | null;
++   created_at?: number | null;
++   updated_at?: number | null;
+++  repo_url?: string | null;
+++  ref?: string | null;
+++  branch?: string | null;
+++  archived?: boolean;
+++  archived_at?: number | null;
+++  attempt?: number | null;
+++  retry_of?: string | null;
+++};
+++
+++type CaseListResponse = {
+++  items: CaseResponse[];
+++  total: number;
+++  page: number;
+++  size: number;
+++};
+++
+++type CaseActionResponse = {
+++  case_id: string;
+++  action: string;
+++  status: string;
+++  message: string;
++ };
++ 
++ type LogEntry = {
++@@ -31,7 +52,13 @@
++   line: string;
++ };
++ 
+++type Toast = {
+++  type: "success" | "error";
+++  message: string;
+++};
+++
++ type Route =
+++  | { type: "dashboard" }
++   | { type: "create" }
++   | {
++       type: "case";
++@@ -47,6 +74,7 @@
++   GIT_CLONE_TIMEOUT: "Git 克隆超时，请重试或使用更小的仓库。",
++   STARTUP_TIMEOUT: "容器启动超时，请确认监听 0.0.0.0 且 EXPOSE 端口正确。",
++   CONTAINER_EXIT_NONZERO: "容器非零退出，请查看容器日志。",
+++  STOPPED_BY_USER: "已由用户手动停止。",
++   UNEXPECTED_ERROR: "未知错误，请查看日志详情。",
++ };
++ 
++@@ -71,29 +99,12 @@
++   BUILDING: "构建中",
++   STARTING: "启动中",
++   RUNNING: "运行中",
+++  STOPPED: "已停止",
++   FAILED: "失败",
++   FINISHED: "已结束",
++   ANALYZING: "分析中",
++ };
++ 
++-function streamLabel(stream: string) {
++-  return STREAM_LABELS[stream] || stream;
++-}
++-
++-function statusLabel(status?: string) {
++-  if (!status) return "-";
++-  const normalized = status.toUpperCase();
++-  const label = STATUS_LABELS[normalized];
++-  return label ? `${label} (${normalized})` : normalized;
++-}
++-
++-function stageLabel(stage?: string) {
++-  if (!stage) return "-";
++-  const normalized = stage.toLowerCase();
++-  const label = STAGE_LABELS[normalized];
++-  return label ? `${label} (${normalized})` : stage;
++-}
++-
++ function joinUrl(base: string, path: string) {
++   const trimmed = base.replace(/\/+$/, "");
++   return `${trimmed}${path}`;
++@@ -110,11 +121,14 @@
++ }
++ 
++ function parseRoute(pathname: string): Route {
+++  if (pathname.startsWith("/create")) {
+++    return { type: "create" };
+++  }
++   const match = pathname.match(/^\/cases\/([^/]+)$/);
++   if (match && match[1]) {
++     return { type: "case", caseId: match[1] };
++   }
++-  return { type: "create" };
+++  return { type: "dashboard" };
++ }
++ 
++ function useRoute() {
++@@ -144,6 +158,7 @@
++   const normalized = (status || "").toUpperCase();
++   if (normalized === "RUNNING") return "running";
++   if (normalized === "FAILED") return "failed";
+++  if (normalized === "STOPPED") return "neutral";
++   if (normalized === "BUILDING" || normalized === "CLONING" || normalized === "STARTING") {
++     return "working";
++   }
++@@ -151,6 +166,24 @@
++   return "neutral";
++ }
++ 
+++function streamLabel(stream: string) {
+++  return STREAM_LABELS[stream] || stream;
+++}
+++
+++function statusLabel(status?: string) {
+++  if (!status) return "-";
+++  const normalized = status.toUpperCase();
+++  const label = STATUS_LABELS[normalized];
+++  return label ? `${label} (${normalized})` : normalized;
+++}
+++
+++function stageLabel(stage?: string) {
+++  if (!stage) return "-";
+++  const normalized = stage.toLowerCase();
+++  const label = STAGE_LABELS[normalized];
+++  return label ? `${label} (${normalized})` : stage;
+++}
+++
++ function App() {
++   const { route, navigate } = useRoute();
++   const [flashCaseId, setFlashCaseId] = useState<string | null>(null);
++@@ -159,21 +192,27 @@
++     <div className="app">
++       <header className="topbar">
++         <div className="brand">
++-            <div className="brand-mark">AH</div>
+++          <div className="brand-mark">AH</div>
++           <div>
++             <div className="brand-title">AntiHub 控制台</div>
++-            <div className="brand-sub">阶段 2 - 创建、观测、对齐</div>
+++            <div className="brand-sub">阶段 3 - 可展示与管理</div>
++           </div>
++         </div>
++         <div className="topbar-actions">
++-          <button className="ghost" onClick={() => navigate("/")}>新建案例</button>
+++          <button className="ghost" onClick={() => navigate("/")}>控制台</button>
+++          <button className="ghost" onClick={() => navigate("/create")}>新建案例</button>
++           <a className="ghost" href="http://127.0.0.1:8010/docs" target="_blank" rel="noreferrer">
++             API 文档
++           </a>
++         </div>
++       </header>
++       <main className="main">
++-        {route.type === "create" ? (
+++        {route.type === "dashboard" ? (
+++          <Dashboard
+++            onOpen={(caseId) => navigate(`/cases/${caseId}`)}
+++            onCreate={() => navigate("/create")}
+++          />
+++        ) : route.type === "create" ? (
++           <CreateCase
++             onCreated={(caseId) => {
++               setFlashCaseId(caseId);
++@@ -373,6 +412,283 @@
++   );
++ }
++ 
+++function Dashboard({ onOpen, onCreate }: { onOpen: (caseId: string) => void; onCreate: () => void }) {
+++  const [cases, setCases] = useState<CaseResponse[]>([]);
+++  const [total, setTotal] = useState(0);
+++  const [page, setPage] = useState(1);
+++  const [size, setSize] = useState(10);
+++  const [query, setQuery] = useState("");
+++  const [status, setStatus] = useState("");
+++  const [stage, setStage] = useState("");
+++  const [includeArchived, setIncludeArchived] = useState(false);
+++  const [loading, setLoading] = useState(false);
+++  const [error, setError] = useState<string | null>(null);
+++  const [toast, setToast] = useState<Toast | null>(null);
+++
+++  const fetchCases = useCallback(async () => {
+++    setLoading(true);
+++    setError(null);
+++    try {
+++      const params = new URLSearchParams();
+++      params.set("page", String(page));
+++      params.set("size", String(size));
+++      if (query.trim()) params.set("q", query.trim());
+++      if (status) params.set("status", status);
+++      if (stage) params.set("stage", stage);
+++      if (includeArchived) params.set("include_archived", "true");
+++      const response = await fetch(joinUrl(API_BASE, `/cases?${params.toString()}`));
+++      if (!response.ok) {
+++        throw new Error(`请求失败 (${response.status})`);
+++      }
+++      const data = (await response.json()) as CaseListResponse;
+++      setCases(data.items || []);
+++      setTotal(data.total || 0);
+++    } catch (err) {
+++      setError(err instanceof Error ? err.message : "加载失败");
+++    } finally {
+++      setLoading(false);
+++    }
+++  }, [page, size, query, status, stage, includeArchived]);
+++
+++  useEffect(() => {
+++    fetchCases();
+++  }, [fetchCases]);
+++
+++  useEffect(() => {
+++    if (!toast) return undefined;
+++    const timer = window.setTimeout(() => setToast(null), 3000);
+++    return () => window.clearTimeout(timer);
+++  }, [toast]);
+++
+++  const totalPages = Math.max(1, Math.ceil(total / size));
+++  const runningCount = cases.filter((item) => item.status?.toUpperCase() === "RUNNING").length;
+++  const failedCount = cases.filter((item) => item.status?.toUpperCase() === "FAILED").length;
+++
+++  const handleAction = async (caseId: string, action: "stop" | "retry" | "archive") => {
+++    const confirmText =
+++      action === "stop"
+++        ? "确认停止该运行中的案例？"
+++        : action === "retry"
+++        ? "确认重试该失败案例？"
+++        : "确认归档该案例？";
+++    if (!window.confirm(confirmText)) return;
+++    try {
+++      const response = await fetch(joinUrl(API_BASE, `/cases/${caseId}/${action}`), {
+++        method: "POST",
+++        headers: { "Content-Type": "application/json" },
+++        body: action === "retry" ? JSON.stringify({}) : undefined,
+++      });
+++      if (!response.ok) {
+++        const text = await response.text();
+++        throw new Error(text || `操作失败 (${response.status})`);
+++      }
+++      const data = (await response.json()) as CaseActionResponse;
+++      setToast({ type: "success", message: `操作成功：${data.message}` });
+++      fetchCases();
+++    } catch (err) {
+++      setToast({ type: "error", message: err instanceof Error ? err.message : "操作失败" });
+++    }
+++  };
+++
+++  return (
+++    <div className="dashboard">
+++      <div className="dashboard-head">
+++        <div>
+++          <div className="section-title">案例列表</div>
+++          <div className="section-sub">支持搜索、筛选、分页与管理动作。</div>
+++        </div>
+++        <div className="dashboard-actions">
+++          <button className="ghost" type="button" onClick={fetchCases}>
+++            刷新列表
+++          </button>
+++          <button className="primary" type="button" onClick={onCreate}>
+++            新建案例
+++          </button>
+++        </div>
+++      </div>
+++
+++      <div className="stats">
+++        <div className="card stat-card">
+++          <div className="stat-title">总数</div>
+++          <div className="stat-value">{total}</div>
+++        </div>
+++        <div className="card stat-card">
+++          <div className="stat-title">运行中</div>
+++          <div className="stat-value">{runningCount}</div>
+++        </div>
+++        <div className="card stat-card">
+++          <div className="stat-title">失败</div>
+++          <div className="stat-value">{failedCount}</div>
+++        </div>
+++      </div>
+++
+++      <div className="filters-panel card">
+++        <label className="field">
+++          <span>搜索</span>
+++          <input
+++            type="text"
+++            placeholder="case_id / repo / ref"
+++            value={query}
+++            onChange={(event) => {
+++              setQuery(event.target.value);
+++              setPage(1);
+++            }}
+++          />
+++        </label>
+++        <label className="field">
+++          <span>状态</span>
+++          <select
+++            value={status}
+++            onChange={(event) => {
+++              setStatus(event.target.value);
+++              setPage(1);
+++            }}
+++          >
+++            <option value="">全部</option>
+++            <option value="RUNNING">RUNNING</option>
+++            <option value="FAILED">FAILED</option>
+++            <option value="STOPPED">STOPPED</option>
+++            <option value="PENDING">PENDING</option>
+++            <option value="BUILDING">BUILDING</option>
+++          </select>
+++        </label>
+++        <label className="field">
+++          <span>阶段</span>
+++          <select
+++            value={stage}
+++            onChange={(event) => {
+++              setStage(event.target.value);
+++              setPage(1);
+++            }}
+++          >
+++            <option value="">全部</option>
+++            <option value="clone">clone</option>
+++            <option value="build">build</option>
+++            <option value="run">run</option>
+++            <option value="analyze">analyze</option>
+++            <option value="system">system</option>
+++          </select>
+++        </label>
+++        <label className="field checkbox">
+++          <span>显示归档</span>
+++          <input
+++            type="checkbox"
+++            checked={includeArchived}
+++            onChange={(event) => {
+++              setIncludeArchived(event.target.checked);
+++              setPage(1);
+++            }}
+++          />
+++        </label>
+++        <label className="field">
+++          <span>每页</span>
+++          <select
+++            value={String(size)}
+++            onChange={(event) => {
+++              setSize(Number(event.target.value));
+++              setPage(1);
+++            }}
+++          >
+++            <option value="10">10</option>
+++            <option value="20">20</option>
+++            <option value="50">50</option>
+++          </select>
+++        </label>
+++      </div>
+++
+++      {toast ? (
+++        <div className={toast.type === "success" ? "success-banner" : "error-banner"}>{toast.message}</div>
+++      ) : null}
+++      {error ? <div className="error-banner">{error}</div> : null}
+++
+++      <div className="card table-card">
+++        <div className="table">
+++          <div className="table-header">
+++            <span>case_id</span>
+++            <span>repo/ref</span>
+++            <span>状态/阶段</span>
+++            <span>更新时间</span>
+++            <span>访问</span>
+++            <span>错误码</span>
+++            <span>操作</span>
+++          </div>
+++          {loading ? (
+++            <div className="table-empty">加载中...</div>
+++          ) : cases.length ? (
+++            cases.map((item) => {
+++              const runtime = item.runtime || {};
+++              const statusUpper = (item.status || "").toUpperCase();
+++              return (
+++                <div className="table-row" key={item.case_id}>
+++                  <span className="mono">{item.case_id}</span>
+++                  <span className="table-repo">
+++                    <div className="mono">{item.repo_url || "-"}</div>
+++                    <div className="muted">{item.ref || item.branch || "-"}</div>
+++                  </span>
+++                  <span>
+++                    <span className={`badge badge--${statusTone(item.status)}`}>{statusLabel(item.status)}</span>
+++                    <span className="stage">{stageLabel(item.stage)}</span>
+++                  </span>
+++                  <span>{formatTime(item.updated_at)}</span>
+++                  <span>
+++                    {runtime.access_url ? (
+++                      <a href={runtime.access_url} target="_blank" rel="noreferrer">
+++                        {runtime.access_url}
+++                      </a>
+++                    ) : runtime.host_port ? (
+++                      <span>{runtime.host_port}</span>
+++                    ) : (
+++                      "-"
+++                    )}
+++                  </span>
+++                  <span className="mono">{statusUpper === "FAILED" ? item.error_code || "-" : "-"}</span>
+++                  <span className="table-actions">
+++                    <button className="ghost" onClick={() => onOpen(item.case_id)}>详情</button>
+++                    <button
+++                      className="ghost"
+++                      disabled={statusUpper !== "RUNNING"}
+++                      onClick={() => handleAction(item.case_id, "stop")}
+++                    >
+++                      停止
+++                    </button>
+++                    <button
+++                      className="ghost"
+++                      disabled={statusUpper !== "FAILED"}
+++                      onClick={() => handleAction(item.case_id, "retry")}
+++                    >
+++                      重试
+++                    </button>
+++                    <button className="ghost" onClick={() => handleAction(item.case_id, "archive")}>
+++                      归档
+++                    </button>
+++                  </span>
+++                </div>
+++              );
+++            })
+++          ) : (
+++            <div className="table-empty">暂无案例</div>
+++          )}
+++        </div>
+++        <div className="pagination">
+++          <button className="ghost" disabled={page <= 1} onClick={() => setPage((p) => Math.max(1, p - 1))}>
+++            上一页
+++          </button>
+++          <span>
+++            第 {page} / {totalPages} 页
+++          </span>
+++          <button
+++            className="ghost"
+++            disabled={page >= totalPages}
+++            onClick={() => setPage((p) => Math.min(totalPages, p + 1))}
+++          >
+++            下一页
+++          </button>
+++        </div>
+++      </div>
+++    </div>
+++  );
+++}
+++
++ function CaseDetail({
++   caseId,
++   onBack,
++@@ -387,6 +703,7 @@
++   const [caseData, setCaseData] = useState<CaseResponse | null>(null);
++   const [loadError, setLoadError] = useState<string | null>(null);
++   const [loading, setLoading] = useState(false);
+++  const [toast, setToast] = useState<Toast | null>(null);
++   const statusRef = useRef<string>("");
++   const fetchLock = useRef(false);
++ 
++@@ -443,7 +760,7 @@
++       if (cancelled) return;
++       await fetchCase(true);
++       const status = statusRef.current.toUpperCase();
++-      const slow = status === "RUNNING" || status === "FAILED" || status === "FINISHED";
+++      const slow = status === "RUNNING" || status === "FAILED" || status === "STOPPED" || status === "FINISHED";
++       const delay = slow ? 5000 : 2000;
++       timer = window.setTimeout(poll, delay);
++     };
++@@ -462,10 +779,63 @@
++     return undefined;
++   }, [flashCaseId, clearFlash]);
++ 
+++  useEffect(() => {
+++    if (!toast) return undefined;
+++    const timer = window.setTimeout(() => setToast(null), 3000);
+++    return () => window.clearTimeout(timer);
+++  }, [toast]);
+++
++   const runtime = caseData?.runtime || {};
++   const envKeys = caseData?.env_keys || [];
++   const errorCode = caseData?.error_code || undefined;
++   const errorMessage = caseData?.error_message || undefined;
+++  const statusUpper = (caseData?.status || "").toUpperCase();
+++
+++  const runAction = async (action: "stop" | "restart" | "retry" | "archive") => {
+++    const confirmText =
+++      action === "stop"
+++        ? "确认停止该运行中的案例？"
+++        : action === "restart"
+++        ? "确认重新启动该案例？"
+++        : action === "retry"
+++        ? "确认重新构建并运行该案例？"
+++        : "确认归档该案例？";
+++    if (!window.confirm(confirmText)) return;
+++    try {
+++      const response = await fetch(joinUrl(API_BASE, `/cases/${caseId}/${action}`), {
+++        method: "POST",
+++        headers: { "Content-Type": "application/json" },
+++        body: action === "retry" ? JSON.stringify({}) : undefined,
+++      });
+++      if (!response.ok) {
+++        const text = await response.text();
+++        throw new Error(text || `操作失败 (${response.status})`);
+++      }
+++      const data = (await response.json()) as CaseActionResponse;
+++      setToast({ type: "success", message: `操作成功：${data.message}` });
+++      fetchCase();
+++    } catch (err) {
+++      setToast({ type: "error", message: err instanceof Error ? err.message : "操作失败" });
+++    }
+++  };
+++
+++  const copyLogs = async () => {
+++    try {
+++      const response = await fetch(joinUrl(API_BASE, `/cases/${caseId}/logs?limit=1000&format=jsonl`));
+++      if (!response.ok) {
+++        throw new Error(`导出失败 (${response.status})`);
+++      }
+++      const text = await response.text();
+++      await navigator.clipboard.writeText(text);
+++      setToast({ type: "success", message: "已复制最近 1000 行日志" });
+++    } catch (err) {
+++      setToast({ type: "error", message: err instanceof Error ? err.message : "导出失败" });
+++    }
+++  };
+++
+++  const downloadLogs = () => {
+++    window.open(joinUrl(API_BASE, `/cases/${caseId}/logs/download?limit=1000`), "_blank");
+++  };
++ 
++   return (
++     <div className="detail">
++@@ -479,6 +849,9 @@
++         </button>
++       </div>
++       {flashCaseId ? <div className="success-banner">创建成功：{flashCaseId}</div> : null}
+++      {toast ? (
+++        <div className={toast.type === "success" ? "success-banner" : "error-banner"}>{toast.message}</div>
+++      ) : null}
++       {loadError ? <div className="error-banner">{loadError}</div> : null}
++       <div className="detail-grid">
++         <section className="card" style={{ animationDelay: "0.05s" }}>
++@@ -522,6 +895,27 @@
++           </div>
++         </section>
++         <section className="card" style={{ animationDelay: "0.18s" }}>
+++          <div className="section-title">管理动作</div>
+++          <div className="action-grid">
+++            <button className="ghost" disabled={statusUpper !== "RUNNING"} onClick={() => runAction("stop")}>
+++              停止
+++            </button>
+++            <button
+++              className="ghost"
+++              disabled={!(statusUpper === "STOPPED" || statusUpper === "FAILED")}
+++              onClick={() => runAction("restart")}
+++            >
+++              重启
+++            </button>
+++            <button className="ghost" disabled={statusUpper !== "FAILED"} onClick={() => runAction("retry")}>
+++              重试
+++            </button>
+++            <button className="ghost" onClick={() => runAction("archive")}>
+++              归档
+++            </button>
+++          </div>
+++        </section>
+++        <section className="card" style={{ animationDelay: "0.2s" }}>
++           <div className="section-title">环境变量键</div>
++           {envKeys.length ? (
++             <div className="chips">
++@@ -546,7 +940,7 @@
++           </section>
++         ) : null}
++         <section className="card logs" style={{ animationDelay: "0.3s" }}>
++-          <LogPanel caseId={caseId} />
+++          <LogPanel caseId={caseId} onCopyLogs={copyLogs} onDownloadLogs={downloadLogs} />
++         </section>
++       </div>
++     </div>
++@@ -573,7 +967,15 @@
++   );
++ }
++ 
++-function LogPanel({ caseId }: { caseId: string }) {
+++function LogPanel({
+++  caseId,
+++  onCopyLogs,
+++  onDownloadLogs,
+++}: {
+++  caseId: string;
+++  onCopyLogs: () => void;
+++  onDownloadLogs: () => void;
+++}) {
++   const [logs, setLogs] = useState<LogEntry[]>([]);
++   const [autoScroll, setAutoScroll] = useState(true);
++   const [status, setStatus] = useState<"connecting" | "open" | "closed" | "error">(
++@@ -668,6 +1070,12 @@
++           </div>
++         </div>
++         <div className="logs-actions">
+++          <button className="ghost" type="button" onClick={onCopyLogs}>
+++            复制 JSONL
+++          </button>
+++          <button className="ghost" type="button" onClick={onDownloadLogs}>
+++            下载 1000 行
+++          </button>
++           <button className="ghost" type="button" onClick={() => setAutoScroll((value) => !value)}>
++             {autoScroll ? "暂停滚动" : "自动滚动"}
++           </button>
++--- frontend/src/styles.css
+++++ frontend/src/styles.css
++@@ -300,6 +300,128 @@
++   font-size: 14px;
++ }
++ 
+++.dashboard {
+++  display: flex;
+++  flex-direction: column;
+++  gap: 20px;
+++}
+++
+++.dashboard-head {
+++  display: flex;
+++  justify-content: space-between;
+++  align-items: center;
+++  gap: 16px;
+++}
+++
+++.dashboard-actions {
+++  display: flex;
+++  gap: 12px;
+++}
+++
+++.stats {
+++  display: grid;
+++  grid-template-columns: repeat(3, 1fr);
+++  gap: 16px;
+++}
+++
+++.stat-card {
+++  display: flex;
+++  flex-direction: column;
+++  gap: 6px;
+++}
+++
+++.stat-title {
+++  color: var(--muted);
+++  font-size: 13px;
+++}
+++
+++.stat-value {
+++  font-size: 24px;
+++  font-weight: 700;
+++}
+++
+++.filters-panel {
+++  display: grid;
+++  grid-template-columns: repeat(5, minmax(0, 1fr));
+++  gap: 12px;
+++  align-items: end;
+++}
+++
+++.filters-panel select,
+++.filters-panel input {
+++  padding: 10px 12px;
+++  border-radius: 12px;
+++  border: 1px solid var(--border);
+++}
+++
+++.table-card {
+++  padding: 0;
+++  overflow: hidden;
+++}
+++
+++.table {
+++  display: grid;
+++}
+++
+++.table-header,
+++.table-row {
+++  display: grid;
+++  grid-template-columns: 1.2fr 2fr 1.6fr 1.2fr 1.6fr 1fr 1.6fr;
+++  gap: 12px;
+++  padding: 16px 20px;
+++  align-items: center;
+++}
+++
+++.table-header {
+++  font-size: 13px;
+++  font-weight: 600;
+++  color: var(--muted);
+++  text-transform: uppercase;
+++  letter-spacing: 0.5px;
+++  background: rgba(30, 111, 122, 0.06);
+++}
+++
+++.table-row {
+++  border-top: 1px solid var(--border);
+++  font-size: 14px;
+++}
+++
+++.table-row a {
+++  color: var(--accent-strong);
+++  text-decoration: none;
+++}
+++
+++.table-repo {
+++  display: flex;
+++  flex-direction: column;
+++  gap: 4px;
+++}
+++
+++.table-actions {
+++  display: flex;
+++  gap: 8px;
+++  flex-wrap: wrap;
+++}
+++
+++.table-empty {
+++  padding: 24px;
+++  color: var(--muted);
+++}
+++
+++.pagination {
+++  display: flex;
+++  justify-content: space-between;
+++  align-items: center;
+++  padding: 16px 20px;
+++  border-top: 1px solid var(--border);
+++}
+++
+++.action-grid {
+++  display: grid;
+++  grid-template-columns: repeat(2, minmax(0, 1fr));
+++  gap: 10px;
+++}
+++
++ .detail {
++   display: flex;
++   flex-direction: column;
++@@ -574,6 +696,14 @@
++     grid-template-columns: 1fr;
++   }
++ 
+++  .stats {
+++    grid-template-columns: 1fr;
+++  }
+++
+++  .filters-panel {
+++    grid-template-columns: 1fr;
+++  }
+++
++   .detail-grid {
++     grid-template-columns: 1fr;
++   }
++@@ -597,4 +727,15 @@
++   .log-line {
++     grid-template-columns: 1fr;
++   }
+++
+++  .table-header,
+++  .table-row {
+++    grid-template-columns: 1fr;
+++    gap: 6px;
+++  }
+++
+++  .pagination {
+++    flex-direction: column;
+++    gap: 12px;
+++  }
++ }
diff -ruN '--exclude=.devlogs' '--exclude=venv' '--exclude=node_modules' '--exclude=__pycache__' /tmp/AntiHub.phase3.base/requirements.txt /home/user2643/code/AntiHub/requirements.txt
--- /tmp/AntiHub.phase3.base/requirements.txt	2026-01-22 21:52:23.262380687 +0800
+++ /home/user2643/code/AntiHub/requirements.txt	2026-01-22 22:47:05.113977042 +0800
@@ -5,3 +5,4 @@
 docker==7.1.0
 pydantic==2.8.2
 websockets==12.0
+PyYAML==6.0.2
diff -ruN '--exclude=.devlogs' '--exclude=venv' '--exclude=node_modules' '--exclude=__pycache__' /tmp/AntiHub.phase3.base/storage.py /home/user2643/code/AntiHub/storage.py
--- /tmp/AntiHub.phase3.base/storage.py	2026-01-22 21:52:23.262380687 +0800
+++ /home/user2643/code/AntiHub/storage.py	2026-01-22 22:43:04.192089353 +0800
@@ -1,13 +1,33 @@
 import json
+import re
 import time
 from typing import Any, Dict, List, Union
 
 import redis
 import redis.asyncio as redis_async
 
-from config import CASE_PREFIX, LOG_LIST_PREFIX, LOG_RETENTION_LINES, REDIS_URL, WS_LOG_CHANNEL_PREFIX
+from config import (
+    CASE_PREFIX,
+    LOG_LIST_PREFIX,
+    LOG_RETENTION_LINES,
+    MANUAL_META_PREFIX,
+    MANUAL_PREFIX,
+    MANUAL_STATS_KEY,
+    MANUAL_STATUS_PREFIX,
+    REDIS_URL,
+    WS_LOG_CHANNEL_PREFIX,
+)
 
 LogRaw = Union[str, bytes, Dict[str, Any]]
+
+SECRET_PAIR_PATTERN = re.compile(
+    r"(?P<key>[A-Za-z0-9_]*(?:KEY|TOKEN|SECRET))(?P<sep>\s*[:=]\s*)(?P<value>[^\s,;]+)",
+    re.IGNORECASE,
+)
+SECRET_JSON_PATTERN = re.compile(
+    r"(?P<key>\"[A-Za-z0-9_]*(?:KEY|TOKEN|SECRET)\"\s*:\s*)\"(?P<value>[^\"]+)\"",
+    re.IGNORECASE,
+)
 
 def get_redis_client() -> redis.Redis:
     return redis.Redis.from_url(REDIS_URL, decode_responses=True)
@@ -39,6 +59,19 @@
     return {key: json.loads(value) for key, value in raw.items()}
 
 
+def list_case_ids() -> List[str]:
+    client = get_redis_client()
+    cursor = 0
+    keys: List[str] = []
+    pattern = f"{CASE_PREFIX}*"
+    while True:
+        cursor, batch = client.scan(cursor=cursor, match=pattern, count=200)
+        keys.extend(batch)
+        if cursor == 0:
+            break
+    return [key.replace(CASE_PREFIX, "", 1) for key in keys]
+
+
 def append_log(case_id: str, message: LogRaw) -> Dict[str, Any]:
     client = get_redis_client()
     payload = _decode_log_entry(message)
@@ -57,6 +90,21 @@
     return [_decode_log_entry(entry) for entry in entries]
 
 
+def get_logs_slice(case_id: str, offset: int = 0, limit: int = 200) -> List[Dict[str, Any]]:
+    if limit <= 0:
+        return []
+    if offset < 0:
+        offset = 0
+    entries = get_logs(case_id)
+    if not entries:
+        return []
+    end = len(entries) - offset
+    if end <= 0:
+        return []
+    start = max(0, end - limit)
+    return entries[start:end]
+
+
 def log_channel(case_id: str) -> str:
     return f"{WS_LOG_CHANNEL_PREFIX}{case_id}"
 
@@ -69,6 +117,65 @@
     return {key: json.dumps(value) for key, value in data.items()}
 
 
+def set_manual(case_id: str, markdown: str, meta: Dict[str, Any]) -> None:
+    client = get_redis_client()
+    client.set(f"{MANUAL_PREFIX}{case_id}", markdown)
+    client.set(f"{MANUAL_META_PREFIX}{case_id}", json.dumps(meta))
+
+
+def get_manual(case_id: str) -> tuple[str | None, Dict[str, Any] | None]:
+    client = get_redis_client()
+    markdown = client.get(f"{MANUAL_PREFIX}{case_id}")
+    meta_raw = client.get(f"{MANUAL_META_PREFIX}{case_id}")
+    meta = json.loads(meta_raw) if meta_raw else None
+    return markdown, meta
+
+
+def set_manual_status(
+    case_id: str,
+    status: str,
+    error_code: str | None = None,
+    error_message: str | None = None,
+    generated_at: float | None = None,
+) -> None:
+    payload = {
+        "status": status,
+        "error_code": error_code,
+        "error_message": error_message,
+        "generated_at": generated_at,
+        "updated_at": time.time(),
+    }
+    client = get_redis_client()
+    client.hset(f"{MANUAL_STATUS_PREFIX}{case_id}", mapping=_encode_data(payload))
+
+
+def get_manual_status(case_id: str) -> Dict[str, Any] | None:
+    client = get_redis_client()
+    raw = client.hgetall(f"{MANUAL_STATUS_PREFIX}{case_id}")
+    if not raw:
+        return None
+    return {key: json.loads(value) for key, value in raw.items()}
+
+
+def record_manual_stats(latency_ms: int, success: bool) -> None:
+    client = get_redis_client()
+    client.hincrby(MANUAL_STATS_KEY, "manual_generation_count", 1)
+    client.hincrby(MANUAL_STATS_KEY, "manual_generation_success", 1 if success else 0)
+    client.hincrby(MANUAL_STATS_KEY, "manual_generation_failures", 0 if success else 1)
+    client.hincrby(MANUAL_STATS_KEY, "manual_generation_latency_ms", latency_ms)
+
+
+def get_manual_stats() -> Dict[str, Any]:
+    client = get_redis_client()
+    raw = client.hgetall(MANUAL_STATS_KEY)
+    stats = {key: int(value) for key, value in raw.items()} if raw else {}
+    count = stats.get("manual_generation_count", 0)
+    total_ms = stats.get("manual_generation_latency_ms", 0)
+    avg_ms = int(total_ms / count) if count else 0
+    stats["manual_generation_latency_avg_ms"] = avg_ms
+    return stats
+
+
 def _decode_log_entry(raw: LogRaw) -> Dict[str, Any]:
     now = time.time()
     if isinstance(raw, (bytes, bytearray)):
@@ -90,4 +197,10 @@
     payload.setdefault("level", "INFO")
     payload.setdefault("line", "")
 
+    line = payload.get("line")
+    if isinstance(line, str) and line:
+        line = SECRET_PAIR_PATTERN.sub(lambda m: f"{m.group('key')}{m.group('sep')}***", line)
+        line = SECRET_JSON_PATTERN.sub(lambda m: f"{m.group('key')}\"***\"", line)
+        payload["line"] = line
+
     return payload
diff -ruN '--exclude=.devlogs' '--exclude=venv' '--exclude=node_modules' '--exclude=__pycache__' /tmp/AntiHub.phase3.base/test-repos/fail-build/Dockerfile /home/user2643/code/AntiHub/test-repos/fail-build/Dockerfile
--- /tmp/AntiHub.phase3.base/test-repos/fail-build/Dockerfile	1970-01-01 08:00:00.000000000 +0800
+++ /home/user2643/code/AntiHub/test-repos/fail-build/Dockerfile	2026-01-22 21:38:27.520651740 +0800
@@ -0,0 +1,2 @@
+FROM nikolaik/python-nodejs:python3.9-nodejs20-slim
+RUN echo "build failing" && exit 1
diff -ruN '--exclude=.devlogs' '--exclude=venv' '--exclude=node_modules' '--exclude=__pycache__' /tmp/AntiHub.phase3.base/third.md /home/user2643/code/AntiHub/third.md
--- /tmp/AntiHub.phase3.base/third.md	1970-01-01 08:00:00.000000000 +0800
+++ /home/user2643/code/AntiHub/third.md	2026-01-22 21:51:33.365696837 +0800
@@ -0,0 +1,126 @@
+# Phase 3 可展示并且管理验收报告
+
+## 1. 概述 / 范围 / 结论
+- 验收范围：Dashboard 列表管理、搜索/筛选/分页、详情管理动作（Stop/Restart/Retry/Archive）、日志导出、OpenAPI 对齐、Demo 脚本与 E2E 证据。
+- 结论：PASS（管理 API + 前端控制台闭环完成，可用于演示与基础运维操作）。
+
+## 2. 新增能力清单
+- Dashboard（/）：列表管理、搜索、状态筛选、分页、归档可见控制。
+- 详情页管理动作：Stop / Restart / Retry / Archive（均带二次确认与结果提示）。
+- 日志管理：历史日志查询 + JSONL 下载导出。
+- 容器可识别性：所有容器打 label（`antihub.case_id`、`antihub.managed=true`），动作只操作带 label 的容器。
+
+## 3. 管理 API 契约（OpenAPI 可见）
+
+### 3.1 列表查询
+- `GET /cases?q=&status=&stage=&page=&size=&include_archived=`
+- 返回：`items[] + {total,page,size}`
+- 示例（节选）：`.devlogs/phase3_cases_page1.json`
+```json
+{
+  "items": [
+    {
+      "case_id": "c_95d61d",
+      "status": "RUNNING",
+      "stage": "run",
+      "repo_url": "/home/user2643/code/AntiHub/test-repos/hello-world",
+      "ref": "master",
+      "runtime": {"host_port":30000,"access_url":"http://localhost:30000"},
+      "updated_at": 1769088996.6860673
+    }
+  ],
+  "total": 1,
+  "page": 1,
+  "size": 5
+}
+```
+
+### 3.2 管理动作
+- `POST /cases/{id}/stop`
+- `POST /cases/{id}/restart`
+- `POST /cases/{id}/retry`（可带 `env` 覆盖）
+- `POST /cases/{id}/archive`
+- 示例（Stop）：`.devlogs/phase3_case1_stop.json`
+```json
+{"case_id":"c_95d61d","action":"stop","status":"STOPPED","message":"Stopped"}
+```
+- 示例（Restart）：`.devlogs/phase3_case1_restart.json`
+```json
+{"case_id":"c_95d61d","action":"restart","status":"RUNNING","message":"Restarted"}
+```
+- 示例（Retry）：`.devlogs/phase3_case3_retry.json`
+```json
+{"case_id":"c_a88c95","action":"retry","status":"PENDING","message":"Retry started"}
+```
+- 示例（Archive）：`.devlogs/phase3_case2_archive.json`
+```json
+{"case_id":"c_d2be0f","action":"archive","status":"ARCHIVED","message":"Archived"}
+```
+
+### 3.3 日志查询/导出
+- `GET /cases/{id}/logs?limit=1000&offset=0&format=jsonl`
+- `GET /cases/{id}/logs/download?limit=1000`（浏览器下载）
+- 示例（JSONL 导出）：`.devlogs/phase3_case1_logs.jsonl`
+```json
+{"ts": 1769088996.689066, "stream": "system", "level": "INFO", "line": "Container started: http://localhost:30000"}
+```
+
+## 4. Demo Script（5 分钟）
+1) 打开控制台 `http://127.0.0.1:5173`，进入 Dashboard
+2) 新建案例：填写 `repo_url` + 可选 `ref` + env（只填 key 或打码 value）
+3) 返回列表：看到新 case 出现在顶部，状态变化可见
+4) 进入详情：查看状态/阶段、运行信息、env_keys、实时日志
+5) 点击 Stop：状态变为 STOPPED（提示成功）
+6) 点击 Restart：状态恢复 RUNNING
+7) 点击“下载 1000 行”：导出日志 JSONL
+8) 点击 Archive：列表默认隐藏；切换“显示归档”可再次看到
+
+## 5. E2E 用例证据
+
+### 用例 1：轻量仓 hello-world（RUNNING + Stop/Restart + 日志导出）
+- 创建响应：`.devlogs/phase3_case1_create.json`（`case_id = c_95d61d`）
+- 列表可见：`.devlogs/phase3_cases_page1.json`
+- 运行状态：`.devlogs/phase3_case1_status.json`
+- 访问验证：`curl http://localhost:30000/` -> `HTTP/1.0 200 OK`
+- Stop：`.devlogs/phase3_case1_stop.json`，状态：`.devlogs/phase3_case1_stopped_status.json`
+- Restart：`.devlogs/phase3_case1_restart.json`，状态：`.devlogs/phase3_case1_restart_status.json`
+- 日志导出：`.devlogs/phase3_case1_logs.jsonl`
+- 结论：PASS
+
+### 用例 2：MetaGPT 场景（RUNNING）
+- 创建响应：`.devlogs/phase3_case4_create.json`（`case_id = c_f02478`）
+- 状态响应：`.devlogs/phase3_case4_status.json`（`RUNNING`，`env_keys=["OPENAI_API_KEY"]`）
+- 访问验证：`curl http://localhost:30000/` -> `HTTP/1.0 200 OK`
+- 结论：PASS
+
+### 用例 3：失败场景 + Retry + Archive
+- 失败构建：`.devlogs/phase3_case3_status.json`（`error_code=DOCKER_BUILD_FAILED`）
+- Retry：`.devlogs/phase3_case3_retry.json` 与 `.devlogs/phase3_case3_retry_status.json`（attempt=2，env_keys 保留）
+- Archive：`.devlogs/phase3_case2_archive.json`；列表默认隐藏 `.devlogs/phase3_cases_no_archived.json`；include_archived 显示 `.devlogs/phase3_cases_with_archived.json`
+- 结论：PASS
+
+## 6. 问题清单与修复记录
+1) 管理动作需要可识别容器
+- 修复：新增容器 label（`antihub.case_id` / `antihub.managed=true`），仅对带 label 容器执行 stop/restart
+
+2) Retry 的 env_keys 展示
+- 修复：当 Retry 未提供 env 时，沿用已有 env_keys（不存 env value）
+
+3) 日志导出
+- 修复：新增 JSONL 导出与下载接口，并在前端提供按钮
+
+Patch：`phase3.patch`
+- 应用：`patch -p0 < phase3.patch`
+- 回滚：`patch -p0 -R < phase3.patch`
+
+## 7. 启动说明
+- 后端：`./dev.sh up`
+- 前端：`cd frontend && npm i && npm run dev`
+- 说明：如在 WSL 环境，请使用 WSL 内部 Node/npm（避免 Windows npm 访问 UNC 路径失败）
+
+## 8. Phase 4 建议
+1) 列表性能与索引（Redis 索引/分页优化）
+2) 多项目视角与角色权限
+3) 日志与指标聚合（服务级别状态视图）
+4) 长任务治理（重试策略、队列可视化）
+5) 容器生命周期与资源配额管理
diff -ruN '--exclude=.devlogs' '--exclude=venv' '--exclude=node_modules' '--exclude=__pycache__' /tmp/AntiHub.phase3.base/worker.py /home/user2643/code/AntiHub/worker.py
--- /tmp/AntiHub.phase3.base/worker.py	2026-01-22 21:52:23.262380687 +0800
+++ /home/user2643/code/AntiHub/worker.py	2026-01-22 22:53:27.553933301 +0800
@@ -8,11 +8,18 @@
 import docker
 import redis
 from celery import Celery
+from celery.exceptions import SoftTimeLimitExceeded
 
 from config import (
+    ANALYZE_TIMEOUT_SECONDS,
     BUILD_ROOT,
+    CASE_LABEL_KEY,
+    CASE_LABEL_MANAGED,
     DEFAULT_BRANCH,
     DOCKER_BUILD_TIMEOUT_SECONDS,
+    MANUAL_MAX_README_CHARS,
+    MANUAL_ROOT,
+    MANUAL_TREE_DEPTH,
     PORT_MODE,
     PORT_POOL_END,
     PORT_POOL_START,
@@ -31,7 +38,15 @@
     run_container_fixed,
     wait_for_container_running,
 )
-from storage import append_log, get_case, update_case
+from manual_generator import generate_manual
+from storage import (
+    append_log,
+    get_case,
+    record_manual_stats,
+    set_manual,
+    set_manual_status,
+    update_case,
+)
 
 celery_app = Celery("agent_platform", broker=REDIS_URL, backend=REDIS_URL)
 redis_client = redis.Redis.from_url(REDIS_URL, decode_responses=True)
@@ -68,25 +83,35 @@
 def reserve_port(case_id: str) -> int:
     for port in range(PORT_POOL_START, PORT_POOL_END + 1):
         lock_key = f"{PORT_LOCK_PREFIX}{port}"
-        if redis_client.set(lock_key, case_id, nx=True, ex=3600):
+        if redis_client.set(lock_key, case_id, nx=True, ex=86400):
             return port
-    raise BuildError("No available ports in pool", "PORT_POOL_EXHAUSTED")
-
-
-def release_port(port: Optional[int]) -> None:
-    if port is None:
-        return
-    redis_client.delete(f"{PORT_LOCK_PREFIX}{port}")
+    raise BuildError("No available ports in pool", "PORT_POOL_EXHAUSTED")
+
+
+def reserve_specific_port(case_id: str, port: int) -> None:
+    lock_key = f"{PORT_LOCK_PREFIX}{port}"
+    existing = redis_client.get(lock_key)
+    if existing and existing != case_id:
+        raise BuildError("Port already reserved", "PORT_IN_USE")
+    redis_client.set(lock_key, case_id, ex=86400)
+
+
+def release_port(port: Optional[int]) -> None:
+    if port is None:
+        return
+    redis_client.delete(f"{PORT_LOCK_PREFIX}{port}")
 
 
 def classify_error(exc: Exception) -> tuple[str, str]:
     message = str(exc)
     if isinstance(exc, BuildError):
         return exc.code, message
+    if isinstance(exc, SoftTimeLimitExceeded):
+        return "TIMEOUT_BUILD", "Build task exceeded time limit"
     if isinstance(exc, subprocess.CalledProcessError):
         return "GIT_CLONE_FAILED", message
     if isinstance(exc, subprocess.TimeoutExpired):
-        return "GIT_CLONE_TIMEOUT", message
+        return "TIMEOUT_CLONE", message
     if isinstance(exc, docker.errors.BuildError):
         return "DOCKER_BUILD_FAILED", message
     if isinstance(exc, docker.errors.APIError):
@@ -96,14 +121,23 @@
     if "Container exited" in message:
         return "CONTAINER_EXITED", (
             "Container exited during startup. Ensure the process stays in the foreground."
-        )
-    if "timed out" in message:
-        return "STARTUP_TIMEOUT", (
+        )
+    if isinstance(exc, TimeoutError) or "timed out" in message.lower():
+        return "TIMEOUT_RUN", (
             "Container startup timed out. Verify the app listens on 0.0.0.0 and the port matches EXPOSE."
         )
     return "UNEXPECTED_ERROR", message
 
 
+def classify_manual_error(exc: Exception) -> tuple[str, str]:
+    message = str(exc)
+    if isinstance(exc, subprocess.CalledProcessError):
+        return "MANUAL_CLONE_FAILED", message
+    if isinstance(exc, subprocess.TimeoutExpired):
+        return "TIMEOUT_CLONE", message
+    return "MANUAL_GENERATION_FAILED", message
+
+
 def stream_container_logs(case_id: str, container_id: str) -> None:
     client = docker.from_env()
     container = client.containers.get(container_id)
@@ -118,6 +152,7 @@
         finished_at = _now_ts()
         existing = get_case(case_id) or {}
         runtime = existing.get("runtime") or {}
+        host_port = runtime.get("host_port") or existing.get("host_port")
         if exit_code is None or exit_code == 0:
             update_case(
                 case_id,
@@ -148,6 +183,8 @@
                 },
             )
             publish_log(case_id, "system", f"Container exited with code {exit_code}", level="ERROR")
+        if PORT_MODE != "dynamic":
+            release_port(host_port)
 
 
 def launch_log_stream(case_id: str, container_id: str) -> None:
@@ -169,6 +206,8 @@
     update_case(case_id, {"status": "CLONING", "stage": "clone"})
     target_dir = Path(BUILD_ROOT) / case_id
     host_port: Optional[int] = None
+    port_reserved = False
+    container_started = False
     try:
         publish_log(case_id, "system", f"Cloning repo {repo_url} (ref {ref})...")
         clone_repo(repo_url, ref, target_dir)
@@ -188,13 +227,15 @@
         dockerfile = ensure_dockerfile(target_dir)
         resolved_port = container_port or detect_exposed_port(dockerfile)
 
+        existing = get_case(case_id) or {}
+        env_keys = sorted(env.keys()) if env else sorted(existing.get("env_keys") or [])
         update_case(
             case_id,
             {
                 "status": "BUILDING",
                 "stage": "build",
                 "container_port": resolved_port,
-                "env_keys": sorted(env.keys()),
+                "env_keys": env_keys,
             },
         )
 
@@ -207,14 +248,30 @@
 
         update_case(case_id, {"status": "STARTING", "stage": "run"})
 
+        labels = {CASE_LABEL_KEY: case_id, CASE_LABEL_MANAGED: "true"}
         if PORT_MODE == "dynamic":
-            container_id, host_port = run_container_dynamic(client, tag, resolved_port, env)
+            container_id, host_port = run_container_dynamic(
+                client,
+                tag,
+                resolved_port,
+                env,
+                labels=labels,
+            )
         else:
             host_port = reserve_port(case_id)
-            container_id = run_container_fixed(client, tag, resolved_port, host_port, env)
+            port_reserved = True
+            container_id = run_container_fixed(
+                client,
+                tag,
+                resolved_port,
+                host_port,
+                env,
+                labels=labels,
+            )
 
         wait_for_container_running(client, container_id, STARTUP_TIMEOUT_SECONDS)
         access_url = f"http://{PUBLIC_HOST}:{host_port}"
+        container_started = True
         update_case(
             case_id,
             {
@@ -254,7 +311,7 @@
         raise
     finally:
         cleanup_build_dir(target_dir)
-        if PORT_MODE != "dynamic":
+        if PORT_MODE != "dynamic" and port_reserved and not container_started:
             release_port(host_port)
 
 
@@ -263,10 +320,87 @@
     stream_container_logs(case_id, container_id)
 
 
-@celery_app.task(name="analyze_case")
+@celery_app.task(name="analyze_case", time_limit=ANALYZE_TIMEOUT_SECONDS)
 def analyze_case(case_id: str) -> None:
-    existing = get_case(case_id) or {}
-    status = existing.get("status") or "RUNNING"
-    if status not in {"FAILED", "FINISHED"}:
-        update_case(case_id, {"status": status, "stage": "analyze"})
-    publish_log(case_id, "analyze", "ANALYZE_QUEUED (stub)")
+    try:
+        existing = get_case(case_id) or {}
+        status = existing.get("status") or "RUNNING"
+        if status not in {"FAILED", "FINISHED"}:
+            update_case(case_id, {"status": status, "stage": "analyze"})
+        publish_log(case_id, "analyze", "ANALYZE_QUEUED (stub)")
+    except SoftTimeLimitExceeded as exc:
+        update_case(
+            case_id,
+            {
+                "status": "FAILED",
+                "stage": "analyze",
+                "error_code": "TIMEOUT_ANALYZE",
+                "error_message": str(exc),
+            },
+        )
+        publish_log(case_id, "system", "ERROR [TIMEOUT_ANALYZE]: analyze timed out", level="ERROR")
+        raise
+
+
+@celery_app.task(name="generate_manual")
+def generate_manual_task(case_id: str) -> dict:
+    start = time.time()
+    data = get_case(case_id) or {}
+    repo_url = data.get("repo_url")
+    ref = data.get("ref") or data.get("branch") or DEFAULT_BRANCH
+    env_keys = data.get("env_keys") or []
+    if not repo_url:
+        error_code = "MANUAL_GENERATION_FAILED"
+        error_message = "Missing repo_url"
+        set_manual_status(case_id, "FAILED", error_code, error_message)
+        update_case(
+            case_id,
+            {
+                "manual_status": "FAILED",
+                "manual_error_code": error_code,
+                "manual_error_message": error_message,
+            },
+        )
+        return {"case_id": case_id, "status": "FAILED"}
+
+    set_manual_status(case_id, "RUNNING")
+    update_case(case_id, {"manual_status": "RUNNING"})
+    target_dir = Path(MANUAL_ROOT) / case_id
+    try:
+        clone_repo(repo_url, ref, target_dir)
+        manual_md, meta = generate_manual(
+            target_dir,
+            env_keys=env_keys,
+            repo_name=Path(repo_url).name,
+            tree_depth=MANUAL_TREE_DEPTH,
+            readme_max_chars=MANUAL_MAX_README_CHARS,
+        )
+        set_manual(case_id, manual_md, meta)
+        set_manual_status(case_id, "SUCCESS", generated_at=meta.get("generated_at"))
+        update_case(
+            case_id,
+            {
+                "manual_status": "SUCCESS",
+                "manual_generated_at": meta.get("generated_at"),
+                "manual_error_code": None,
+                "manual_error_message": None,
+            },
+        )
+        record_manual_stats(int((time.time() - start) * 1000), True)
+        return {"case_id": case_id, "status": "SUCCESS"}
+    except Exception as exc:  # noqa: BLE001
+        error_code, error_message = classify_manual_error(exc)
+        set_manual_status(case_id, "FAILED", error_code, error_message)
+        update_case(
+            case_id,
+            {
+                "manual_status": "FAILED",
+                "manual_error_code": error_code,
+                "manual_error_message": error_message,
+            },
+        )
+        publish_log(case_id, "system", f"ERROR [{error_code}]: {error_message}", level="ERROR")
+        record_manual_stats(int((time.time() - start) * 1000), False)
+        raise
+    finally:
+        cleanup_build_dir(target_dir)
